2025-11-05 00:05:28,175: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\output.log initialized.
2025-11-05 00:05:28,176: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528
2025-11-05 00:05:28,177: ### Run configurations for testing_run
2025-11-05 00:05:28,177: experiment_name: testing_run
2025-11-05 00:05:28,178: train_basin_file: calpella
2025-11-05 00:05:28,179: validation_basin_file: calpella
2025-11-05 00:05:28,180: test_basin_file: calpella
2025-11-05 00:05:28,181: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:05:28,181: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:05:28,182: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:05:28,182: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:05:28,184: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:05:28,184: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:05:28,185: device: cuda:0
2025-11-05 00:05:28,186: physics_informed: False
2025-11-05 00:05:28,186: physics_data_file: None
2025-11-05 00:05:28,189: validate_every: 5
2025-11-05 00:05:28,190: validate_n_random_basins: 1
2025-11-05 00:05:28,191: metrics: ['NSE', 'MSE']
2025-11-05 00:05:28,191: model: cudalstm
2025-11-05 00:05:28,192: head: regression
2025-11-05 00:05:28,193: output_activation: linear
2025-11-05 00:05:28,194: hidden_size: 64
2025-11-05 00:05:28,194: initial_forget_bias: 3
2025-11-05 00:05:28,195: output_dropout: 0.4
2025-11-05 00:05:28,196: num_layers: 1
2025-11-05 00:05:28,197: dev_mode: True
2025-11-05 00:05:28,197: optimizer: Adam
2025-11-05 00:05:28,199: loss: NSE
2025-11-05 00:05:28,200: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:05:28,201: batch_size: 64
2025-11-05 00:05:28,202: epochs: 16
2025-11-05 00:05:28,204: clip_gradient_norm: 1
2025-11-05 00:05:28,204: predict_last_n: 1
2025-11-05 00:05:28,206: seq_length: 90
2025-11-05 00:05:28,207: log_interval: 16
2025-11-05 00:05:28,209: log_tensorboard: True
2025-11-05 00:05:28,210: log_n_figures: 1
2025-11-05 00:05:28,211: save_weights_every: 16
2025-11-05 00:05:28,212: early_stopping: True
2025-11-05 00:05:28,213: early_stopping_mode: patience
2025-11-05 00:05:28,216: patience_early_stopping: 3
2025-11-05 00:05:28,217: min_delta_early_stopping: 0.0
2025-11-05 00:05:28,218: minimum_epochs_before_early_stopping: 10
2025-11-05 00:05:28,220: early_stopping_slope_window: 7
2025-11-05 00:05:28,221: early_stopping_slope_patience: 2
2025-11-05 00:05:28,222: early_stopping_slope_min_epoch: 8
2025-11-05 00:05:28,224: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:05:28,225: early_stopping_slope_use_log: True
2025-11-05 00:05:28,226: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:05:28,227: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:05:28,228: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:05:28,230: early_stopping_slope_variance_guard: True
2025-11-05 00:05:28,231: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:05:28,232: dataset: russian_river
2025-11-05 00:05:28,233: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:05:28,235: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:05:28,236: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:05:28,238: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:05:28,239: hourly: False
2025-11-05 00:05:28,240: is_mts: False
2025-11-05 00:05:28,241: is_mts_data: False
2025-11-05 00:05:28,243: verbose: True
2025-11-05 00:05:28,245: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528
2025-11-05 00:05:28,246: run_label: BASELINE
2025-11-05 00:05:28,248: number_of_basins: 1
2025-11-05 00:05:28,248: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\train_data
2025-11-05 00:05:28,250: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\img_log
2025-11-05 00:05:28,941: ### Device cuda:0 will be used for training
2025-11-05 00:05:28,942: Loading basin data into xarray data set.
2025-11-05 00:05:29,072: Calculating target variable stds per basin
2025-11-05 00:05:29,082: Create lookup table and convert to pytorch tensor
2025-11-05 00:05:31,539: Early stopping enabled: mode=patience
2025-11-05 00:05:32,178: Epoch 1 average loss: avg_loss: 2.62e-06, avg_total_loss: 2.62e-06
2025-11-05 00:05:32,541: Epoch 2 average loss: avg_loss: 1.55e-06, avg_total_loss: 1.55e-06
2025-11-05 00:05:32,896: Epoch 3 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:05:33,274: Epoch 4 average loss: avg_loss: 9.52e-07, avg_total_loss: 9.52e-07
2025-11-05 00:05:33,585: Epoch 5 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:05:34,193: Epoch 5 average validation loss: 1.12e-06 -- Median validation metrics: avg_loss: 1.12e-06, NSE: 0.74268, MSE: 44082.01953
2025-11-05 00:05:34,529: Epoch 6 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:05:34,903: Epoch 7 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:05:34,903: Setting learning rate to 0.005
2025-11-05 00:05:35,275: Epoch 8 average loss: avg_loss: 1.49e-06, avg_total_loss: 1.49e-06
2025-11-05 00:05:35,633: Epoch 9 average loss: avg_loss: 9.89e-07, avg_total_loss: 9.89e-07
2025-11-05 00:05:35,988: Epoch 10 average loss: avg_loss: 8.22e-07, avg_total_loss: 8.22e-07
2025-11-05 00:05:36,224: Epoch 10 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76893, MSE: 39585.41797
2025-11-05 00:05:36,619: Epoch 11 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:05:36,620: Setting learning rate to 0.001
2025-11-05 00:05:37,060: Epoch 12 average loss: avg_loss: 7.33e-07, avg_total_loss: 7.33e-07
2025-11-05 00:05:37,487: Epoch 13 average loss: avg_loss: 7.97e-07, avg_total_loss: 7.97e-07
2025-11-05 00:05:38,026: Epoch 14 average loss: avg_loss: 7.25e-07, avg_total_loss: 7.25e-07
2025-11-05 00:05:38,457: Epoch 15 average loss: avg_loss: 7.70e-07, avg_total_loss: 7.70e-07
2025-11-05 00:05:38,708: Epoch 15 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76413, MSE: 40407.48438
2025-11-05 00:05:39,068: Epoch 16 average loss: avg_loss: 7.10e-07, avg_total_loss: 7.10e-07
2025-11-05 00:05:39,084: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\model_epoch016.pt
2025-11-05 00:05:39,274: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:05:39,275: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000528\validation\model_epoch016\validation_results.p
2025-11-05 00:05:39,991: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\output.log initialized.
2025-11-05 00:05:39,992: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539
2025-11-05 00:05:39,993: ### Run configurations for testing_run
2025-11-05 00:05:39,993: experiment_name: testing_run
2025-11-05 00:05:39,994: train_basin_file: calpella
2025-11-05 00:05:39,995: validation_basin_file: calpella
2025-11-05 00:05:39,996: test_basin_file: calpella
2025-11-05 00:05:39,997: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:05:39,998: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:05:39,999: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:05:39,999: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:05:40,000: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:05:40,001: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:05:40,002: device: cuda:0
2025-11-05 00:05:40,002: physics_informed: False
2025-11-05 00:05:40,002: physics_data_file: None
2025-11-05 00:05:40,003: validate_every: 5
2025-11-05 00:05:40,004: validate_n_random_basins: 1
2025-11-05 00:05:40,004: metrics: ['NSE', 'MSE']
2025-11-05 00:05:40,005: model: cudalstm
2025-11-05 00:05:40,006: head: regression
2025-11-05 00:05:40,007: output_activation: linear
2025-11-05 00:05:40,007: hidden_size: 64
2025-11-05 00:05:40,008: initial_forget_bias: 3
2025-11-05 00:05:40,009: output_dropout: 0.4
2025-11-05 00:05:40,009: num_layers: 1
2025-11-05 00:05:40,010: dev_mode: True
2025-11-05 00:05:40,011: optimizer: Adam
2025-11-05 00:05:40,012: loss: NSE
2025-11-05 00:05:40,013: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:05:40,014: batch_size: 128
2025-11-05 00:05:40,015: epochs: 16
2025-11-05 00:05:40,015: clip_gradient_norm: 1
2025-11-05 00:05:40,016: predict_last_n: 1
2025-11-05 00:05:40,017: seq_length: 90
2025-11-05 00:05:40,017: log_interval: 16
2025-11-05 00:05:40,018: log_tensorboard: True
2025-11-05 00:05:40,019: log_n_figures: 1
2025-11-05 00:05:40,020: save_weights_every: 16
2025-11-05 00:05:40,021: early_stopping: True
2025-11-05 00:05:40,022: early_stopping_mode: patience
2025-11-05 00:05:40,023: patience_early_stopping: 3
2025-11-05 00:05:40,025: min_delta_early_stopping: 0.0
2025-11-05 00:05:40,026: minimum_epochs_before_early_stopping: 10
2025-11-05 00:05:40,027: early_stopping_slope_window: 7
2025-11-05 00:05:40,029: early_stopping_slope_patience: 2
2025-11-05 00:05:40,030: early_stopping_slope_min_epoch: 8
2025-11-05 00:05:40,032: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:05:40,033: early_stopping_slope_use_log: True
2025-11-05 00:05:40,034: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:05:40,035: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:05:40,036: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:05:40,037: early_stopping_slope_variance_guard: True
2025-11-05 00:05:40,039: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:05:40,040: dataset: russian_river
2025-11-05 00:05:40,042: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:05:40,043: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:05:40,044: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:05:40,045: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:05:40,046: hourly: False
2025-11-05 00:05:40,047: is_mts: False
2025-11-05 00:05:40,048: is_mts_data: False
2025-11-05 00:05:40,049: verbose: True
2025-11-05 00:05:40,051: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539
2025-11-05 00:05:40,051: run_label: BASELINE
2025-11-05 00:05:40,053: number_of_basins: 1
2025-11-05 00:05:40,054: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\train_data
2025-11-05 00:05:40,055: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\img_log
2025-11-05 00:05:40,060: ### Device cuda:0 will be used for training
2025-11-05 00:05:40,061: Loading basin data into xarray data set.
2025-11-05 00:05:40,226: Calculating target variable stds per basin
2025-11-05 00:05:40,234: Create lookup table and convert to pytorch tensor
2025-11-05 00:05:40,355: Early stopping enabled: mode=patience
2025-11-05 00:05:40,553: Epoch 1 average loss: avg_loss: 3.15e-06, avg_total_loss: 3.15e-06
2025-11-05 00:05:40,845: Epoch 2 average loss: avg_loss: 1.76e-06, avg_total_loss: 1.76e-06
2025-11-05 00:05:41,077: Epoch 3 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:05:41,365: Epoch 4 average loss: avg_loss: 1.19e-06, avg_total_loss: 1.19e-06
2025-11-05 00:05:41,655: Epoch 5 average loss: avg_loss: 1.12e-06, avg_total_loss: 1.12e-06
2025-11-05 00:05:42,061: Epoch 5 average validation loss: 9.71e-07 -- Median validation metrics: avg_loss: 9.71e-07, NSE: 0.77763, MSE: 38094.03906
2025-11-05 00:05:42,310: Epoch 6 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:05:42,596: Epoch 7 average loss: avg_loss: 8.71e-07, avg_total_loss: 8.71e-07
2025-11-05 00:05:42,597: Setting learning rate to 0.005
2025-11-05 00:05:42,913: Epoch 8 average loss: avg_loss: 8.62e-07, avg_total_loss: 8.62e-07
2025-11-05 00:05:43,200: Epoch 9 average loss: avg_loss: 7.55e-07, avg_total_loss: 7.55e-07
2025-11-05 00:05:43,491: Epoch 10 average loss: avg_loss: 6.58e-07, avg_total_loss: 6.58e-07
2025-11-05 00:05:43,874: Epoch 10 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.75974, MSE: 41158.73047
2025-11-05 00:05:44,210: Epoch 11 average loss: avg_loss: 7.48e-07, avg_total_loss: 7.48e-07
2025-11-05 00:05:44,211: Setting learning rate to 0.001
2025-11-05 00:05:44,478: Epoch 12 average loss: avg_loss: 7.55e-07, avg_total_loss: 7.55e-07
2025-11-05 00:05:44,771: Epoch 13 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:05:45,073: Epoch 14 average loss: avg_loss: 6.24e-07, avg_total_loss: 6.24e-07
2025-11-05 00:05:45,309: Epoch 15 average loss: avg_loss: 6.68e-07, avg_total_loss: 6.68e-07
2025-11-05 00:05:45,588: Epoch 15 average validation loss: 1.08e-06 -- Median validation metrics: avg_loss: 1.08e-06, NSE: 0.75206, MSE: 42475.76953
2025-11-05 00:05:45,763: Epoch 16 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:05:45,777: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\model_epoch016.pt
2025-11-05 00:05:45,968: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:05:45,970: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000539\validation\model_epoch016\validation_results.p
2025-11-05 00:05:46,724: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\output.log initialized.
2025-11-05 00:05:46,725: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546
2025-11-05 00:05:46,726: ### Run configurations for testing_run
2025-11-05 00:05:46,727: experiment_name: testing_run
2025-11-05 00:05:46,728: train_basin_file: calpella
2025-11-05 00:05:46,729: validation_basin_file: calpella
2025-11-05 00:05:46,730: test_basin_file: calpella
2025-11-05 00:05:46,731: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:05:46,732: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:05:46,733: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:05:46,734: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:05:46,735: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:05:46,736: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:05:46,737: device: cuda:0
2025-11-05 00:05:46,738: physics_informed: False
2025-11-05 00:05:46,739: physics_data_file: None
2025-11-05 00:05:46,740: validate_every: 5
2025-11-05 00:05:46,741: validate_n_random_basins: 1
2025-11-05 00:05:46,742: metrics: ['NSE', 'MSE']
2025-11-05 00:05:46,743: model: cudalstm
2025-11-05 00:05:46,744: head: regression
2025-11-05 00:05:46,744: output_activation: linear
2025-11-05 00:05:46,745: hidden_size: 64
2025-11-05 00:05:46,746: initial_forget_bias: 3
2025-11-05 00:05:46,747: output_dropout: 0.4
2025-11-05 00:05:46,748: num_layers: 1
2025-11-05 00:05:46,749: dev_mode: True
2025-11-05 00:05:46,749: optimizer: Adam
2025-11-05 00:05:46,750: loss: NSE
2025-11-05 00:05:46,751: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:05:46,752: batch_size: 256
2025-11-05 00:05:46,752: epochs: 16
2025-11-05 00:05:46,753: clip_gradient_norm: 1
2025-11-05 00:05:46,754: predict_last_n: 1
2025-11-05 00:05:46,755: seq_length: 90
2025-11-05 00:05:46,755: log_interval: 16
2025-11-05 00:05:46,756: log_tensorboard: True
2025-11-05 00:05:46,757: log_n_figures: 1
2025-11-05 00:05:46,759: save_weights_every: 16
2025-11-05 00:05:46,768: early_stopping: True
2025-11-05 00:05:46,769: early_stopping_mode: patience
2025-11-05 00:05:46,770: patience_early_stopping: 3
2025-11-05 00:05:46,770: min_delta_early_stopping: 0.0
2025-11-05 00:05:46,771: minimum_epochs_before_early_stopping: 10
2025-11-05 00:05:46,772: early_stopping_slope_window: 7
2025-11-05 00:05:46,773: early_stopping_slope_patience: 2
2025-11-05 00:05:46,774: early_stopping_slope_min_epoch: 8
2025-11-05 00:05:46,774: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:05:46,775: early_stopping_slope_use_log: True
2025-11-05 00:05:46,776: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:05:46,776: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:05:46,777: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:05:46,778: early_stopping_slope_variance_guard: True
2025-11-05 00:05:46,779: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:05:46,779: dataset: russian_river
2025-11-05 00:05:46,780: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:05:46,781: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:05:46,782: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:05:46,783: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:05:46,783: hourly: False
2025-11-05 00:05:46,784: is_mts: False
2025-11-05 00:05:46,785: is_mts_data: False
2025-11-05 00:05:46,786: verbose: True
2025-11-05 00:05:46,786: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546
2025-11-05 00:05:46,787: run_label: BASELINE
2025-11-05 00:05:46,787: number_of_basins: 1
2025-11-05 00:05:46,789: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\train_data
2025-11-05 00:05:46,789: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\img_log
2025-11-05 00:05:46,791: ### Device cuda:0 will be used for training
2025-11-05 00:05:46,792: Loading basin data into xarray data set.
2025-11-05 00:05:46,946: Calculating target variable stds per basin
2025-11-05 00:05:46,953: Create lookup table and convert to pytorch tensor
2025-11-05 00:05:47,074: Early stopping enabled: mode=patience
2025-11-05 00:05:47,288: Epoch 1 average loss: avg_loss: 3.51e-06, avg_total_loss: 3.51e-06
2025-11-05 00:05:47,475: Epoch 2 average loss: avg_loss: 2.22e-06, avg_total_loss: 2.22e-06
2025-11-05 00:05:47,661: Epoch 3 average loss: avg_loss: 1.68e-06, avg_total_loss: 1.68e-06
2025-11-05 00:05:47,860: Epoch 4 average loss: avg_loss: 1.50e-06, avg_total_loss: 1.50e-06
2025-11-05 00:05:47,983: Epoch 5 average loss: avg_loss: 1.27e-06, avg_total_loss: 1.27e-06
2025-11-05 00:05:48,336: Epoch 5 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.74128, MSE: 44321.02734
2025-11-05 00:05:48,442: Epoch 6 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:05:48,540: Epoch 7 average loss: avg_loss: 1.14e-06, avg_total_loss: 1.14e-06
2025-11-05 00:05:48,541: Setting learning rate to 0.005
2025-11-05 00:05:48,677: Epoch 8 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:05:48,799: Epoch 9 average loss: avg_loss: 9.97e-07, avg_total_loss: 9.97e-07
2025-11-05 00:05:48,930: Epoch 10 average loss: avg_loss: 9.01e-07, avg_total_loss: 9.01e-07
2025-11-05 00:05:49,188: Epoch 10 average validation loss: 1.00e-06 -- Median validation metrics: avg_loss: 1.00e-06, NSE: 0.74751, MSE: 43255.07031
2025-11-05 00:05:49,289: Epoch 11 average loss: avg_loss: 8.39e-07, avg_total_loss: 8.39e-07
2025-11-05 00:05:49,289: Setting learning rate to 0.001
2025-11-05 00:05:49,388: Epoch 12 average loss: avg_loss: 7.77e-07, avg_total_loss: 7.77e-07
2025-11-05 00:05:49,528: Epoch 13 average loss: avg_loss: 7.82e-07, avg_total_loss: 7.82e-07
2025-11-05 00:05:49,650: Epoch 14 average loss: avg_loss: 7.57e-07, avg_total_loss: 7.57e-07
2025-11-05 00:05:49,782: Epoch 15 average loss: avg_loss: 7.75e-07, avg_total_loss: 7.75e-07
2025-11-05 00:05:50,061: Epoch 15 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.74333, MSE: 43970.47266
2025-11-05 00:05:50,184: Epoch 16 average loss: avg_loss: 8.78e-07, avg_total_loss: 8.78e-07
2025-11-05 00:05:50,199: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\model_epoch016.pt
2025-11-05 00:05:50,370: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:05:50,372: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000546\validation\model_epoch016\validation_results.p
2025-11-05 00:05:51,042: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\output.log initialized.
2025-11-05 00:05:51,043: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551
2025-11-05 00:05:51,044: ### Run configurations for testing_run
2025-11-05 00:05:51,045: experiment_name: testing_run
2025-11-05 00:05:51,045: train_basin_file: calpella
2025-11-05 00:05:51,046: validation_basin_file: calpella
2025-11-05 00:05:51,047: test_basin_file: calpella
2025-11-05 00:05:51,047: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:05:51,048: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:05:51,049: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:05:51,049: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:05:51,050: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:05:51,050: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:05:51,052: device: cuda:0
2025-11-05 00:05:51,053: physics_informed: False
2025-11-05 00:05:51,053: physics_data_file: None
2025-11-05 00:05:51,054: validate_every: 5
2025-11-05 00:05:51,055: validate_n_random_basins: 1
2025-11-05 00:05:51,055: metrics: ['NSE', 'MSE']
2025-11-05 00:05:51,056: model: cudalstm
2025-11-05 00:05:51,057: head: regression
2025-11-05 00:05:51,058: output_activation: linear
2025-11-05 00:05:51,059: hidden_size: 64
2025-11-05 00:05:51,060: initial_forget_bias: 3
2025-11-05 00:05:51,061: output_dropout: 0.4
2025-11-05 00:05:51,062: num_layers: 1
2025-11-05 00:05:51,063: dev_mode: True
2025-11-05 00:05:51,064: optimizer: Adam
2025-11-05 00:05:51,064: loss: NSE
2025-11-05 00:05:51,065: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:05:51,066: batch_size: 64
2025-11-05 00:05:51,067: epochs: 32
2025-11-05 00:05:51,067: clip_gradient_norm: 1
2025-11-05 00:05:51,068: predict_last_n: 1
2025-11-05 00:05:51,068: seq_length: 90
2025-11-05 00:05:51,069: log_interval: 16
2025-11-05 00:05:51,071: log_tensorboard: True
2025-11-05 00:05:51,071: log_n_figures: 1
2025-11-05 00:05:51,072: save_weights_every: 32
2025-11-05 00:05:51,073: early_stopping: True
2025-11-05 00:05:51,074: early_stopping_mode: patience
2025-11-05 00:05:51,075: patience_early_stopping: 3
2025-11-05 00:05:51,075: min_delta_early_stopping: 0.0
2025-11-05 00:05:51,076: minimum_epochs_before_early_stopping: 10
2025-11-05 00:05:51,077: early_stopping_slope_window: 7
2025-11-05 00:05:51,078: early_stopping_slope_patience: 2
2025-11-05 00:05:51,078: early_stopping_slope_min_epoch: 8
2025-11-05 00:05:51,079: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:05:51,080: early_stopping_slope_use_log: True
2025-11-05 00:05:51,081: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:05:51,082: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:05:51,083: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:05:51,084: early_stopping_slope_variance_guard: True
2025-11-05 00:05:51,085: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:05:51,086: dataset: russian_river
2025-11-05 00:05:51,087: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:05:51,087: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:05:51,088: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:05:51,089: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:05:51,090: hourly: False
2025-11-05 00:05:51,091: is_mts: False
2025-11-05 00:05:51,092: is_mts_data: False
2025-11-05 00:05:51,093: verbose: True
2025-11-05 00:05:51,094: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551
2025-11-05 00:05:51,094: run_label: BASELINE
2025-11-05 00:05:51,095: number_of_basins: 1
2025-11-05 00:05:51,096: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\train_data
2025-11-05 00:05:51,096: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\img_log
2025-11-05 00:05:51,099: ### Device cuda:0 will be used for training
2025-11-05 00:05:51,100: Loading basin data into xarray data set.
2025-11-05 00:05:51,261: Calculating target variable stds per basin
2025-11-05 00:05:51,270: Create lookup table and convert to pytorch tensor
2025-11-05 00:05:51,400: Early stopping enabled: mode=patience
2025-11-05 00:05:51,796: Epoch 1 average loss: avg_loss: 2.68e-06, avg_total_loss: 2.68e-06
2025-11-05 00:05:52,221: Epoch 2 average loss: avg_loss: 1.51e-06, avg_total_loss: 1.51e-06
2025-11-05 00:05:52,570: Epoch 3 average loss: avg_loss: 1.20e-06, avg_total_loss: 1.20e-06
2025-11-05 00:05:52,931: Epoch 4 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:05:53,428: Epoch 5 average loss: avg_loss: 9.31e-07, avg_total_loss: 9.31e-07
2025-11-05 00:05:53,817: Epoch 5 average validation loss: 9.78e-07 -- Median validation metrics: avg_loss: 9.78e-07, NSE: 0.77562, MSE: 38438.86328
2025-11-05 00:05:54,272: Epoch 6 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:05:54,700: Epoch 7 average loss: avg_loss: 8.46e-07, avg_total_loss: 8.46e-07
2025-11-05 00:05:55,069: Epoch 8 average loss: avg_loss: 8.43e-07, avg_total_loss: 8.43e-07
2025-11-05 00:05:55,462: Epoch 9 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:05:55,842: Epoch 10 average loss: avg_loss: 8.39e-07, avg_total_loss: 8.39e-07
2025-11-05 00:05:56,092: Epoch 10 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76643, MSE: 40013.32812
2025-11-05 00:05:56,484: Epoch 11 average loss: avg_loss: 8.13e-07, avg_total_loss: 8.13e-07
2025-11-05 00:05:56,877: Epoch 12 average loss: avg_loss: 7.16e-07, avg_total_loss: 7.16e-07
2025-11-05 00:05:57,255: Epoch 13 average loss: avg_loss: 8.15e-07, avg_total_loss: 8.15e-07
2025-11-05 00:05:57,638: Epoch 14 average loss: avg_loss: 6.74e-07, avg_total_loss: 6.74e-07
2025-11-05 00:05:58,044: Epoch 15 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:05:58,303: Epoch 15 average validation loss: 9.99e-07 -- Median validation metrics: avg_loss: 9.99e-07, NSE: 0.76966, MSE: 39460.30078
2025-11-05 00:05:58,305: Setting learning rate to 0.005
2025-11-05 00:05:58,699: Epoch 16 average loss: avg_loss: 7.26e-07, avg_total_loss: 7.26e-07
2025-11-05 00:05:59,093: Epoch 17 average loss: avg_loss: 6.32e-07, avg_total_loss: 6.32e-07
2025-11-05 00:05:59,486: Epoch 18 average loss: avg_loss: 7.05e-07, avg_total_loss: 7.05e-07
2025-11-05 00:05:59,890: Epoch 19 average loss: avg_loss: 5.60e-07, avg_total_loss: 5.60e-07
2025-11-05 00:06:00,292: Epoch 20 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:06:00,550: Epoch 20 average validation loss: 9.55e-07 -- Median validation metrics: avg_loss: 9.55e-07, NSE: 0.78146, MSE: 37439.28125
2025-11-05 00:06:00,960: Epoch 21 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:06:01,342: Epoch 22 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:06:01,838: Epoch 23 average loss: avg_loss: 6.04e-07, avg_total_loss: 6.04e-07
2025-11-05 00:06:01,839: Setting learning rate to 0.001
2025-11-05 00:06:02,233: Epoch 24 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:06:02,608: Epoch 25 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:06:02,879: Epoch 25 average validation loss: 9.18e-07 -- Median validation metrics: avg_loss: 9.18e-07, NSE: 0.78893, MSE: 36159.64062
2025-11-05 00:06:03,273: Epoch 26 average loss: avg_loss: 4.25e-07, avg_total_loss: 4.25e-07
2025-11-05 00:06:03,661: Epoch 27 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:06:04,050: Epoch 28 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:06:04,439: Epoch 29 average loss: avg_loss: 4.55e-07, avg_total_loss: 4.55e-07
2025-11-05 00:06:04,854: Epoch 30 average loss: avg_loss: 4.81e-07, avg_total_loss: 4.81e-07
2025-11-05 00:06:05,127: Epoch 30 average validation loss: 9.20e-07 -- Median validation metrics: avg_loss: 9.20e-07, NSE: 0.78869, MSE: 36199.94141
2025-11-05 00:06:05,545: Epoch 31 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:06:05,970: Epoch 32 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:06:05,988: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\model_epoch032.pt
2025-11-05 00:06:06,293: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:06:06,295: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000551\validation\model_epoch032\validation_results.p
2025-11-05 00:06:06,947: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\output.log initialized.
2025-11-05 00:06:06,947: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606
2025-11-05 00:06:06,948: ### Run configurations for testing_run
2025-11-05 00:06:06,949: experiment_name: testing_run
2025-11-05 00:06:06,950: train_basin_file: calpella
2025-11-05 00:06:06,950: validation_basin_file: calpella
2025-11-05 00:06:06,951: test_basin_file: calpella
2025-11-05 00:06:06,952: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:06:06,952: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:06:06,953: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:06:06,954: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:06:06,954: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:06:06,955: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:06:06,956: device: cuda:0
2025-11-05 00:06:06,956: physics_informed: False
2025-11-05 00:06:06,957: physics_data_file: None
2025-11-05 00:06:06,958: validate_every: 5
2025-11-05 00:06:06,959: validate_n_random_basins: 1
2025-11-05 00:06:06,959: metrics: ['NSE', 'MSE']
2025-11-05 00:06:06,960: model: cudalstm
2025-11-05 00:06:06,960: head: regression
2025-11-05 00:06:06,961: output_activation: linear
2025-11-05 00:06:06,962: hidden_size: 64
2025-11-05 00:06:06,962: initial_forget_bias: 3
2025-11-05 00:06:06,963: output_dropout: 0.4
2025-11-05 00:06:06,964: num_layers: 1
2025-11-05 00:06:06,964: dev_mode: True
2025-11-05 00:06:06,964: optimizer: Adam
2025-11-05 00:06:06,966: loss: NSE
2025-11-05 00:06:06,966: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:06:06,967: batch_size: 128
2025-11-05 00:06:06,967: epochs: 32
2025-11-05 00:06:06,968: clip_gradient_norm: 1
2025-11-05 00:06:06,969: predict_last_n: 1
2025-11-05 00:06:06,970: seq_length: 90
2025-11-05 00:06:06,970: log_interval: 16
2025-11-05 00:06:06,971: log_tensorboard: True
2025-11-05 00:06:06,972: log_n_figures: 1
2025-11-05 00:06:06,972: save_weights_every: 32
2025-11-05 00:06:06,973: early_stopping: True
2025-11-05 00:06:06,974: early_stopping_mode: patience
2025-11-05 00:06:06,975: patience_early_stopping: 3
2025-11-05 00:06:06,975: min_delta_early_stopping: 0.0
2025-11-05 00:06:06,976: minimum_epochs_before_early_stopping: 10
2025-11-05 00:06:06,977: early_stopping_slope_window: 7
2025-11-05 00:06:06,978: early_stopping_slope_patience: 2
2025-11-05 00:06:06,978: early_stopping_slope_min_epoch: 8
2025-11-05 00:06:06,979: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:06:06,980: early_stopping_slope_use_log: True
2025-11-05 00:06:06,981: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:06:06,982: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:06:06,982: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:06:06,983: early_stopping_slope_variance_guard: True
2025-11-05 00:06:06,984: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:06:06,985: dataset: russian_river
2025-11-05 00:06:06,986: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:06:06,986: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:06:06,987: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:06:06,988: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:06:06,989: hourly: False
2025-11-05 00:06:06,989: is_mts: False
2025-11-05 00:06:06,991: is_mts_data: False
2025-11-05 00:06:06,992: verbose: True
2025-11-05 00:06:06,993: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606
2025-11-05 00:06:06,993: run_label: BASELINE
2025-11-05 00:06:06,994: number_of_basins: 1
2025-11-05 00:06:06,995: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\train_data
2025-11-05 00:06:06,996: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\img_log
2025-11-05 00:06:06,998: ### Device cuda:0 will be used for training
2025-11-05 00:06:07,000: Loading basin data into xarray data set.
2025-11-05 00:06:07,170: Calculating target variable stds per basin
2025-11-05 00:06:07,178: Create lookup table and convert to pytorch tensor
2025-11-05 00:06:07,293: Early stopping enabled: mode=patience
2025-11-05 00:06:07,800: Epoch 1 average loss: avg_loss: 3.02e-06, avg_total_loss: 3.02e-06
2025-11-05 00:06:08,094: Epoch 2 average loss: avg_loss: 1.93e-06, avg_total_loss: 1.93e-06
2025-11-05 00:06:08,377: Epoch 3 average loss: avg_loss: 1.65e-06, avg_total_loss: 1.65e-06
2025-11-05 00:06:08,651: Epoch 4 average loss: avg_loss: 1.27e-06, avg_total_loss: 1.27e-06
2025-11-05 00:06:08,932: Epoch 5 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:06:09,347: Epoch 5 average validation loss: 1.05e-06 -- Median validation metrics: avg_loss: 1.05e-06, NSE: 0.75922, MSE: 41249.31641
2025-11-05 00:06:09,618: Epoch 6 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:06:09,883: Epoch 7 average loss: avg_loss: 9.98e-07, avg_total_loss: 9.98e-07
2025-11-05 00:06:10,114: Epoch 8 average loss: avg_loss: 1.12e-06, avg_total_loss: 1.12e-06
2025-11-05 00:06:10,355: Epoch 9 average loss: avg_loss: 9.45e-07, avg_total_loss: 9.45e-07
2025-11-05 00:06:10,610: Epoch 10 average loss: avg_loss: 8.72e-07, avg_total_loss: 8.72e-07
2025-11-05 00:06:10,885: Epoch 10 average validation loss: 1.26e-06 -- Median validation metrics: avg_loss: 1.26e-06, NSE: 0.70983, MSE: 49708.85156
2025-11-05 00:06:11,119: Epoch 11 average loss: avg_loss: 8.54e-07, avg_total_loss: 8.54e-07
2025-11-05 00:06:11,373: Epoch 12 average loss: avg_loss: 8.47e-07, avg_total_loss: 8.47e-07
2025-11-05 00:06:11,639: Epoch 13 average loss: avg_loss: 7.98e-07, avg_total_loss: 7.98e-07
2025-11-05 00:06:11,914: Epoch 14 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:06:12,210: Epoch 15 average loss: avg_loss: 7.06e-07, avg_total_loss: 7.06e-07
2025-11-05 00:06:12,479: Epoch 15 average validation loss: 9.72e-07 -- Median validation metrics: avg_loss: 9.72e-07, NSE: 0.77701, MSE: 38201.53906
2025-11-05 00:06:12,480: Setting learning rate to 0.005
2025-11-05 00:06:12,744: Epoch 16 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:06:13,035: Epoch 17 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:06:13,320: Epoch 18 average loss: avg_loss: 5.69e-07, avg_total_loss: 5.69e-07
2025-11-05 00:06:13,628: Epoch 19 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:06:13,941: Epoch 20 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:06:14,253: Epoch 20 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75442, MSE: 42071.26172
2025-11-05 00:06:14,558: Epoch 21 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:06:14,836: Epoch 22 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:06:15,134: Epoch 23 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:06:15,135: Setting learning rate to 0.001
2025-11-05 00:06:15,418: Epoch 24 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:06:15,719: Epoch 25 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:06:15,985: Epoch 25 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75328, MSE: 42266.51562
2025-11-05 00:06:16,281: Epoch 26 average loss: avg_loss: 5.29e-07, avg_total_loss: 5.29e-07
2025-11-05 00:06:16,536: Epoch 27 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:06:16,765: Epoch 28 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:06:16,965: Epoch 29 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:06:17,222: Epoch 30 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:06:17,490: Epoch 30 average validation loss: 1.10e-06 -- Median validation metrics: avg_loss: 1.10e-06, NSE: 0.74827, MSE: 43125.21484
2025-11-05 00:06:17,491: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:06:17,492: Early stopping triggered at epoch 30
2025-11-05 00:06:17,508: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\model_epoch030.pt
2025-11-05 00:06:17,683: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:06:17,684: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000606\validation\model_epoch030\validation_results.p
2025-11-05 00:06:18,483: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\output.log initialized.
2025-11-05 00:06:18,484: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618
2025-11-05 00:06:18,485: ### Run configurations for testing_run
2025-11-05 00:06:18,486: experiment_name: testing_run
2025-11-05 00:06:18,486: train_basin_file: calpella
2025-11-05 00:06:18,487: validation_basin_file: calpella
2025-11-05 00:06:18,488: test_basin_file: calpella
2025-11-05 00:06:18,488: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:06:18,489: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:06:18,490: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:06:18,490: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:06:18,492: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:06:18,492: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:06:18,493: device: cuda:0
2025-11-05 00:06:18,493: physics_informed: False
2025-11-05 00:06:18,494: physics_data_file: None
2025-11-05 00:06:18,495: validate_every: 5
2025-11-05 00:06:18,495: validate_n_random_basins: 1
2025-11-05 00:06:18,496: metrics: ['NSE', 'MSE']
2025-11-05 00:06:18,497: model: cudalstm
2025-11-05 00:06:18,497: head: regression
2025-11-05 00:06:18,498: output_activation: linear
2025-11-05 00:06:18,498: hidden_size: 64
2025-11-05 00:06:18,499: initial_forget_bias: 3
2025-11-05 00:06:18,499: output_dropout: 0.4
2025-11-05 00:06:18,501: num_layers: 1
2025-11-05 00:06:18,501: dev_mode: True
2025-11-05 00:06:18,502: optimizer: Adam
2025-11-05 00:06:18,502: loss: NSE
2025-11-05 00:06:18,503: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:06:18,504: batch_size: 256
2025-11-05 00:06:18,504: epochs: 32
2025-11-05 00:06:18,505: clip_gradient_norm: 1
2025-11-05 00:06:18,506: predict_last_n: 1
2025-11-05 00:06:18,506: seq_length: 90
2025-11-05 00:06:18,507: log_interval: 16
2025-11-05 00:06:18,507: log_tensorboard: True
2025-11-05 00:06:18,508: log_n_figures: 1
2025-11-05 00:06:18,509: save_weights_every: 32
2025-11-05 00:06:18,509: early_stopping: True
2025-11-05 00:06:18,510: early_stopping_mode: patience
2025-11-05 00:06:18,511: patience_early_stopping: 3
2025-11-05 00:06:18,511: min_delta_early_stopping: 0.0
2025-11-05 00:06:18,512: minimum_epochs_before_early_stopping: 10
2025-11-05 00:06:18,513: early_stopping_slope_window: 7
2025-11-05 00:06:18,513: early_stopping_slope_patience: 2
2025-11-05 00:06:18,514: early_stopping_slope_min_epoch: 8
2025-11-05 00:06:18,515: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:06:18,515: early_stopping_slope_use_log: True
2025-11-05 00:06:18,516: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:06:18,517: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:06:18,518: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:06:18,519: early_stopping_slope_variance_guard: True
2025-11-05 00:06:18,519: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:06:18,520: dataset: russian_river
2025-11-05 00:06:18,521: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:06:18,521: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:06:18,522: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:06:18,523: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:06:18,524: hourly: False
2025-11-05 00:06:18,525: is_mts: False
2025-11-05 00:06:18,527: is_mts_data: False
2025-11-05 00:06:18,527: verbose: True
2025-11-05 00:06:18,528: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618
2025-11-05 00:06:18,529: run_label: BASELINE
2025-11-05 00:06:18,530: number_of_basins: 1
2025-11-05 00:06:18,530: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\train_data
2025-11-05 00:06:18,531: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\img_log
2025-11-05 00:06:18,534: ### Device cuda:0 will be used for training
2025-11-05 00:06:18,535: Loading basin data into xarray data set.
2025-11-05 00:06:18,700: Calculating target variable stds per basin
2025-11-05 00:06:18,710: Create lookup table and convert to pytorch tensor
2025-11-05 00:06:18,844: Early stopping enabled: mode=patience
2025-11-05 00:06:19,064: Epoch 1 average loss: avg_loss: 3.43e-06, avg_total_loss: 3.43e-06
2025-11-05 00:06:19,284: Epoch 2 average loss: avg_loss: 2.26e-06, avg_total_loss: 2.26e-06
2025-11-05 00:06:19,504: Epoch 3 average loss: avg_loss: 1.66e-06, avg_total_loss: 1.66e-06
2025-11-05 00:06:19,706: Epoch 4 average loss: avg_loss: 1.19e-06, avg_total_loss: 1.19e-06
2025-11-05 00:06:19,904: Epoch 5 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:06:20,295: Epoch 5 average validation loss: 1.34e-06 -- Median validation metrics: avg_loss: 1.34e-06, NSE: 0.65867, MSE: 58474.17578
2025-11-05 00:06:20,404: Epoch 6 average loss: avg_loss: 1.40e-06, avg_total_loss: 1.40e-06
2025-11-05 00:06:20,518: Epoch 7 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:06:20,665: Epoch 8 average loss: avg_loss: 9.97e-07, avg_total_loss: 9.97e-07
2025-11-05 00:06:20,790: Epoch 9 average loss: avg_loss: 9.15e-07, avg_total_loss: 9.15e-07
2025-11-05 00:06:20,928: Epoch 10 average loss: avg_loss: 8.94e-07, avg_total_loss: 8.94e-07
2025-11-05 00:06:21,204: Epoch 10 average validation loss: 1.36e-06 -- Median validation metrics: avg_loss: 1.36e-06, NSE: 0.65456, MSE: 59177.87500
2025-11-05 00:06:21,327: Epoch 11 average loss: avg_loss: 9.87e-07, avg_total_loss: 9.87e-07
2025-11-05 00:06:21,459: Epoch 12 average loss: avg_loss: 8.69e-07, avg_total_loss: 8.69e-07
2025-11-05 00:06:21,588: Epoch 13 average loss: avg_loss: 8.13e-07, avg_total_loss: 8.13e-07
2025-11-05 00:06:21,743: Epoch 14 average loss: avg_loss: 8.38e-07, avg_total_loss: 8.38e-07
2025-11-05 00:06:21,884: Epoch 15 average loss: avg_loss: 7.89e-07, avg_total_loss: 7.89e-07
2025-11-05 00:06:22,158: Epoch 15 average validation loss: 9.77e-07 -- Median validation metrics: avg_loss: 9.77e-07, NSE: 0.75095, MSE: 42665.56641
2025-11-05 00:06:22,158: Setting learning rate to 0.005
2025-11-05 00:06:22,305: Epoch 16 average loss: avg_loss: 7.00e-07, avg_total_loss: 7.00e-07
2025-11-05 00:06:22,450: Epoch 17 average loss: avg_loss: 7.66e-07, avg_total_loss: 7.66e-07
2025-11-05 00:06:22,587: Epoch 18 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:06:22,725: Epoch 19 average loss: avg_loss: 6.97e-07, avg_total_loss: 6.97e-07
2025-11-05 00:06:22,883: Epoch 20 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:06:23,149: Epoch 20 average validation loss: 8.46e-07 -- Median validation metrics: avg_loss: 8.46e-07, NSE: 0.78472, MSE: 36879.75781
2025-11-05 00:06:23,275: Epoch 21 average loss: avg_loss: 6.51e-07, avg_total_loss: 6.51e-07
2025-11-05 00:06:23,423: Epoch 22 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:06:23,566: Epoch 23 average loss: avg_loss: 6.26e-07, avg_total_loss: 6.26e-07
2025-11-05 00:06:23,567: Setting learning rate to 0.001
2025-11-05 00:06:23,708: Epoch 24 average loss: avg_loss: 6.32e-07, avg_total_loss: 6.32e-07
2025-11-05 00:06:23,875: Epoch 25 average loss: avg_loss: 6.26e-07, avg_total_loss: 6.26e-07
2025-11-05 00:06:24,161: Epoch 25 average validation loss: 9.06e-07 -- Median validation metrics: avg_loss: 9.06e-07, NSE: 0.76935, MSE: 39513.55469
2025-11-05 00:06:24,301: Epoch 26 average loss: avg_loss: 7.04e-07, avg_total_loss: 7.04e-07
2025-11-05 00:06:24,504: Epoch 27 average loss: avg_loss: 6.03e-07, avg_total_loss: 6.03e-07
2025-11-05 00:06:24,702: Epoch 28 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:06:24,895: Epoch 29 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:06:25,089: Epoch 30 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:06:25,333: Epoch 30 average validation loss: 9.45e-07 -- Median validation metrics: avg_loss: 9.45e-07, NSE: 0.76011, MSE: 41095.85938
2025-11-05 00:06:25,466: Epoch 31 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:06:25,626: Epoch 32 average loss: avg_loss: 7.15e-07, avg_total_loss: 7.15e-07
2025-11-05 00:06:25,646: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\model_epoch032.pt
2025-11-05 00:06:25,842: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:06:25,843: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000618\validation\model_epoch032\validation_results.p
2025-11-05 00:06:26,591: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\output.log initialized.
2025-11-05 00:06:26,592: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626
2025-11-05 00:06:26,593: ### Run configurations for testing_run
2025-11-05 00:06:26,593: experiment_name: testing_run
2025-11-05 00:06:26,594: train_basin_file: calpella
2025-11-05 00:06:26,594: validation_basin_file: calpella
2025-11-05 00:06:26,595: test_basin_file: calpella
2025-11-05 00:06:26,596: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:06:26,597: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:06:26,597: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:06:26,598: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:06:26,598: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:06:26,599: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:06:26,600: device: cuda:0
2025-11-05 00:06:26,601: physics_informed: False
2025-11-05 00:06:26,602: physics_data_file: None
2025-11-05 00:06:26,603: validate_every: 5
2025-11-05 00:06:26,603: validate_n_random_basins: 1
2025-11-05 00:06:26,604: metrics: ['NSE', 'MSE']
2025-11-05 00:06:26,605: model: cudalstm
2025-11-05 00:06:26,606: head: regression
2025-11-05 00:06:26,606: output_activation: linear
2025-11-05 00:06:26,607: hidden_size: 64
2025-11-05 00:06:26,608: initial_forget_bias: 3
2025-11-05 00:06:26,609: output_dropout: 0.4
2025-11-05 00:06:26,609: num_layers: 1
2025-11-05 00:06:26,610: dev_mode: True
2025-11-05 00:06:26,610: optimizer: Adam
2025-11-05 00:06:26,612: loss: NSE
2025-11-05 00:06:26,612: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:06:26,613: batch_size: 64
2025-11-05 00:06:26,614: epochs: 48
2025-11-05 00:06:26,615: clip_gradient_norm: 1
2025-11-05 00:06:26,615: predict_last_n: 1
2025-11-05 00:06:26,616: seq_length: 90
2025-11-05 00:06:26,617: log_interval: 16
2025-11-05 00:06:26,618: log_tensorboard: True
2025-11-05 00:06:26,619: log_n_figures: 1
2025-11-05 00:06:26,620: save_weights_every: 48
2025-11-05 00:06:26,620: early_stopping: True
2025-11-05 00:06:26,621: early_stopping_mode: patience
2025-11-05 00:06:26,622: patience_early_stopping: 3
2025-11-05 00:06:26,622: min_delta_early_stopping: 0.0
2025-11-05 00:06:26,623: minimum_epochs_before_early_stopping: 10
2025-11-05 00:06:26,624: early_stopping_slope_window: 7
2025-11-05 00:06:26,625: early_stopping_slope_patience: 2
2025-11-05 00:06:26,625: early_stopping_slope_min_epoch: 8
2025-11-05 00:06:26,626: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:06:26,627: early_stopping_slope_use_log: True
2025-11-05 00:06:26,628: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:06:26,629: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:06:26,630: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:06:26,630: early_stopping_slope_variance_guard: True
2025-11-05 00:06:26,631: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:06:26,632: dataset: russian_river
2025-11-05 00:06:26,633: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:06:26,633: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:06:26,634: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:06:26,635: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:06:26,635: hourly: False
2025-11-05 00:06:26,636: is_mts: False
2025-11-05 00:06:26,638: is_mts_data: False
2025-11-05 00:06:26,639: verbose: True
2025-11-05 00:06:26,640: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626
2025-11-05 00:06:26,642: run_label: BASELINE
2025-11-05 00:06:26,643: number_of_basins: 1
2025-11-05 00:06:26,646: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\train_data
2025-11-05 00:06:26,647: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\img_log
2025-11-05 00:06:26,650: ### Device cuda:0 will be used for training
2025-11-05 00:06:26,652: Loading basin data into xarray data set.
2025-11-05 00:06:26,809: Calculating target variable stds per basin
2025-11-05 00:06:26,820: Create lookup table and convert to pytorch tensor
2025-11-05 00:06:26,946: Early stopping enabled: mode=patience
2025-11-05 00:06:27,403: Epoch 1 average loss: avg_loss: 2.71e-06, avg_total_loss: 2.71e-06
2025-11-05 00:06:27,897: Epoch 2 average loss: avg_loss: 1.55e-06, avg_total_loss: 1.55e-06
2025-11-05 00:06:28,400: Epoch 3 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:06:28,951: Epoch 4 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:06:29,717: Epoch 5 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:06:30,111: Epoch 5 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75322, MSE: 42276.74219
2025-11-05 00:06:30,513: Epoch 6 average loss: avg_loss: 8.64e-07, avg_total_loss: 8.64e-07
2025-11-05 00:06:30,957: Epoch 7 average loss: avg_loss: 8.49e-07, avg_total_loss: 8.49e-07
2025-11-05 00:06:31,432: Epoch 8 average loss: avg_loss: 8.37e-07, avg_total_loss: 8.37e-07
2025-11-05 00:06:31,980: Epoch 9 average loss: avg_loss: 7.57e-07, avg_total_loss: 7.57e-07
2025-11-05 00:06:32,430: Epoch 10 average loss: avg_loss: 7.71e-07, avg_total_loss: 7.71e-07
2025-11-05 00:06:32,745: Epoch 10 average validation loss: 1.05e-06 -- Median validation metrics: avg_loss: 1.05e-06, NSE: 0.75912, MSE: 41265.17188
2025-11-05 00:06:33,153: Epoch 11 average loss: avg_loss: 8.36e-07, avg_total_loss: 8.36e-07
2025-11-05 00:06:33,698: Epoch 12 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:06:34,121: Epoch 13 average loss: avg_loss: 7.48e-07, avg_total_loss: 7.48e-07
2025-11-05 00:06:34,534: Epoch 14 average loss: avg_loss: 7.91e-07, avg_total_loss: 7.91e-07
2025-11-05 00:06:34,950: Epoch 15 average loss: avg_loss: 5.99e-07, avg_total_loss: 5.99e-07
2025-11-05 00:06:35,206: Epoch 15 average validation loss: 9.83e-07 -- Median validation metrics: avg_loss: 9.83e-07, NSE: 0.77388, MSE: 38736.92578
2025-11-05 00:06:35,733: Epoch 16 average loss: avg_loss: 6.89e-07, avg_total_loss: 6.89e-07
2025-11-05 00:06:36,150: Epoch 17 average loss: avg_loss: 7.21e-07, avg_total_loss: 7.21e-07
2025-11-05 00:06:36,601: Epoch 18 average loss: avg_loss: 6.41e-07, avg_total_loss: 6.41e-07
2025-11-05 00:06:36,998: Epoch 19 average loss: avg_loss: 6.16e-07, avg_total_loss: 6.16e-07
2025-11-05 00:06:37,436: Epoch 20 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:06:37,752: Epoch 20 average validation loss: 9.37e-07 -- Median validation metrics: avg_loss: 9.37e-07, NSE: 0.78447, MSE: 36923.13281
2025-11-05 00:06:38,348: Epoch 21 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:06:38,795: Epoch 22 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:06:39,229: Epoch 23 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:06:39,230: Setting learning rate to 0.005
2025-11-05 00:06:39,676: Epoch 24 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:06:40,162: Epoch 25 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:06:40,525: Epoch 25 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76715, MSE: 39890.50391
2025-11-05 00:06:40,935: Epoch 26 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:06:41,321: Epoch 27 average loss: avg_loss: 4.99e-07, avg_total_loss: 4.99e-07
2025-11-05 00:06:41,668: Epoch 28 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:06:42,027: Epoch 29 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:06:42,426: Epoch 30 average loss: avg_loss: 3.99e-07, avg_total_loss: 3.99e-07
2025-11-05 00:06:42,695: Epoch 30 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76700, MSE: 39915.10156
2025-11-05 00:06:43,056: Epoch 31 average loss: avg_loss: 4.66e-07, avg_total_loss: 4.66e-07
2025-11-05 00:06:43,430: Epoch 32 average loss: avg_loss: 3.98e-07, avg_total_loss: 3.98e-07
2025-11-05 00:06:43,788: Epoch 33 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:06:44,153: Epoch 34 average loss: avg_loss: 4.19e-07, avg_total_loss: 4.19e-07
2025-11-05 00:06:44,529: Epoch 35 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:06:44,827: Epoch 35 average validation loss: 9.37e-07 -- Median validation metrics: avg_loss: 9.37e-07, NSE: 0.78478, MSE: 36870.08594
2025-11-05 00:06:44,828: Setting learning rate to 0.001
2025-11-05 00:06:45,299: Epoch 36 average loss: avg_loss: 3.77e-07, avg_total_loss: 3.77e-07
2025-11-05 00:06:45,664: Epoch 37 average loss: avg_loss: 2.99e-07, avg_total_loss: 2.99e-07
2025-11-05 00:06:46,078: Epoch 38 average loss: avg_loss: 3.26e-07, avg_total_loss: 3.26e-07
2025-11-05 00:06:46,488: Epoch 39 average loss: avg_loss: 3.57e-07, avg_total_loss: 3.57e-07
2025-11-05 00:06:46,861: Epoch 40 average loss: avg_loss: 3.69e-07, avg_total_loss: 3.69e-07
2025-11-05 00:06:47,114: Epoch 40 average validation loss: 9.70e-07 -- Median validation metrics: avg_loss: 9.70e-07, NSE: 0.77684, MSE: 38229.47266
2025-11-05 00:06:47,603: Epoch 41 average loss: avg_loss: 3.05e-07, avg_total_loss: 3.05e-07
2025-11-05 00:06:48,140: Epoch 42 average loss: avg_loss: 3.37e-07, avg_total_loss: 3.37e-07
2025-11-05 00:06:48,601: Epoch 43 average loss: avg_loss: 3.28e-07, avg_total_loss: 3.28e-07
2025-11-05 00:06:49,114: Epoch 44 average loss: avg_loss: 3.42e-07, avg_total_loss: 3.42e-07
2025-11-05 00:06:49,528: Epoch 45 average loss: avg_loss: 3.18e-07, avg_total_loss: 3.18e-07
2025-11-05 00:06:49,815: Epoch 45 average validation loss: 9.48e-07 -- Median validation metrics: avg_loss: 9.48e-07, NSE: 0.78184, MSE: 37373.61719
2025-11-05 00:06:50,398: Epoch 46 average loss: avg_loss: 2.81e-07, avg_total_loss: 2.81e-07
2025-11-05 00:06:50,894: Epoch 47 average loss: avg_loss: 3.45e-07, avg_total_loss: 3.45e-07
2025-11-05 00:06:51,411: Epoch 48 average loss: avg_loss: 2.78e-07, avg_total_loss: 2.78e-07
2025-11-05 00:06:51,431: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\model_epoch048.pt
2025-11-05 00:06:51,652: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\validation\model_epoch048\validation_metrics.csv
2025-11-05 00:06:51,654: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000626\validation\model_epoch048\validation_results.p
2025-11-05 00:06:52,360: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\output.log initialized.
2025-11-05 00:06:52,361: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652
2025-11-05 00:06:52,362: ### Run configurations for testing_run
2025-11-05 00:06:52,362: experiment_name: testing_run
2025-11-05 00:06:52,363: train_basin_file: calpella
2025-11-05 00:06:52,364: validation_basin_file: calpella
2025-11-05 00:06:52,364: test_basin_file: calpella
2025-11-05 00:06:52,365: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:06:52,366: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:06:52,366: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:06:52,368: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:06:52,368: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:06:52,369: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:06:52,369: device: cuda:0
2025-11-05 00:06:52,370: physics_informed: False
2025-11-05 00:06:52,371: physics_data_file: None
2025-11-05 00:06:52,372: validate_every: 5
2025-11-05 00:06:52,372: validate_n_random_basins: 1
2025-11-05 00:06:52,374: metrics: ['NSE', 'MSE']
2025-11-05 00:06:52,374: model: cudalstm
2025-11-05 00:06:52,375: head: regression
2025-11-05 00:06:52,376: output_activation: linear
2025-11-05 00:06:52,377: hidden_size: 64
2025-11-05 00:06:52,377: initial_forget_bias: 3
2025-11-05 00:06:52,378: output_dropout: 0.4
2025-11-05 00:06:52,378: num_layers: 1
2025-11-05 00:06:52,379: dev_mode: True
2025-11-05 00:06:52,380: optimizer: Adam
2025-11-05 00:06:52,380: loss: NSE
2025-11-05 00:06:52,381: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:06:52,382: batch_size: 128
2025-11-05 00:06:52,382: epochs: 48
2025-11-05 00:06:52,383: clip_gradient_norm: 1
2025-11-05 00:06:52,384: predict_last_n: 1
2025-11-05 00:06:52,384: seq_length: 90
2025-11-05 00:06:52,385: log_interval: 16
2025-11-05 00:06:52,386: log_tensorboard: True
2025-11-05 00:06:52,386: log_n_figures: 1
2025-11-05 00:06:52,387: save_weights_every: 48
2025-11-05 00:06:52,388: early_stopping: True
2025-11-05 00:06:52,389: early_stopping_mode: patience
2025-11-05 00:06:52,390: patience_early_stopping: 3
2025-11-05 00:06:52,391: min_delta_early_stopping: 0.0
2025-11-05 00:06:52,391: minimum_epochs_before_early_stopping: 10
2025-11-05 00:06:52,392: early_stopping_slope_window: 7
2025-11-05 00:06:52,392: early_stopping_slope_patience: 2
2025-11-05 00:06:52,393: early_stopping_slope_min_epoch: 8
2025-11-05 00:06:52,394: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:06:52,394: early_stopping_slope_use_log: True
2025-11-05 00:06:52,395: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:06:52,396: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:06:52,397: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:06:52,398: early_stopping_slope_variance_guard: True
2025-11-05 00:06:52,399: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:06:52,399: dataset: russian_river
2025-11-05 00:06:52,400: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:06:52,401: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:06:52,401: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:06:52,402: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:06:52,403: hourly: False
2025-11-05 00:06:52,403: is_mts: False
2025-11-05 00:06:52,404: is_mts_data: False
2025-11-05 00:06:52,405: verbose: True
2025-11-05 00:06:52,405: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652
2025-11-05 00:06:52,406: run_label: BASELINE
2025-11-05 00:06:52,407: number_of_basins: 1
2025-11-05 00:06:52,408: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\train_data
2025-11-05 00:06:52,408: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\img_log
2025-11-05 00:06:52,410: ### Device cuda:0 will be used for training
2025-11-05 00:06:52,411: Loading basin data into xarray data set.
2025-11-05 00:06:52,575: Calculating target variable stds per basin
2025-11-05 00:06:52,583: Create lookup table and convert to pytorch tensor
2025-11-05 00:06:52,705: Early stopping enabled: mode=patience
2025-11-05 00:06:53,099: Epoch 1 average loss: avg_loss: 2.90e-06, avg_total_loss: 2.90e-06
2025-11-05 00:06:53,403: Epoch 2 average loss: avg_loss: 1.72e-06, avg_total_loss: 1.72e-06
2025-11-05 00:06:53,710: Epoch 3 average loss: avg_loss: 1.41e-06, avg_total_loss: 1.41e-06
2025-11-05 00:06:54,021: Epoch 4 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:06:54,299: Epoch 5 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:06:54,772: Epoch 5 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75517, MSE: 41942.78516
2025-11-05 00:06:55,057: Epoch 6 average loss: avg_loss: 9.80e-07, avg_total_loss: 9.80e-07
2025-11-05 00:06:55,387: Epoch 7 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:06:55,684: Epoch 8 average loss: avg_loss: 8.91e-07, avg_total_loss: 8.91e-07
2025-11-05 00:06:55,946: Epoch 9 average loss: avg_loss: 9.93e-07, avg_total_loss: 9.93e-07
2025-11-05 00:06:56,165: Epoch 10 average loss: avg_loss: 8.21e-07, avg_total_loss: 8.21e-07
2025-11-05 00:06:56,423: Epoch 10 average validation loss: 9.58e-07 -- Median validation metrics: avg_loss: 9.58e-07, NSE: 0.77944, MSE: 37783.80469
2025-11-05 00:06:56,595: Epoch 11 average loss: avg_loss: 7.62e-07, avg_total_loss: 7.62e-07
2025-11-05 00:06:56,781: Epoch 12 average loss: avg_loss: 8.48e-07, avg_total_loss: 8.48e-07
2025-11-05 00:06:56,992: Epoch 13 average loss: avg_loss: 7.65e-07, avg_total_loss: 7.65e-07
2025-11-05 00:06:57,197: Epoch 14 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:06:57,397: Epoch 15 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:06:57,651: Epoch 15 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.74847, MSE: 43090.72656
2025-11-05 00:06:57,849: Epoch 16 average loss: avg_loss: 7.33e-07, avg_total_loss: 7.33e-07
2025-11-05 00:06:58,104: Epoch 17 average loss: avg_loss: 6.23e-07, avg_total_loss: 6.23e-07
2025-11-05 00:06:58,380: Epoch 18 average loss: avg_loss: 6.30e-07, avg_total_loss: 6.30e-07
2025-11-05 00:06:58,649: Epoch 19 average loss: avg_loss: 6.97e-07, avg_total_loss: 6.97e-07
2025-11-05 00:06:58,893: Epoch 20 average loss: avg_loss: 6.12e-07, avg_total_loss: 6.12e-07
2025-11-05 00:06:59,147: Epoch 20 average validation loss: 9.91e-07 -- Median validation metrics: avg_loss: 9.91e-07, NSE: 0.77236, MSE: 38997.82422
2025-11-05 00:06:59,319: Epoch 21 average loss: avg_loss: 6.18e-07, avg_total_loss: 6.18e-07
2025-11-05 00:06:59,533: Epoch 22 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:06:59,722: Epoch 23 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:06:59,723: Setting learning rate to 0.005
2025-11-05 00:06:59,929: Epoch 24 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:07:00,137: Epoch 25 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:07:00,377: Epoch 25 average validation loss: 9.43e-07 -- Median validation metrics: avg_loss: 9.43e-07, NSE: 0.78321, MSE: 37139.21094
2025-11-05 00:07:00,554: Epoch 26 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:07:00,802: Epoch 27 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:07:00,998: Epoch 28 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:07:01,220: Epoch 29 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:07:01,435: Epoch 30 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:07:01,678: Epoch 30 average validation loss: 9.43e-07 -- Median validation metrics: avg_loss: 9.43e-07, NSE: 0.78309, MSE: 37159.74609
2025-11-05 00:07:01,865: Epoch 31 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:07:02,153: Epoch 32 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:07:02,469: Epoch 33 average loss: avg_loss: 5.04e-07, avg_total_loss: 5.04e-07
2025-11-05 00:07:02,758: Epoch 34 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:07:03,068: Epoch 35 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:07:03,394: Epoch 35 average validation loss: 9.15e-07 -- Median validation metrics: avg_loss: 9.15e-07, NSE: 0.78964, MSE: 36037.14844
2025-11-05 00:07:03,394: Setting learning rate to 0.001
2025-11-05 00:07:03,760: Epoch 36 average loss: avg_loss: 4.58e-07, avg_total_loss: 4.58e-07
2025-11-05 00:07:04,088: Epoch 37 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:07:04,386: Epoch 38 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:07:04,671: Epoch 39 average loss: avg_loss: 4.42e-07, avg_total_loss: 4.42e-07
2025-11-05 00:07:04,953: Epoch 40 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:07:05,227: Epoch 40 average validation loss: 9.56e-07 -- Median validation metrics: avg_loss: 9.56e-07, NSE: 0.78029, MSE: 37639.53516
2025-11-05 00:07:05,533: Epoch 41 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:07:05,840: Epoch 42 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:07:06,151: Epoch 43 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:07:06,476: Epoch 44 average loss: avg_loss: 4.18e-07, avg_total_loss: 4.18e-07
2025-11-05 00:07:06,792: Epoch 45 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:07:07,094: Epoch 45 average validation loss: 9.29e-07 -- Median validation metrics: avg_loss: 9.29e-07, NSE: 0.78634, MSE: 36602.71094
2025-11-05 00:07:07,373: Epoch 46 average loss: avg_loss: 4.39e-07, avg_total_loss: 4.39e-07
2025-11-05 00:07:07,680: Epoch 47 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:07:07,967: Epoch 48 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:07:07,988: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\model_epoch048.pt
2025-11-05 00:07:08,198: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\validation\model_epoch048\validation_metrics.csv
2025-11-05 00:07:08,200: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000652\validation\model_epoch048\validation_results.p
2025-11-05 00:07:08,945: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\output.log initialized.
2025-11-05 00:07:08,946: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708
2025-11-05 00:07:08,947: ### Run configurations for testing_run
2025-11-05 00:07:08,947: experiment_name: testing_run
2025-11-05 00:07:08,948: train_basin_file: calpella
2025-11-05 00:07:08,949: validation_basin_file: calpella
2025-11-05 00:07:08,950: test_basin_file: calpella
2025-11-05 00:07:08,950: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:08,951: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:08,952: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:08,952: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:08,953: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:08,954: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:08,954: device: cuda:0
2025-11-05 00:07:08,956: physics_informed: False
2025-11-05 00:07:08,956: physics_data_file: None
2025-11-05 00:07:08,958: validate_every: 5
2025-11-05 00:07:08,959: validate_n_random_basins: 1
2025-11-05 00:07:08,960: metrics: ['NSE', 'MSE']
2025-11-05 00:07:08,960: model: cudalstm
2025-11-05 00:07:08,961: head: regression
2025-11-05 00:07:08,962: output_activation: linear
2025-11-05 00:07:08,963: hidden_size: 64
2025-11-05 00:07:08,963: initial_forget_bias: 3
2025-11-05 00:07:08,964: output_dropout: 0.4
2025-11-05 00:07:08,964: num_layers: 1
2025-11-05 00:07:08,965: dev_mode: True
2025-11-05 00:07:08,966: optimizer: Adam
2025-11-05 00:07:08,967: loss: NSE
2025-11-05 00:07:08,968: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:07:08,968: batch_size: 256
2025-11-05 00:07:08,969: epochs: 48
2025-11-05 00:07:08,970: clip_gradient_norm: 1
2025-11-05 00:07:08,971: predict_last_n: 1
2025-11-05 00:07:08,971: seq_length: 90
2025-11-05 00:07:08,973: log_interval: 16
2025-11-05 00:07:08,973: log_tensorboard: True
2025-11-05 00:07:08,973: log_n_figures: 1
2025-11-05 00:07:08,973: save_weights_every: 48
2025-11-05 00:07:08,975: early_stopping: True
2025-11-05 00:07:08,975: early_stopping_mode: patience
2025-11-05 00:07:08,976: patience_early_stopping: 3
2025-11-05 00:07:08,977: min_delta_early_stopping: 0.0
2025-11-05 00:07:08,979: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:08,980: early_stopping_slope_window: 7
2025-11-05 00:07:08,980: early_stopping_slope_patience: 2
2025-11-05 00:07:08,981: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:08,982: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:08,983: early_stopping_slope_use_log: True
2025-11-05 00:07:08,983: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:08,984: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:08,985: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:08,985: early_stopping_slope_variance_guard: True
2025-11-05 00:07:08,986: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:08,986: dataset: russian_river
2025-11-05 00:07:08,987: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:08,987: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:08,988: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:08,990: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:08,991: hourly: False
2025-11-05 00:07:08,992: is_mts: False
2025-11-05 00:07:08,993: is_mts_data: False
2025-11-05 00:07:08,993: verbose: True
2025-11-05 00:07:08,994: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708
2025-11-05 00:07:08,995: run_label: BASELINE
2025-11-05 00:07:08,996: number_of_basins: 1
2025-11-05 00:07:08,996: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\train_data
2025-11-05 00:07:08,997: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\img_log
2025-11-05 00:07:08,999: ### Device cuda:0 will be used for training
2025-11-05 00:07:09,001: Loading basin data into xarray data set.
2025-11-05 00:07:09,171: Calculating target variable stds per basin
2025-11-05 00:07:09,181: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:09,304: Early stopping enabled: mode=patience
2025-11-05 00:07:09,518: Epoch 1 average loss: avg_loss: 3.70e-06, avg_total_loss: 3.70e-06
2025-11-05 00:07:09,710: Epoch 2 average loss: avg_loss: 2.55e-06, avg_total_loss: 2.55e-06
2025-11-05 00:07:09,857: Epoch 3 average loss: avg_loss: 1.86e-06, avg_total_loss: 1.86e-06
2025-11-05 00:07:10,017: Epoch 4 average loss: avg_loss: 1.44e-06, avg_total_loss: 1.44e-06
2025-11-05 00:07:10,162: Epoch 5 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:07:10,598: Epoch 5 average validation loss: 1.08e-06 -- Median validation metrics: avg_loss: 1.08e-06, NSE: 0.72866, MSE: 46483.83984
2025-11-05 00:07:10,735: Epoch 6 average loss: avg_loss: 1.24e-06, avg_total_loss: 1.24e-06
2025-11-05 00:07:10,899: Epoch 7 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:07:11,055: Epoch 8 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:07:11,211: Epoch 9 average loss: avg_loss: 9.10e-07, avg_total_loss: 9.10e-07
2025-11-05 00:07:11,380: Epoch 10 average loss: avg_loss: 8.78e-07, avg_total_loss: 8.78e-07
2025-11-05 00:07:11,676: Epoch 10 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.73720, MSE: 45020.39453
2025-11-05 00:07:11,893: Epoch 11 average loss: avg_loss: 8.53e-07, avg_total_loss: 8.53e-07
2025-11-05 00:07:12,097: Epoch 12 average loss: avg_loss: 8.30e-07, avg_total_loss: 8.30e-07
2025-11-05 00:07:12,295: Epoch 13 average loss: avg_loss: 8.11e-07, avg_total_loss: 8.11e-07
2025-11-05 00:07:12,491: Epoch 14 average loss: avg_loss: 7.04e-07, avg_total_loss: 7.04e-07
2025-11-05 00:07:12,626: Epoch 15 average loss: avg_loss: 7.69e-07, avg_total_loss: 7.69e-07
2025-11-05 00:07:12,862: Epoch 15 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.73918, MSE: 44681.10156
2025-11-05 00:07:12,992: Epoch 16 average loss: avg_loss: 7.08e-07, avg_total_loss: 7.08e-07
2025-11-05 00:07:13,121: Epoch 17 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:07:13,242: Epoch 18 average loss: avg_loss: 6.84e-07, avg_total_loss: 6.84e-07
2025-11-05 00:07:13,387: Epoch 19 average loss: avg_loss: 6.83e-07, avg_total_loss: 6.83e-07
2025-11-05 00:07:13,524: Epoch 20 average loss: avg_loss: 7.41e-07, avg_total_loss: 7.41e-07
2025-11-05 00:07:13,769: Epoch 20 average validation loss: 9.83e-07 -- Median validation metrics: avg_loss: 9.83e-07, NSE: 0.75010, MSE: 42810.71094
2025-11-05 00:07:13,907: Epoch 21 average loss: avg_loss: 7.39e-07, avg_total_loss: 7.39e-07
2025-11-05 00:07:14,042: Epoch 22 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:07:14,196: Epoch 23 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:07:14,197: Setting learning rate to 0.005
2025-11-05 00:07:14,362: Epoch 24 average loss: avg_loss: 6.18e-07, avg_total_loss: 6.18e-07
2025-11-05 00:07:14,512: Epoch 25 average loss: avg_loss: 6.40e-07, avg_total_loss: 6.40e-07
2025-11-05 00:07:14,813: Epoch 25 average validation loss: 9.37e-07 -- Median validation metrics: avg_loss: 9.37e-07, NSE: 0.76153, MSE: 40852.31250
2025-11-05 00:07:14,957: Epoch 26 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:07:15,115: Epoch 27 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:07:15,255: Epoch 28 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:07:15,410: Epoch 29 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:07:15,561: Epoch 30 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:07:15,818: Epoch 30 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.72320, MSE: 47418.64453
2025-11-05 00:07:16,009: Epoch 31 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:07:16,220: Epoch 32 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:07:16,457: Epoch 33 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:07:16,678: Epoch 34 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:07:16,882: Epoch 35 average loss: avg_loss: 5.53e-07, avg_total_loss: 5.53e-07
2025-11-05 00:07:17,126: Epoch 35 average validation loss: 9.49e-07 -- Median validation metrics: avg_loss: 9.49e-07, NSE: 0.75744, MSE: 41553.94531
2025-11-05 00:07:17,127: Setting learning rate to 0.001
2025-11-05 00:07:17,245: Epoch 36 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:07:17,366: Epoch 37 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:07:17,519: Epoch 38 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:07:17,669: Epoch 39 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:07:17,992: Epoch 40 average loss: avg_loss: 4.72e-07, avg_total_loss: 4.72e-07
2025-11-05 00:07:18,233: Epoch 40 average validation loss: 9.87e-07 -- Median validation metrics: avg_loss: 9.87e-07, NSE: 0.74919, MSE: 42966.66016
2025-11-05 00:07:18,234: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:07:18,235: Early stopping triggered at epoch 40
2025-11-05 00:07:18,250: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\model_epoch040.pt
2025-11-05 00:07:18,440: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:07:18,442: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000708\validation\model_epoch040\validation_results.p
2025-11-05 00:07:19,193: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\output.log initialized.
2025-11-05 00:07:19,194: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719
2025-11-05 00:07:19,195: ### Run configurations for testing_run
2025-11-05 00:07:19,196: experiment_name: testing_run
2025-11-05 00:07:19,197: train_basin_file: calpella
2025-11-05 00:07:19,197: validation_basin_file: calpella
2025-11-05 00:07:19,198: test_basin_file: calpella
2025-11-05 00:07:19,199: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:19,200: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:19,200: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:19,201: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:19,202: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:19,202: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:19,203: device: cuda:0
2025-11-05 00:07:19,204: physics_informed: False
2025-11-05 00:07:19,204: physics_data_file: None
2025-11-05 00:07:19,205: validate_every: 5
2025-11-05 00:07:19,206: validate_n_random_basins: 1
2025-11-05 00:07:19,207: metrics: ['NSE', 'MSE']
2025-11-05 00:07:19,207: model: cudalstm
2025-11-05 00:07:19,208: head: regression
2025-11-05 00:07:19,209: output_activation: linear
2025-11-05 00:07:19,210: hidden_size: 64
2025-11-05 00:07:19,210: initial_forget_bias: 3
2025-11-05 00:07:19,211: output_dropout: 0.4
2025-11-05 00:07:19,212: num_layers: 1
2025-11-05 00:07:19,212: dev_mode: True
2025-11-05 00:07:19,213: optimizer: Adam
2025-11-05 00:07:19,214: loss: NSE
2025-11-05 00:07:19,214: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:07:19,215: batch_size: 64
2025-11-05 00:07:19,216: epochs: 16
2025-11-05 00:07:19,216: clip_gradient_norm: 1
2025-11-05 00:07:19,217: predict_last_n: 1
2025-11-05 00:07:19,218: seq_length: 120
2025-11-05 00:07:19,219: log_interval: 16
2025-11-05 00:07:19,219: log_tensorboard: True
2025-11-05 00:07:19,220: log_n_figures: 1
2025-11-05 00:07:19,220: save_weights_every: 16
2025-11-05 00:07:19,221: early_stopping: True
2025-11-05 00:07:19,221: early_stopping_mode: patience
2025-11-05 00:07:19,222: patience_early_stopping: 3
2025-11-05 00:07:19,223: min_delta_early_stopping: 0.0
2025-11-05 00:07:19,223: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:19,224: early_stopping_slope_window: 7
2025-11-05 00:07:19,225: early_stopping_slope_patience: 2
2025-11-05 00:07:19,225: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:19,226: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:19,226: early_stopping_slope_use_log: True
2025-11-05 00:07:19,227: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:19,228: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:19,229: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:19,229: early_stopping_slope_variance_guard: True
2025-11-05 00:07:19,230: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:19,231: dataset: russian_river
2025-11-05 00:07:19,232: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:19,233: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:19,233: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:19,234: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:19,235: hourly: False
2025-11-05 00:07:19,235: is_mts: False
2025-11-05 00:07:19,236: is_mts_data: False
2025-11-05 00:07:19,237: verbose: True
2025-11-05 00:07:19,239: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719
2025-11-05 00:07:19,240: run_label: BASELINE
2025-11-05 00:07:19,241: number_of_basins: 1
2025-11-05 00:07:19,242: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\train_data
2025-11-05 00:07:19,243: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\img_log
2025-11-05 00:07:19,246: ### Device cuda:0 will be used for training
2025-11-05 00:07:19,247: Loading basin data into xarray data set.
2025-11-05 00:07:19,429: Calculating target variable stds per basin
2025-11-05 00:07:19,438: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:19,559: Early stopping enabled: mode=patience
2025-11-05 00:07:20,050: Epoch 1 average loss: avg_loss: 2.43e-06, avg_total_loss: 2.43e-06
2025-11-05 00:07:20,522: Epoch 2 average loss: avg_loss: 1.43e-06, avg_total_loss: 1.43e-06
2025-11-05 00:07:21,012: Epoch 3 average loss: avg_loss: 1.21e-06, avg_total_loss: 1.21e-06
2025-11-05 00:07:21,703: Epoch 4 average loss: avg_loss: 9.32e-07, avg_total_loss: 9.32e-07
2025-11-05 00:07:22,149: Epoch 5 average loss: avg_loss: 8.72e-07, avg_total_loss: 8.72e-07
2025-11-05 00:07:22,647: Epoch 5 average validation loss: 1.39e-06 -- Median validation metrics: avg_loss: 1.39e-06, NSE: 0.68165, MSE: 54537.43359
2025-11-05 00:07:23,148: Epoch 6 average loss: avg_loss: 7.24e-07, avg_total_loss: 7.24e-07
2025-11-05 00:07:23,620: Epoch 7 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:07:23,621: Setting learning rate to 0.005
2025-11-05 00:07:24,059: Epoch 8 average loss: avg_loss: 7.53e-07, avg_total_loss: 7.53e-07
2025-11-05 00:07:24,498: Epoch 9 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:07:24,943: Epoch 10 average loss: avg_loss: 6.88e-07, avg_total_loss: 6.88e-07
2025-11-05 00:07:25,219: Epoch 10 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76581, MSE: 40119.61719
2025-11-05 00:07:25,649: Epoch 11 average loss: avg_loss: 5.57e-07, avg_total_loss: 5.57e-07
2025-11-05 00:07:25,650: Setting learning rate to 0.001
2025-11-05 00:07:26,071: Epoch 12 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:07:26,467: Epoch 13 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:07:26,878: Epoch 14 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:07:27,287: Epoch 15 average loss: avg_loss: 5.59e-07, avg_total_loss: 5.59e-07
2025-11-05 00:07:27,551: Epoch 15 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75454, MSE: 42050.83594
2025-11-05 00:07:27,949: Epoch 16 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:07:27,965: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\model_epoch016.pt
2025-11-05 00:07:28,163: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:07:28,164: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000719\validation\model_epoch016\validation_results.p
2025-11-05 00:07:28,872: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\output.log initialized.
2025-11-05 00:07:28,873: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728
2025-11-05 00:07:28,874: ### Run configurations for testing_run
2025-11-05 00:07:28,875: experiment_name: testing_run
2025-11-05 00:07:28,875: train_basin_file: calpella
2025-11-05 00:07:28,876: validation_basin_file: calpella
2025-11-05 00:07:28,877: test_basin_file: calpella
2025-11-05 00:07:28,877: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:28,878: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:28,879: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:28,879: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:28,881: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:28,882: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:28,882: device: cuda:0
2025-11-05 00:07:28,883: physics_informed: False
2025-11-05 00:07:28,884: physics_data_file: None
2025-11-05 00:07:28,884: validate_every: 5
2025-11-05 00:07:28,885: validate_n_random_basins: 1
2025-11-05 00:07:28,886: metrics: ['NSE', 'MSE']
2025-11-05 00:07:28,887: model: cudalstm
2025-11-05 00:07:28,887: head: regression
2025-11-05 00:07:28,888: output_activation: linear
2025-11-05 00:07:28,889: hidden_size: 64
2025-11-05 00:07:28,890: initial_forget_bias: 3
2025-11-05 00:07:28,891: output_dropout: 0.4
2025-11-05 00:07:28,891: num_layers: 1
2025-11-05 00:07:28,892: dev_mode: True
2025-11-05 00:07:28,892: optimizer: Adam
2025-11-05 00:07:28,893: loss: NSE
2025-11-05 00:07:28,894: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:07:28,894: batch_size: 128
2025-11-05 00:07:28,896: epochs: 16
2025-11-05 00:07:28,896: clip_gradient_norm: 1
2025-11-05 00:07:28,897: predict_last_n: 1
2025-11-05 00:07:28,898: seq_length: 120
2025-11-05 00:07:28,898: log_interval: 16
2025-11-05 00:07:28,899: log_tensorboard: True
2025-11-05 00:07:28,900: log_n_figures: 1
2025-11-05 00:07:28,900: save_weights_every: 16
2025-11-05 00:07:28,901: early_stopping: True
2025-11-05 00:07:28,901: early_stopping_mode: patience
2025-11-05 00:07:28,902: patience_early_stopping: 3
2025-11-05 00:07:28,903: min_delta_early_stopping: 0.0
2025-11-05 00:07:28,903: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:28,904: early_stopping_slope_window: 7
2025-11-05 00:07:28,905: early_stopping_slope_patience: 2
2025-11-05 00:07:28,905: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:28,906: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:28,908: early_stopping_slope_use_log: True
2025-11-05 00:07:28,909: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:28,909: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:28,910: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:28,911: early_stopping_slope_variance_guard: True
2025-11-05 00:07:28,912: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:28,912: dataset: russian_river
2025-11-05 00:07:28,913: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:28,914: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:28,915: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:28,915: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:28,916: hourly: False
2025-11-05 00:07:28,917: is_mts: False
2025-11-05 00:07:28,918: is_mts_data: False
2025-11-05 00:07:28,919: verbose: True
2025-11-05 00:07:28,920: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728
2025-11-05 00:07:28,920: run_label: BASELINE
2025-11-05 00:07:28,921: number_of_basins: 1
2025-11-05 00:07:28,922: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\train_data
2025-11-05 00:07:28,923: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\img_log
2025-11-05 00:07:28,925: ### Device cuda:0 will be used for training
2025-11-05 00:07:28,926: Loading basin data into xarray data set.
2025-11-05 00:07:29,104: Calculating target variable stds per basin
2025-11-05 00:07:29,114: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:29,232: Early stopping enabled: mode=patience
2025-11-05 00:07:29,494: Epoch 1 average loss: avg_loss: 2.64e-06, avg_total_loss: 2.64e-06
2025-11-05 00:07:29,699: Epoch 2 average loss: avg_loss: 1.52e-06, avg_total_loss: 1.52e-06
2025-11-05 00:07:29,948: Epoch 3 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:07:30,205: Epoch 4 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:07:30,486: Epoch 5 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:07:30,871: Epoch 5 average validation loss: 9.95e-07 -- Median validation metrics: avg_loss: 9.95e-07, NSE: 0.77133, MSE: 39173.58594
2025-11-05 00:07:31,053: Epoch 6 average loss: avg_loss: 8.94e-07, avg_total_loss: 8.94e-07
2025-11-05 00:07:31,224: Epoch 7 average loss: avg_loss: 7.58e-07, avg_total_loss: 7.58e-07
2025-11-05 00:07:31,225: Setting learning rate to 0.005
2025-11-05 00:07:31,485: Epoch 8 average loss: avg_loss: 7.49e-07, avg_total_loss: 7.49e-07
2025-11-05 00:07:31,658: Epoch 9 average loss: avg_loss: 7.01e-07, avg_total_loss: 7.01e-07
2025-11-05 00:07:31,870: Epoch 10 average loss: avg_loss: 6.81e-07, avg_total_loss: 6.81e-07
2025-11-05 00:07:32,125: Epoch 10 average validation loss: 1.16e-06 -- Median validation metrics: avg_loss: 1.16e-06, NSE: 0.73187, MSE: 45933.23828
2025-11-05 00:07:32,286: Epoch 11 average loss: avg_loss: 7.35e-07, avg_total_loss: 7.35e-07
2025-11-05 00:07:32,287: Setting learning rate to 0.001
2025-11-05 00:07:32,510: Epoch 12 average loss: avg_loss: 6.78e-07, avg_total_loss: 6.78e-07
2025-11-05 00:07:32,712: Epoch 13 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:07:32,901: Epoch 14 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:07:33,064: Epoch 15 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:07:33,334: Epoch 15 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76872, MSE: 39621.33203
2025-11-05 00:07:33,512: Epoch 16 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:07:33,527: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\model_epoch016.pt
2025-11-05 00:07:33,709: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:07:33,710: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000728\validation\model_epoch016\validation_results.p
2025-11-05 00:07:34,327: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\output.log initialized.
2025-11-05 00:07:34,328: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734
2025-11-05 00:07:34,329: ### Run configurations for testing_run
2025-11-05 00:07:34,330: experiment_name: testing_run
2025-11-05 00:07:34,330: train_basin_file: calpella
2025-11-05 00:07:34,331: validation_basin_file: calpella
2025-11-05 00:07:34,332: test_basin_file: calpella
2025-11-05 00:07:34,332: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:34,333: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:34,333: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:34,334: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:34,335: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:34,335: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:34,335: device: cuda:0
2025-11-05 00:07:34,335: physics_informed: False
2025-11-05 00:07:34,336: physics_data_file: None
2025-11-05 00:07:34,338: validate_every: 5
2025-11-05 00:07:34,338: validate_n_random_basins: 1
2025-11-05 00:07:34,338: metrics: ['NSE', 'MSE']
2025-11-05 00:07:34,338: model: cudalstm
2025-11-05 00:07:34,339: head: regression
2025-11-05 00:07:34,341: output_activation: linear
2025-11-05 00:07:34,341: hidden_size: 64
2025-11-05 00:07:34,341: initial_forget_bias: 3
2025-11-05 00:07:34,343: output_dropout: 0.4
2025-11-05 00:07:34,343: num_layers: 1
2025-11-05 00:07:34,344: dev_mode: True
2025-11-05 00:07:34,344: optimizer: Adam
2025-11-05 00:07:34,345: loss: NSE
2025-11-05 00:07:34,345: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:07:34,347: batch_size: 256
2025-11-05 00:07:34,347: epochs: 16
2025-11-05 00:07:34,348: clip_gradient_norm: 1
2025-11-05 00:07:34,348: predict_last_n: 1
2025-11-05 00:07:34,348: seq_length: 120
2025-11-05 00:07:34,350: log_interval: 16
2025-11-05 00:07:34,350: log_tensorboard: True
2025-11-05 00:07:34,351: log_n_figures: 1
2025-11-05 00:07:34,351: save_weights_every: 16
2025-11-05 00:07:34,351: early_stopping: True
2025-11-05 00:07:34,351: early_stopping_mode: patience
2025-11-05 00:07:34,352: patience_early_stopping: 3
2025-11-05 00:07:34,353: min_delta_early_stopping: 0.0
2025-11-05 00:07:34,353: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:34,355: early_stopping_slope_window: 7
2025-11-05 00:07:34,355: early_stopping_slope_patience: 2
2025-11-05 00:07:34,355: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:34,357: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:34,357: early_stopping_slope_use_log: True
2025-11-05 00:07:34,357: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:34,357: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:34,358: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:34,358: early_stopping_slope_variance_guard: True
2025-11-05 00:07:34,359: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:34,360: dataset: russian_river
2025-11-05 00:07:34,360: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:34,361: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:34,361: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:34,362: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:34,364: hourly: False
2025-11-05 00:07:34,364: is_mts: False
2025-11-05 00:07:34,365: is_mts_data: False
2025-11-05 00:07:34,365: verbose: True
2025-11-05 00:07:34,366: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734
2025-11-05 00:07:34,366: run_label: BASELINE
2025-11-05 00:07:34,367: number_of_basins: 1
2025-11-05 00:07:34,368: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\train_data
2025-11-05 00:07:34,368: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\img_log
2025-11-05 00:07:34,370: ### Device cuda:0 will be used for training
2025-11-05 00:07:34,370: Loading basin data into xarray data set.
2025-11-05 00:07:34,489: Calculating target variable stds per basin
2025-11-05 00:07:34,497: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:34,608: Early stopping enabled: mode=patience
2025-11-05 00:07:34,853: Epoch 1 average loss: avg_loss: 2.97e-06, avg_total_loss: 2.97e-06
2025-11-05 00:07:35,088: Epoch 2 average loss: avg_loss: 2.33e-06, avg_total_loss: 2.33e-06
2025-11-05 00:07:35,299: Epoch 3 average loss: avg_loss: 1.39e-06, avg_total_loss: 1.39e-06
2025-11-05 00:07:35,432: Epoch 4 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:07:35,550: Epoch 5 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:07:35,968: Epoch 5 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.74328, MSE: 43978.80078
2025-11-05 00:07:36,093: Epoch 6 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:07:36,204: Epoch 7 average loss: avg_loss: 9.53e-07, avg_total_loss: 9.53e-07
2025-11-05 00:07:36,205: Setting learning rate to 0.005
2025-11-05 00:07:36,331: Epoch 8 average loss: avg_loss: 8.00e-07, avg_total_loss: 8.00e-07
2025-11-05 00:07:36,463: Epoch 9 average loss: avg_loss: 9.85e-07, avg_total_loss: 9.85e-07
2025-11-05 00:07:36,585: Epoch 10 average loss: avg_loss: 8.58e-07, avg_total_loss: 8.58e-07
2025-11-05 00:07:36,849: Epoch 10 average validation loss: 1.10e-06 -- Median validation metrics: avg_loss: 1.10e-06, NSE: 0.72137, MSE: 47732.42188
2025-11-05 00:07:36,985: Epoch 11 average loss: avg_loss: 8.27e-07, avg_total_loss: 8.27e-07
2025-11-05 00:07:36,985: Setting learning rate to 0.001
2025-11-05 00:07:37,102: Epoch 12 average loss: avg_loss: 8.17e-07, avg_total_loss: 8.17e-07
2025-11-05 00:07:37,222: Epoch 13 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:07:37,363: Epoch 14 average loss: avg_loss: 7.39e-07, avg_total_loss: 7.39e-07
2025-11-05 00:07:37,491: Epoch 15 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:07:37,727: Epoch 15 average validation loss: 9.87e-07 -- Median validation metrics: avg_loss: 9.87e-07, NSE: 0.74947, MSE: 42919.48828
2025-11-05 00:07:37,852: Epoch 16 average loss: avg_loss: 7.39e-07, avg_total_loss: 7.39e-07
2025-11-05 00:07:37,867: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\model_epoch016.pt
2025-11-05 00:07:38,028: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:07:38,030: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000734\validation\model_epoch016\validation_results.p
2025-11-05 00:07:38,667: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\output.log initialized.
2025-11-05 00:07:38,668: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738
2025-11-05 00:07:38,668: ### Run configurations for testing_run
2025-11-05 00:07:38,669: experiment_name: testing_run
2025-11-05 00:07:38,670: train_basin_file: calpella
2025-11-05 00:07:38,670: validation_basin_file: calpella
2025-11-05 00:07:38,671: test_basin_file: calpella
2025-11-05 00:07:38,672: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:38,673: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:38,674: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:38,675: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:38,676: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:38,677: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:38,678: device: cuda:0
2025-11-05 00:07:38,678: physics_informed: False
2025-11-05 00:07:38,680: physics_data_file: None
2025-11-05 00:07:38,681: validate_every: 5
2025-11-05 00:07:38,682: validate_n_random_basins: 1
2025-11-05 00:07:38,683: metrics: ['NSE', 'MSE']
2025-11-05 00:07:38,683: model: cudalstm
2025-11-05 00:07:38,684: head: regression
2025-11-05 00:07:38,685: output_activation: linear
2025-11-05 00:07:38,686: hidden_size: 64
2025-11-05 00:07:38,687: initial_forget_bias: 3
2025-11-05 00:07:38,687: output_dropout: 0.4
2025-11-05 00:07:38,688: num_layers: 1
2025-11-05 00:07:38,689: dev_mode: True
2025-11-05 00:07:38,689: optimizer: Adam
2025-11-05 00:07:38,690: loss: NSE
2025-11-05 00:07:38,691: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:07:38,692: batch_size: 64
2025-11-05 00:07:38,693: epochs: 32
2025-11-05 00:07:38,693: clip_gradient_norm: 1
2025-11-05 00:07:38,694: predict_last_n: 1
2025-11-05 00:07:38,695: seq_length: 120
2025-11-05 00:07:38,696: log_interval: 16
2025-11-05 00:07:38,696: log_tensorboard: True
2025-11-05 00:07:38,697: log_n_figures: 1
2025-11-05 00:07:38,698: save_weights_every: 32
2025-11-05 00:07:38,699: early_stopping: True
2025-11-05 00:07:38,700: early_stopping_mode: patience
2025-11-05 00:07:38,701: patience_early_stopping: 3
2025-11-05 00:07:38,702: min_delta_early_stopping: 0.0
2025-11-05 00:07:38,703: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:38,703: early_stopping_slope_window: 7
2025-11-05 00:07:38,704: early_stopping_slope_patience: 2
2025-11-05 00:07:38,706: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:38,706: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:38,708: early_stopping_slope_use_log: True
2025-11-05 00:07:38,709: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:38,711: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:38,712: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:38,713: early_stopping_slope_variance_guard: True
2025-11-05 00:07:38,714: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:38,715: dataset: russian_river
2025-11-05 00:07:38,716: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:38,717: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:38,718: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:38,719: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:38,720: hourly: False
2025-11-05 00:07:38,721: is_mts: False
2025-11-05 00:07:38,721: is_mts_data: False
2025-11-05 00:07:38,722: verbose: True
2025-11-05 00:07:38,722: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738
2025-11-05 00:07:38,723: run_label: BASELINE
2025-11-05 00:07:38,724: number_of_basins: 1
2025-11-05 00:07:38,724: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\train_data
2025-11-05 00:07:38,725: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\img_log
2025-11-05 00:07:38,728: ### Device cuda:0 will be used for training
2025-11-05 00:07:38,729: Loading basin data into xarray data set.
2025-11-05 00:07:38,867: Calculating target variable stds per basin
2025-11-05 00:07:38,875: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:38,980: Early stopping enabled: mode=patience
2025-11-05 00:07:39,330: Epoch 1 average loss: avg_loss: 2.28e-06, avg_total_loss: 2.28e-06
2025-11-05 00:07:39,786: Epoch 2 average loss: avg_loss: 1.43e-06, avg_total_loss: 1.43e-06
2025-11-05 00:07:40,211: Epoch 3 average loss: avg_loss: 1.17e-06, avg_total_loss: 1.17e-06
2025-11-05 00:07:40,629: Epoch 4 average loss: avg_loss: 9.92e-07, avg_total_loss: 9.92e-07
2025-11-05 00:07:41,045: Epoch 5 average loss: avg_loss: 8.01e-07, avg_total_loss: 8.01e-07
2025-11-05 00:07:41,436: Epoch 5 average validation loss: 9.34e-07 -- Median validation metrics: avg_loss: 9.34e-07, NSE: 0.78566, MSE: 36718.20703
2025-11-05 00:07:41,842: Epoch 6 average loss: avg_loss: 8.03e-07, avg_total_loss: 8.03e-07
2025-11-05 00:07:42,236: Epoch 7 average loss: avg_loss: 8.29e-07, avg_total_loss: 8.29e-07
2025-11-05 00:07:42,664: Epoch 8 average loss: avg_loss: 8.21e-07, avg_total_loss: 8.21e-07
2025-11-05 00:07:43,080: Epoch 9 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:07:43,502: Epoch 10 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:07:43,934: Epoch 10 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76759, MSE: 39813.79297
2025-11-05 00:07:44,334: Epoch 11 average loss: avg_loss: 6.25e-07, avg_total_loss: 6.25e-07
2025-11-05 00:07:44,733: Epoch 12 average loss: avg_loss: 8.63e-07, avg_total_loss: 8.63e-07
2025-11-05 00:07:45,127: Epoch 13 average loss: avg_loss: 9.16e-07, avg_total_loss: 9.16e-07
2025-11-05 00:07:45,523: Epoch 14 average loss: avg_loss: 7.70e-07, avg_total_loss: 7.70e-07
2025-11-05 00:07:45,964: Epoch 15 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:07:46,216: Epoch 15 average validation loss: 8.77e-07 -- Median validation metrics: avg_loss: 8.77e-07, NSE: 0.79788, MSE: 34625.08594
2025-11-05 00:07:46,217: Setting learning rate to 0.005
2025-11-05 00:07:46,648: Epoch 16 average loss: avg_loss: 6.29e-07, avg_total_loss: 6.29e-07
2025-11-05 00:07:47,113: Epoch 17 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:07:47,616: Epoch 18 average loss: avg_loss: 6.44e-07, avg_total_loss: 6.44e-07
2025-11-05 00:07:48,246: Epoch 19 average loss: avg_loss: 6.06e-07, avg_total_loss: 6.06e-07
2025-11-05 00:07:48,678: Epoch 20 average loss: avg_loss: 5.57e-07, avg_total_loss: 5.57e-07
2025-11-05 00:07:48,971: Epoch 20 average validation loss: 9.92e-07 -- Median validation metrics: avg_loss: 9.92e-07, NSE: 0.77245, MSE: 38982.10156
2025-11-05 00:07:49,378: Epoch 21 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:07:49,787: Epoch 22 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:07:50,193: Epoch 23 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:07:50,193: Setting learning rate to 0.001
2025-11-05 00:07:50,584: Epoch 24 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:07:50,991: Epoch 25 average loss: avg_loss: 5.13e-07, avg_total_loss: 5.13e-07
2025-11-05 00:07:51,264: Epoch 25 average validation loss: 9.96e-07 -- Median validation metrics: avg_loss: 9.96e-07, NSE: 0.77101, MSE: 39229.40625
2025-11-05 00:07:51,655: Epoch 26 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:07:52,046: Epoch 27 average loss: avg_loss: 4.62e-07, avg_total_loss: 4.62e-07
2025-11-05 00:07:52,460: Epoch 28 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:07:52,864: Epoch 29 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:07:53,267: Epoch 30 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:07:53,542: Epoch 30 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76415, MSE: 40404.30078
2025-11-05 00:07:53,543: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:07:53,544: Early stopping triggered at epoch 30
2025-11-05 00:07:53,565: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\model_epoch030.pt
2025-11-05 00:07:53,754: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:07:53,756: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000738\validation\model_epoch030\validation_results.p
2025-11-05 00:07:54,409: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\output.log initialized.
2025-11-05 00:07:54,410: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754
2025-11-05 00:07:54,410: ### Run configurations for testing_run
2025-11-05 00:07:54,411: experiment_name: testing_run
2025-11-05 00:07:54,411: train_basin_file: calpella
2025-11-05 00:07:54,412: validation_basin_file: calpella
2025-11-05 00:07:54,412: test_basin_file: calpella
2025-11-05 00:07:54,413: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:07:54,413: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:07:54,414: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:07:54,414: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:07:54,414: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:07:54,415: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:07:54,416: device: cuda:0
2025-11-05 00:07:54,416: physics_informed: False
2025-11-05 00:07:54,417: physics_data_file: None
2025-11-05 00:07:54,417: validate_every: 5
2025-11-05 00:07:54,418: validate_n_random_basins: 1
2025-11-05 00:07:54,418: metrics: ['NSE', 'MSE']
2025-11-05 00:07:54,419: model: cudalstm
2025-11-05 00:07:54,420: head: regression
2025-11-05 00:07:54,420: output_activation: linear
2025-11-05 00:07:54,421: hidden_size: 64
2025-11-05 00:07:54,421: initial_forget_bias: 3
2025-11-05 00:07:54,422: output_dropout: 0.4
2025-11-05 00:07:54,422: num_layers: 1
2025-11-05 00:07:54,422: dev_mode: True
2025-11-05 00:07:54,423: optimizer: Adam
2025-11-05 00:07:54,424: loss: NSE
2025-11-05 00:07:54,424: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:07:54,425: batch_size: 128
2025-11-05 00:07:54,425: epochs: 32
2025-11-05 00:07:54,426: clip_gradient_norm: 1
2025-11-05 00:07:54,426: predict_last_n: 1
2025-11-05 00:07:54,427: seq_length: 120
2025-11-05 00:07:54,427: log_interval: 16
2025-11-05 00:07:54,428: log_tensorboard: True
2025-11-05 00:07:54,429: log_n_figures: 1
2025-11-05 00:07:54,429: save_weights_every: 32
2025-11-05 00:07:54,430: early_stopping: True
2025-11-05 00:07:54,430: early_stopping_mode: patience
2025-11-05 00:07:54,431: patience_early_stopping: 3
2025-11-05 00:07:54,431: min_delta_early_stopping: 0.0
2025-11-05 00:07:54,432: minimum_epochs_before_early_stopping: 10
2025-11-05 00:07:54,432: early_stopping_slope_window: 7
2025-11-05 00:07:54,433: early_stopping_slope_patience: 2
2025-11-05 00:07:54,433: early_stopping_slope_min_epoch: 8
2025-11-05 00:07:54,435: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:07:54,435: early_stopping_slope_use_log: True
2025-11-05 00:07:54,436: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:07:54,437: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:07:54,437: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:07:54,438: early_stopping_slope_variance_guard: True
2025-11-05 00:07:54,438: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:07:54,439: dataset: russian_river
2025-11-05 00:07:54,440: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:07:54,440: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:07:54,441: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:07:54,442: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:07:54,442: hourly: False
2025-11-05 00:07:54,443: is_mts: False
2025-11-05 00:07:54,443: is_mts_data: False
2025-11-05 00:07:54,444: verbose: True
2025-11-05 00:07:54,444: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754
2025-11-05 00:07:54,445: run_label: BASELINE
2025-11-05 00:07:54,445: number_of_basins: 1
2025-11-05 00:07:54,446: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\train_data
2025-11-05 00:07:54,446: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\img_log
2025-11-05 00:07:54,449: ### Device cuda:0 will be used for training
2025-11-05 00:07:54,450: Loading basin data into xarray data set.
2025-11-05 00:07:54,608: Calculating target variable stds per basin
2025-11-05 00:07:54,616: Create lookup table and convert to pytorch tensor
2025-11-05 00:07:54,713: Early stopping enabled: mode=patience
2025-11-05 00:07:55,013: Epoch 1 average loss: avg_loss: 2.74e-06, avg_total_loss: 2.74e-06
2025-11-05 00:07:55,332: Epoch 2 average loss: avg_loss: 1.65e-06, avg_total_loss: 1.65e-06
2025-11-05 00:07:55,626: Epoch 3 average loss: avg_loss: 1.21e-06, avg_total_loss: 1.21e-06
2025-11-05 00:07:55,823: Epoch 4 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:07:56,007: Epoch 5 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:07:56,366: Epoch 5 average validation loss: 1.21e-06 -- Median validation metrics: avg_loss: 1.21e-06, NSE: 0.72299, MSE: 47454.95703
2025-11-05 00:07:56,519: Epoch 6 average loss: avg_loss: 8.07e-07, avg_total_loss: 8.07e-07
2025-11-05 00:07:56,676: Epoch 7 average loss: avg_loss: 7.60e-07, avg_total_loss: 7.60e-07
2025-11-05 00:07:56,835: Epoch 8 average loss: avg_loss: 7.45e-07, avg_total_loss: 7.45e-07
2025-11-05 00:07:57,025: Epoch 9 average loss: avg_loss: 7.81e-07, avg_total_loss: 7.81e-07
2025-11-05 00:07:57,212: Epoch 10 average loss: avg_loss: 6.71e-07, avg_total_loss: 6.71e-07
2025-11-05 00:07:57,445: Epoch 10 average validation loss: 9.56e-07 -- Median validation metrics: avg_loss: 9.56e-07, NSE: 0.77999, MSE: 37690.85156
2025-11-05 00:07:57,635: Epoch 11 average loss: avg_loss: 7.30e-07, avg_total_loss: 7.30e-07
2025-11-05 00:07:57,809: Epoch 12 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:07:58,046: Epoch 13 average loss: avg_loss: 7.10e-07, avg_total_loss: 7.10e-07
2025-11-05 00:07:58,248: Epoch 14 average loss: avg_loss: 7.10e-07, avg_total_loss: 7.10e-07
2025-11-05 00:07:58,525: Epoch 15 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:07:58,865: Epoch 15 average validation loss: 9.73e-07 -- Median validation metrics: avg_loss: 9.73e-07, NSE: 0.77619, MSE: 38341.06250
2025-11-05 00:07:58,866: Setting learning rate to 0.005
2025-11-05 00:07:59,115: Epoch 16 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:07:59,329: Epoch 17 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:07:59,555: Epoch 18 average loss: avg_loss: 5.23e-07, avg_total_loss: 5.23e-07
2025-11-05 00:07:59,768: Epoch 19 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:07:59,997: Epoch 20 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:08:00,283: Epoch 20 average validation loss: 1.10e-06 -- Median validation metrics: avg_loss: 1.10e-06, NSE: 0.74672, MSE: 43389.66406
2025-11-05 00:08:00,593: Epoch 21 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:08:00,901: Epoch 22 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:08:01,207: Epoch 23 average loss: avg_loss: 4.72e-07, avg_total_loss: 4.72e-07
2025-11-05 00:08:01,207: Setting learning rate to 0.001
2025-11-05 00:08:01,480: Epoch 24 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:08:01,648: Epoch 25 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:08:01,936: Epoch 25 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76332, MSE: 40546.71875
2025-11-05 00:08:01,937: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:08:01,937: Early stopping triggered at epoch 25
2025-11-05 00:08:01,957: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\model_epoch025.pt
2025-11-05 00:08:02,154: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:08:02,155: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000754\validation\model_epoch025\validation_results.p
2025-11-05 00:08:02,843: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\output.log initialized.
2025-11-05 00:08:02,844: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802
2025-11-05 00:08:02,845: ### Run configurations for testing_run
2025-11-05 00:08:02,845: experiment_name: testing_run
2025-11-05 00:08:02,846: train_basin_file: calpella
2025-11-05 00:08:02,847: validation_basin_file: calpella
2025-11-05 00:08:02,847: test_basin_file: calpella
2025-11-05 00:08:02,848: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:08:02,849: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:08:02,850: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:08:02,851: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:08:02,851: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:08:02,851: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:08:02,853: device: cuda:0
2025-11-05 00:08:02,854: physics_informed: False
2025-11-05 00:08:02,855: physics_data_file: None
2025-11-05 00:08:02,855: validate_every: 5
2025-11-05 00:08:02,856: validate_n_random_basins: 1
2025-11-05 00:08:02,857: metrics: ['NSE', 'MSE']
2025-11-05 00:08:02,858: model: cudalstm
2025-11-05 00:08:02,858: head: regression
2025-11-05 00:08:02,859: output_activation: linear
2025-11-05 00:08:02,859: hidden_size: 64
2025-11-05 00:08:02,860: initial_forget_bias: 3
2025-11-05 00:08:02,860: output_dropout: 0.4
2025-11-05 00:08:02,861: num_layers: 1
2025-11-05 00:08:02,862: dev_mode: True
2025-11-05 00:08:02,863: optimizer: Adam
2025-11-05 00:08:02,863: loss: NSE
2025-11-05 00:08:02,864: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:08:02,865: batch_size: 256
2025-11-05 00:08:02,866: epochs: 32
2025-11-05 00:08:02,867: clip_gradient_norm: 1
2025-11-05 00:08:02,868: predict_last_n: 1
2025-11-05 00:08:02,868: seq_length: 120
2025-11-05 00:08:02,869: log_interval: 16
2025-11-05 00:08:02,870: log_tensorboard: True
2025-11-05 00:08:02,870: log_n_figures: 1
2025-11-05 00:08:02,871: save_weights_every: 32
2025-11-05 00:08:02,871: early_stopping: True
2025-11-05 00:08:02,872: early_stopping_mode: patience
2025-11-05 00:08:02,872: patience_early_stopping: 3
2025-11-05 00:08:02,873: min_delta_early_stopping: 0.0
2025-11-05 00:08:02,874: minimum_epochs_before_early_stopping: 10
2025-11-05 00:08:02,874: early_stopping_slope_window: 7
2025-11-05 00:08:02,875: early_stopping_slope_patience: 2
2025-11-05 00:08:02,877: early_stopping_slope_min_epoch: 8
2025-11-05 00:08:02,877: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:08:02,878: early_stopping_slope_use_log: True
2025-11-05 00:08:02,879: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:08:02,880: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:08:02,880: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:08:02,881: early_stopping_slope_variance_guard: True
2025-11-05 00:08:02,882: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:08:02,882: dataset: russian_river
2025-11-05 00:08:02,883: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:08:02,884: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:08:02,885: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:08:02,885: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:08:02,886: hourly: False
2025-11-05 00:08:02,888: is_mts: False
2025-11-05 00:08:02,888: is_mts_data: False
2025-11-05 00:08:02,889: verbose: True
2025-11-05 00:08:02,890: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802
2025-11-05 00:08:02,891: run_label: BASELINE
2025-11-05 00:08:02,892: number_of_basins: 1
2025-11-05 00:08:02,893: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\train_data
2025-11-05 00:08:02,893: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\img_log
2025-11-05 00:08:02,896: ### Device cuda:0 will be used for training
2025-11-05 00:08:02,897: Loading basin data into xarray data set.
2025-11-05 00:08:03,075: Calculating target variable stds per basin
2025-11-05 00:08:03,088: Create lookup table and convert to pytorch tensor
2025-11-05 00:08:03,231: Early stopping enabled: mode=patience
2025-11-05 00:08:03,479: Epoch 1 average loss: avg_loss: 3.12e-06, avg_total_loss: 3.12e-06
2025-11-05 00:08:03,721: Epoch 2 average loss: avg_loss: 1.93e-06, avg_total_loss: 1.93e-06
2025-11-05 00:08:03,992: Epoch 3 average loss: avg_loss: 1.54e-06, avg_total_loss: 1.54e-06
2025-11-05 00:08:04,230: Epoch 4 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:08:04,345: Epoch 5 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:08:04,720: Epoch 5 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.72240, MSE: 47556.25391
2025-11-05 00:08:04,831: Epoch 6 average loss: avg_loss: 1.00e-06, avg_total_loss: 1.00e-06
2025-11-05 00:08:04,945: Epoch 7 average loss: avg_loss: 8.98e-07, avg_total_loss: 8.98e-07
2025-11-05 00:08:05,072: Epoch 8 average loss: avg_loss: 9.23e-07, avg_total_loss: 9.23e-07
2025-11-05 00:08:05,201: Epoch 9 average loss: avg_loss: 9.71e-07, avg_total_loss: 9.71e-07
2025-11-05 00:08:05,340: Epoch 10 average loss: avg_loss: 9.22e-07, avg_total_loss: 9.22e-07
2025-11-05 00:08:05,608: Epoch 10 average validation loss: 1.26e-06 -- Median validation metrics: avg_loss: 1.26e-06, NSE: 0.68283, MSE: 54334.42188
2025-11-05 00:08:05,719: Epoch 11 average loss: avg_loss: 8.63e-07, avg_total_loss: 8.63e-07
2025-11-05 00:08:05,820: Epoch 12 average loss: avg_loss: 7.89e-07, avg_total_loss: 7.89e-07
2025-11-05 00:08:05,950: Epoch 13 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:08:06,077: Epoch 14 average loss: avg_loss: 6.74e-07, avg_total_loss: 6.74e-07
2025-11-05 00:08:06,217: Epoch 15 average loss: avg_loss: 7.34e-07, avg_total_loss: 7.34e-07
2025-11-05 00:08:06,520: Epoch 15 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.73824, MSE: 44843.36328
2025-11-05 00:08:06,521: Setting learning rate to 0.005
2025-11-05 00:08:06,649: Epoch 16 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:08:06,797: Epoch 17 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:08:06,952: Epoch 18 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:08:07,112: Epoch 19 average loss: avg_loss: 5.69e-07, avg_total_loss: 5.69e-07
2025-11-05 00:08:07,288: Epoch 20 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:08:07,571: Epoch 20 average validation loss: 1.06e-06 -- Median validation metrics: avg_loss: 1.06e-06, NSE: 0.72944, MSE: 46350.09375
2025-11-05 00:08:07,703: Epoch 21 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:08:07,840: Epoch 22 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:08:07,986: Epoch 23 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:08:07,987: Setting learning rate to 0.001
2025-11-05 00:08:08,159: Epoch 24 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:08:08,315: Epoch 25 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:08:08,584: Epoch 25 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.73442, MSE: 45497.47266
2025-11-05 00:08:08,732: Epoch 26 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:08:08,894: Epoch 27 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:08:09,043: Epoch 28 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:08:09,202: Epoch 29 average loss: avg_loss: 5.60e-07, avg_total_loss: 5.60e-07
2025-11-05 00:08:09,357: Epoch 30 average loss: avg_loss: 5.29e-07, avg_total_loss: 5.29e-07
2025-11-05 00:08:09,659: Epoch 30 average validation loss: 1.11e-06 -- Median validation metrics: avg_loss: 1.11e-06, NSE: 0.71933, MSE: 48082.84375
2025-11-05 00:08:09,660: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:08:09,660: Early stopping triggered at epoch 30
2025-11-05 00:08:09,684: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\model_epoch030.pt
2025-11-05 00:08:10,049: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:08:10,051: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000802\validation\model_epoch030\validation_results.p
2025-11-05 00:08:10,865: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\output.log initialized.
2025-11-05 00:08:10,866: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810
2025-11-05 00:08:10,867: ### Run configurations for testing_run
2025-11-05 00:08:10,868: experiment_name: testing_run
2025-11-05 00:08:10,868: train_basin_file: calpella
2025-11-05 00:08:10,869: validation_basin_file: calpella
2025-11-05 00:08:10,870: test_basin_file: calpella
2025-11-05 00:08:10,871: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:08:10,872: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:08:10,873: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:08:10,874: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:08:10,874: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:08:10,875: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:08:10,876: device: cuda:0
2025-11-05 00:08:10,877: physics_informed: False
2025-11-05 00:08:10,878: physics_data_file: None
2025-11-05 00:08:10,878: validate_every: 5
2025-11-05 00:08:10,879: validate_n_random_basins: 1
2025-11-05 00:08:10,880: metrics: ['NSE', 'MSE']
2025-11-05 00:08:10,881: model: cudalstm
2025-11-05 00:08:10,882: head: regression
2025-11-05 00:08:10,883: output_activation: linear
2025-11-05 00:08:10,884: hidden_size: 64
2025-11-05 00:08:10,884: initial_forget_bias: 3
2025-11-05 00:08:10,885: output_dropout: 0.4
2025-11-05 00:08:10,886: num_layers: 1
2025-11-05 00:08:10,887: dev_mode: True
2025-11-05 00:08:10,887: optimizer: Adam
2025-11-05 00:08:10,888: loss: NSE
2025-11-05 00:08:10,889: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:08:10,890: batch_size: 64
2025-11-05 00:08:10,890: epochs: 48
2025-11-05 00:08:10,891: clip_gradient_norm: 1
2025-11-05 00:08:10,892: predict_last_n: 1
2025-11-05 00:08:10,893: seq_length: 120
2025-11-05 00:08:10,894: log_interval: 16
2025-11-05 00:08:10,895: log_tensorboard: True
2025-11-05 00:08:10,895: log_n_figures: 1
2025-11-05 00:08:10,896: save_weights_every: 48
2025-11-05 00:08:10,897: early_stopping: True
2025-11-05 00:08:10,898: early_stopping_mode: patience
2025-11-05 00:08:10,898: patience_early_stopping: 3
2025-11-05 00:08:10,899: min_delta_early_stopping: 0.0
2025-11-05 00:08:10,900: minimum_epochs_before_early_stopping: 10
2025-11-05 00:08:10,901: early_stopping_slope_window: 7
2025-11-05 00:08:10,901: early_stopping_slope_patience: 2
2025-11-05 00:08:10,902: early_stopping_slope_min_epoch: 8
2025-11-05 00:08:10,904: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:08:10,905: early_stopping_slope_use_log: True
2025-11-05 00:08:10,905: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:08:10,906: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:08:10,908: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:08:10,908: early_stopping_slope_variance_guard: True
2025-11-05 00:08:10,909: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:08:10,910: dataset: russian_river
2025-11-05 00:08:10,911: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:08:10,912: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:08:10,913: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:08:10,914: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:08:10,915: hourly: False
2025-11-05 00:08:10,915: is_mts: False
2025-11-05 00:08:10,916: is_mts_data: False
2025-11-05 00:08:10,917: verbose: True
2025-11-05 00:08:10,918: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810
2025-11-05 00:08:10,919: run_label: BASELINE
2025-11-05 00:08:10,919: number_of_basins: 1
2025-11-05 00:08:10,920: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\train_data
2025-11-05 00:08:10,921: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\img_log
2025-11-05 00:08:10,923: ### Device cuda:0 will be used for training
2025-11-05 00:08:10,925: Loading basin data into xarray data set.
2025-11-05 00:08:11,110: Calculating target variable stds per basin
2025-11-05 00:08:11,121: Create lookup table and convert to pytorch tensor
2025-11-05 00:08:11,257: Early stopping enabled: mode=patience
2025-11-05 00:08:11,800: Epoch 1 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:08:12,286: Epoch 2 average loss: avg_loss: 1.14e-06, avg_total_loss: 1.14e-06
2025-11-05 00:08:12,756: Epoch 3 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:08:13,465: Epoch 4 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:08:13,923: Epoch 5 average loss: avg_loss: 9.07e-07, avg_total_loss: 9.07e-07
2025-11-05 00:08:14,341: Epoch 5 average validation loss: 8.68e-07 -- Median validation metrics: avg_loss: 8.68e-07, NSE: 0.79985, MSE: 34287.74219
2025-11-05 00:08:14,732: Epoch 6 average loss: avg_loss: 8.84e-07, avg_total_loss: 8.84e-07
2025-11-05 00:08:15,212: Epoch 7 average loss: avg_loss: 7.62e-07, avg_total_loss: 7.62e-07
2025-11-05 00:08:15,671: Epoch 8 average loss: avg_loss: 8.82e-07, avg_total_loss: 8.82e-07
2025-11-05 00:08:16,083: Epoch 9 average loss: avg_loss: 7.74e-07, avg_total_loss: 7.74e-07
2025-11-05 00:08:16,573: Epoch 10 average loss: avg_loss: 7.17e-07, avg_total_loss: 7.17e-07
2025-11-05 00:08:16,903: Epoch 10 average validation loss: 1.15e-06 -- Median validation metrics: avg_loss: 1.15e-06, NSE: 0.73622, MSE: 45187.98828
2025-11-05 00:08:17,386: Epoch 11 average loss: avg_loss: 7.06e-07, avg_total_loss: 7.06e-07
2025-11-05 00:08:17,838: Epoch 12 average loss: avg_loss: 6.93e-07, avg_total_loss: 6.93e-07
2025-11-05 00:08:18,362: Epoch 13 average loss: avg_loss: 7.14e-07, avg_total_loss: 7.14e-07
2025-11-05 00:08:18,854: Epoch 14 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:08:19,348: Epoch 15 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:08:19,645: Epoch 15 average validation loss: 9.33e-07 -- Median validation metrics: avg_loss: 9.33e-07, NSE: 0.78552, MSE: 36743.07812
2025-11-05 00:08:20,165: Epoch 16 average loss: avg_loss: 5.98e-07, avg_total_loss: 5.98e-07
2025-11-05 00:08:20,709: Epoch 17 average loss: avg_loss: 7.52e-07, avg_total_loss: 7.52e-07
2025-11-05 00:08:21,200: Epoch 18 average loss: avg_loss: 7.75e-07, avg_total_loss: 7.75e-07
2025-11-05 00:08:21,652: Epoch 19 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:08:22,114: Epoch 20 average loss: avg_loss: 6.30e-07, avg_total_loss: 6.30e-07
2025-11-05 00:08:22,407: Epoch 20 average validation loss: 9.30e-07 -- Median validation metrics: avg_loss: 9.30e-07, NSE: 0.78663, MSE: 36553.55078
2025-11-05 00:08:22,844: Epoch 21 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:08:23,301: Epoch 22 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:08:23,798: Epoch 23 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:08:23,799: Setting learning rate to 0.005
2025-11-05 00:08:24,275: Epoch 24 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:08:24,749: Epoch 25 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:08:25,029: Epoch 25 average validation loss: 9.66e-07 -- Median validation metrics: avg_loss: 9.66e-07, NSE: 0.77762, MSE: 38096.08984
2025-11-05 00:08:25,475: Epoch 26 average loss: avg_loss: 4.70e-07, avg_total_loss: 4.70e-07
2025-11-05 00:08:25,939: Epoch 27 average loss: avg_loss: 4.89e-07, avg_total_loss: 4.89e-07
2025-11-05 00:08:26,411: Epoch 28 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:08:26,874: Epoch 29 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:08:27,352: Epoch 30 average loss: avg_loss: 4.58e-07, avg_total_loss: 4.58e-07
2025-11-05 00:08:27,626: Epoch 30 average validation loss: 9.32e-07 -- Median validation metrics: avg_loss: 9.32e-07, NSE: 0.78562, MSE: 36726.53906
2025-11-05 00:08:28,101: Epoch 31 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:08:28,676: Epoch 32 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:08:29,139: Epoch 33 average loss: avg_loss: 4.24e-07, avg_total_loss: 4.24e-07
2025-11-05 00:08:29,628: Epoch 34 average loss: avg_loss: 3.92e-07, avg_total_loss: 3.92e-07
2025-11-05 00:08:30,083: Epoch 35 average loss: avg_loss: 4.66e-07, avg_total_loss: 4.66e-07
2025-11-05 00:08:30,372: Epoch 35 average validation loss: 9.87e-07 -- Median validation metrics: avg_loss: 9.87e-07, NSE: 0.77341, MSE: 38816.98828
2025-11-05 00:08:30,374: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:08:30,375: Early stopping triggered at epoch 35
2025-11-05 00:08:30,391: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\model_epoch035.pt
2025-11-05 00:08:30,602: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:08:30,604: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000810\validation\model_epoch035\validation_results.p
2025-11-05 00:08:31,318: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\output.log initialized.
2025-11-05 00:08:31,320: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831
2025-11-05 00:08:31,321: ### Run configurations for testing_run
2025-11-05 00:08:31,322: experiment_name: testing_run
2025-11-05 00:08:31,322: train_basin_file: calpella
2025-11-05 00:08:31,323: validation_basin_file: calpella
2025-11-05 00:08:31,324: test_basin_file: calpella
2025-11-05 00:08:31,325: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:08:31,325: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:08:31,326: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:08:31,327: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:08:31,327: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:08:31,328: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:08:31,329: device: cuda:0
2025-11-05 00:08:31,329: physics_informed: False
2025-11-05 00:08:31,330: physics_data_file: None
2025-11-05 00:08:31,330: validate_every: 5
2025-11-05 00:08:31,331: validate_n_random_basins: 1
2025-11-05 00:08:31,331: metrics: ['NSE', 'MSE']
2025-11-05 00:08:31,332: model: cudalstm
2025-11-05 00:08:31,333: head: regression
2025-11-05 00:08:31,333: output_activation: linear
2025-11-05 00:08:31,334: hidden_size: 64
2025-11-05 00:08:31,335: initial_forget_bias: 3
2025-11-05 00:08:31,335: output_dropout: 0.4
2025-11-05 00:08:31,336: num_layers: 1
2025-11-05 00:08:31,337: dev_mode: True
2025-11-05 00:08:31,337: optimizer: Adam
2025-11-05 00:08:31,338: loss: NSE
2025-11-05 00:08:31,338: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:08:31,339: batch_size: 128
2025-11-05 00:08:31,339: epochs: 48
2025-11-05 00:08:31,340: clip_gradient_norm: 1
2025-11-05 00:08:31,341: predict_last_n: 1
2025-11-05 00:08:31,342: seq_length: 120
2025-11-05 00:08:31,343: log_interval: 16
2025-11-05 00:08:31,343: log_tensorboard: True
2025-11-05 00:08:31,344: log_n_figures: 1
2025-11-05 00:08:31,345: save_weights_every: 48
2025-11-05 00:08:31,345: early_stopping: True
2025-11-05 00:08:31,346: early_stopping_mode: patience
2025-11-05 00:08:31,346: patience_early_stopping: 3
2025-11-05 00:08:31,347: min_delta_early_stopping: 0.0
2025-11-05 00:08:31,347: minimum_epochs_before_early_stopping: 10
2025-11-05 00:08:31,348: early_stopping_slope_window: 7
2025-11-05 00:08:31,349: early_stopping_slope_patience: 2
2025-11-05 00:08:31,350: early_stopping_slope_min_epoch: 8
2025-11-05 00:08:31,350: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:08:31,351: early_stopping_slope_use_log: True
2025-11-05 00:08:31,352: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:08:31,352: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:08:31,353: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:08:31,354: early_stopping_slope_variance_guard: True
2025-11-05 00:08:31,355: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:08:31,356: dataset: russian_river
2025-11-05 00:08:31,357: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:08:31,357: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:08:31,358: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:08:31,359: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:08:31,360: hourly: False
2025-11-05 00:08:31,360: is_mts: False
2025-11-05 00:08:31,361: is_mts_data: False
2025-11-05 00:08:31,362: verbose: True
2025-11-05 00:08:31,364: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831
2025-11-05 00:08:31,364: run_label: BASELINE
2025-11-05 00:08:31,365: number_of_basins: 1
2025-11-05 00:08:31,366: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\train_data
2025-11-05 00:08:31,367: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\img_log
2025-11-05 00:08:31,368: ### Device cuda:0 will be used for training
2025-11-05 00:08:31,369: Loading basin data into xarray data set.
2025-11-05 00:08:31,529: Calculating target variable stds per basin
2025-11-05 00:08:31,538: Create lookup table and convert to pytorch tensor
2025-11-05 00:08:31,663: Early stopping enabled: mode=patience
2025-11-05 00:08:32,191: Epoch 1 average loss: avg_loss: 2.50e-06, avg_total_loss: 2.50e-06
2025-11-05 00:08:32,493: Epoch 2 average loss: avg_loss: 1.59e-06, avg_total_loss: 1.59e-06
2025-11-05 00:08:32,733: Epoch 3 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:08:32,961: Epoch 4 average loss: avg_loss: 1.27e-06, avg_total_loss: 1.27e-06
2025-11-05 00:08:33,181: Epoch 5 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:08:33,591: Epoch 5 average validation loss: 1.58e-06 -- Median validation metrics: avg_loss: 1.58e-06, NSE: 0.63742, MSE: 62114.96484
2025-11-05 00:08:33,789: Epoch 6 average loss: avg_loss: 8.82e-07, avg_total_loss: 8.82e-07
2025-11-05 00:08:33,988: Epoch 7 average loss: avg_loss: 8.61e-07, avg_total_loss: 8.61e-07
2025-11-05 00:08:34,188: Epoch 8 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:08:34,420: Epoch 9 average loss: avg_loss: 7.40e-07, avg_total_loss: 7.40e-07
2025-11-05 00:08:34,658: Epoch 10 average loss: avg_loss: 7.52e-07, avg_total_loss: 7.52e-07
2025-11-05 00:08:34,914: Epoch 10 average validation loss: 9.34e-07 -- Median validation metrics: avg_loss: 9.34e-07, NSE: 0.78510, MSE: 36814.50781
2025-11-05 00:08:35,156: Epoch 11 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:08:35,458: Epoch 12 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:08:35,762: Epoch 13 average loss: avg_loss: 7.08e-07, avg_total_loss: 7.08e-07
2025-11-05 00:08:35,989: Epoch 14 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:08:36,179: Epoch 15 average loss: avg_loss: 7.37e-07, avg_total_loss: 7.37e-07
2025-11-05 00:08:36,431: Epoch 15 average validation loss: 9.99e-07 -- Median validation metrics: avg_loss: 9.99e-07, NSE: 0.77036, MSE: 39339.41406
2025-11-05 00:08:36,647: Epoch 16 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:08:36,850: Epoch 17 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:08:37,043: Epoch 18 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:08:37,251: Epoch 19 average loss: avg_loss: 7.04e-07, avg_total_loss: 7.04e-07
2025-11-05 00:08:37,451: Epoch 20 average loss: avg_loss: 6.21e-07, avg_total_loss: 6.21e-07
2025-11-05 00:08:37,723: Epoch 20 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76683, MSE: 39945.51953
2025-11-05 00:08:37,906: Epoch 21 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:08:38,111: Epoch 22 average loss: avg_loss: 6.61e-07, avg_total_loss: 6.61e-07
2025-11-05 00:08:38,301: Epoch 23 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:08:38,302: Setting learning rate to 0.005
2025-11-05 00:08:38,532: Epoch 24 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:08:38,729: Epoch 25 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:08:39,009: Epoch 25 average validation loss: 8.93e-07 -- Median validation metrics: avg_loss: 8.93e-07, NSE: 0.79494, MSE: 35128.58594
2025-11-05 00:08:39,204: Epoch 26 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:08:39,419: Epoch 27 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:08:39,627: Epoch 28 average loss: avg_loss: 4.97e-07, avg_total_loss: 4.97e-07
2025-11-05 00:08:39,855: Epoch 29 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:08:40,060: Epoch 30 average loss: avg_loss: 4.79e-07, avg_total_loss: 4.79e-07
2025-11-05 00:08:40,340: Epoch 30 average validation loss: 8.31e-07 -- Median validation metrics: avg_loss: 8.31e-07, NSE: 0.80873, MSE: 32767.59375
2025-11-05 00:08:40,582: Epoch 31 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:08:40,888: Epoch 32 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:08:41,181: Epoch 33 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:08:41,465: Epoch 34 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:08:41,666: Epoch 35 average loss: avg_loss: 4.47e-07, avg_total_loss: 4.47e-07
2025-11-05 00:08:41,909: Epoch 35 average validation loss: 8.91e-07 -- Median validation metrics: avg_loss: 8.91e-07, NSE: 0.79487, MSE: 35141.19922
2025-11-05 00:08:41,910: Setting learning rate to 0.001
2025-11-05 00:08:42,081: Epoch 36 average loss: avg_loss: 4.81e-07, avg_total_loss: 4.81e-07
2025-11-05 00:08:42,274: Epoch 37 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:08:42,461: Epoch 38 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:08:42,671: Epoch 39 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:08:42,847: Epoch 40 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:08:43,135: Epoch 40 average validation loss: 9.42e-07 -- Median validation metrics: avg_loss: 9.42e-07, NSE: 0.78326, MSE: 37130.93359
2025-11-05 00:08:43,309: Epoch 41 average loss: avg_loss: 4.47e-07, avg_total_loss: 4.47e-07
2025-11-05 00:08:43,508: Epoch 42 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:08:43,740: Epoch 43 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:08:43,955: Epoch 44 average loss: avg_loss: 4.12e-07, avg_total_loss: 4.12e-07
2025-11-05 00:08:44,142: Epoch 45 average loss: avg_loss: 3.51e-07, avg_total_loss: 3.51e-07
2025-11-05 00:08:44,391: Epoch 45 average validation loss: 9.15e-07 -- Median validation metrics: avg_loss: 9.15e-07, NSE: 0.78949, MSE: 36062.39453
2025-11-05 00:08:44,392: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:08:44,393: Early stopping triggered at epoch 45
2025-11-05 00:08:44,408: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\model_epoch045.pt
2025-11-05 00:08:44,596: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:08:44,598: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000831\validation\model_epoch045\validation_results.p
2025-11-05 00:08:45,268: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\output.log initialized.
2025-11-05 00:08:45,269: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845
2025-11-05 00:08:45,270: ### Run configurations for testing_run
2025-11-05 00:08:45,270: experiment_name: testing_run
2025-11-05 00:08:45,271: train_basin_file: calpella
2025-11-05 00:08:45,272: validation_basin_file: calpella
2025-11-05 00:08:45,272: test_basin_file: calpella
2025-11-05 00:08:45,273: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:08:45,275: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:08:45,276: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:08:45,276: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:08:45,277: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:08:45,278: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:08:45,278: device: cuda:0
2025-11-05 00:08:45,279: physics_informed: False
2025-11-05 00:08:45,280: physics_data_file: None
2025-11-05 00:08:45,280: validate_every: 5
2025-11-05 00:08:45,281: validate_n_random_basins: 1
2025-11-05 00:08:45,282: metrics: ['NSE', 'MSE']
2025-11-05 00:08:45,282: model: cudalstm
2025-11-05 00:08:45,283: head: regression
2025-11-05 00:08:45,284: output_activation: linear
2025-11-05 00:08:45,285: hidden_size: 64
2025-11-05 00:08:45,285: initial_forget_bias: 3
2025-11-05 00:08:45,286: output_dropout: 0.4
2025-11-05 00:08:45,287: num_layers: 1
2025-11-05 00:08:45,288: dev_mode: True
2025-11-05 00:08:45,289: optimizer: Adam
2025-11-05 00:08:45,290: loss: NSE
2025-11-05 00:08:45,290: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:08:45,291: batch_size: 256
2025-11-05 00:08:45,292: epochs: 48
2025-11-05 00:08:45,293: clip_gradient_norm: 1
2025-11-05 00:08:45,293: predict_last_n: 1
2025-11-05 00:08:45,294: seq_length: 120
2025-11-05 00:08:45,297: log_interval: 16
2025-11-05 00:08:45,298: log_tensorboard: True
2025-11-05 00:08:45,299: log_n_figures: 1
2025-11-05 00:08:45,300: save_weights_every: 48
2025-11-05 00:08:45,300: early_stopping: True
2025-11-05 00:08:45,302: early_stopping_mode: patience
2025-11-05 00:08:45,303: patience_early_stopping: 3
2025-11-05 00:08:45,304: min_delta_early_stopping: 0.0
2025-11-05 00:08:45,305: minimum_epochs_before_early_stopping: 10
2025-11-05 00:08:45,306: early_stopping_slope_window: 7
2025-11-05 00:08:45,306: early_stopping_slope_patience: 2
2025-11-05 00:08:45,308: early_stopping_slope_min_epoch: 8
2025-11-05 00:08:45,310: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:08:45,311: early_stopping_slope_use_log: True
2025-11-05 00:08:45,312: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:08:45,313: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:08:45,314: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:08:45,316: early_stopping_slope_variance_guard: True
2025-11-05 00:08:45,317: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:08:45,318: dataset: russian_river
2025-11-05 00:08:45,319: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:08:45,320: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:08:45,321: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:08:45,322: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:08:45,323: hourly: False
2025-11-05 00:08:45,324: is_mts: False
2025-11-05 00:08:45,325: is_mts_data: False
2025-11-05 00:08:45,326: verbose: True
2025-11-05 00:08:45,328: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845
2025-11-05 00:08:45,328: run_label: BASELINE
2025-11-05 00:08:45,329: number_of_basins: 1
2025-11-05 00:08:45,330: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\train_data
2025-11-05 00:08:45,331: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\img_log
2025-11-05 00:08:45,333: ### Device cuda:0 will be used for training
2025-11-05 00:08:45,335: Loading basin data into xarray data set.
2025-11-05 00:08:45,527: Calculating target variable stds per basin
2025-11-05 00:08:45,539: Create lookup table and convert to pytorch tensor
2025-11-05 00:08:45,683: Early stopping enabled: mode=patience
2025-11-05 00:08:45,944: Epoch 1 average loss: avg_loss: 2.80e-06, avg_total_loss: 2.80e-06
2025-11-05 00:08:46,179: Epoch 2 average loss: avg_loss: 2.14e-06, avg_total_loss: 2.14e-06
2025-11-05 00:08:46,433: Epoch 3 average loss: avg_loss: 1.45e-06, avg_total_loss: 1.45e-06
2025-11-05 00:08:46,664: Epoch 4 average loss: avg_loss: 1.29e-06, avg_total_loss: 1.29e-06
2025-11-05 00:08:46,833: Epoch 5 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:08:47,275: Epoch 5 average validation loss: 1.22e-06 -- Median validation metrics: avg_loss: 1.22e-06, NSE: 0.70236, MSE: 50988.53125
2025-11-05 00:08:47,439: Epoch 6 average loss: avg_loss: 1.12e-06, avg_total_loss: 1.12e-06
2025-11-05 00:08:47,588: Epoch 7 average loss: avg_loss: 9.50e-07, avg_total_loss: 9.50e-07
2025-11-05 00:08:47,756: Epoch 8 average loss: avg_loss: 9.74e-07, avg_total_loss: 9.74e-07
2025-11-05 00:08:47,910: Epoch 9 average loss: avg_loss: 8.10e-07, avg_total_loss: 8.10e-07
2025-11-05 00:08:48,304: Epoch 10 average loss: avg_loss: 7.93e-07, avg_total_loss: 7.93e-07
2025-11-05 00:08:48,609: Epoch 10 average validation loss: 1.10e-06 -- Median validation metrics: avg_loss: 1.10e-06, NSE: 0.71955, MSE: 48045.08984
2025-11-05 00:08:48,789: Epoch 11 average loss: avg_loss: 7.77e-07, avg_total_loss: 7.77e-07
2025-11-05 00:08:48,958: Epoch 12 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:08:49,128: Epoch 13 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:08:49,327: Epoch 14 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:08:49,498: Epoch 15 average loss: avg_loss: 6.46e-07, avg_total_loss: 6.46e-07
2025-11-05 00:08:49,818: Epoch 15 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.72894, MSE: 46436.60156
2025-11-05 00:08:49,991: Epoch 16 average loss: avg_loss: 8.11e-07, avg_total_loss: 8.11e-07
2025-11-05 00:08:50,161: Epoch 17 average loss: avg_loss: 6.87e-07, avg_total_loss: 6.87e-07
2025-11-05 00:08:50,331: Epoch 18 average loss: avg_loss: 6.68e-07, avg_total_loss: 6.68e-07
2025-11-05 00:08:50,509: Epoch 19 average loss: avg_loss: 6.23e-07, avg_total_loss: 6.23e-07
2025-11-05 00:08:50,706: Epoch 20 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:08:51,003: Epoch 20 average validation loss: 9.28e-07 -- Median validation metrics: avg_loss: 9.28e-07, NSE: 0.76380, MSE: 40463.87891
2025-11-05 00:08:51,186: Epoch 21 average loss: avg_loss: 6.14e-07, avg_total_loss: 6.14e-07
2025-11-05 00:08:51,410: Epoch 22 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:08:51,608: Epoch 23 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:08:51,609: Setting learning rate to 0.005
2025-11-05 00:08:51,794: Epoch 24 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:08:51,996: Epoch 25 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:08:52,330: Epoch 25 average validation loss: 9.27e-07 -- Median validation metrics: avg_loss: 9.27e-07, NSE: 0.76604, MSE: 40080.91016
2025-11-05 00:08:52,534: Epoch 26 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:08:52,743: Epoch 27 average loss: avg_loss: 6.41e-07, avg_total_loss: 6.41e-07
2025-11-05 00:08:52,977: Epoch 28 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:08:53,180: Epoch 29 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:08:53,386: Epoch 30 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:08:53,688: Epoch 30 average validation loss: 9.43e-07 -- Median validation metrics: avg_loss: 9.43e-07, NSE: 0.76149, MSE: 40859.87500
2025-11-05 00:08:53,952: Epoch 31 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:08:54,213: Epoch 32 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:08:54,475: Epoch 33 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:08:54,729: Epoch 34 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:08:54,905: Epoch 35 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:08:55,210: Epoch 35 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.73906, MSE: 44702.80078
2025-11-05 00:08:55,212: Setting learning rate to 0.001
2025-11-05 00:08:55,361: Epoch 36 average loss: avg_loss: 5.16e-07, avg_total_loss: 5.16e-07
2025-11-05 00:08:55,497: Epoch 37 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:08:55,650: Epoch 38 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:08:55,790: Epoch 39 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:08:55,923: Epoch 40 average loss: avg_loss: 4.40e-07, avg_total_loss: 4.40e-07
2025-11-05 00:08:56,209: Epoch 40 average validation loss: 9.63e-07 -- Median validation metrics: avg_loss: 9.63e-07, NSE: 0.75531, MSE: 41919.02734
2025-11-05 00:08:56,210: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:08:56,211: Early stopping triggered at epoch 40
2025-11-05 00:08:56,228: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\model_epoch040.pt
2025-11-05 00:08:56,449: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:08:56,451: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000845\validation\model_epoch040\validation_results.p
2025-11-05 00:08:57,244: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\output.log initialized.
2025-11-05 00:08:57,245: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857
2025-11-05 00:08:57,246: ### Run configurations for testing_run
2025-11-05 00:08:57,247: experiment_name: testing_run
2025-11-05 00:08:57,247: train_basin_file: calpella
2025-11-05 00:08:57,248: validation_basin_file: calpella
2025-11-05 00:08:57,249: test_basin_file: calpella
2025-11-05 00:08:57,250: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:08:57,250: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:08:57,251: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:08:57,252: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:08:57,253: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:08:57,254: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:08:57,255: device: cuda:0
2025-11-05 00:08:57,255: physics_informed: False
2025-11-05 00:08:57,256: physics_data_file: None
2025-11-05 00:08:57,257: validate_every: 5
2025-11-05 00:08:57,258: validate_n_random_basins: 1
2025-11-05 00:08:57,258: metrics: ['NSE', 'MSE']
2025-11-05 00:08:57,259: model: cudalstm
2025-11-05 00:08:57,260: head: regression
2025-11-05 00:08:57,260: output_activation: linear
2025-11-05 00:08:57,262: hidden_size: 128
2025-11-05 00:08:57,263: initial_forget_bias: 3
2025-11-05 00:08:57,264: output_dropout: 0.4
2025-11-05 00:08:57,264: num_layers: 1
2025-11-05 00:08:57,265: dev_mode: True
2025-11-05 00:08:57,266: optimizer: Adam
2025-11-05 00:08:57,266: loss: NSE
2025-11-05 00:08:57,267: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:08:57,268: batch_size: 64
2025-11-05 00:08:57,269: epochs: 16
2025-11-05 00:08:57,269: clip_gradient_norm: 1
2025-11-05 00:08:57,270: predict_last_n: 1
2025-11-05 00:08:57,271: seq_length: 90
2025-11-05 00:08:57,271: log_interval: 16
2025-11-05 00:08:57,272: log_tensorboard: True
2025-11-05 00:08:57,273: log_n_figures: 1
2025-11-05 00:08:57,273: save_weights_every: 16
2025-11-05 00:08:57,275: early_stopping: True
2025-11-05 00:08:57,275: early_stopping_mode: patience
2025-11-05 00:08:57,276: patience_early_stopping: 3
2025-11-05 00:08:57,277: min_delta_early_stopping: 0.0
2025-11-05 00:08:57,278: minimum_epochs_before_early_stopping: 10
2025-11-05 00:08:57,278: early_stopping_slope_window: 7
2025-11-05 00:08:57,279: early_stopping_slope_patience: 2
2025-11-05 00:08:57,280: early_stopping_slope_min_epoch: 8
2025-11-05 00:08:57,281: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:08:57,281: early_stopping_slope_use_log: True
2025-11-05 00:08:57,283: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:08:57,284: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:08:57,285: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:08:57,285: early_stopping_slope_variance_guard: True
2025-11-05 00:08:57,286: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:08:57,287: dataset: russian_river
2025-11-05 00:08:57,288: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:08:57,289: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:08:57,290: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:08:57,291: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:08:57,292: hourly: False
2025-11-05 00:08:57,293: is_mts: False
2025-11-05 00:08:57,294: is_mts_data: False
2025-11-05 00:08:57,294: verbose: True
2025-11-05 00:08:57,295: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857
2025-11-05 00:08:57,296: run_label: BASELINE
2025-11-05 00:08:57,296: number_of_basins: 1
2025-11-05 00:08:57,297: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\train_data
2025-11-05 00:08:57,298: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\img_log
2025-11-05 00:08:57,301: ### Device cuda:0 will be used for training
2025-11-05 00:08:57,302: Loading basin data into xarray data set.
2025-11-05 00:08:57,491: Calculating target variable stds per basin
2025-11-05 00:08:57,500: Create lookup table and convert to pytorch tensor
2025-11-05 00:08:57,625: Early stopping enabled: mode=patience
2025-11-05 00:08:58,236: Epoch 1 average loss: avg_loss: 3.56e-06, avg_total_loss: 3.56e-06
2025-11-05 00:08:58,811: Epoch 2 average loss: avg_loss: 1.97e-06, avg_total_loss: 1.97e-06
2025-11-05 00:08:59,388: Epoch 3 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:08:59,992: Epoch 4 average loss: avg_loss: 9.64e-07, avg_total_loss: 9.64e-07
2025-11-05 00:09:00,503: Epoch 5 average loss: avg_loss: 9.42e-07, avg_total_loss: 9.42e-07
2025-11-05 00:09:01,053: Epoch 5 average validation loss: 9.20e-07 -- Median validation metrics: avg_loss: 9.20e-07, NSE: 0.78959, MSE: 36045.82422
2025-11-05 00:09:01,526: Epoch 6 average loss: avg_loss: 8.89e-07, avg_total_loss: 8.89e-07
2025-11-05 00:09:02,021: Epoch 7 average loss: avg_loss: 9.18e-07, avg_total_loss: 9.18e-07
2025-11-05 00:09:02,022: Setting learning rate to 0.005
2025-11-05 00:09:02,607: Epoch 8 average loss: avg_loss: 8.39e-07, avg_total_loss: 8.39e-07
2025-11-05 00:09:03,148: Epoch 9 average loss: avg_loss: 7.62e-07, avg_total_loss: 7.62e-07
2025-11-05 00:09:03,619: Epoch 10 average loss: avg_loss: 7.08e-07, avg_total_loss: 7.08e-07
2025-11-05 00:09:03,975: Epoch 10 average validation loss: 9.99e-07 -- Median validation metrics: avg_loss: 9.99e-07, NSE: 0.77093, MSE: 39243.12109
2025-11-05 00:09:04,430: Epoch 11 average loss: avg_loss: 7.29e-07, avg_total_loss: 7.29e-07
2025-11-05 00:09:04,432: Setting learning rate to 0.001
2025-11-05 00:09:04,944: Epoch 12 average loss: avg_loss: 7.12e-07, avg_total_loss: 7.12e-07
2025-11-05 00:09:05,456: Epoch 13 average loss: avg_loss: 6.16e-07, avg_total_loss: 6.16e-07
2025-11-05 00:09:05,940: Epoch 14 average loss: avg_loss: 6.33e-07, avg_total_loss: 6.33e-07
2025-11-05 00:09:06,451: Epoch 15 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:09:06,772: Epoch 15 average validation loss: 9.90e-07 -- Median validation metrics: avg_loss: 9.90e-07, NSE: 0.77251, MSE: 38971.35156
2025-11-05 00:09:07,318: Epoch 16 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:09:07,339: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\model_epoch016.pt
2025-11-05 00:09:07,595: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:09:07,597: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000857\validation\model_epoch016\validation_results.p
2025-11-05 00:09:08,331: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\output.log initialized.
2025-11-05 00:09:08,333: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908
2025-11-05 00:09:08,334: ### Run configurations for testing_run
2025-11-05 00:09:08,335: experiment_name: testing_run
2025-11-05 00:09:08,336: train_basin_file: calpella
2025-11-05 00:09:08,337: validation_basin_file: calpella
2025-11-05 00:09:08,338: test_basin_file: calpella
2025-11-05 00:09:08,339: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:08,340: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:08,341: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:08,343: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:08,344: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:08,345: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:08,346: device: cuda:0
2025-11-05 00:09:08,347: physics_informed: False
2025-11-05 00:09:08,348: physics_data_file: None
2025-11-05 00:09:08,349: validate_every: 5
2025-11-05 00:09:08,350: validate_n_random_basins: 1
2025-11-05 00:09:08,351: metrics: ['NSE', 'MSE']
2025-11-05 00:09:08,352: model: cudalstm
2025-11-05 00:09:08,353: head: regression
2025-11-05 00:09:08,355: output_activation: linear
2025-11-05 00:09:08,356: hidden_size: 128
2025-11-05 00:09:08,357: initial_forget_bias: 3
2025-11-05 00:09:08,359: output_dropout: 0.4
2025-11-05 00:09:08,359: num_layers: 1
2025-11-05 00:09:08,361: dev_mode: True
2025-11-05 00:09:08,362: optimizer: Adam
2025-11-05 00:09:08,363: loss: NSE
2025-11-05 00:09:08,364: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:09:08,364: batch_size: 128
2025-11-05 00:09:08,365: epochs: 16
2025-11-05 00:09:08,366: clip_gradient_norm: 1
2025-11-05 00:09:08,367: predict_last_n: 1
2025-11-05 00:09:08,367: seq_length: 90
2025-11-05 00:09:08,368: log_interval: 16
2025-11-05 00:09:08,369: log_tensorboard: True
2025-11-05 00:09:08,370: log_n_figures: 1
2025-11-05 00:09:08,371: save_weights_every: 16
2025-11-05 00:09:08,371: early_stopping: True
2025-11-05 00:09:08,372: early_stopping_mode: patience
2025-11-05 00:09:08,373: patience_early_stopping: 3
2025-11-05 00:09:08,373: min_delta_early_stopping: 0.0
2025-11-05 00:09:08,374: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:08,375: early_stopping_slope_window: 7
2025-11-05 00:09:08,376: early_stopping_slope_patience: 2
2025-11-05 00:09:08,377: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:08,378: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:08,379: early_stopping_slope_use_log: True
2025-11-05 00:09:08,380: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:08,381: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:08,382: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:08,383: early_stopping_slope_variance_guard: True
2025-11-05 00:09:08,383: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:08,384: dataset: russian_river
2025-11-05 00:09:08,384: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:08,385: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:08,386: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:08,389: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:08,390: hourly: False
2025-11-05 00:09:08,391: is_mts: False
2025-11-05 00:09:08,392: is_mts_data: False
2025-11-05 00:09:08,393: verbose: True
2025-11-05 00:09:08,394: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908
2025-11-05 00:09:08,395: run_label: BASELINE
2025-11-05 00:09:08,396: number_of_basins: 1
2025-11-05 00:09:08,397: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\train_data
2025-11-05 00:09:08,397: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\img_log
2025-11-05 00:09:08,400: ### Device cuda:0 will be used for training
2025-11-05 00:09:08,402: Loading basin data into xarray data set.
2025-11-05 00:09:08,556: Calculating target variable stds per basin
2025-11-05 00:09:08,566: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:08,679: Early stopping enabled: mode=patience
2025-11-05 00:09:09,047: Epoch 1 average loss: avg_loss: 3.37e-06, avg_total_loss: 3.37e-06
2025-11-05 00:09:09,302: Epoch 2 average loss: avg_loss: 2.44e-06, avg_total_loss: 2.44e-06
2025-11-05 00:09:09,554: Epoch 3 average loss: avg_loss: 1.62e-06, avg_total_loss: 1.62e-06
2025-11-05 00:09:09,843: Epoch 4 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:09:10,116: Epoch 5 average loss: avg_loss: 1.17e-06, avg_total_loss: 1.17e-06
2025-11-05 00:09:10,546: Epoch 5 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76210, MSE: 40755.45703
2025-11-05 00:09:10,787: Epoch 6 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:09:11,038: Epoch 7 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:09:11,039: Setting learning rate to 0.005
2025-11-05 00:09:11,315: Epoch 8 average loss: avg_loss: 7.71e-07, avg_total_loss: 7.71e-07
2025-11-05 00:09:11,568: Epoch 9 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:09:11,840: Epoch 10 average loss: avg_loss: 8.25e-07, avg_total_loss: 8.25e-07
2025-11-05 00:09:12,104: Epoch 10 average validation loss: 1.18e-06 -- Median validation metrics: avg_loss: 1.18e-06, NSE: 0.72875, MSE: 46467.71484
2025-11-05 00:09:12,353: Epoch 11 average loss: avg_loss: 7.68e-07, avg_total_loss: 7.68e-07
2025-11-05 00:09:12,354: Setting learning rate to 0.001
2025-11-05 00:09:12,617: Epoch 12 average loss: avg_loss: 6.77e-07, avg_total_loss: 6.77e-07
2025-11-05 00:09:12,898: Epoch 13 average loss: avg_loss: 6.40e-07, avg_total_loss: 6.40e-07
2025-11-05 00:09:13,144: Epoch 14 average loss: avg_loss: 6.90e-07, avg_total_loss: 6.90e-07
2025-11-05 00:09:13,415: Epoch 15 average loss: avg_loss: 6.35e-07, avg_total_loss: 6.35e-07
2025-11-05 00:09:13,707: Epoch 15 average validation loss: 9.66e-07 -- Median validation metrics: avg_loss: 9.66e-07, NSE: 0.77764, MSE: 38093.68750
2025-11-05 00:09:13,952: Epoch 16 average loss: avg_loss: 6.70e-07, avg_total_loss: 6.70e-07
2025-11-05 00:09:13,980: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\model_epoch016.pt
2025-11-05 00:09:14,167: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:09:14,168: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000908\validation\model_epoch016\validation_results.p
2025-11-05 00:09:14,854: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\output.log initialized.
2025-11-05 00:09:14,856: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914
2025-11-05 00:09:14,857: ### Run configurations for testing_run
2025-11-05 00:09:14,859: experiment_name: testing_run
2025-11-05 00:09:14,860: train_basin_file: calpella
2025-11-05 00:09:14,861: validation_basin_file: calpella
2025-11-05 00:09:14,862: test_basin_file: calpella
2025-11-05 00:09:14,863: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:14,864: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:14,865: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:14,866: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:14,866: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:14,867: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:14,868: device: cuda:0
2025-11-05 00:09:14,869: physics_informed: False
2025-11-05 00:09:14,870: physics_data_file: None
2025-11-05 00:09:14,870: validate_every: 5
2025-11-05 00:09:14,871: validate_n_random_basins: 1
2025-11-05 00:09:14,872: metrics: ['NSE', 'MSE']
2025-11-05 00:09:14,873: model: cudalstm
2025-11-05 00:09:14,874: head: regression
2025-11-05 00:09:14,875: output_activation: linear
2025-11-05 00:09:14,876: hidden_size: 128
2025-11-05 00:09:14,877: initial_forget_bias: 3
2025-11-05 00:09:14,878: output_dropout: 0.4
2025-11-05 00:09:14,879: num_layers: 1
2025-11-05 00:09:14,880: dev_mode: True
2025-11-05 00:09:14,881: optimizer: Adam
2025-11-05 00:09:14,882: loss: NSE
2025-11-05 00:09:14,883: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:09:14,884: batch_size: 256
2025-11-05 00:09:14,885: epochs: 16
2025-11-05 00:09:14,886: clip_gradient_norm: 1
2025-11-05 00:09:14,886: predict_last_n: 1
2025-11-05 00:09:14,887: seq_length: 90
2025-11-05 00:09:14,888: log_interval: 16
2025-11-05 00:09:14,890: log_tensorboard: True
2025-11-05 00:09:14,890: log_n_figures: 1
2025-11-05 00:09:14,891: save_weights_every: 16
2025-11-05 00:09:14,893: early_stopping: True
2025-11-05 00:09:14,893: early_stopping_mode: patience
2025-11-05 00:09:14,894: patience_early_stopping: 3
2025-11-05 00:09:14,895: min_delta_early_stopping: 0.0
2025-11-05 00:09:14,896: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:14,897: early_stopping_slope_window: 7
2025-11-05 00:09:14,897: early_stopping_slope_patience: 2
2025-11-05 00:09:14,898: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:14,899: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:14,900: early_stopping_slope_use_log: True
2025-11-05 00:09:14,901: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:14,902: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:14,904: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:14,904: early_stopping_slope_variance_guard: True
2025-11-05 00:09:14,905: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:14,906: dataset: russian_river
2025-11-05 00:09:14,907: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:14,908: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:14,909: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:14,910: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:14,911: hourly: False
2025-11-05 00:09:14,912: is_mts: False
2025-11-05 00:09:14,913: is_mts_data: False
2025-11-05 00:09:14,914: verbose: True
2025-11-05 00:09:14,915: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914
2025-11-05 00:09:14,916: run_label: BASELINE
2025-11-05 00:09:14,916: number_of_basins: 1
2025-11-05 00:09:14,917: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\train_data
2025-11-05 00:09:14,918: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\img_log
2025-11-05 00:09:14,921: ### Device cuda:0 will be used for training
2025-11-05 00:09:14,922: Loading basin data into xarray data set.
2025-11-05 00:09:15,280: Calculating target variable stds per basin
2025-11-05 00:09:15,290: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:15,440: Early stopping enabled: mode=patience
2025-11-05 00:09:15,796: Epoch 1 average loss: avg_loss: 3.59e-06, avg_total_loss: 3.59e-06
2025-11-05 00:09:16,056: Epoch 2 average loss: avg_loss: 2.48e-06, avg_total_loss: 2.48e-06
2025-11-05 00:09:16,223: Epoch 3 average loss: avg_loss: 1.55e-06, avg_total_loss: 1.55e-06
2025-11-05 00:09:16,366: Epoch 4 average loss: avg_loss: 1.21e-06, avg_total_loss: 1.21e-06
2025-11-05 00:09:16,521: Epoch 5 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:09:16,964: Epoch 5 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.74382, MSE: 43887.41797
2025-11-05 00:09:17,103: Epoch 6 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:09:17,245: Epoch 7 average loss: avg_loss: 9.50e-07, avg_total_loss: 9.50e-07
2025-11-05 00:09:17,246: Setting learning rate to 0.005
2025-11-05 00:09:17,404: Epoch 8 average loss: avg_loss: 9.47e-07, avg_total_loss: 9.47e-07
2025-11-05 00:09:17,557: Epoch 9 average loss: avg_loss: 8.65e-07, avg_total_loss: 8.65e-07
2025-11-05 00:09:17,713: Epoch 10 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:09:18,015: Epoch 10 average validation loss: 1.31e-06 -- Median validation metrics: avg_loss: 1.31e-06, NSE: 0.66528, MSE: 57341.87891
2025-11-05 00:09:18,188: Epoch 11 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:09:18,189: Setting learning rate to 0.001
2025-11-05 00:09:18,353: Epoch 12 average loss: avg_loss: 9.38e-07, avg_total_loss: 9.38e-07
2025-11-05 00:09:18,521: Epoch 13 average loss: avg_loss: 7.81e-07, avg_total_loss: 7.81e-07
2025-11-05 00:09:18,718: Epoch 14 average loss: avg_loss: 7.34e-07, avg_total_loss: 7.34e-07
2025-11-05 00:09:18,894: Epoch 15 average loss: avg_loss: 7.25e-07, avg_total_loss: 7.25e-07
2025-11-05 00:09:19,166: Epoch 15 average validation loss: 9.76e-07 -- Median validation metrics: avg_loss: 9.76e-07, NSE: 0.75175, MSE: 42528.40625
2025-11-05 00:09:19,342: Epoch 16 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:09:19,364: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\model_epoch016.pt
2025-11-05 00:09:19,563: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:09:19,564: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000914\validation\model_epoch016\validation_results.p
2025-11-05 00:09:20,261: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\output.log initialized.
2025-11-05 00:09:20,262: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920
2025-11-05 00:09:20,262: ### Run configurations for testing_run
2025-11-05 00:09:20,264: experiment_name: testing_run
2025-11-05 00:09:20,265: train_basin_file: calpella
2025-11-05 00:09:20,265: validation_basin_file: calpella
2025-11-05 00:09:20,266: test_basin_file: calpella
2025-11-05 00:09:20,266: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:20,268: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:20,268: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:20,269: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:20,270: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:20,271: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:20,272: device: cuda:0
2025-11-05 00:09:20,273: physics_informed: False
2025-11-05 00:09:20,274: physics_data_file: None
2025-11-05 00:09:20,275: validate_every: 5
2025-11-05 00:09:20,275: validate_n_random_basins: 1
2025-11-05 00:09:20,276: metrics: ['NSE', 'MSE']
2025-11-05 00:09:20,277: model: cudalstm
2025-11-05 00:09:20,278: head: regression
2025-11-05 00:09:20,279: output_activation: linear
2025-11-05 00:09:20,279: hidden_size: 128
2025-11-05 00:09:20,280: initial_forget_bias: 3
2025-11-05 00:09:20,281: output_dropout: 0.4
2025-11-05 00:09:20,281: num_layers: 1
2025-11-05 00:09:20,282: dev_mode: True
2025-11-05 00:09:20,283: optimizer: Adam
2025-11-05 00:09:20,283: loss: NSE
2025-11-05 00:09:20,284: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:09:20,284: batch_size: 64
2025-11-05 00:09:20,285: epochs: 32
2025-11-05 00:09:20,286: clip_gradient_norm: 1
2025-11-05 00:09:20,287: predict_last_n: 1
2025-11-05 00:09:20,288: seq_length: 90
2025-11-05 00:09:20,289: log_interval: 16
2025-11-05 00:09:20,290: log_tensorboard: True
2025-11-05 00:09:20,291: log_n_figures: 1
2025-11-05 00:09:20,291: save_weights_every: 32
2025-11-05 00:09:20,292: early_stopping: True
2025-11-05 00:09:20,292: early_stopping_mode: patience
2025-11-05 00:09:20,293: patience_early_stopping: 3
2025-11-05 00:09:20,294: min_delta_early_stopping: 0.0
2025-11-05 00:09:20,295: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:20,295: early_stopping_slope_window: 7
2025-11-05 00:09:20,296: early_stopping_slope_patience: 2
2025-11-05 00:09:20,297: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:20,298: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:20,298: early_stopping_slope_use_log: True
2025-11-05 00:09:20,299: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:20,300: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:20,300: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:20,301: early_stopping_slope_variance_guard: True
2025-11-05 00:09:20,301: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:20,302: dataset: russian_river
2025-11-05 00:09:20,303: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:20,304: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:20,305: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:20,305: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:20,306: hourly: False
2025-11-05 00:09:20,306: is_mts: False
2025-11-05 00:09:20,307: is_mts_data: False
2025-11-05 00:09:20,308: verbose: True
2025-11-05 00:09:20,308: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920
2025-11-05 00:09:20,309: run_label: BASELINE
2025-11-05 00:09:20,310: number_of_basins: 1
2025-11-05 00:09:20,311: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\train_data
2025-11-05 00:09:20,312: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\img_log
2025-11-05 00:09:20,314: ### Device cuda:0 will be used for training
2025-11-05 00:09:20,315: Loading basin data into xarray data set.
2025-11-05 00:09:20,476: Calculating target variable stds per basin
2025-11-05 00:09:20,485: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:20,600: Early stopping enabled: mode=patience
2025-11-05 00:09:21,083: Epoch 1 average loss: avg_loss: 2.96e-06, avg_total_loss: 2.96e-06
2025-11-05 00:09:21,565: Epoch 2 average loss: avg_loss: 1.44e-06, avg_total_loss: 1.44e-06
2025-11-05 00:09:22,121: Epoch 3 average loss: avg_loss: 3.80e-06, avg_total_loss: 3.80e-06
2025-11-05 00:09:22,693: Epoch 4 average loss: avg_loss: 3.57e-06, avg_total_loss: 3.57e-06
2025-11-05 00:09:23,242: Epoch 5 average loss: avg_loss: 2.55e-06, avg_total_loss: 2.55e-06
2025-11-05 00:09:23,688: Epoch 5 average validation loss: 1.78e-06 -- Median validation metrics: avg_loss: 1.78e-06, NSE: 0.59295, MSE: 69733.46094
2025-11-05 00:09:24,097: Epoch 6 average loss: avg_loss: 2.16e-06, avg_total_loss: 2.16e-06
2025-11-05 00:09:24,526: Epoch 7 average loss: avg_loss: 1.76e-06, avg_total_loss: 1.76e-06
2025-11-05 00:09:24,964: Epoch 8 average loss: avg_loss: 1.75e-06, avg_total_loss: 1.75e-06
2025-11-05 00:09:25,476: Epoch 9 average loss: avg_loss: 1.43e-06, avg_total_loss: 1.43e-06
2025-11-05 00:09:25,908: Epoch 10 average loss: avg_loss: 1.37e-06, avg_total_loss: 1.37e-06
2025-11-05 00:09:26,185: Epoch 10 average validation loss: 1.39e-06 -- Median validation metrics: avg_loss: 1.39e-06, NSE: 0.68795, MSE: 53457.22656
2025-11-05 00:09:26,582: Epoch 11 average loss: avg_loss: 1.39e-06, avg_total_loss: 1.39e-06
2025-11-05 00:09:27,095: Epoch 12 average loss: avg_loss: 1.31e-06, avg_total_loss: 1.31e-06
2025-11-05 00:09:27,540: Epoch 13 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:09:28,015: Epoch 14 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:09:28,490: Epoch 15 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:09:28,786: Epoch 15 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76630, MSE: 40035.77734
2025-11-05 00:09:28,787: Setting learning rate to 0.005
2025-11-05 00:09:29,293: Epoch 16 average loss: avg_loss: 1.26e-06, avg_total_loss: 1.26e-06
2025-11-05 00:09:29,708: Epoch 17 average loss: avg_loss: 1.53e-06, avg_total_loss: 1.53e-06
2025-11-05 00:09:30,120: Epoch 18 average loss: avg_loss: 1.87e-06, avg_total_loss: 1.87e-06
2025-11-05 00:09:30,566: Epoch 19 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:09:31,009: Epoch 20 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:09:31,317: Epoch 20 average validation loss: 1.20e-06 -- Median validation metrics: avg_loss: 1.20e-06, NSE: 0.72437, MSE: 47218.81641
2025-11-05 00:09:31,794: Epoch 21 average loss: avg_loss: 9.87e-07, avg_total_loss: 9.87e-07
2025-11-05 00:09:32,233: Epoch 22 average loss: avg_loss: 9.60e-07, avg_total_loss: 9.60e-07
2025-11-05 00:09:32,636: Epoch 23 average loss: avg_loss: 9.15e-07, avg_total_loss: 9.15e-07
2025-11-05 00:09:32,637: Setting learning rate to 0.001
2025-11-05 00:09:33,042: Epoch 24 average loss: avg_loss: 8.43e-07, avg_total_loss: 8.43e-07
2025-11-05 00:09:33,424: Epoch 25 average loss: avg_loss: 9.47e-07, avg_total_loss: 9.47e-07
2025-11-05 00:09:33,749: Epoch 25 average validation loss: 1.29e-06 -- Median validation metrics: avg_loss: 1.29e-06, NSE: 0.70354, MSE: 50786.35938
2025-11-05 00:09:34,234: Epoch 26 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:09:34,618: Epoch 27 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:09:35,039: Epoch 28 average loss: avg_loss: 8.94e-07, avg_total_loss: 8.94e-07
2025-11-05 00:09:35,446: Epoch 29 average loss: avg_loss: 8.10e-07, avg_total_loss: 8.10e-07
2025-11-05 00:09:35,835: Epoch 30 average loss: avg_loss: 9.77e-07, avg_total_loss: 9.77e-07
2025-11-05 00:09:36,121: Epoch 30 average validation loss: 1.23e-06 -- Median validation metrics: avg_loss: 1.23e-06, NSE: 0.71898, MSE: 48141.90625
2025-11-05 00:09:36,122: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:09:36,124: Early stopping triggered at epoch 30
2025-11-05 00:09:36,140: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\model_epoch030.pt
2025-11-05 00:09:36,350: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:09:36,352: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000920\validation\model_epoch030\validation_results.p
2025-11-05 00:09:37,049: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\output.log initialized.
2025-11-05 00:09:37,050: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937
2025-11-05 00:09:37,051: ### Run configurations for testing_run
2025-11-05 00:09:37,051: experiment_name: testing_run
2025-11-05 00:09:37,052: train_basin_file: calpella
2025-11-05 00:09:37,053: validation_basin_file: calpella
2025-11-05 00:09:37,054: test_basin_file: calpella
2025-11-05 00:09:37,055: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:37,056: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:37,057: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:37,058: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:37,059: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:37,059: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:37,060: device: cuda:0
2025-11-05 00:09:37,061: physics_informed: False
2025-11-05 00:09:37,062: physics_data_file: None
2025-11-05 00:09:37,063: validate_every: 5
2025-11-05 00:09:37,063: validate_n_random_basins: 1
2025-11-05 00:09:37,064: metrics: ['NSE', 'MSE']
2025-11-05 00:09:37,065: model: cudalstm
2025-11-05 00:09:37,066: head: regression
2025-11-05 00:09:37,066: output_activation: linear
2025-11-05 00:09:37,067: hidden_size: 128
2025-11-05 00:09:37,068: initial_forget_bias: 3
2025-11-05 00:09:37,068: output_dropout: 0.4
2025-11-05 00:09:37,069: num_layers: 1
2025-11-05 00:09:37,070: dev_mode: True
2025-11-05 00:09:37,070: optimizer: Adam
2025-11-05 00:09:37,071: loss: NSE
2025-11-05 00:09:37,072: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:09:37,072: batch_size: 128
2025-11-05 00:09:37,073: epochs: 32
2025-11-05 00:09:37,074: clip_gradient_norm: 1
2025-11-05 00:09:37,075: predict_last_n: 1
2025-11-05 00:09:37,076: seq_length: 90
2025-11-05 00:09:37,077: log_interval: 16
2025-11-05 00:09:37,078: log_tensorboard: True
2025-11-05 00:09:37,078: log_n_figures: 1
2025-11-05 00:09:37,079: save_weights_every: 32
2025-11-05 00:09:37,080: early_stopping: True
2025-11-05 00:09:37,081: early_stopping_mode: patience
2025-11-05 00:09:37,081: patience_early_stopping: 3
2025-11-05 00:09:37,082: min_delta_early_stopping: 0.0
2025-11-05 00:09:37,083: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:37,083: early_stopping_slope_window: 7
2025-11-05 00:09:37,084: early_stopping_slope_patience: 2
2025-11-05 00:09:37,085: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:37,085: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:37,086: early_stopping_slope_use_log: True
2025-11-05 00:09:37,087: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:37,087: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:37,088: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:37,089: early_stopping_slope_variance_guard: True
2025-11-05 00:09:37,090: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:37,091: dataset: russian_river
2025-11-05 00:09:37,091: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:37,092: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:37,093: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:37,094: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:37,095: hourly: False
2025-11-05 00:09:37,096: is_mts: False
2025-11-05 00:09:37,096: is_mts_data: False
2025-11-05 00:09:37,097: verbose: True
2025-11-05 00:09:37,098: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937
2025-11-05 00:09:37,099: run_label: BASELINE
2025-11-05 00:09:37,099: number_of_basins: 1
2025-11-05 00:09:37,100: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\train_data
2025-11-05 00:09:37,101: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\img_log
2025-11-05 00:09:37,103: ### Device cuda:0 will be used for training
2025-11-05 00:09:37,104: Loading basin data into xarray data set.
2025-11-05 00:09:37,245: Calculating target variable stds per basin
2025-11-05 00:09:37,253: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:37,364: Early stopping enabled: mode=patience
2025-11-05 00:09:37,782: Epoch 1 average loss: avg_loss: 3.09e-06, avg_total_loss: 3.09e-06
2025-11-05 00:09:38,094: Epoch 2 average loss: avg_loss: 1.58e-06, avg_total_loss: 1.58e-06
2025-11-05 00:09:38,328: Epoch 3 average loss: avg_loss: 1.45e-06, avg_total_loss: 1.45e-06
2025-11-05 00:09:38,541: Epoch 4 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:09:38,788: Epoch 5 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:09:39,211: Epoch 5 average validation loss: 9.51e-07 -- Median validation metrics: avg_loss: 9.51e-07, NSE: 0.78126, MSE: 37473.29688
2025-11-05 00:09:39,408: Epoch 6 average loss: avg_loss: 9.22e-07, avg_total_loss: 9.22e-07
2025-11-05 00:09:39,645: Epoch 7 average loss: avg_loss: 9.08e-07, avg_total_loss: 9.08e-07
2025-11-05 00:09:39,922: Epoch 8 average loss: avg_loss: 9.02e-07, avg_total_loss: 9.02e-07
2025-11-05 00:09:40,167: Epoch 9 average loss: avg_loss: 8.13e-07, avg_total_loss: 8.13e-07
2025-11-05 00:09:40,426: Epoch 10 average loss: avg_loss: 8.99e-07, avg_total_loss: 8.99e-07
2025-11-05 00:09:40,771: Epoch 10 average validation loss: 8.61e-07 -- Median validation metrics: avg_loss: 8.61e-07, NSE: 0.80154, MSE: 33999.18359
2025-11-05 00:09:41,039: Epoch 11 average loss: avg_loss: 7.93e-07, avg_total_loss: 7.93e-07
2025-11-05 00:09:41,292: Epoch 12 average loss: avg_loss: 6.68e-07, avg_total_loss: 6.68e-07
2025-11-05 00:09:41,553: Epoch 13 average loss: avg_loss: 6.95e-07, avg_total_loss: 6.95e-07
2025-11-05 00:09:41,796: Epoch 14 average loss: avg_loss: 8.01e-07, avg_total_loss: 8.01e-07
2025-11-05 00:09:42,036: Epoch 15 average loss: avg_loss: 8.51e-07, avg_total_loss: 8.51e-07
2025-11-05 00:09:42,287: Epoch 15 average validation loss: 1.21e-06 -- Median validation metrics: avg_loss: 1.21e-06, NSE: 0.72528, MSE: 47063.05078
2025-11-05 00:09:42,288: Setting learning rate to 0.005
2025-11-05 00:09:42,511: Epoch 16 average loss: avg_loss: 6.48e-07, avg_total_loss: 6.48e-07
2025-11-05 00:09:42,712: Epoch 17 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:09:42,937: Epoch 18 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:09:43,163: Epoch 19 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:09:43,376: Epoch 20 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:09:43,610: Epoch 20 average validation loss: 8.99e-07 -- Median validation metrics: avg_loss: 8.99e-07, NSE: 0.79314, MSE: 35436.80859
2025-11-05 00:09:43,830: Epoch 21 average loss: avg_loss: 5.09e-07, avg_total_loss: 5.09e-07
2025-11-05 00:09:44,095: Epoch 22 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:09:44,314: Epoch 23 average loss: avg_loss: 5.29e-07, avg_total_loss: 5.29e-07
2025-11-05 00:09:44,315: Setting learning rate to 0.001
2025-11-05 00:09:44,543: Epoch 24 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:09:44,744: Epoch 25 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:09:45,008: Epoch 25 average validation loss: 9.23e-07 -- Median validation metrics: avg_loss: 9.23e-07, NSE: 0.78814, MSE: 36294.64844
2025-11-05 00:09:45,009: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:09:45,010: Early stopping triggered at epoch 25
2025-11-05 00:09:45,026: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\model_epoch025.pt
2025-11-05 00:09:45,210: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:09:45,212: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000937\validation\model_epoch025\validation_results.p
2025-11-05 00:09:45,973: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\output.log initialized.
2025-11-05 00:09:45,974: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945
2025-11-05 00:09:45,975: ### Run configurations for testing_run
2025-11-05 00:09:45,975: experiment_name: testing_run
2025-11-05 00:09:45,975: train_basin_file: calpella
2025-11-05 00:09:45,976: validation_basin_file: calpella
2025-11-05 00:09:45,977: test_basin_file: calpella
2025-11-05 00:09:45,978: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:45,978: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:45,979: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:45,980: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:45,980: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:45,981: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:45,981: device: cuda:0
2025-11-05 00:09:45,982: physics_informed: False
2025-11-05 00:09:45,982: physics_data_file: None
2025-11-05 00:09:45,983: validate_every: 5
2025-11-05 00:09:45,983: validate_n_random_basins: 1
2025-11-05 00:09:45,984: metrics: ['NSE', 'MSE']
2025-11-05 00:09:45,984: model: cudalstm
2025-11-05 00:09:45,985: head: regression
2025-11-05 00:09:45,985: output_activation: linear
2025-11-05 00:09:45,986: hidden_size: 128
2025-11-05 00:09:45,986: initial_forget_bias: 3
2025-11-05 00:09:45,987: output_dropout: 0.4
2025-11-05 00:09:45,987: num_layers: 1
2025-11-05 00:09:45,988: dev_mode: True
2025-11-05 00:09:45,988: optimizer: Adam
2025-11-05 00:09:45,989: loss: NSE
2025-11-05 00:09:45,989: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:09:45,990: batch_size: 256
2025-11-05 00:09:45,990: epochs: 32
2025-11-05 00:09:45,991: clip_gradient_norm: 1
2025-11-05 00:09:45,992: predict_last_n: 1
2025-11-05 00:09:45,993: seq_length: 90
2025-11-05 00:09:45,994: log_interval: 16
2025-11-05 00:09:45,995: log_tensorboard: True
2025-11-05 00:09:45,995: log_n_figures: 1
2025-11-05 00:09:45,997: save_weights_every: 32
2025-11-05 00:09:45,998: early_stopping: True
2025-11-05 00:09:46,000: early_stopping_mode: patience
2025-11-05 00:09:46,002: patience_early_stopping: 3
2025-11-05 00:09:46,003: min_delta_early_stopping: 0.0
2025-11-05 00:09:46,004: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:46,005: early_stopping_slope_window: 7
2025-11-05 00:09:46,006: early_stopping_slope_patience: 2
2025-11-05 00:09:46,007: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:46,007: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:46,008: early_stopping_slope_use_log: True
2025-11-05 00:09:46,009: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:46,010: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:46,012: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:46,014: early_stopping_slope_variance_guard: True
2025-11-05 00:09:46,014: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:46,015: dataset: russian_river
2025-11-05 00:09:46,017: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:46,018: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:46,019: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:46,021: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:46,021: hourly: False
2025-11-05 00:09:46,023: is_mts: False
2025-11-05 00:09:46,024: is_mts_data: False
2025-11-05 00:09:46,025: verbose: True
2025-11-05 00:09:46,026: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945
2025-11-05 00:09:46,028: run_label: BASELINE
2025-11-05 00:09:46,029: number_of_basins: 1
2025-11-05 00:09:46,030: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\train_data
2025-11-05 00:09:46,031: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\img_log
2025-11-05 00:09:46,034: ### Device cuda:0 will be used for training
2025-11-05 00:09:46,036: Loading basin data into xarray data set.
2025-11-05 00:09:46,187: Calculating target variable stds per basin
2025-11-05 00:09:46,195: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:46,308: Early stopping enabled: mode=patience
2025-11-05 00:09:46,621: Epoch 1 average loss: avg_loss: 3.82e-06, avg_total_loss: 3.82e-06
2025-11-05 00:09:46,939: Epoch 2 average loss: avg_loss: 2.61e-06, avg_total_loss: 2.61e-06
2025-11-05 00:09:47,123: Epoch 3 average loss: avg_loss: 1.87e-06, avg_total_loss: 1.87e-06
2025-11-05 00:09:47,259: Epoch 4 average loss: avg_loss: 1.49e-06, avg_total_loss: 1.49e-06
2025-11-05 00:09:47,400: Epoch 5 average loss: avg_loss: 1.37e-06, avg_total_loss: 1.37e-06
2025-11-05 00:09:47,818: Epoch 5 average validation loss: 1.08e-06 -- Median validation metrics: avg_loss: 1.08e-06, NSE: 0.73333, MSE: 45683.31641
2025-11-05 00:09:47,954: Epoch 6 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:09:48,093: Epoch 7 average loss: avg_loss: 9.79e-07, avg_total_loss: 9.79e-07
2025-11-05 00:09:48,236: Epoch 8 average loss: avg_loss: 9.18e-07, avg_total_loss: 9.18e-07
2025-11-05 00:09:48,373: Epoch 9 average loss: avg_loss: 9.43e-07, avg_total_loss: 9.43e-07
2025-11-05 00:09:48,518: Epoch 10 average loss: avg_loss: 9.27e-07, avg_total_loss: 9.27e-07
2025-11-05 00:09:48,813: Epoch 10 average validation loss: 8.95e-07 -- Median validation metrics: avg_loss: 8.95e-07, NSE: 0.78052, MSE: 37600.46094
2025-11-05 00:09:48,956: Epoch 11 average loss: avg_loss: 7.92e-07, avg_total_loss: 7.92e-07
2025-11-05 00:09:49,099: Epoch 12 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:09:49,265: Epoch 13 average loss: avg_loss: 8.43e-07, avg_total_loss: 8.43e-07
2025-11-05 00:09:49,417: Epoch 14 average loss: avg_loss: 7.29e-07, avg_total_loss: 7.29e-07
2025-11-05 00:09:49,569: Epoch 15 average loss: avg_loss: 7.24e-07, avg_total_loss: 7.24e-07
2025-11-05 00:09:49,860: Epoch 15 average validation loss: 9.09e-07 -- Median validation metrics: avg_loss: 9.09e-07, NSE: 0.77508, MSE: 38531.91406
2025-11-05 00:09:49,860: Setting learning rate to 0.005
2025-11-05 00:09:50,008: Epoch 16 average loss: avg_loss: 7.02e-07, avg_total_loss: 7.02e-07
2025-11-05 00:09:50,151: Epoch 17 average loss: avg_loss: 7.03e-07, avg_total_loss: 7.03e-07
2025-11-05 00:09:50,313: Epoch 18 average loss: avg_loss: 6.02e-07, avg_total_loss: 6.02e-07
2025-11-05 00:09:50,467: Epoch 19 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:09:50,612: Epoch 20 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:09:50,891: Epoch 20 average validation loss: 9.53e-07 -- Median validation metrics: avg_loss: 9.53e-07, NSE: 0.75932, MSE: 41231.67969
2025-11-05 00:09:51,038: Epoch 21 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:09:51,188: Epoch 22 average loss: avg_loss: 6.47e-07, avg_total_loss: 6.47e-07
2025-11-05 00:09:51,360: Epoch 23 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:09:51,361: Setting learning rate to 0.001
2025-11-05 00:09:51,525: Epoch 24 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:09:51,680: Epoch 25 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:09:51,969: Epoch 25 average validation loss: 8.78e-07 -- Median validation metrics: avg_loss: 8.78e-07, NSE: 0.77775, MSE: 38073.83203
2025-11-05 00:09:52,117: Epoch 26 average loss: avg_loss: 6.10e-07, avg_total_loss: 6.10e-07
2025-11-05 00:09:52,264: Epoch 27 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:09:52,436: Epoch 28 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:09:52,594: Epoch 29 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:09:52,747: Epoch 30 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:09:53,070: Epoch 30 average validation loss: 8.66e-07 -- Median validation metrics: avg_loss: 8.66e-07, NSE: 0.78019, MSE: 37655.55469
2025-11-05 00:09:53,219: Epoch 31 average loss: avg_loss: 6.15e-07, avg_total_loss: 6.15e-07
2025-11-05 00:09:53,361: Epoch 32 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:09:53,379: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\model_epoch032.pt
2025-11-05 00:09:53,564: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:09:53,566: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000945\validation\model_epoch032\validation_results.p
2025-11-05 00:09:54,398: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\output.log initialized.
2025-11-05 00:09:54,399: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954
2025-11-05 00:09:54,400: ### Run configurations for testing_run
2025-11-05 00:09:54,401: experiment_name: testing_run
2025-11-05 00:09:54,402: train_basin_file: calpella
2025-11-05 00:09:54,403: validation_basin_file: calpella
2025-11-05 00:09:54,404: test_basin_file: calpella
2025-11-05 00:09:54,405: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:09:54,406: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:09:54,407: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:09:54,407: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:09:54,408: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:09:54,409: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:09:54,410: device: cuda:0
2025-11-05 00:09:54,411: physics_informed: False
2025-11-05 00:09:54,412: physics_data_file: None
2025-11-05 00:09:54,412: validate_every: 5
2025-11-05 00:09:54,413: validate_n_random_basins: 1
2025-11-05 00:09:54,414: metrics: ['NSE', 'MSE']
2025-11-05 00:09:54,415: model: cudalstm
2025-11-05 00:09:54,416: head: regression
2025-11-05 00:09:54,417: output_activation: linear
2025-11-05 00:09:54,418: hidden_size: 128
2025-11-05 00:09:54,418: initial_forget_bias: 3
2025-11-05 00:09:54,419: output_dropout: 0.4
2025-11-05 00:09:54,420: num_layers: 1
2025-11-05 00:09:54,420: dev_mode: True
2025-11-05 00:09:54,421: optimizer: Adam
2025-11-05 00:09:54,422: loss: NSE
2025-11-05 00:09:54,423: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:09:54,424: batch_size: 64
2025-11-05 00:09:54,425: epochs: 48
2025-11-05 00:09:54,425: clip_gradient_norm: 1
2025-11-05 00:09:54,426: predict_last_n: 1
2025-11-05 00:09:54,427: seq_length: 90
2025-11-05 00:09:54,427: log_interval: 16
2025-11-05 00:09:54,428: log_tensorboard: True
2025-11-05 00:09:54,429: log_n_figures: 1
2025-11-05 00:09:54,430: save_weights_every: 48
2025-11-05 00:09:54,430: early_stopping: True
2025-11-05 00:09:54,431: early_stopping_mode: patience
2025-11-05 00:09:54,432: patience_early_stopping: 3
2025-11-05 00:09:54,433: min_delta_early_stopping: 0.0
2025-11-05 00:09:54,433: minimum_epochs_before_early_stopping: 10
2025-11-05 00:09:54,434: early_stopping_slope_window: 7
2025-11-05 00:09:54,434: early_stopping_slope_patience: 2
2025-11-05 00:09:54,435: early_stopping_slope_min_epoch: 8
2025-11-05 00:09:54,436: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:09:54,437: early_stopping_slope_use_log: True
2025-11-05 00:09:54,438: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:09:54,439: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:09:54,439: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:09:54,440: early_stopping_slope_variance_guard: True
2025-11-05 00:09:54,441: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:09:54,442: dataset: russian_river
2025-11-05 00:09:54,443: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:09:54,443: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:09:54,444: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:09:54,445: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:09:54,445: hourly: False
2025-11-05 00:09:54,448: is_mts: False
2025-11-05 00:09:54,449: is_mts_data: False
2025-11-05 00:09:54,451: verbose: True
2025-11-05 00:09:54,453: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954
2025-11-05 00:09:54,454: run_label: BASELINE
2025-11-05 00:09:54,455: number_of_basins: 1
2025-11-05 00:09:54,456: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\train_data
2025-11-05 00:09:54,457: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\img_log
2025-11-05 00:09:54,461: ### Device cuda:0 will be used for training
2025-11-05 00:09:54,463: Loading basin data into xarray data set.
2025-11-05 00:09:54,632: Calculating target variable stds per basin
2025-11-05 00:09:54,641: Create lookup table and convert to pytorch tensor
2025-11-05 00:09:54,767: Early stopping enabled: mode=patience
2025-11-05 00:09:55,223: Epoch 1 average loss: avg_loss: 2.88e-06, avg_total_loss: 2.88e-06
2025-11-05 00:09:55,771: Epoch 2 average loss: avg_loss: 1.69e-06, avg_total_loss: 1.69e-06
2025-11-05 00:09:56,343: Epoch 3 average loss: avg_loss: 1.33e-06, avg_total_loss: 1.33e-06
2025-11-05 00:09:56,836: Epoch 4 average loss: avg_loss: 1.22e-06, avg_total_loss: 1.22e-06
2025-11-05 00:09:57,304: Epoch 5 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:09:57,706: Epoch 5 average validation loss: 1.13e-06 -- Median validation metrics: avg_loss: 1.13e-06, NSE: 0.74002, MSE: 44536.97266
2025-11-05 00:09:58,106: Epoch 6 average loss: avg_loss: 9.42e-07, avg_total_loss: 9.42e-07
2025-11-05 00:09:58,601: Epoch 7 average loss: avg_loss: 8.99e-07, avg_total_loss: 8.99e-07
2025-11-05 00:09:59,239: Epoch 8 average loss: avg_loss: 9.73e-07, avg_total_loss: 9.73e-07
2025-11-05 00:09:59,806: Epoch 9 average loss: avg_loss: 8.77e-07, avg_total_loss: 8.77e-07
2025-11-05 00:10:00,291: Epoch 10 average loss: avg_loss: 7.79e-07, avg_total_loss: 7.79e-07
2025-11-05 00:10:00,605: Epoch 10 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76393, MSE: 40442.39453
2025-11-05 00:10:01,020: Epoch 11 average loss: avg_loss: 9.60e-07, avg_total_loss: 9.60e-07
2025-11-05 00:10:01,443: Epoch 12 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:10:01,846: Epoch 13 average loss: avg_loss: 9.66e-07, avg_total_loss: 9.66e-07
2025-11-05 00:10:02,253: Epoch 14 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:10:02,677: Epoch 15 average loss: avg_loss: 8.57e-07, avg_total_loss: 8.57e-07
2025-11-05 00:10:02,949: Epoch 15 average validation loss: 1.05e-06 -- Median validation metrics: avg_loss: 1.05e-06, NSE: 0.75748, MSE: 41546.36328
2025-11-05 00:10:03,388: Epoch 16 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:10:03,808: Epoch 17 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:10:04,313: Epoch 18 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:10:04,833: Epoch 19 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:10:05,273: Epoch 20 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:10:05,562: Epoch 20 average validation loss: 1.13e-06 -- Median validation metrics: avg_loss: 1.13e-06, NSE: 0.74075, MSE: 44412.30859
2025-11-05 00:10:05,981: Epoch 21 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:10:06,462: Epoch 22 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:10:06,898: Epoch 23 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:10:06,898: Setting learning rate to 0.005
2025-11-05 00:10:07,462: Epoch 24 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:10:07,854: Epoch 25 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:10:08,137: Epoch 25 average validation loss: 1.08e-06 -- Median validation metrics: avg_loss: 1.08e-06, NSE: 0.75103, MSE: 42651.60547
2025-11-05 00:10:08,139: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:10:08,139: Early stopping triggered at epoch 25
2025-11-05 00:10:08,155: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\model_epoch025.pt
2025-11-05 00:10:08,350: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:10:08,352: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_000954\validation\model_epoch025\validation_results.p
2025-11-05 00:10:08,996: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\output.log initialized.
2025-11-05 00:10:08,997: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008
2025-11-05 00:10:08,997: ### Run configurations for testing_run
2025-11-05 00:10:08,998: experiment_name: testing_run
2025-11-05 00:10:08,999: train_basin_file: calpella
2025-11-05 00:10:08,999: validation_basin_file: calpella
2025-11-05 00:10:09,000: test_basin_file: calpella
2025-11-05 00:10:09,001: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:09,001: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:09,002: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:09,002: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:09,002: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:09,004: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:09,004: device: cuda:0
2025-11-05 00:10:09,005: physics_informed: False
2025-11-05 00:10:09,005: physics_data_file: None
2025-11-05 00:10:09,006: validate_every: 5
2025-11-05 00:10:09,006: validate_n_random_basins: 1
2025-11-05 00:10:09,007: metrics: ['NSE', 'MSE']
2025-11-05 00:10:09,007: model: cudalstm
2025-11-05 00:10:09,008: head: regression
2025-11-05 00:10:09,009: output_activation: linear
2025-11-05 00:10:09,009: hidden_size: 128
2025-11-05 00:10:09,010: initial_forget_bias: 3
2025-11-05 00:10:09,010: output_dropout: 0.4
2025-11-05 00:10:09,011: num_layers: 1
2025-11-05 00:10:09,011: dev_mode: True
2025-11-05 00:10:09,012: optimizer: Adam
2025-11-05 00:10:09,012: loss: NSE
2025-11-05 00:10:09,013: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:10:09,014: batch_size: 128
2025-11-05 00:10:09,014: epochs: 48
2025-11-05 00:10:09,015: clip_gradient_norm: 1
2025-11-05 00:10:09,016: predict_last_n: 1
2025-11-05 00:10:09,017: seq_length: 90
2025-11-05 00:10:09,018: log_interval: 16
2025-11-05 00:10:09,019: log_tensorboard: True
2025-11-05 00:10:09,019: log_n_figures: 1
2025-11-05 00:10:09,020: save_weights_every: 48
2025-11-05 00:10:09,021: early_stopping: True
2025-11-05 00:10:09,021: early_stopping_mode: patience
2025-11-05 00:10:09,022: patience_early_stopping: 3
2025-11-05 00:10:09,023: min_delta_early_stopping: 0.0
2025-11-05 00:10:09,024: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:09,025: early_stopping_slope_window: 7
2025-11-05 00:10:09,025: early_stopping_slope_patience: 2
2025-11-05 00:10:09,026: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:09,026: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:09,027: early_stopping_slope_use_log: True
2025-11-05 00:10:09,027: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:09,028: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:09,029: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:09,029: early_stopping_slope_variance_guard: True
2025-11-05 00:10:09,030: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:09,031: dataset: russian_river
2025-11-05 00:10:09,031: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:09,032: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:09,033: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:09,033: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:09,034: hourly: False
2025-11-05 00:10:09,034: is_mts: False
2025-11-05 00:10:09,035: is_mts_data: False
2025-11-05 00:10:09,036: verbose: True
2025-11-05 00:10:09,036: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008
2025-11-05 00:10:09,038: run_label: BASELINE
2025-11-05 00:10:09,039: number_of_basins: 1
2025-11-05 00:10:09,041: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\train_data
2025-11-05 00:10:09,042: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\img_log
2025-11-05 00:10:09,045: ### Device cuda:0 will be used for training
2025-11-05 00:10:09,046: Loading basin data into xarray data set.
2025-11-05 00:10:09,218: Calculating target variable stds per basin
2025-11-05 00:10:09,227: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:09,347: Early stopping enabled: mode=patience
2025-11-05 00:10:09,742: Epoch 1 average loss: avg_loss: 3.28e-06, avg_total_loss: 3.28e-06
2025-11-05 00:10:10,065: Epoch 2 average loss: avg_loss: 1.86e-06, avg_total_loss: 1.86e-06
2025-11-05 00:10:10,296: Epoch 3 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:10:10,548: Epoch 4 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:10:10,795: Epoch 5 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:10:11,199: Epoch 5 average validation loss: 1.53e-06 -- Median validation metrics: avg_loss: 1.53e-06, NSE: 0.65114, MSE: 59764.45312
2025-11-05 00:10:11,383: Epoch 6 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:10:11,636: Epoch 7 average loss: avg_loss: 9.35e-07, avg_total_loss: 9.35e-07
2025-11-05 00:10:11,873: Epoch 8 average loss: avg_loss: 7.96e-07, avg_total_loss: 7.96e-07
2025-11-05 00:10:12,156: Epoch 9 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:10:12,403: Epoch 10 average loss: avg_loss: 9.96e-07, avg_total_loss: 9.96e-07
2025-11-05 00:10:12,706: Epoch 10 average validation loss: 1.33e-06 -- Median validation metrics: avg_loss: 1.33e-06, NSE: 0.69846, MSE: 51656.85547
2025-11-05 00:10:12,922: Epoch 11 average loss: avg_loss: 8.04e-07, avg_total_loss: 8.04e-07
2025-11-05 00:10:13,191: Epoch 12 average loss: avg_loss: 8.03e-07, avg_total_loss: 8.03e-07
2025-11-05 00:10:13,458: Epoch 13 average loss: avg_loss: 6.81e-07, avg_total_loss: 6.81e-07
2025-11-05 00:10:13,726: Epoch 14 average loss: avg_loss: 7.14e-07, avg_total_loss: 7.14e-07
2025-11-05 00:10:14,008: Epoch 15 average loss: avg_loss: 6.35e-07, avg_total_loss: 6.35e-07
2025-11-05 00:10:14,296: Epoch 15 average validation loss: 1.14e-06 -- Median validation metrics: avg_loss: 1.14e-06, NSE: 0.73891, MSE: 44727.11719
2025-11-05 00:10:14,536: Epoch 16 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:10:14,821: Epoch 17 average loss: avg_loss: 6.91e-07, avg_total_loss: 6.91e-07
2025-11-05 00:10:15,083: Epoch 18 average loss: avg_loss: 7.40e-07, avg_total_loss: 7.40e-07
2025-11-05 00:10:15,339: Epoch 19 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:10:15,618: Epoch 20 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:10:16,043: Epoch 20 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.75500, MSE: 41970.66016
2025-11-05 00:10:16,320: Epoch 21 average loss: avg_loss: 6.06e-07, avg_total_loss: 6.06e-07
2025-11-05 00:10:16,635: Epoch 22 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:10:16,944: Epoch 23 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:10:16,945: Setting learning rate to 0.005
2025-11-05 00:10:17,220: Epoch 24 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:10:17,500: Epoch 25 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:10:17,766: Epoch 25 average validation loss: 9.63e-07 -- Median validation metrics: avg_loss: 9.63e-07, NSE: 0.77851, MSE: 37944.41016
2025-11-05 00:10:18,027: Epoch 26 average loss: avg_loss: 5.24e-07, avg_total_loss: 5.24e-07
2025-11-05 00:10:18,316: Epoch 27 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:10:18,577: Epoch 28 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:10:18,853: Epoch 29 average loss: avg_loss: 4.72e-07, avg_total_loss: 4.72e-07
2025-11-05 00:10:19,102: Epoch 30 average loss: avg_loss: 5.12e-07, avg_total_loss: 5.12e-07
2025-11-05 00:10:19,363: Epoch 30 average validation loss: 9.55e-07 -- Median validation metrics: avg_loss: 9.55e-07, NSE: 0.77988, MSE: 37709.41406
2025-11-05 00:10:19,645: Epoch 31 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:10:19,947: Epoch 32 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:10:20,222: Epoch 33 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:10:20,509: Epoch 34 average loss: avg_loss: 3.94e-07, avg_total_loss: 3.94e-07
2025-11-05 00:10:20,778: Epoch 35 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:10:21,061: Epoch 35 average validation loss: 9.48e-07 -- Median validation metrics: avg_loss: 9.48e-07, NSE: 0.78158, MSE: 37417.30078
2025-11-05 00:10:21,062: Setting learning rate to 0.001
2025-11-05 00:10:21,318: Epoch 36 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:10:21,610: Epoch 37 average loss: avg_loss: 4.23e-07, avg_total_loss: 4.23e-07
2025-11-05 00:10:21,847: Epoch 38 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:10:22,108: Epoch 39 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:10:22,390: Epoch 40 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:10:22,698: Epoch 40 average validation loss: 9.61e-07 -- Median validation metrics: avg_loss: 9.61e-07, NSE: 0.77894, MSE: 37870.98438
2025-11-05 00:10:22,986: Epoch 41 average loss: avg_loss: 3.80e-07, avg_total_loss: 3.80e-07
2025-11-05 00:10:23,265: Epoch 42 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:10:23,567: Epoch 43 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:10:23,845: Epoch 44 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:10:24,121: Epoch 45 average loss: avg_loss: 4.03e-07, avg_total_loss: 4.03e-07
2025-11-05 00:10:24,428: Epoch 45 average validation loss: 9.75e-07 -- Median validation metrics: avg_loss: 9.75e-07, NSE: 0.77581, MSE: 38406.78125
2025-11-05 00:10:24,707: Epoch 46 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:10:24,994: Epoch 47 average loss: avg_loss: 3.94e-07, avg_total_loss: 3.94e-07
2025-11-05 00:10:25,314: Epoch 48 average loss: avg_loss: 3.56e-07, avg_total_loss: 3.56e-07
2025-11-05 00:10:25,338: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\model_epoch048.pt
2025-11-05 00:10:25,586: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\validation\model_epoch048\validation_metrics.csv
2025-11-05 00:10:25,588: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001008\validation\model_epoch048\validation_results.p
2025-11-05 00:10:26,324: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\output.log initialized.
2025-11-05 00:10:26,326: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026
2025-11-05 00:10:26,326: ### Run configurations for testing_run
2025-11-05 00:10:26,327: experiment_name: testing_run
2025-11-05 00:10:26,328: train_basin_file: calpella
2025-11-05 00:10:26,328: validation_basin_file: calpella
2025-11-05 00:10:26,329: test_basin_file: calpella
2025-11-05 00:10:26,330: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:26,331: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:26,332: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:26,333: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:26,334: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:26,334: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:26,335: device: cuda:0
2025-11-05 00:10:26,336: physics_informed: False
2025-11-05 00:10:26,337: physics_data_file: None
2025-11-05 00:10:26,338: validate_every: 5
2025-11-05 00:10:26,338: validate_n_random_basins: 1
2025-11-05 00:10:26,339: metrics: ['NSE', 'MSE']
2025-11-05 00:10:26,340: model: cudalstm
2025-11-05 00:10:26,340: head: regression
2025-11-05 00:10:26,341: output_activation: linear
2025-11-05 00:10:26,341: hidden_size: 128
2025-11-05 00:10:26,342: initial_forget_bias: 3
2025-11-05 00:10:26,343: output_dropout: 0.4
2025-11-05 00:10:26,344: num_layers: 1
2025-11-05 00:10:26,345: dev_mode: True
2025-11-05 00:10:26,345: optimizer: Adam
2025-11-05 00:10:26,346: loss: NSE
2025-11-05 00:10:26,347: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:10:26,348: batch_size: 256
2025-11-05 00:10:26,348: epochs: 48
2025-11-05 00:10:26,349: clip_gradient_norm: 1
2025-11-05 00:10:26,350: predict_last_n: 1
2025-11-05 00:10:26,351: seq_length: 90
2025-11-05 00:10:26,352: log_interval: 16
2025-11-05 00:10:26,352: log_tensorboard: True
2025-11-05 00:10:26,353: log_n_figures: 1
2025-11-05 00:10:26,354: save_weights_every: 48
2025-11-05 00:10:26,355: early_stopping: True
2025-11-05 00:10:26,355: early_stopping_mode: patience
2025-11-05 00:10:26,356: patience_early_stopping: 3
2025-11-05 00:10:26,357: min_delta_early_stopping: 0.0
2025-11-05 00:10:26,358: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:26,359: early_stopping_slope_window: 7
2025-11-05 00:10:26,360: early_stopping_slope_patience: 2
2025-11-05 00:10:26,361: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:26,362: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:26,362: early_stopping_slope_use_log: True
2025-11-05 00:10:26,363: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:26,364: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:26,365: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:26,366: early_stopping_slope_variance_guard: True
2025-11-05 00:10:26,367: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:26,368: dataset: russian_river
2025-11-05 00:10:26,370: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:26,372: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:26,372: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:26,374: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:26,375: hourly: False
2025-11-05 00:10:26,376: is_mts: False
2025-11-05 00:10:26,377: is_mts_data: False
2025-11-05 00:10:26,378: verbose: True
2025-11-05 00:10:26,379: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026
2025-11-05 00:10:26,382: run_label: BASELINE
2025-11-05 00:10:26,383: number_of_basins: 1
2025-11-05 00:10:26,385: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\train_data
2025-11-05 00:10:26,385: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\img_log
2025-11-05 00:10:26,389: ### Device cuda:0 will be used for training
2025-11-05 00:10:26,391: Loading basin data into xarray data set.
2025-11-05 00:10:26,550: Calculating target variable stds per basin
2025-11-05 00:10:26,559: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:26,671: Early stopping enabled: mode=patience
2025-11-05 00:10:26,987: Epoch 1 average loss: avg_loss: 3.72e-06, avg_total_loss: 3.72e-06
2025-11-05 00:10:27,140: Epoch 2 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:10:27,326: Epoch 3 average loss: avg_loss: 1.75e-06, avg_total_loss: 1.75e-06
2025-11-05 00:10:27,491: Epoch 4 average loss: avg_loss: 1.46e-06, avg_total_loss: 1.46e-06
2025-11-05 00:10:27,677: Epoch 5 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:10:28,131: Epoch 5 average validation loss: 9.87e-07 -- Median validation metrics: avg_loss: 9.87e-07, NSE: 0.74799, MSE: 43173.13672
2025-11-05 00:10:28,282: Epoch 6 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:10:28,435: Epoch 7 average loss: avg_loss: 9.84e-07, avg_total_loss: 9.84e-07
2025-11-05 00:10:28,607: Epoch 8 average loss: avg_loss: 8.94e-07, avg_total_loss: 8.94e-07
2025-11-05 00:10:28,765: Epoch 9 average loss: avg_loss: 8.25e-07, avg_total_loss: 8.25e-07
2025-11-05 00:10:28,923: Epoch 10 average loss: avg_loss: 8.72e-07, avg_total_loss: 8.72e-07
2025-11-05 00:10:29,177: Epoch 10 average validation loss: 9.14e-07 -- Median validation metrics: avg_loss: 9.14e-07, NSE: 0.76658, MSE: 39988.42969
2025-11-05 00:10:29,339: Epoch 11 average loss: avg_loss: 9.77e-07, avg_total_loss: 9.77e-07
2025-11-05 00:10:29,495: Epoch 12 average loss: avg_loss: 8.96e-07, avg_total_loss: 8.96e-07
2025-11-05 00:10:29,644: Epoch 13 average loss: avg_loss: 7.69e-07, avg_total_loss: 7.69e-07
2025-11-05 00:10:29,816: Epoch 14 average loss: avg_loss: 7.50e-07, avg_total_loss: 7.50e-07
2025-11-05 00:10:29,971: Epoch 15 average loss: avg_loss: 7.03e-07, avg_total_loss: 7.03e-07
2025-11-05 00:10:30,224: Epoch 15 average validation loss: 9.51e-07 -- Median validation metrics: avg_loss: 9.51e-07, NSE: 0.75788, MSE: 41478.22656
2025-11-05 00:10:30,387: Epoch 16 average loss: avg_loss: 6.34e-07, avg_total_loss: 6.34e-07
2025-11-05 00:10:30,538: Epoch 17 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:10:30,686: Epoch 18 average loss: avg_loss: 6.02e-07, avg_total_loss: 6.02e-07
2025-11-05 00:10:30,852: Epoch 19 average loss: avg_loss: 6.33e-07, avg_total_loss: 6.33e-07
2025-11-05 00:10:31,005: Epoch 20 average loss: avg_loss: 7.32e-07, avg_total_loss: 7.32e-07
2025-11-05 00:10:31,257: Epoch 20 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.73613, MSE: 45203.48828
2025-11-05 00:10:31,410: Epoch 21 average loss: avg_loss: 6.85e-07, avg_total_loss: 6.85e-07
2025-11-05 00:10:31,578: Epoch 22 average loss: avg_loss: 7.21e-07, avg_total_loss: 7.21e-07
2025-11-05 00:10:31,742: Epoch 23 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:10:31,743: Setting learning rate to 0.005
2025-11-05 00:10:31,896: Epoch 24 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:10:32,066: Epoch 25 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:10:32,339: Epoch 25 average validation loss: 8.54e-07 -- Median validation metrics: avg_loss: 8.54e-07, NSE: 0.78179, MSE: 37382.76172
2025-11-05 00:10:32,486: Epoch 26 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:10:32,633: Epoch 27 average loss: avg_loss: 6.76e-07, avg_total_loss: 6.76e-07
2025-11-05 00:10:32,799: Epoch 28 average loss: avg_loss: 5.79e-07, avg_total_loss: 5.79e-07
2025-11-05 00:10:32,948: Epoch 29 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:10:33,096: Epoch 30 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:10:33,356: Epoch 30 average validation loss: 8.90e-07 -- Median validation metrics: avg_loss: 8.90e-07, NSE: 0.77288, MSE: 38909.29297
2025-11-05 00:10:33,500: Epoch 31 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:10:33,646: Epoch 32 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:10:33,811: Epoch 33 average loss: avg_loss: 5.00e-07, avg_total_loss: 5.00e-07
2025-11-05 00:10:33,952: Epoch 34 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:10:34,089: Epoch 35 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:10:34,378: Epoch 35 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.74305, MSE: 44019.26172
2025-11-05 00:10:34,379: Setting learning rate to 0.001
2025-11-05 00:10:34,520: Epoch 36 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:10:34,661: Epoch 37 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:10:34,825: Epoch 38 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:10:34,973: Epoch 39 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:10:35,113: Epoch 40 average loss: avg_loss: 4.36e-07, avg_total_loss: 4.36e-07
2025-11-05 00:10:35,377: Epoch 40 average validation loss: 1.05e-06 -- Median validation metrics: avg_loss: 1.05e-06, NSE: 0.73404, MSE: 45562.77734
2025-11-05 00:10:35,377: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:10:35,378: Early stopping triggered at epoch 40
2025-11-05 00:10:35,393: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\model_epoch040.pt
2025-11-05 00:10:35,562: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:10:35,564: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001026\validation\model_epoch040\validation_results.p
2025-11-05 00:10:36,255: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\output.log initialized.
2025-11-05 00:10:36,256: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036
2025-11-05 00:10:36,257: ### Run configurations for testing_run
2025-11-05 00:10:36,258: experiment_name: testing_run
2025-11-05 00:10:36,258: train_basin_file: calpella
2025-11-05 00:10:36,259: validation_basin_file: calpella
2025-11-05 00:10:36,260: test_basin_file: calpella
2025-11-05 00:10:36,260: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:36,261: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:36,262: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:36,262: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:36,263: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:36,263: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:36,264: device: cuda:0
2025-11-05 00:10:36,265: physics_informed: False
2025-11-05 00:10:36,266: physics_data_file: None
2025-11-05 00:10:36,267: validate_every: 5
2025-11-05 00:10:36,267: validate_n_random_basins: 1
2025-11-05 00:10:36,268: metrics: ['NSE', 'MSE']
2025-11-05 00:10:36,269: model: cudalstm
2025-11-05 00:10:36,269: head: regression
2025-11-05 00:10:36,270: output_activation: linear
2025-11-05 00:10:36,271: hidden_size: 128
2025-11-05 00:10:36,271: initial_forget_bias: 3
2025-11-05 00:10:36,272: output_dropout: 0.4
2025-11-05 00:10:36,272: num_layers: 1
2025-11-05 00:10:36,275: dev_mode: True
2025-11-05 00:10:36,276: optimizer: Adam
2025-11-05 00:10:36,277: loss: NSE
2025-11-05 00:10:36,279: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:10:36,280: batch_size: 64
2025-11-05 00:10:36,281: epochs: 16
2025-11-05 00:10:36,283: clip_gradient_norm: 1
2025-11-05 00:10:36,284: predict_last_n: 1
2025-11-05 00:10:36,285: seq_length: 120
2025-11-05 00:10:36,286: log_interval: 16
2025-11-05 00:10:36,287: log_tensorboard: True
2025-11-05 00:10:36,288: log_n_figures: 1
2025-11-05 00:10:36,289: save_weights_every: 16
2025-11-05 00:10:36,290: early_stopping: True
2025-11-05 00:10:36,291: early_stopping_mode: patience
2025-11-05 00:10:36,293: patience_early_stopping: 3
2025-11-05 00:10:36,293: min_delta_early_stopping: 0.0
2025-11-05 00:10:36,294: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:36,295: early_stopping_slope_window: 7
2025-11-05 00:10:36,296: early_stopping_slope_patience: 2
2025-11-05 00:10:36,297: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:36,298: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:36,299: early_stopping_slope_use_log: True
2025-11-05 00:10:36,300: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:36,302: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:36,303: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:36,304: early_stopping_slope_variance_guard: True
2025-11-05 00:10:36,305: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:36,306: dataset: russian_river
2025-11-05 00:10:36,307: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:36,308: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:36,310: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:36,311: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:36,312: hourly: False
2025-11-05 00:10:36,313: is_mts: False
2025-11-05 00:10:36,314: is_mts_data: False
2025-11-05 00:10:36,315: verbose: True
2025-11-05 00:10:36,316: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036
2025-11-05 00:10:36,317: run_label: BASELINE
2025-11-05 00:10:36,318: number_of_basins: 1
2025-11-05 00:10:36,318: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\train_data
2025-11-05 00:10:36,319: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\img_log
2025-11-05 00:10:36,322: ### Device cuda:0 will be used for training
2025-11-05 00:10:36,323: Loading basin data into xarray data set.
2025-11-05 00:10:36,488: Calculating target variable stds per basin
2025-11-05 00:10:36,496: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:36,767: Early stopping enabled: mode=patience
2025-11-05 00:10:37,291: Epoch 1 average loss: avg_loss: 2.54e-06, avg_total_loss: 2.54e-06
2025-11-05 00:10:37,783: Epoch 2 average loss: avg_loss: 1.33e-06, avg_total_loss: 1.33e-06
2025-11-05 00:10:38,278: Epoch 3 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:10:38,774: Epoch 4 average loss: avg_loss: 2.51e-06, avg_total_loss: 2.51e-06
2025-11-05 00:10:39,258: Epoch 5 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:10:39,730: Epoch 5 average validation loss: 1.63e-06 -- Median validation metrics: avg_loss: 1.63e-06, NSE: 0.63086, MSE: 63238.72266
2025-11-05 00:10:40,279: Epoch 6 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:10:40,716: Epoch 7 average loss: avg_loss: 9.64e-07, avg_total_loss: 9.64e-07
2025-11-05 00:10:40,716: Setting learning rate to 0.005
2025-11-05 00:10:41,168: Epoch 8 average loss: avg_loss: 8.77e-07, avg_total_loss: 8.77e-07
2025-11-05 00:10:41,612: Epoch 9 average loss: avg_loss: 8.44e-07, avg_total_loss: 8.44e-07
2025-11-05 00:10:42,018: Epoch 10 average loss: avg_loss: 8.56e-07, avg_total_loss: 8.56e-07
2025-11-05 00:10:42,309: Epoch 10 average validation loss: 9.82e-07 -- Median validation metrics: avg_loss: 9.82e-07, NSE: 0.77458, MSE: 38617.82422
2025-11-05 00:10:42,720: Epoch 11 average loss: avg_loss: 7.47e-07, avg_total_loss: 7.47e-07
2025-11-05 00:10:42,721: Setting learning rate to 0.001
2025-11-05 00:10:43,158: Epoch 12 average loss: avg_loss: 7.24e-07, avg_total_loss: 7.24e-07
2025-11-05 00:10:43,620: Epoch 13 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:10:44,114: Epoch 14 average loss: avg_loss: 6.84e-07, avg_total_loss: 6.84e-07
2025-11-05 00:10:44,612: Epoch 15 average loss: avg_loss: 6.83e-07, avg_total_loss: 6.83e-07
2025-11-05 00:10:44,921: Epoch 15 average validation loss: 9.47e-07 -- Median validation metrics: avg_loss: 9.47e-07, NSE: 0.78283, MSE: 37203.23828
2025-11-05 00:10:45,483: Epoch 16 average loss: avg_loss: 6.87e-07, avg_total_loss: 6.87e-07
2025-11-05 00:10:45,505: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\model_epoch016.pt
2025-11-05 00:10:45,754: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:10:45,756: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001036\validation\model_epoch016\validation_results.p
2025-11-05 00:10:46,439: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\output.log initialized.
2025-11-05 00:10:46,440: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046
2025-11-05 00:10:46,441: ### Run configurations for testing_run
2025-11-05 00:10:46,442: experiment_name: testing_run
2025-11-05 00:10:46,443: train_basin_file: calpella
2025-11-05 00:10:46,444: validation_basin_file: calpella
2025-11-05 00:10:46,446: test_basin_file: calpella
2025-11-05 00:10:46,446: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:46,447: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:46,448: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:46,449: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:46,449: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:46,450: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:46,451: device: cuda:0
2025-11-05 00:10:46,451: physics_informed: False
2025-11-05 00:10:46,452: physics_data_file: None
2025-11-05 00:10:46,453: validate_every: 5
2025-11-05 00:10:46,453: validate_n_random_basins: 1
2025-11-05 00:10:46,454: metrics: ['NSE', 'MSE']
2025-11-05 00:10:46,454: model: cudalstm
2025-11-05 00:10:46,455: head: regression
2025-11-05 00:10:46,455: output_activation: linear
2025-11-05 00:10:46,456: hidden_size: 128
2025-11-05 00:10:46,456: initial_forget_bias: 3
2025-11-05 00:10:46,457: output_dropout: 0.4
2025-11-05 00:10:46,457: num_layers: 1
2025-11-05 00:10:46,458: dev_mode: True
2025-11-05 00:10:46,459: optimizer: Adam
2025-11-05 00:10:46,460: loss: NSE
2025-11-05 00:10:46,461: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:10:46,461: batch_size: 128
2025-11-05 00:10:46,462: epochs: 16
2025-11-05 00:10:46,462: clip_gradient_norm: 1
2025-11-05 00:10:46,463: predict_last_n: 1
2025-11-05 00:10:46,464: seq_length: 120
2025-11-05 00:10:46,465: log_interval: 16
2025-11-05 00:10:46,465: log_tensorboard: True
2025-11-05 00:10:46,466: log_n_figures: 1
2025-11-05 00:10:46,467: save_weights_every: 16
2025-11-05 00:10:46,467: early_stopping: True
2025-11-05 00:10:46,468: early_stopping_mode: patience
2025-11-05 00:10:46,469: patience_early_stopping: 3
2025-11-05 00:10:46,470: min_delta_early_stopping: 0.0
2025-11-05 00:10:46,470: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:46,471: early_stopping_slope_window: 7
2025-11-05 00:10:46,472: early_stopping_slope_patience: 2
2025-11-05 00:10:46,472: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:46,473: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:46,474: early_stopping_slope_use_log: True
2025-11-05 00:10:46,474: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:46,475: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:46,475: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:46,476: early_stopping_slope_variance_guard: True
2025-11-05 00:10:46,477: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:46,478: dataset: russian_river
2025-11-05 00:10:46,479: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:46,480: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:46,481: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:46,481: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:46,483: hourly: False
2025-11-05 00:10:46,484: is_mts: False
2025-11-05 00:10:46,485: is_mts_data: False
2025-11-05 00:10:46,485: verbose: True
2025-11-05 00:10:46,486: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046
2025-11-05 00:10:46,487: run_label: BASELINE
2025-11-05 00:10:46,488: number_of_basins: 1
2025-11-05 00:10:46,488: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\train_data
2025-11-05 00:10:46,489: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\img_log
2025-11-05 00:10:46,492: ### Device cuda:0 will be used for training
2025-11-05 00:10:46,493: Loading basin data into xarray data set.
2025-11-05 00:10:46,656: Calculating target variable stds per basin
2025-11-05 00:10:46,669: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:46,777: Early stopping enabled: mode=patience
2025-11-05 00:10:47,099: Epoch 1 average loss: avg_loss: 2.85e-06, avg_total_loss: 2.85e-06
2025-11-05 00:10:47,339: Epoch 2 average loss: avg_loss: 1.54e-06, avg_total_loss: 1.54e-06
2025-11-05 00:10:47,586: Epoch 3 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:10:47,830: Epoch 4 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:10:48,068: Epoch 5 average loss: avg_loss: 9.02e-07, avg_total_loss: 9.02e-07
2025-11-05 00:10:48,497: Epoch 5 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76595, MSE: 40095.33203
2025-11-05 00:10:48,732: Epoch 6 average loss: avg_loss: 7.66e-07, avg_total_loss: 7.66e-07
2025-11-05 00:10:48,990: Epoch 7 average loss: avg_loss: 8.16e-07, avg_total_loss: 8.16e-07
2025-11-05 00:10:48,990: Setting learning rate to 0.005
2025-11-05 00:10:49,237: Epoch 8 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:10:49,494: Epoch 9 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:10:49,747: Epoch 10 average loss: avg_loss: 7.01e-07, avg_total_loss: 7.01e-07
2025-11-05 00:10:50,029: Epoch 10 average validation loss: 9.56e-07 -- Median validation metrics: avg_loss: 9.56e-07, NSE: 0.77981, MSE: 37720.47656
2025-11-05 00:10:50,263: Epoch 11 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:10:50,264: Setting learning rate to 0.001
2025-11-05 00:10:50,526: Epoch 12 average loss: avg_loss: 6.15e-07, avg_total_loss: 6.15e-07
2025-11-05 00:10:50,787: Epoch 13 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:10:51,053: Epoch 14 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:10:51,299: Epoch 15 average loss: avg_loss: 6.66e-07, avg_total_loss: 6.66e-07
2025-11-05 00:10:51,584: Epoch 15 average validation loss: 1.17e-06 -- Median validation metrics: avg_loss: 1.17e-06, NSE: 0.72986, MSE: 46278.81641
2025-11-05 00:10:51,834: Epoch 16 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:10:51,852: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\model_epoch016.pt
2025-11-05 00:10:52,050: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:10:52,051: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001046\validation\model_epoch016\validation_results.p
2025-11-05 00:10:52,716: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\output.log initialized.
2025-11-05 00:10:52,718: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052
2025-11-05 00:10:52,719: ### Run configurations for testing_run
2025-11-05 00:10:52,720: experiment_name: testing_run
2025-11-05 00:10:52,721: train_basin_file: calpella
2025-11-05 00:10:52,721: validation_basin_file: calpella
2025-11-05 00:10:52,723: test_basin_file: calpella
2025-11-05 00:10:52,724: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:52,726: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:52,727: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:52,728: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:52,729: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:52,730: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:52,731: device: cuda:0
2025-11-05 00:10:52,732: physics_informed: False
2025-11-05 00:10:52,733: physics_data_file: None
2025-11-05 00:10:52,733: validate_every: 5
2025-11-05 00:10:52,734: validate_n_random_basins: 1
2025-11-05 00:10:52,735: metrics: ['NSE', 'MSE']
2025-11-05 00:10:52,736: model: cudalstm
2025-11-05 00:10:52,737: head: regression
2025-11-05 00:10:52,738: output_activation: linear
2025-11-05 00:10:52,739: hidden_size: 128
2025-11-05 00:10:52,739: initial_forget_bias: 3
2025-11-05 00:10:52,740: output_dropout: 0.4
2025-11-05 00:10:52,741: num_layers: 1
2025-11-05 00:10:52,741: dev_mode: True
2025-11-05 00:10:52,742: optimizer: Adam
2025-11-05 00:10:52,743: loss: NSE
2025-11-05 00:10:52,745: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:10:52,746: batch_size: 256
2025-11-05 00:10:52,746: epochs: 16
2025-11-05 00:10:52,748: clip_gradient_norm: 1
2025-11-05 00:10:52,749: predict_last_n: 1
2025-11-05 00:10:52,750: seq_length: 120
2025-11-05 00:10:52,751: log_interval: 16
2025-11-05 00:10:52,752: log_tensorboard: True
2025-11-05 00:10:52,752: log_n_figures: 1
2025-11-05 00:10:52,754: save_weights_every: 16
2025-11-05 00:10:52,754: early_stopping: True
2025-11-05 00:10:52,755: early_stopping_mode: patience
2025-11-05 00:10:52,756: patience_early_stopping: 3
2025-11-05 00:10:52,757: min_delta_early_stopping: 0.0
2025-11-05 00:10:52,757: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:52,758: early_stopping_slope_window: 7
2025-11-05 00:10:52,759: early_stopping_slope_patience: 2
2025-11-05 00:10:52,759: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:52,760: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:52,761: early_stopping_slope_use_log: True
2025-11-05 00:10:52,762: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:52,763: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:52,764: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:52,764: early_stopping_slope_variance_guard: True
2025-11-05 00:10:52,765: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:52,766: dataset: russian_river
2025-11-05 00:10:52,767: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:52,767: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:52,768: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:52,768: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:52,769: hourly: False
2025-11-05 00:10:52,770: is_mts: False
2025-11-05 00:10:52,771: is_mts_data: False
2025-11-05 00:10:52,771: verbose: True
2025-11-05 00:10:52,772: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052
2025-11-05 00:10:52,773: run_label: BASELINE
2025-11-05 00:10:52,773: number_of_basins: 1
2025-11-05 00:10:52,774: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\train_data
2025-11-05 00:10:52,775: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\img_log
2025-11-05 00:10:52,778: ### Device cuda:0 will be used for training
2025-11-05 00:10:52,779: Loading basin data into xarray data set.
2025-11-05 00:10:52,928: Calculating target variable stds per basin
2025-11-05 00:10:52,936: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:53,054: Early stopping enabled: mode=patience
2025-11-05 00:10:53,298: Epoch 1 average loss: avg_loss: 3.19e-06, avg_total_loss: 3.19e-06
2025-11-05 00:10:53,520: Epoch 2 average loss: avg_loss: 2.12e-06, avg_total_loss: 2.12e-06
2025-11-05 00:10:53,707: Epoch 3 average loss: avg_loss: 1.64e-06, avg_total_loss: 1.64e-06
2025-11-05 00:10:53,876: Epoch 4 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:10:54,057: Epoch 5 average loss: avg_loss: 9.89e-07, avg_total_loss: 9.89e-07
2025-11-05 00:10:54,443: Epoch 5 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.72023, MSE: 47928.01953
2025-11-05 00:10:54,602: Epoch 6 average loss: avg_loss: 1.00e-06, avg_total_loss: 1.00e-06
2025-11-05 00:10:54,785: Epoch 7 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:10:54,786: Setting learning rate to 0.005
2025-11-05 00:10:54,947: Epoch 8 average loss: avg_loss: 8.29e-07, avg_total_loss: 8.29e-07
2025-11-05 00:10:55,101: Epoch 9 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:10:55,277: Epoch 10 average loss: avg_loss: 8.36e-07, avg_total_loss: 8.36e-07
2025-11-05 00:10:55,531: Epoch 10 average validation loss: 9.57e-07 -- Median validation metrics: avg_loss: 9.57e-07, NSE: 0.75653, MSE: 41709.69531
2025-11-05 00:10:55,678: Epoch 11 average loss: avg_loss: 7.12e-07, avg_total_loss: 7.12e-07
2025-11-05 00:10:55,679: Setting learning rate to 0.001
2025-11-05 00:10:55,827: Epoch 12 average loss: avg_loss: 7.44e-07, avg_total_loss: 7.44e-07
2025-11-05 00:10:56,006: Epoch 13 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:10:56,162: Epoch 14 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:10:56,312: Epoch 15 average loss: avg_loss: 6.27e-07, avg_total_loss: 6.27e-07
2025-11-05 00:10:56,593: Epoch 15 average validation loss: 9.73e-07 -- Median validation metrics: avg_loss: 9.73e-07, NSE: 0.75348, MSE: 42231.80078
2025-11-05 00:10:56,748: Epoch 16 average loss: avg_loss: 6.75e-07, avg_total_loss: 6.75e-07
2025-11-05 00:10:56,765: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\model_epoch016.pt
2025-11-05 00:10:56,948: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:10:56,950: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001052\validation\model_epoch016\validation_results.p
2025-11-05 00:10:57,597: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\output.log initialized.
2025-11-05 00:10:57,598: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057
2025-11-05 00:10:57,599: ### Run configurations for testing_run
2025-11-05 00:10:57,600: experiment_name: testing_run
2025-11-05 00:10:57,601: train_basin_file: calpella
2025-11-05 00:10:57,601: validation_basin_file: calpella
2025-11-05 00:10:57,602: test_basin_file: calpella
2025-11-05 00:10:57,602: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:10:57,603: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:10:57,604: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:10:57,604: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:10:57,605: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:10:57,606: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:10:57,606: device: cuda:0
2025-11-05 00:10:57,607: physics_informed: False
2025-11-05 00:10:57,608: physics_data_file: None
2025-11-05 00:10:57,608: validate_every: 5
2025-11-05 00:10:57,609: validate_n_random_basins: 1
2025-11-05 00:10:57,610: metrics: ['NSE', 'MSE']
2025-11-05 00:10:57,611: model: cudalstm
2025-11-05 00:10:57,612: head: regression
2025-11-05 00:10:57,612: output_activation: linear
2025-11-05 00:10:57,613: hidden_size: 128
2025-11-05 00:10:57,613: initial_forget_bias: 3
2025-11-05 00:10:57,614: output_dropout: 0.4
2025-11-05 00:10:57,615: num_layers: 1
2025-11-05 00:10:57,616: dev_mode: True
2025-11-05 00:10:57,616: optimizer: Adam
2025-11-05 00:10:57,618: loss: NSE
2025-11-05 00:10:57,618: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:10:57,619: batch_size: 64
2025-11-05 00:10:57,620: epochs: 32
2025-11-05 00:10:57,620: clip_gradient_norm: 1
2025-11-05 00:10:57,621: predict_last_n: 1
2025-11-05 00:10:57,622: seq_length: 120
2025-11-05 00:10:57,623: log_interval: 16
2025-11-05 00:10:57,623: log_tensorboard: True
2025-11-05 00:10:57,624: log_n_figures: 1
2025-11-05 00:10:57,625: save_weights_every: 32
2025-11-05 00:10:57,626: early_stopping: True
2025-11-05 00:10:57,627: early_stopping_mode: patience
2025-11-05 00:10:57,627: patience_early_stopping: 3
2025-11-05 00:10:57,628: min_delta_early_stopping: 0.0
2025-11-05 00:10:57,629: minimum_epochs_before_early_stopping: 10
2025-11-05 00:10:57,629: early_stopping_slope_window: 7
2025-11-05 00:10:57,630: early_stopping_slope_patience: 2
2025-11-05 00:10:57,631: early_stopping_slope_min_epoch: 8
2025-11-05 00:10:57,631: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:10:57,632: early_stopping_slope_use_log: True
2025-11-05 00:10:57,633: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:10:57,634: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:10:57,634: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:10:57,635: early_stopping_slope_variance_guard: True
2025-11-05 00:10:57,636: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:10:57,636: dataset: russian_river
2025-11-05 00:10:57,637: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:10:57,638: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:10:57,638: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:10:57,639: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:10:57,639: hourly: False
2025-11-05 00:10:57,640: is_mts: False
2025-11-05 00:10:57,641: is_mts_data: False
2025-11-05 00:10:57,642: verbose: True
2025-11-05 00:10:57,643: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057
2025-11-05 00:10:57,643: run_label: BASELINE
2025-11-05 00:10:57,644: number_of_basins: 1
2025-11-05 00:10:57,645: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\train_data
2025-11-05 00:10:57,646: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\img_log
2025-11-05 00:10:57,648: ### Device cuda:0 will be used for training
2025-11-05 00:10:57,649: Loading basin data into xarray data set.
2025-11-05 00:10:57,807: Calculating target variable stds per basin
2025-11-05 00:10:57,816: Create lookup table and convert to pytorch tensor
2025-11-05 00:10:57,930: Early stopping enabled: mode=patience
2025-11-05 00:10:58,357: Epoch 1 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:10:58,836: Epoch 2 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:10:59,298: Epoch 3 average loss: avg_loss: 1.12e-06, avg_total_loss: 1.12e-06
2025-11-05 00:10:59,774: Epoch 4 average loss: avg_loss: 8.62e-07, avg_total_loss: 8.62e-07
2025-11-05 00:11:00,261: Epoch 5 average loss: avg_loss: 8.46e-07, avg_total_loss: 8.46e-07
2025-11-05 00:11:00,699: Epoch 5 average validation loss: 1.30e-06 -- Median validation metrics: avg_loss: 1.30e-06, NSE: 0.70438, MSE: 50643.43359
2025-11-05 00:11:01,239: Epoch 6 average loss: avg_loss: 9.95e-07, avg_total_loss: 9.95e-07
2025-11-05 00:11:01,672: Epoch 7 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:11:02,073: Epoch 8 average loss: avg_loss: 7.34e-07, avg_total_loss: 7.34e-07
2025-11-05 00:11:02,494: Epoch 9 average loss: avg_loss: 8.26e-07, avg_total_loss: 8.26e-07
2025-11-05 00:11:02,918: Epoch 10 average loss: avg_loss: 7.15e-07, avg_total_loss: 7.15e-07
2025-11-05 00:11:03,200: Epoch 10 average validation loss: 1.54e-06 -- Median validation metrics: avg_loss: 1.54e-06, NSE: 0.64627, MSE: 60599.05469
2025-11-05 00:11:03,617: Epoch 11 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:11:04,070: Epoch 12 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:11:04,509: Epoch 13 average loss: avg_loss: 6.09e-07, avg_total_loss: 6.09e-07
2025-11-05 00:11:04,994: Epoch 14 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:11:05,461: Epoch 15 average loss: avg_loss: 6.25e-07, avg_total_loss: 6.25e-07
2025-11-05 00:11:05,757: Epoch 15 average validation loss: 1.30e-06 -- Median validation metrics: avg_loss: 1.30e-06, NSE: 0.70217, MSE: 51022.46875
2025-11-05 00:11:05,758: Setting learning rate to 0.005
2025-11-05 00:11:06,209: Epoch 16 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:11:06,728: Epoch 17 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:11:07,152: Epoch 18 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:11:07,553: Epoch 19 average loss: avg_loss: 4.43e-07, avg_total_loss: 4.43e-07
2025-11-05 00:11:07,964: Epoch 20 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:11:08,287: Epoch 20 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76513, MSE: 40235.41016
2025-11-05 00:11:08,718: Epoch 21 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:11:09,147: Epoch 22 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:11:09,571: Epoch 23 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:11:09,572: Setting learning rate to 0.001
2025-11-05 00:11:10,025: Epoch 24 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:11:10,456: Epoch 25 average loss: avg_loss: 4.64e-07, avg_total_loss: 4.64e-07
2025-11-05 00:11:10,872: Epoch 25 average validation loss: 9.92e-07 -- Median validation metrics: avg_loss: 9.92e-07, NSE: 0.77197, MSE: 39063.76953
2025-11-05 00:11:11,330: Epoch 26 average loss: avg_loss: 4.71e-07, avg_total_loss: 4.71e-07
2025-11-05 00:11:11,740: Epoch 27 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:11:12,183: Epoch 28 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:11:12,619: Epoch 29 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:11:13,026: Epoch 30 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:11:13,307: Epoch 30 average validation loss: 8.71e-07 -- Median validation metrics: avg_loss: 8.71e-07, NSE: 0.79973, MSE: 34308.38672
2025-11-05 00:11:13,711: Epoch 31 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:11:14,163: Epoch 32 average loss: avg_loss: 3.57e-07, avg_total_loss: 3.57e-07
2025-11-05 00:11:14,181: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\model_epoch032.pt
2025-11-05 00:11:14,390: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:11:14,392: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001057\validation\model_epoch032\validation_results.p
2025-11-05 00:11:15,119: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\output.log initialized.
2025-11-05 00:11:15,120: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115
2025-11-05 00:11:15,121: ### Run configurations for testing_run
2025-11-05 00:11:15,122: experiment_name: testing_run
2025-11-05 00:11:15,123: train_basin_file: calpella
2025-11-05 00:11:15,124: validation_basin_file: calpella
2025-11-05 00:11:15,125: test_basin_file: calpella
2025-11-05 00:11:15,125: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:11:15,127: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:11:15,128: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:11:15,128: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:11:15,129: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:11:15,130: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:11:15,131: device: cuda:0
2025-11-05 00:11:15,132: physics_informed: False
2025-11-05 00:11:15,133: physics_data_file: None
2025-11-05 00:11:15,134: validate_every: 5
2025-11-05 00:11:15,134: validate_n_random_basins: 1
2025-11-05 00:11:15,135: metrics: ['NSE', 'MSE']
2025-11-05 00:11:15,136: model: cudalstm
2025-11-05 00:11:15,137: head: regression
2025-11-05 00:11:15,138: output_activation: linear
2025-11-05 00:11:15,139: hidden_size: 128
2025-11-05 00:11:15,140: initial_forget_bias: 3
2025-11-05 00:11:15,141: output_dropout: 0.4
2025-11-05 00:11:15,141: num_layers: 1
2025-11-05 00:11:15,142: dev_mode: True
2025-11-05 00:11:15,143: optimizer: Adam
2025-11-05 00:11:15,144: loss: NSE
2025-11-05 00:11:15,145: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:11:15,146: batch_size: 128
2025-11-05 00:11:15,147: epochs: 32
2025-11-05 00:11:15,147: clip_gradient_norm: 1
2025-11-05 00:11:15,148: predict_last_n: 1
2025-11-05 00:11:15,148: seq_length: 120
2025-11-05 00:11:15,150: log_interval: 16
2025-11-05 00:11:15,150: log_tensorboard: True
2025-11-05 00:11:15,151: log_n_figures: 1
2025-11-05 00:11:15,151: save_weights_every: 32
2025-11-05 00:11:15,152: early_stopping: True
2025-11-05 00:11:15,153: early_stopping_mode: patience
2025-11-05 00:11:15,154: patience_early_stopping: 3
2025-11-05 00:11:15,155: min_delta_early_stopping: 0.0
2025-11-05 00:11:15,155: minimum_epochs_before_early_stopping: 10
2025-11-05 00:11:15,156: early_stopping_slope_window: 7
2025-11-05 00:11:15,157: early_stopping_slope_patience: 2
2025-11-05 00:11:15,158: early_stopping_slope_min_epoch: 8
2025-11-05 00:11:15,158: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:11:15,159: early_stopping_slope_use_log: True
2025-11-05 00:11:15,160: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:11:15,161: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:11:15,162: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:11:15,163: early_stopping_slope_variance_guard: True
2025-11-05 00:11:15,164: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:11:15,165: dataset: russian_river
2025-11-05 00:11:15,165: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:11:15,166: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:11:15,167: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:11:15,168: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:11:15,169: hourly: False
2025-11-05 00:11:15,170: is_mts: False
2025-11-05 00:11:15,171: is_mts_data: False
2025-11-05 00:11:15,172: verbose: True
2025-11-05 00:11:15,173: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115
2025-11-05 00:11:15,173: run_label: BASELINE
2025-11-05 00:11:15,174: number_of_basins: 1
2025-11-05 00:11:15,175: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\train_data
2025-11-05 00:11:15,176: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\img_log
2025-11-05 00:11:15,178: ### Device cuda:0 will be used for training
2025-11-05 00:11:15,179: Loading basin data into xarray data set.
2025-11-05 00:11:15,365: Calculating target variable stds per basin
2025-11-05 00:11:15,375: Create lookup table and convert to pytorch tensor
2025-11-05 00:11:15,507: Early stopping enabled: mode=patience
2025-11-05 00:11:15,990: Epoch 1 average loss: avg_loss: 2.74e-06, avg_total_loss: 2.74e-06
2025-11-05 00:11:16,265: Epoch 2 average loss: avg_loss: 1.53e-06, avg_total_loss: 1.53e-06
2025-11-05 00:11:16,538: Epoch 3 average loss: avg_loss: 1.14e-06, avg_total_loss: 1.14e-06
2025-11-05 00:11:16,833: Epoch 4 average loss: avg_loss: 9.23e-07, avg_total_loss: 9.23e-07
2025-11-05 00:11:17,131: Epoch 5 average loss: avg_loss: 8.42e-07, avg_total_loss: 8.42e-07
2025-11-05 00:11:17,584: Epoch 5 average validation loss: 1.32e-06 -- Median validation metrics: avg_loss: 1.32e-06, NSE: 0.69692, MSE: 51921.91797
2025-11-05 00:11:17,835: Epoch 6 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:11:18,118: Epoch 7 average loss: avg_loss: 7.30e-07, avg_total_loss: 7.30e-07
2025-11-05 00:11:18,404: Epoch 8 average loss: avg_loss: 7.17e-07, avg_total_loss: 7.17e-07
2025-11-05 00:11:18,672: Epoch 9 average loss: avg_loss: 7.16e-07, avg_total_loss: 7.16e-07
2025-11-05 00:11:18,948: Epoch 10 average loss: avg_loss: 7.26e-07, avg_total_loss: 7.26e-07
2025-11-05 00:11:19,219: Epoch 10 average validation loss: 9.23e-07 -- Median validation metrics: avg_loss: 9.23e-07, NSE: 0.78809, MSE: 36303.14844
2025-11-05 00:11:19,484: Epoch 11 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:11:19,759: Epoch 12 average loss: avg_loss: 6.78e-07, avg_total_loss: 6.78e-07
2025-11-05 00:11:20,023: Epoch 13 average loss: avg_loss: 6.10e-07, avg_total_loss: 6.10e-07
2025-11-05 00:11:20,310: Epoch 14 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:11:20,582: Epoch 15 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:11:20,875: Epoch 15 average validation loss: 1.20e-06 -- Median validation metrics: avg_loss: 1.20e-06, NSE: 0.72736, MSE: 46706.44141
2025-11-05 00:11:20,876: Setting learning rate to 0.005
2025-11-05 00:11:21,146: Epoch 16 average loss: avg_loss: 9.01e-07, avg_total_loss: 9.01e-07
2025-11-05 00:11:21,431: Epoch 17 average loss: avg_loss: 6.48e-07, avg_total_loss: 6.48e-07
2025-11-05 00:11:21,707: Epoch 18 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:11:21,977: Epoch 19 average loss: avg_loss: 6.23e-07, avg_total_loss: 6.23e-07
2025-11-05 00:11:22,246: Epoch 20 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:11:22,522: Epoch 20 average validation loss: 9.10e-07 -- Median validation metrics: avg_loss: 9.10e-07, NSE: 0.79054, MSE: 35883.74219
2025-11-05 00:11:22,775: Epoch 21 average loss: avg_loss: 5.69e-07, avg_total_loss: 5.69e-07
2025-11-05 00:11:23,048: Epoch 22 average loss: avg_loss: 5.71e-07, avg_total_loss: 5.71e-07
2025-11-05 00:11:23,328: Epoch 23 average loss: avg_loss: 5.26e-07, avg_total_loss: 5.26e-07
2025-11-05 00:11:23,329: Setting learning rate to 0.001
2025-11-05 00:11:23,619: Epoch 24 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:11:23,920: Epoch 25 average loss: avg_loss: 4.61e-07, avg_total_loss: 4.61e-07
2025-11-05 00:11:24,212: Epoch 25 average validation loss: 9.62e-07 -- Median validation metrics: avg_loss: 9.62e-07, NSE: 0.77869, MSE: 37913.78906
2025-11-05 00:11:24,464: Epoch 26 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:11:24,748: Epoch 27 average loss: avg_loss: 5.07e-07, avg_total_loss: 5.07e-07
2025-11-05 00:11:25,047: Epoch 28 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:11:25,317: Epoch 29 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:11:25,625: Epoch 30 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:11:25,964: Epoch 30 average validation loss: 1.08e-06 -- Median validation metrics: avg_loss: 1.08e-06, NSE: 0.75106, MSE: 42646.23047
2025-11-05 00:11:26,253: Epoch 31 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:11:26,538: Epoch 32 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:11:26,571: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\model_epoch032.pt
2025-11-05 00:11:26,796: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:11:26,798: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001115\validation\model_epoch032\validation_results.p
2025-11-05 00:11:27,480: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\output.log initialized.
2025-11-05 00:11:27,481: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127
2025-11-05 00:11:27,481: ### Run configurations for testing_run
2025-11-05 00:11:27,482: experiment_name: testing_run
2025-11-05 00:11:27,483: train_basin_file: calpella
2025-11-05 00:11:27,483: validation_basin_file: calpella
2025-11-05 00:11:27,484: test_basin_file: calpella
2025-11-05 00:11:27,485: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:11:27,485: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:11:27,486: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:11:27,487: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:11:27,488: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:11:27,489: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:11:27,489: device: cuda:0
2025-11-05 00:11:27,490: physics_informed: False
2025-11-05 00:11:27,491: physics_data_file: None
2025-11-05 00:11:27,491: validate_every: 5
2025-11-05 00:11:27,492: validate_n_random_basins: 1
2025-11-05 00:11:27,493: metrics: ['NSE', 'MSE']
2025-11-05 00:11:27,494: model: cudalstm
2025-11-05 00:11:27,494: head: regression
2025-11-05 00:11:27,495: output_activation: linear
2025-11-05 00:11:27,496: hidden_size: 128
2025-11-05 00:11:27,497: initial_forget_bias: 3
2025-11-05 00:11:27,497: output_dropout: 0.4
2025-11-05 00:11:27,498: num_layers: 1
2025-11-05 00:11:27,499: dev_mode: True
2025-11-05 00:11:27,500: optimizer: Adam
2025-11-05 00:11:27,501: loss: NSE
2025-11-05 00:11:27,502: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:11:27,504: batch_size: 256
2025-11-05 00:11:27,505: epochs: 32
2025-11-05 00:11:27,506: clip_gradient_norm: 1
2025-11-05 00:11:27,507: predict_last_n: 1
2025-11-05 00:11:27,508: seq_length: 120
2025-11-05 00:11:27,509: log_interval: 16
2025-11-05 00:11:27,511: log_tensorboard: True
2025-11-05 00:11:27,512: log_n_figures: 1
2025-11-05 00:11:27,514: save_weights_every: 32
2025-11-05 00:11:27,515: early_stopping: True
2025-11-05 00:11:27,516: early_stopping_mode: patience
2025-11-05 00:11:27,518: patience_early_stopping: 3
2025-11-05 00:11:27,519: min_delta_early_stopping: 0.0
2025-11-05 00:11:27,520: minimum_epochs_before_early_stopping: 10
2025-11-05 00:11:27,522: early_stopping_slope_window: 7
2025-11-05 00:11:27,523: early_stopping_slope_patience: 2
2025-11-05 00:11:27,524: early_stopping_slope_min_epoch: 8
2025-11-05 00:11:27,525: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:11:27,526: early_stopping_slope_use_log: True
2025-11-05 00:11:27,527: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:11:27,529: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:11:27,530: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:11:27,531: early_stopping_slope_variance_guard: True
2025-11-05 00:11:27,533: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:11:27,534: dataset: russian_river
2025-11-05 00:11:27,535: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:11:27,537: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:11:27,538: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:11:27,540: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:11:27,551: hourly: False
2025-11-05 00:11:27,553: is_mts: False
2025-11-05 00:11:27,554: is_mts_data: False
2025-11-05 00:11:27,555: verbose: True
2025-11-05 00:11:27,556: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127
2025-11-05 00:11:27,556: run_label: BASELINE
2025-11-05 00:11:27,557: number_of_basins: 1
2025-11-05 00:11:27,558: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\train_data
2025-11-05 00:11:27,559: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\img_log
2025-11-05 00:11:27,563: ### Device cuda:0 will be used for training
2025-11-05 00:11:27,565: Loading basin data into xarray data set.
2025-11-05 00:11:27,733: Calculating target variable stds per basin
2025-11-05 00:11:27,744: Create lookup table and convert to pytorch tensor
2025-11-05 00:11:27,888: Early stopping enabled: mode=patience
2025-11-05 00:11:28,212: Epoch 1 average loss: avg_loss: 2.98e-06, avg_total_loss: 2.98e-06
2025-11-05 00:11:28,391: Epoch 2 average loss: avg_loss: 1.84e-06, avg_total_loss: 1.84e-06
2025-11-05 00:11:28,557: Epoch 3 average loss: avg_loss: 1.41e-06, avg_total_loss: 1.41e-06
2025-11-05 00:11:28,715: Epoch 4 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:11:28,885: Epoch 5 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:11:29,345: Epoch 5 average validation loss: 9.45e-07 -- Median validation metrics: avg_loss: 9.45e-07, NSE: 0.75998, MSE: 41117.80469
2025-11-05 00:11:29,502: Epoch 6 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:11:29,662: Epoch 7 average loss: avg_loss: 9.52e-07, avg_total_loss: 9.52e-07
2025-11-05 00:11:29,840: Epoch 8 average loss: avg_loss: 8.16e-07, avg_total_loss: 8.16e-07
2025-11-05 00:11:30,000: Epoch 9 average loss: avg_loss: 8.96e-07, avg_total_loss: 8.96e-07
2025-11-05 00:11:30,182: Epoch 10 average loss: avg_loss: 8.05e-07, avg_total_loss: 8.05e-07
2025-11-05 00:11:30,457: Epoch 10 average validation loss: 1.21e-06 -- Median validation metrics: avg_loss: 1.21e-06, NSE: 0.69993, MSE: 51406.25781
2025-11-05 00:11:30,627: Epoch 11 average loss: avg_loss: 7.07e-07, avg_total_loss: 7.07e-07
2025-11-05 00:11:30,781: Epoch 12 average loss: avg_loss: 6.76e-07, avg_total_loss: 6.76e-07
2025-11-05 00:11:30,942: Epoch 13 average loss: avg_loss: 6.97e-07, avg_total_loss: 6.97e-07
2025-11-05 00:11:31,121: Epoch 14 average loss: avg_loss: 7.43e-07, avg_total_loss: 7.43e-07
2025-11-05 00:11:31,275: Epoch 15 average loss: avg_loss: 7.38e-07, avg_total_loss: 7.38e-07
2025-11-05 00:11:31,532: Epoch 15 average validation loss: 1.18e-06 -- Median validation metrics: avg_loss: 1.18e-06, NSE: 0.69944, MSE: 51489.63672
2025-11-05 00:11:31,533: Setting learning rate to 0.005
2025-11-05 00:11:31,691: Epoch 16 average loss: avg_loss: 6.30e-07, avg_total_loss: 6.30e-07
2025-11-05 00:11:31,855: Epoch 17 average loss: avg_loss: 6.38e-07, avg_total_loss: 6.38e-07
2025-11-05 00:11:32,008: Epoch 18 average loss: avg_loss: 5.46e-07, avg_total_loss: 5.46e-07
2025-11-05 00:11:32,183: Epoch 19 average loss: avg_loss: 6.02e-07, avg_total_loss: 6.02e-07
2025-11-05 00:11:32,343: Epoch 20 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:11:32,593: Epoch 20 average validation loss: 8.92e-07 -- Median validation metrics: avg_loss: 8.92e-07, NSE: 0.77186, MSE: 39082.76953
2025-11-05 00:11:32,739: Epoch 21 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:11:32,905: Epoch 22 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:11:33,083: Epoch 23 average loss: avg_loss: 5.97e-07, avg_total_loss: 5.97e-07
2025-11-05 00:11:33,084: Setting learning rate to 0.001
2025-11-05 00:11:33,246: Epoch 24 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:11:33,412: Epoch 25 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:11:33,681: Epoch 25 average validation loss: 9.28e-07 -- Median validation metrics: avg_loss: 9.28e-07, NSE: 0.76422, MSE: 40391.97266
2025-11-05 00:11:33,838: Epoch 26 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:11:33,999: Epoch 27 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:11:34,152: Epoch 28 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:11:34,319: Epoch 29 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:11:34,476: Epoch 30 average loss: avg_loss: 5.08e-07, avg_total_loss: 5.08e-07
2025-11-05 00:11:34,744: Epoch 30 average validation loss: 9.25e-07 -- Median validation metrics: avg_loss: 9.25e-07, NSE: 0.76421, MSE: 40393.73828
2025-11-05 00:11:34,922: Epoch 31 average loss: avg_loss: 5.07e-07, avg_total_loss: 5.07e-07
2025-11-05 00:11:35,091: Epoch 32 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:11:35,111: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\model_epoch032.pt
2025-11-05 00:11:35,316: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:11:35,318: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001127\validation\model_epoch032\validation_results.p
2025-11-05 00:11:36,050: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\output.log initialized.
2025-11-05 00:11:36,052: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136
2025-11-05 00:11:36,053: ### Run configurations for testing_run
2025-11-05 00:11:36,053: experiment_name: testing_run
2025-11-05 00:11:36,054: train_basin_file: calpella
2025-11-05 00:11:36,055: validation_basin_file: calpella
2025-11-05 00:11:36,056: test_basin_file: calpella
2025-11-05 00:11:36,057: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:11:36,058: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:11:36,059: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:11:36,060: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:11:36,061: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:11:36,061: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:11:36,063: device: cuda:0
2025-11-05 00:11:36,064: physics_informed: False
2025-11-05 00:11:36,065: physics_data_file: None
2025-11-05 00:11:36,066: validate_every: 5
2025-11-05 00:11:36,068: validate_n_random_basins: 1
2025-11-05 00:11:36,069: metrics: ['NSE', 'MSE']
2025-11-05 00:11:36,070: model: cudalstm
2025-11-05 00:11:36,071: head: regression
2025-11-05 00:11:36,073: output_activation: linear
2025-11-05 00:11:36,074: hidden_size: 128
2025-11-05 00:11:36,074: initial_forget_bias: 3
2025-11-05 00:11:36,075: output_dropout: 0.4
2025-11-05 00:11:36,076: num_layers: 1
2025-11-05 00:11:36,077: dev_mode: True
2025-11-05 00:11:36,077: optimizer: Adam
2025-11-05 00:11:36,078: loss: NSE
2025-11-05 00:11:36,079: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:11:36,080: batch_size: 64
2025-11-05 00:11:36,081: epochs: 48
2025-11-05 00:11:36,081: clip_gradient_norm: 1
2025-11-05 00:11:36,082: predict_last_n: 1
2025-11-05 00:11:36,083: seq_length: 120
2025-11-05 00:11:36,083: log_interval: 16
2025-11-05 00:11:36,084: log_tensorboard: True
2025-11-05 00:11:36,085: log_n_figures: 1
2025-11-05 00:11:36,086: save_weights_every: 48
2025-11-05 00:11:36,087: early_stopping: True
2025-11-05 00:11:36,088: early_stopping_mode: patience
2025-11-05 00:11:36,089: patience_early_stopping: 3
2025-11-05 00:11:36,089: min_delta_early_stopping: 0.0
2025-11-05 00:11:36,090: minimum_epochs_before_early_stopping: 10
2025-11-05 00:11:36,091: early_stopping_slope_window: 7
2025-11-05 00:11:36,092: early_stopping_slope_patience: 2
2025-11-05 00:11:36,092: early_stopping_slope_min_epoch: 8
2025-11-05 00:11:36,093: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:11:36,093: early_stopping_slope_use_log: True
2025-11-05 00:11:36,094: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:11:36,095: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:11:36,096: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:11:36,097: early_stopping_slope_variance_guard: True
2025-11-05 00:11:36,098: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:11:36,098: dataset: russian_river
2025-11-05 00:11:36,099: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:11:36,100: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:11:36,101: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:11:36,102: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:11:36,102: hourly: False
2025-11-05 00:11:36,103: is_mts: False
2025-11-05 00:11:36,104: is_mts_data: False
2025-11-05 00:11:36,105: verbose: True
2025-11-05 00:11:36,105: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136
2025-11-05 00:11:36,106: run_label: BASELINE
2025-11-05 00:11:36,107: number_of_basins: 1
2025-11-05 00:11:36,108: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\train_data
2025-11-05 00:11:36,109: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\img_log
2025-11-05 00:11:36,111: ### Device cuda:0 will be used for training
2025-11-05 00:11:36,112: Loading basin data into xarray data set.
2025-11-05 00:11:36,264: Calculating target variable stds per basin
2025-11-05 00:11:36,273: Create lookup table and convert to pytorch tensor
2025-11-05 00:11:36,550: Early stopping enabled: mode=patience
2025-11-05 00:11:37,052: Epoch 1 average loss: avg_loss: 2.43e-06, avg_total_loss: 2.43e-06
2025-11-05 00:11:37,563: Epoch 2 average loss: avg_loss: 1.41e-06, avg_total_loss: 1.41e-06
2025-11-05 00:11:38,069: Epoch 3 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:11:38,570: Epoch 4 average loss: avg_loss: 9.65e-07, avg_total_loss: 9.65e-07
2025-11-05 00:11:39,086: Epoch 5 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:11:39,560: Epoch 5 average validation loss: 1.19e-06 -- Median validation metrics: avg_loss: 1.19e-06, NSE: 0.72638, MSE: 46875.09766
2025-11-05 00:11:40,089: Epoch 6 average loss: avg_loss: 9.46e-07, avg_total_loss: 9.46e-07
2025-11-05 00:11:40,500: Epoch 7 average loss: avg_loss: 8.00e-07, avg_total_loss: 8.00e-07
2025-11-05 00:11:40,891: Epoch 8 average loss: avg_loss: 7.27e-07, avg_total_loss: 7.27e-07
2025-11-05 00:11:41,341: Epoch 9 average loss: avg_loss: 8.29e-07, avg_total_loss: 8.29e-07
2025-11-05 00:11:41,849: Epoch 10 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:11:42,179: Epoch 10 average validation loss: 3.84e-06 -- Median validation metrics: avg_loss: 3.84e-06, NSE: 0.55138, MSE: 76853.68750
2025-11-05 00:11:42,692: Epoch 11 average loss: avg_loss: 1.51e-06, avg_total_loss: 1.51e-06
2025-11-05 00:11:43,199: Epoch 12 average loss: avg_loss: 8.83e-07, avg_total_loss: 8.83e-07
2025-11-05 00:11:43,712: Epoch 13 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:11:44,217: Epoch 14 average loss: avg_loss: 6.94e-07, avg_total_loss: 6.94e-07
2025-11-05 00:11:44,734: Epoch 15 average loss: avg_loss: 7.60e-07, avg_total_loss: 7.60e-07
2025-11-05 00:11:45,085: Epoch 15 average validation loss: 8.80e-07 -- Median validation metrics: avg_loss: 8.80e-07, NSE: 0.79738, MSE: 34711.84375
2025-11-05 00:11:45,635: Epoch 16 average loss: avg_loss: 7.24e-07, avg_total_loss: 7.24e-07
2025-11-05 00:11:46,130: Epoch 17 average loss: avg_loss: 7.46e-07, avg_total_loss: 7.46e-07
2025-11-05 00:11:46,584: Epoch 18 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:11:47,047: Epoch 19 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:11:47,544: Epoch 20 average loss: avg_loss: 6.22e-07, avg_total_loss: 6.22e-07
2025-11-05 00:11:47,897: Epoch 20 average validation loss: 9.68e-07 -- Median validation metrics: avg_loss: 9.68e-07, NSE: 0.77691, MSE: 38217.77344
2025-11-05 00:11:48,382: Epoch 21 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:11:49,019: Epoch 22 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:11:49,563: Epoch 23 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:11:49,564: Setting learning rate to 0.005
2025-11-05 00:11:50,089: Epoch 24 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:11:50,562: Epoch 25 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:11:50,858: Epoch 25 average validation loss: 9.58e-07 -- Median validation metrics: avg_loss: 9.58e-07, NSE: 0.77933, MSE: 37804.28906
2025-11-05 00:11:51,373: Epoch 26 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:11:51,869: Epoch 27 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:11:52,347: Epoch 28 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:11:52,814: Epoch 29 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:11:53,258: Epoch 30 average loss: avg_loss: 4.03e-07, avg_total_loss: 4.03e-07
2025-11-05 00:11:53,582: Epoch 30 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.76151, MSE: 40855.59766
2025-11-05 00:11:53,583: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:11:53,584: Early stopping triggered at epoch 30
2025-11-05 00:11:53,600: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\model_epoch030.pt
2025-11-05 00:11:53,806: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:11:53,807: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001136\validation\model_epoch030\validation_results.p
2025-11-05 00:11:54,469: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\output.log initialized.
2025-11-05 00:11:54,470: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154
2025-11-05 00:11:54,470: ### Run configurations for testing_run
2025-11-05 00:11:54,471: experiment_name: testing_run
2025-11-05 00:11:54,472: train_basin_file: calpella
2025-11-05 00:11:54,472: validation_basin_file: calpella
2025-11-05 00:11:54,473: test_basin_file: calpella
2025-11-05 00:11:54,474: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:11:54,474: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:11:54,475: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:11:54,476: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:11:54,476: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:11:54,477: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:11:54,477: device: cuda:0
2025-11-05 00:11:54,478: physics_informed: False
2025-11-05 00:11:54,479: physics_data_file: None
2025-11-05 00:11:54,479: validate_every: 5
2025-11-05 00:11:54,480: validate_n_random_basins: 1
2025-11-05 00:11:54,481: metrics: ['NSE', 'MSE']
2025-11-05 00:11:54,482: model: cudalstm
2025-11-05 00:11:54,482: head: regression
2025-11-05 00:11:54,483: output_activation: linear
2025-11-05 00:11:54,484: hidden_size: 128
2025-11-05 00:11:54,484: initial_forget_bias: 3
2025-11-05 00:11:54,485: output_dropout: 0.4
2025-11-05 00:11:54,486: num_layers: 1
2025-11-05 00:11:54,487: dev_mode: True
2025-11-05 00:11:54,487: optimizer: Adam
2025-11-05 00:11:54,488: loss: NSE
2025-11-05 00:11:54,489: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:11:54,489: batch_size: 128
2025-11-05 00:11:54,491: epochs: 48
2025-11-05 00:11:54,491: clip_gradient_norm: 1
2025-11-05 00:11:54,492: predict_last_n: 1
2025-11-05 00:11:54,493: seq_length: 120
2025-11-05 00:11:54,493: log_interval: 16
2025-11-05 00:11:54,494: log_tensorboard: True
2025-11-05 00:11:54,494: log_n_figures: 1
2025-11-05 00:11:54,495: save_weights_every: 48
2025-11-05 00:11:54,496: early_stopping: True
2025-11-05 00:11:54,496: early_stopping_mode: patience
2025-11-05 00:11:54,497: patience_early_stopping: 3
2025-11-05 00:11:54,497: min_delta_early_stopping: 0.0
2025-11-05 00:11:54,498: minimum_epochs_before_early_stopping: 10
2025-11-05 00:11:54,499: early_stopping_slope_window: 7
2025-11-05 00:11:54,500: early_stopping_slope_patience: 2
2025-11-05 00:11:54,500: early_stopping_slope_min_epoch: 8
2025-11-05 00:11:54,501: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:11:54,502: early_stopping_slope_use_log: True
2025-11-05 00:11:54,502: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:11:54,503: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:11:54,504: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:11:54,504: early_stopping_slope_variance_guard: True
2025-11-05 00:11:54,505: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:11:54,505: dataset: russian_river
2025-11-05 00:11:54,506: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:11:54,507: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:11:54,507: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:11:54,508: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:11:54,509: hourly: False
2025-11-05 00:11:54,510: is_mts: False
2025-11-05 00:11:54,511: is_mts_data: False
2025-11-05 00:11:54,512: verbose: True
2025-11-05 00:11:54,513: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154
2025-11-05 00:11:54,514: run_label: BASELINE
2025-11-05 00:11:54,515: number_of_basins: 1
2025-11-05 00:11:54,517: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\train_data
2025-11-05 00:11:54,517: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\img_log
2025-11-05 00:11:54,521: ### Device cuda:0 will be used for training
2025-11-05 00:11:54,522: Loading basin data into xarray data set.
2025-11-05 00:11:54,682: Calculating target variable stds per basin
2025-11-05 00:11:54,691: Create lookup table and convert to pytorch tensor
2025-11-05 00:11:54,815: Early stopping enabled: mode=patience
2025-11-05 00:11:55,273: Epoch 1 average loss: avg_loss: 2.90e-06, avg_total_loss: 2.90e-06
2025-11-05 00:11:55,560: Epoch 2 average loss: avg_loss: 1.60e-06, avg_total_loss: 1.60e-06
2025-11-05 00:11:55,786: Epoch 3 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:11:56,048: Epoch 4 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:11:56,335: Epoch 5 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:11:56,771: Epoch 5 average validation loss: 1.45e-06 -- Median validation metrics: avg_loss: 1.45e-06, NSE: 0.66622, MSE: 57179.78906
2025-11-05 00:11:56,991: Epoch 6 average loss: avg_loss: 9.91e-07, avg_total_loss: 9.91e-07
2025-11-05 00:11:57,267: Epoch 7 average loss: avg_loss: 8.83e-07, avg_total_loss: 8.83e-07
2025-11-05 00:11:57,520: Epoch 8 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:11:57,785: Epoch 9 average loss: avg_loss: 7.42e-07, avg_total_loss: 7.42e-07
2025-11-05 00:11:58,050: Epoch 10 average loss: avg_loss: 7.28e-07, avg_total_loss: 7.28e-07
2025-11-05 00:11:58,367: Epoch 10 average validation loss: 1.32e-06 -- Median validation metrics: avg_loss: 1.32e-06, NSE: 0.69956, MSE: 51469.51953
2025-11-05 00:11:58,617: Epoch 11 average loss: avg_loss: 7.41e-07, avg_total_loss: 7.41e-07
2025-11-05 00:11:58,906: Epoch 12 average loss: avg_loss: 6.75e-07, avg_total_loss: 6.75e-07
2025-11-05 00:11:59,190: Epoch 13 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:11:59,448: Epoch 14 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:11:59,713: Epoch 15 average loss: avg_loss: 6.29e-07, avg_total_loss: 6.29e-07
2025-11-05 00:11:59,998: Epoch 15 average validation loss: 9.92e-07 -- Median validation metrics: avg_loss: 9.92e-07, NSE: 0.77196, MSE: 39066.69531
2025-11-05 00:12:00,259: Epoch 16 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:12:00,535: Epoch 17 average loss: avg_loss: 7.50e-07, avg_total_loss: 7.50e-07
2025-11-05 00:12:00,813: Epoch 18 average loss: avg_loss: 6.21e-07, avg_total_loss: 6.21e-07
2025-11-05 00:12:01,111: Epoch 19 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:12:01,408: Epoch 20 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:12:01,683: Epoch 20 average validation loss: 8.74e-07 -- Median validation metrics: avg_loss: 8.74e-07, NSE: 0.79903, MSE: 34429.31250
2025-11-05 00:12:01,939: Epoch 21 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:12:02,229: Epoch 22 average loss: avg_loss: 5.90e-07, avg_total_loss: 5.90e-07
2025-11-05 00:12:02,489: Epoch 23 average loss: avg_loss: 5.63e-07, avg_total_loss: 5.63e-07
2025-11-05 00:12:02,490: Setting learning rate to 0.005
2025-11-05 00:12:02,775: Epoch 24 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:12:03,068: Epoch 25 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:12:03,347: Epoch 25 average validation loss: 8.92e-07 -- Median validation metrics: avg_loss: 8.92e-07, NSE: 0.79487, MSE: 35141.52734
2025-11-05 00:12:03,603: Epoch 26 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:12:03,880: Epoch 27 average loss: avg_loss: 4.38e-07, avg_total_loss: 4.38e-07
2025-11-05 00:12:04,163: Epoch 28 average loss: avg_loss: 4.38e-07, avg_total_loss: 4.38e-07
2025-11-05 00:12:04,472: Epoch 29 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:12:04,779: Epoch 30 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:12:05,080: Epoch 30 average validation loss: 8.42e-07 -- Median validation metrics: avg_loss: 8.42e-07, NSE: 0.80617, MSE: 33205.96484
2025-11-05 00:12:05,345: Epoch 31 average loss: avg_loss: 4.78e-07, avg_total_loss: 4.78e-07
2025-11-05 00:12:05,632: Epoch 32 average loss: avg_loss: 4.47e-07, avg_total_loss: 4.47e-07
2025-11-05 00:12:05,906: Epoch 33 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:12:06,169: Epoch 34 average loss: avg_loss: 4.68e-07, avg_total_loss: 4.68e-07
2025-11-05 00:12:06,443: Epoch 35 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:12:06,720: Epoch 35 average validation loss: 9.52e-07 -- Median validation metrics: avg_loss: 9.52e-07, NSE: 0.78074, MSE: 37562.71484
2025-11-05 00:12:06,721: Setting learning rate to 0.001
2025-11-05 00:12:06,975: Epoch 36 average loss: avg_loss: 3.81e-07, avg_total_loss: 3.81e-07
2025-11-05 00:12:07,258: Epoch 37 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:12:07,542: Epoch 38 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:12:07,793: Epoch 39 average loss: avg_loss: 3.84e-07, avg_total_loss: 3.84e-07
2025-11-05 00:12:08,071: Epoch 40 average loss: avg_loss: 3.44e-07, avg_total_loss: 3.44e-07
2025-11-05 00:12:08,367: Epoch 40 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76814, MSE: 39719.56250
2025-11-05 00:12:08,612: Epoch 41 average loss: avg_loss: 3.84e-07, avg_total_loss: 3.84e-07
2025-11-05 00:12:08,891: Epoch 42 average loss: avg_loss: 3.85e-07, avg_total_loss: 3.85e-07
2025-11-05 00:12:09,167: Epoch 43 average loss: avg_loss: 3.86e-07, avg_total_loss: 3.86e-07
2025-11-05 00:12:09,435: Epoch 44 average loss: avg_loss: 3.57e-07, avg_total_loss: 3.57e-07
2025-11-05 00:12:09,718: Epoch 45 average loss: avg_loss: 3.39e-07, avg_total_loss: 3.39e-07
2025-11-05 00:12:09,978: Epoch 45 average validation loss: 9.90e-07 -- Median validation metrics: avg_loss: 9.90e-07, NSE: 0.77225, MSE: 39016.87500
2025-11-05 00:12:09,978: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:12:09,979: Early stopping triggered at epoch 45
2025-11-05 00:12:09,997: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\model_epoch045.pt
2025-11-05 00:12:10,193: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:12:10,194: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001154\validation\model_epoch045\validation_results.p
2025-11-05 00:12:10,873: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\output.log initialized.
2025-11-05 00:12:10,875: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210
2025-11-05 00:12:10,875: ### Run configurations for testing_run
2025-11-05 00:12:10,876: experiment_name: testing_run
2025-11-05 00:12:10,877: train_basin_file: calpella
2025-11-05 00:12:10,879: validation_basin_file: calpella
2025-11-05 00:12:10,880: test_basin_file: calpella
2025-11-05 00:12:10,881: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:12:10,882: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:12:10,883: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:12:10,884: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:12:10,885: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:12:10,886: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:12:10,886: device: cuda:0
2025-11-05 00:12:10,887: physics_informed: False
2025-11-05 00:12:10,888: physics_data_file: None
2025-11-05 00:12:10,889: validate_every: 5
2025-11-05 00:12:10,889: validate_n_random_basins: 1
2025-11-05 00:12:10,890: metrics: ['NSE', 'MSE']
2025-11-05 00:12:10,891: model: cudalstm
2025-11-05 00:12:10,892: head: regression
2025-11-05 00:12:10,892: output_activation: linear
2025-11-05 00:12:10,893: hidden_size: 128
2025-11-05 00:12:10,894: initial_forget_bias: 3
2025-11-05 00:12:10,894: output_dropout: 0.4
2025-11-05 00:12:10,895: num_layers: 1
2025-11-05 00:12:10,896: dev_mode: True
2025-11-05 00:12:10,897: optimizer: Adam
2025-11-05 00:12:10,897: loss: NSE
2025-11-05 00:12:10,898: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:12:10,899: batch_size: 256
2025-11-05 00:12:10,900: epochs: 48
2025-11-05 00:12:10,901: clip_gradient_norm: 1
2025-11-05 00:12:10,902: predict_last_n: 1
2025-11-05 00:12:10,903: seq_length: 120
2025-11-05 00:12:10,904: log_interval: 16
2025-11-05 00:12:10,905: log_tensorboard: True
2025-11-05 00:12:10,905: log_n_figures: 1
2025-11-05 00:12:10,906: save_weights_every: 48
2025-11-05 00:12:10,907: early_stopping: True
2025-11-05 00:12:10,907: early_stopping_mode: patience
2025-11-05 00:12:10,908: patience_early_stopping: 3
2025-11-05 00:12:10,909: min_delta_early_stopping: 0.0
2025-11-05 00:12:10,909: minimum_epochs_before_early_stopping: 10
2025-11-05 00:12:10,910: early_stopping_slope_window: 7
2025-11-05 00:12:10,911: early_stopping_slope_patience: 2
2025-11-05 00:12:10,912: early_stopping_slope_min_epoch: 8
2025-11-05 00:12:10,913: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:12:10,914: early_stopping_slope_use_log: True
2025-11-05 00:12:10,915: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:12:10,915: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:12:10,916: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:12:10,917: early_stopping_slope_variance_guard: True
2025-11-05 00:12:10,917: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:12:10,918: dataset: russian_river
2025-11-05 00:12:10,919: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:12:10,920: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:12:10,920: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:12:10,921: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:12:10,922: hourly: False
2025-11-05 00:12:10,922: is_mts: False
2025-11-05 00:12:10,923: is_mts_data: False
2025-11-05 00:12:10,924: verbose: True
2025-11-05 00:12:10,925: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210
2025-11-05 00:12:10,925: run_label: BASELINE
2025-11-05 00:12:10,926: number_of_basins: 1
2025-11-05 00:12:10,927: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\train_data
2025-11-05 00:12:10,927: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\img_log
2025-11-05 00:12:10,930: ### Device cuda:0 will be used for training
2025-11-05 00:12:10,931: Loading basin data into xarray data set.
2025-11-05 00:12:11,073: Calculating target variable stds per basin
2025-11-05 00:12:11,080: Create lookup table and convert to pytorch tensor
2025-11-05 00:12:11,187: Early stopping enabled: mode=patience
2025-11-05 00:12:11,404: Epoch 1 average loss: avg_loss: 3.09e-06, avg_total_loss: 3.09e-06
2025-11-05 00:12:11,617: Epoch 2 average loss: avg_loss: 2.10e-06, avg_total_loss: 2.10e-06
2025-11-05 00:12:11,795: Epoch 3 average loss: avg_loss: 1.61e-06, avg_total_loss: 1.61e-06
2025-11-05 00:12:11,973: Epoch 4 average loss: avg_loss: 1.26e-06, avg_total_loss: 1.26e-06
2025-11-05 00:12:12,162: Epoch 5 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:12:12,562: Epoch 5 average validation loss: 1.11e-06 -- Median validation metrics: avg_loss: 1.11e-06, NSE: 0.71755, MSE: 48387.96875
2025-11-05 00:12:12,721: Epoch 6 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:12:12,891: Epoch 7 average loss: avg_loss: 8.89e-07, avg_total_loss: 8.89e-07
2025-11-05 00:12:13,075: Epoch 8 average loss: avg_loss: 8.67e-07, avg_total_loss: 8.67e-07
2025-11-05 00:12:13,244: Epoch 9 average loss: avg_loss: 8.10e-07, avg_total_loss: 8.10e-07
2025-11-05 00:12:13,414: Epoch 10 average loss: avg_loss: 7.60e-07, avg_total_loss: 7.60e-07
2025-11-05 00:12:13,689: Epoch 10 average validation loss: 1.21e-06 -- Median validation metrics: avg_loss: 1.21e-06, NSE: 0.69168, MSE: 52818.21094
2025-11-05 00:12:13,838: Epoch 11 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:12:14,004: Epoch 12 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:12:14,186: Epoch 13 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:12:14,345: Epoch 14 average loss: avg_loss: 7.25e-07, avg_total_loss: 7.25e-07
2025-11-05 00:12:14,498: Epoch 15 average loss: avg_loss: 5.98e-07, avg_total_loss: 5.98e-07
2025-11-05 00:12:14,780: Epoch 15 average validation loss: 1.24e-06 -- Median validation metrics: avg_loss: 1.24e-06, NSE: 0.68509, MSE: 53947.30078
2025-11-05 00:12:14,924: Epoch 16 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:12:15,215: Epoch 17 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:12:15,373: Epoch 18 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:12:15,521: Epoch 19 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:12:15,669: Epoch 20 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:12:15,954: Epoch 20 average validation loss: 1.00e-06 -- Median validation metrics: avg_loss: 1.00e-06, NSE: 0.74631, MSE: 43460.77344
2025-11-05 00:12:16,103: Epoch 21 average loss: avg_loss: 6.29e-07, avg_total_loss: 6.29e-07
2025-11-05 00:12:16,256: Epoch 22 average loss: avg_loss: 7.66e-07, avg_total_loss: 7.66e-07
2025-11-05 00:12:16,436: Epoch 23 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:12:16,437: Setting learning rate to 0.005
2025-11-05 00:12:16,587: Epoch 24 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:12:16,736: Epoch 25 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:12:16,994: Epoch 25 average validation loss: 8.23e-07 -- Median validation metrics: avg_loss: 8.23e-07, NSE: 0.79049, MSE: 35890.98828
2025-11-05 00:12:17,155: Epoch 26 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:12:17,309: Epoch 27 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:12:17,466: Epoch 28 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:12:17,623: Epoch 29 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:12:17,779: Epoch 30 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:12:18,016: Epoch 30 average validation loss: 8.39e-07 -- Median validation metrics: avg_loss: 8.39e-07, NSE: 0.78555, MSE: 36737.13281
2025-11-05 00:12:18,180: Epoch 31 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:12:18,337: Epoch 32 average loss: avg_loss: 4.70e-07, avg_total_loss: 4.70e-07
2025-11-05 00:12:18,487: Epoch 33 average loss: avg_loss: 4.23e-07, avg_total_loss: 4.23e-07
2025-11-05 00:12:18,655: Epoch 34 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:12:18,806: Epoch 35 average loss: avg_loss: 4.42e-07, avg_total_loss: 4.42e-07
2025-11-05 00:12:19,049: Epoch 35 average validation loss: 9.33e-07 -- Median validation metrics: avg_loss: 9.33e-07, NSE: 0.76285, MSE: 40626.62500
2025-11-05 00:12:19,050: Setting learning rate to 0.001
2025-11-05 00:12:19,218: Epoch 36 average loss: avg_loss: 4.03e-07, avg_total_loss: 4.03e-07
2025-11-05 00:12:19,387: Epoch 37 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:12:19,542: Epoch 38 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:12:19,715: Epoch 39 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:12:19,864: Epoch 40 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:12:20,116: Epoch 40 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.73705, MSE: 45046.36328
2025-11-05 00:12:20,117: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:12:20,119: Early stopping triggered at epoch 40
2025-11-05 00:12:20,133: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\model_epoch040.pt
2025-11-05 00:12:20,304: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:12:20,306: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001210\validation\model_epoch040\validation_results.p
2025-11-05 00:12:20,968: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\output.log initialized.
2025-11-05 00:12:20,969: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220
2025-11-05 00:12:20,970: ### Run configurations for testing_run
2025-11-05 00:12:20,971: experiment_name: testing_run
2025-11-05 00:12:20,972: train_basin_file: calpella
2025-11-05 00:12:20,974: validation_basin_file: calpella
2025-11-05 00:12:20,974: test_basin_file: calpella
2025-11-05 00:12:20,976: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:12:20,977: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:12:20,979: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:12:20,980: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:12:20,981: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:12:20,982: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:12:20,983: device: cuda:0
2025-11-05 00:12:20,984: physics_informed: False
2025-11-05 00:12:20,985: physics_data_file: None
2025-11-05 00:12:20,986: validate_every: 5
2025-11-05 00:12:20,987: validate_n_random_basins: 1
2025-11-05 00:12:20,987: metrics: ['NSE', 'MSE']
2025-11-05 00:12:20,988: model: cudalstm
2025-11-05 00:12:20,990: head: regression
2025-11-05 00:12:20,991: output_activation: linear
2025-11-05 00:12:20,992: hidden_size: 256
2025-11-05 00:12:20,992: initial_forget_bias: 3
2025-11-05 00:12:20,993: output_dropout: 0.4
2025-11-05 00:12:20,994: num_layers: 1
2025-11-05 00:12:20,996: dev_mode: True
2025-11-05 00:12:20,997: optimizer: Adam
2025-11-05 00:12:20,998: loss: NSE
2025-11-05 00:12:20,999: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:12:21,000: batch_size: 64
2025-11-05 00:12:21,001: epochs: 16
2025-11-05 00:12:21,002: clip_gradient_norm: 1
2025-11-05 00:12:21,004: predict_last_n: 1
2025-11-05 00:12:21,005: seq_length: 90
2025-11-05 00:12:21,006: log_interval: 16
2025-11-05 00:12:21,006: log_tensorboard: True
2025-11-05 00:12:21,008: log_n_figures: 1
2025-11-05 00:12:21,008: save_weights_every: 16
2025-11-05 00:12:21,009: early_stopping: True
2025-11-05 00:12:21,011: early_stopping_mode: patience
2025-11-05 00:12:21,012: patience_early_stopping: 3
2025-11-05 00:12:21,012: min_delta_early_stopping: 0.0
2025-11-05 00:12:21,013: minimum_epochs_before_early_stopping: 10
2025-11-05 00:12:21,014: early_stopping_slope_window: 7
2025-11-05 00:12:21,015: early_stopping_slope_patience: 2
2025-11-05 00:12:21,016: early_stopping_slope_min_epoch: 8
2025-11-05 00:12:21,016: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:12:21,017: early_stopping_slope_use_log: True
2025-11-05 00:12:21,018: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:12:21,018: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:12:21,019: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:12:21,020: early_stopping_slope_variance_guard: True
2025-11-05 00:12:21,020: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:12:21,021: dataset: russian_river
2025-11-05 00:12:21,022: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:12:21,023: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:12:21,025: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:12:21,026: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:12:21,027: hourly: False
2025-11-05 00:12:21,028: is_mts: False
2025-11-05 00:12:21,029: is_mts_data: False
2025-11-05 00:12:21,030: verbose: True
2025-11-05 00:12:21,031: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220
2025-11-05 00:12:21,031: run_label: BASELINE
2025-11-05 00:12:21,033: number_of_basins: 1
2025-11-05 00:12:21,034: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\train_data
2025-11-05 00:12:21,034: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\img_log
2025-11-05 00:12:21,036: ### Device cuda:0 will be used for training
2025-11-05 00:12:21,037: Loading basin data into xarray data set.
2025-11-05 00:12:21,178: Calculating target variable stds per basin
2025-11-05 00:12:21,187: Create lookup table and convert to pytorch tensor
2025-11-05 00:12:21,317: Early stopping enabled: mode=patience
2025-11-05 00:12:21,944: Epoch 1 average loss: avg_loss: 4.51e-06, avg_total_loss: 4.51e-06
2025-11-05 00:12:22,563: Epoch 2 average loss: avg_loss: 2.94e-06, avg_total_loss: 2.94e-06
2025-11-05 00:12:23,159: Epoch 3 average loss: avg_loss: 1.88e-06, avg_total_loss: 1.88e-06
2025-11-05 00:12:23,750: Epoch 4 average loss: avg_loss: 1.46e-06, avg_total_loss: 1.46e-06
2025-11-05 00:12:24,320: Epoch 5 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:12:24,761: Epoch 5 average validation loss: 1.45e-06 -- Median validation metrics: avg_loss: 1.45e-06, NSE: 0.67401, MSE: 55846.61719
2025-11-05 00:12:25,319: Epoch 6 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:12:25,864: Epoch 7 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:12:25,865: Setting learning rate to 0.005
2025-11-05 00:12:26,424: Epoch 8 average loss: avg_loss: 9.33e-07, avg_total_loss: 9.33e-07
2025-11-05 00:12:26,953: Epoch 9 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:12:27,507: Epoch 10 average loss: avg_loss: 8.46e-07, avg_total_loss: 8.46e-07
2025-11-05 00:12:27,818: Epoch 10 average validation loss: 1.06e-06 -- Median validation metrics: avg_loss: 1.06e-06, NSE: 0.75618, MSE: 41768.59375
2025-11-05 00:12:28,329: Epoch 11 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:12:28,330: Setting learning rate to 0.001
2025-11-05 00:12:28,881: Epoch 12 average loss: avg_loss: 7.02e-07, avg_total_loss: 7.02e-07
2025-11-05 00:12:29,421: Epoch 13 average loss: avg_loss: 6.93e-07, avg_total_loss: 6.93e-07
2025-11-05 00:12:29,960: Epoch 14 average loss: avg_loss: 6.18e-07, avg_total_loss: 6.18e-07
2025-11-05 00:12:30,565: Epoch 15 average loss: avg_loss: 6.87e-07, avg_total_loss: 6.87e-07
2025-11-05 00:12:30,870: Epoch 15 average validation loss: 9.74e-07 -- Median validation metrics: avg_loss: 9.74e-07, NSE: 0.77660, MSE: 38271.95703
2025-11-05 00:12:31,416: Epoch 16 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:12:31,440: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\model_epoch016.pt
2025-11-05 00:12:31,664: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:12:31,665: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001220\validation\model_epoch016\validation_results.p
2025-11-05 00:12:32,332: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\output.log initialized.
2025-11-05 00:12:32,333: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232
2025-11-05 00:12:32,334: ### Run configurations for testing_run
2025-11-05 00:12:32,335: experiment_name: testing_run
2025-11-05 00:12:32,335: train_basin_file: calpella
2025-11-05 00:12:32,336: validation_basin_file: calpella
2025-11-05 00:12:32,337: test_basin_file: calpella
2025-11-05 00:12:32,337: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:12:32,338: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:12:32,339: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:12:32,340: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:12:32,340: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:12:32,341: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:12:32,342: device: cuda:0
2025-11-05 00:12:32,343: physics_informed: False
2025-11-05 00:12:32,344: physics_data_file: None
2025-11-05 00:12:32,345: validate_every: 5
2025-11-05 00:12:32,346: validate_n_random_basins: 1
2025-11-05 00:12:32,347: metrics: ['NSE', 'MSE']
2025-11-05 00:12:32,347: model: cudalstm
2025-11-05 00:12:32,348: head: regression
2025-11-05 00:12:32,349: output_activation: linear
2025-11-05 00:12:32,349: hidden_size: 256
2025-11-05 00:12:32,350: initial_forget_bias: 3
2025-11-05 00:12:32,351: output_dropout: 0.4
2025-11-05 00:12:32,352: num_layers: 1
2025-11-05 00:12:32,352: dev_mode: True
2025-11-05 00:12:32,353: optimizer: Adam
2025-11-05 00:12:32,353: loss: NSE
2025-11-05 00:12:32,354: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:12:32,355: batch_size: 128
2025-11-05 00:12:32,356: epochs: 16
2025-11-05 00:12:32,356: clip_gradient_norm: 1
2025-11-05 00:12:32,356: predict_last_n: 1
2025-11-05 00:12:32,358: seq_length: 90
2025-11-05 00:12:32,359: log_interval: 16
2025-11-05 00:12:32,359: log_tensorboard: True
2025-11-05 00:12:32,360: log_n_figures: 1
2025-11-05 00:12:32,361: save_weights_every: 16
2025-11-05 00:12:32,362: early_stopping: True
2025-11-05 00:12:32,363: early_stopping_mode: patience
2025-11-05 00:12:32,363: patience_early_stopping: 3
2025-11-05 00:12:32,364: min_delta_early_stopping: 0.0
2025-11-05 00:12:32,365: minimum_epochs_before_early_stopping: 10
2025-11-05 00:12:32,366: early_stopping_slope_window: 7
2025-11-05 00:12:32,366: early_stopping_slope_patience: 2
2025-11-05 00:12:32,367: early_stopping_slope_min_epoch: 8
2025-11-05 00:12:32,368: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:12:32,369: early_stopping_slope_use_log: True
2025-11-05 00:12:32,369: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:12:32,370: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:12:32,371: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:12:32,372: early_stopping_slope_variance_guard: True
2025-11-05 00:12:32,372: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:12:32,374: dataset: russian_river
2025-11-05 00:12:32,374: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:12:32,375: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:12:32,376: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:12:32,376: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:12:32,377: hourly: False
2025-11-05 00:12:32,377: is_mts: False
2025-11-05 00:12:32,378: is_mts_data: False
2025-11-05 00:12:32,379: verbose: True
2025-11-05 00:12:32,380: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232
2025-11-05 00:12:32,380: run_label: BASELINE
2025-11-05 00:12:32,381: number_of_basins: 1
2025-11-05 00:12:32,382: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\train_data
2025-11-05 00:12:32,383: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\img_log
2025-11-05 00:12:32,386: ### Device cuda:0 will be used for training
2025-11-05 00:12:32,387: Loading basin data into xarray data set.
2025-11-05 00:12:32,536: Calculating target variable stds per basin
2025-11-05 00:12:32,546: Create lookup table and convert to pytorch tensor
2025-11-05 00:12:32,662: Early stopping enabled: mode=patience
2025-11-05 00:12:33,000: Epoch 1 average loss: avg_loss: 4.41e-06, avg_total_loss: 4.41e-06
2025-11-05 00:12:33,353: Epoch 2 average loss: avg_loss: 3.09e-06, avg_total_loss: 3.09e-06
2025-11-05 00:12:33,686: Epoch 3 average loss: avg_loss: 2.20e-06, avg_total_loss: 2.20e-06
2025-11-05 00:12:34,045: Epoch 4 average loss: avg_loss: 1.76e-06, avg_total_loss: 1.76e-06
2025-11-05 00:12:34,348: Epoch 5 average loss: avg_loss: 1.43e-06, avg_total_loss: 1.43e-06
2025-11-05 00:12:34,809: Epoch 5 average validation loss: 1.23e-06 -- Median validation metrics: avg_loss: 1.23e-06, NSE: 0.71850, MSE: 48223.61719
2025-11-05 00:12:35,102: Epoch 6 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:12:35,422: Epoch 7 average loss: avg_loss: 1.20e-06, avg_total_loss: 1.20e-06
2025-11-05 00:12:35,423: Setting learning rate to 0.005
2025-11-05 00:12:35,712: Epoch 8 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:12:36,020: Epoch 9 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:12:36,340: Epoch 10 average loss: avg_loss: 8.67e-07, avg_total_loss: 8.67e-07
2025-11-05 00:12:36,624: Epoch 10 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76612, MSE: 40066.23047
2025-11-05 00:12:36,896: Epoch 11 average loss: avg_loss: 8.70e-07, avg_total_loss: 8.70e-07
2025-11-05 00:12:36,897: Setting learning rate to 0.001
2025-11-05 00:12:37,214: Epoch 12 average loss: avg_loss: 7.29e-07, avg_total_loss: 7.29e-07
2025-11-05 00:12:37,516: Epoch 13 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:12:37,793: Epoch 14 average loss: avg_loss: 7.37e-07, avg_total_loss: 7.37e-07
2025-11-05 00:12:38,094: Epoch 15 average loss: avg_loss: 7.78e-07, avg_total_loss: 7.78e-07
2025-11-05 00:12:38,347: Epoch 15 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76772, MSE: 39792.65234
2025-11-05 00:12:38,641: Epoch 16 average loss: avg_loss: 6.21e-07, avg_total_loss: 6.21e-07
2025-11-05 00:12:38,666: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\model_epoch016.pt
2025-11-05 00:12:38,864: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:12:38,866: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001232\validation\model_epoch016\validation_results.p
2025-11-05 00:12:39,513: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\output.log initialized.
2025-11-05 00:12:39,514: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239
2025-11-05 00:12:39,516: ### Run configurations for testing_run
2025-11-05 00:12:39,517: experiment_name: testing_run
2025-11-05 00:12:39,518: train_basin_file: calpella
2025-11-05 00:12:39,519: validation_basin_file: calpella
2025-11-05 00:12:39,520: test_basin_file: calpella
2025-11-05 00:12:39,521: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:12:39,522: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:12:39,522: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:12:39,523: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:12:39,524: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:12:39,524: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:12:39,525: device: cuda:0
2025-11-05 00:12:39,526: physics_informed: False
2025-11-05 00:12:39,526: physics_data_file: None
2025-11-05 00:12:39,527: validate_every: 5
2025-11-05 00:12:39,527: validate_n_random_basins: 1
2025-11-05 00:12:39,528: metrics: ['NSE', 'MSE']
2025-11-05 00:12:39,528: model: cudalstm
2025-11-05 00:12:39,529: head: regression
2025-11-05 00:12:39,529: output_activation: linear
2025-11-05 00:12:39,530: hidden_size: 256
2025-11-05 00:12:39,531: initial_forget_bias: 3
2025-11-05 00:12:39,532: output_dropout: 0.4
2025-11-05 00:12:39,533: num_layers: 1
2025-11-05 00:12:39,534: dev_mode: True
2025-11-05 00:12:39,535: optimizer: Adam
2025-11-05 00:12:39,536: loss: NSE
2025-11-05 00:12:39,537: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:12:39,538: batch_size: 256
2025-11-05 00:12:39,539: epochs: 16
2025-11-05 00:12:39,540: clip_gradient_norm: 1
2025-11-05 00:12:39,541: predict_last_n: 1
2025-11-05 00:12:39,543: seq_length: 90
2025-11-05 00:12:39,543: log_interval: 16
2025-11-05 00:12:39,544: log_tensorboard: True
2025-11-05 00:12:39,545: log_n_figures: 1
2025-11-05 00:12:39,546: save_weights_every: 16
2025-11-05 00:12:39,548: early_stopping: True
2025-11-05 00:12:39,549: early_stopping_mode: patience
2025-11-05 00:12:39,551: patience_early_stopping: 3
2025-11-05 00:12:39,552: min_delta_early_stopping: 0.0
2025-11-05 00:12:39,554: minimum_epochs_before_early_stopping: 10
2025-11-05 00:12:39,555: early_stopping_slope_window: 7
2025-11-05 00:12:39,556: early_stopping_slope_patience: 2
2025-11-05 00:12:39,558: early_stopping_slope_min_epoch: 8
2025-11-05 00:12:39,559: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:12:39,561: early_stopping_slope_use_log: True
2025-11-05 00:12:39,562: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:12:39,564: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:12:39,565: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:12:39,566: early_stopping_slope_variance_guard: True
2025-11-05 00:12:39,568: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:12:39,569: dataset: russian_river
2025-11-05 00:12:39,569: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:12:39,570: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:12:39,571: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:12:39,573: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:12:39,573: hourly: False
2025-11-05 00:12:39,574: is_mts: False
2025-11-05 00:12:39,575: is_mts_data: False
2025-11-05 00:12:39,576: verbose: True
2025-11-05 00:12:39,577: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239
2025-11-05 00:12:39,578: run_label: BASELINE
2025-11-05 00:12:39,579: number_of_basins: 1
2025-11-05 00:12:39,581: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\train_data
2025-11-05 00:12:39,582: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\img_log
2025-11-05 00:12:39,584: ### Device cuda:0 will be used for training
2025-11-05 00:12:39,585: Loading basin data into xarray data set.
2025-11-05 00:12:39,727: Calculating target variable stds per basin
2025-11-05 00:12:39,734: Create lookup table and convert to pytorch tensor
2025-11-05 00:12:39,838: Early stopping enabled: mode=patience
2025-11-05 00:12:40,074: Epoch 1 average loss: avg_loss: 4.42e-06, avg_total_loss: 4.42e-06
2025-11-05 00:12:40,301: Epoch 2 average loss: avg_loss: 2.67e-06, avg_total_loss: 2.67e-06
2025-11-05 00:12:40,513: Epoch 3 average loss: avg_loss: 1.69e-06, avg_total_loss: 1.69e-06
2025-11-05 00:12:40,699: Epoch 4 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:12:40,888: Epoch 5 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:12:41,394: Epoch 5 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.74232, MSE: 44143.12891
2025-11-05 00:12:41,568: Epoch 6 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:12:41,774: Epoch 7 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:12:41,774: Setting learning rate to 0.005
2025-11-05 00:12:41,967: Epoch 8 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:12:42,149: Epoch 9 average loss: avg_loss: 9.38e-07, avg_total_loss: 9.38e-07
2025-11-05 00:12:42,352: Epoch 10 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:12:42,619: Epoch 10 average validation loss: 8.02e-07 -- Median validation metrics: avg_loss: 8.02e-07, NSE: 0.79774, MSE: 34649.48828
2025-11-05 00:12:42,807: Epoch 11 average loss: avg_loss: 8.33e-07, avg_total_loss: 8.33e-07
2025-11-05 00:12:42,807: Setting learning rate to 0.001
2025-11-05 00:12:43,008: Epoch 12 average loss: avg_loss: 8.13e-07, avg_total_loss: 8.13e-07
2025-11-05 00:12:43,202: Epoch 13 average loss: avg_loss: 7.63e-07, avg_total_loss: 7.63e-07
2025-11-05 00:12:43,387: Epoch 14 average loss: avg_loss: 7.43e-07, avg_total_loss: 7.43e-07
2025-11-05 00:12:43,596: Epoch 15 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:12:43,869: Epoch 15 average validation loss: 8.55e-07 -- Median validation metrics: avg_loss: 8.55e-07, NSE: 0.78314, MSE: 37150.61328
2025-11-05 00:12:44,049: Epoch 16 average loss: avg_loss: 7.06e-07, avg_total_loss: 7.06e-07
2025-11-05 00:12:44,068: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\model_epoch016.pt
2025-11-05 00:12:44,251: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:12:44,252: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001239\validation\model_epoch016\validation_results.p
2025-11-05 00:12:44,927: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\output.log initialized.
2025-11-05 00:12:44,928: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244
2025-11-05 00:12:44,929: ### Run configurations for testing_run
2025-11-05 00:12:44,930: experiment_name: testing_run
2025-11-05 00:12:44,931: train_basin_file: calpella
2025-11-05 00:12:44,932: validation_basin_file: calpella
2025-11-05 00:12:44,932: test_basin_file: calpella
2025-11-05 00:12:44,933: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:12:44,934: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:12:44,934: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:12:44,935: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:12:44,936: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:12:44,936: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:12:44,937: device: cuda:0
2025-11-05 00:12:44,938: physics_informed: False
2025-11-05 00:12:44,938: physics_data_file: None
2025-11-05 00:12:44,939: validate_every: 5
2025-11-05 00:12:44,940: validate_n_random_basins: 1
2025-11-05 00:12:44,941: metrics: ['NSE', 'MSE']
2025-11-05 00:12:44,942: model: cudalstm
2025-11-05 00:12:44,942: head: regression
2025-11-05 00:12:44,943: output_activation: linear
2025-11-05 00:12:44,944: hidden_size: 256
2025-11-05 00:12:44,944: initial_forget_bias: 3
2025-11-05 00:12:44,945: output_dropout: 0.4
2025-11-05 00:12:44,946: num_layers: 1
2025-11-05 00:12:44,947: dev_mode: True
2025-11-05 00:12:44,947: optimizer: Adam
2025-11-05 00:12:44,948: loss: NSE
2025-11-05 00:12:44,949: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:12:44,950: batch_size: 64
2025-11-05 00:12:44,951: epochs: 32
2025-11-05 00:12:44,952: clip_gradient_norm: 1
2025-11-05 00:12:44,953: predict_last_n: 1
2025-11-05 00:12:44,953: seq_length: 90
2025-11-05 00:12:44,955: log_interval: 16
2025-11-05 00:12:44,956: log_tensorboard: True
2025-11-05 00:12:44,957: log_n_figures: 1
2025-11-05 00:12:44,958: save_weights_every: 32
2025-11-05 00:12:44,958: early_stopping: True
2025-11-05 00:12:44,959: early_stopping_mode: patience
2025-11-05 00:12:44,960: patience_early_stopping: 3
2025-11-05 00:12:44,960: min_delta_early_stopping: 0.0
2025-11-05 00:12:44,962: minimum_epochs_before_early_stopping: 10
2025-11-05 00:12:44,962: early_stopping_slope_window: 7
2025-11-05 00:12:44,963: early_stopping_slope_patience: 2
2025-11-05 00:12:44,964: early_stopping_slope_min_epoch: 8
2025-11-05 00:12:44,965: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:12:44,966: early_stopping_slope_use_log: True
2025-11-05 00:12:44,967: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:12:44,968: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:12:44,969: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:12:44,970: early_stopping_slope_variance_guard: True
2025-11-05 00:12:44,971: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:12:44,972: dataset: russian_river
2025-11-05 00:12:44,973: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:12:44,974: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:12:44,974: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:12:44,975: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:12:44,976: hourly: False
2025-11-05 00:12:44,977: is_mts: False
2025-11-05 00:12:44,978: is_mts_data: False
2025-11-05 00:12:44,979: verbose: True
2025-11-05 00:12:44,980: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244
2025-11-05 00:12:44,981: run_label: BASELINE
2025-11-05 00:12:44,982: number_of_basins: 1
2025-11-05 00:12:44,983: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\train_data
2025-11-05 00:12:44,983: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\img_log
2025-11-05 00:12:44,986: ### Device cuda:0 will be used for training
2025-11-05 00:12:44,987: Loading basin data into xarray data set.
2025-11-05 00:12:45,134: Calculating target variable stds per basin
2025-11-05 00:12:45,143: Create lookup table and convert to pytorch tensor
2025-11-05 00:12:45,253: Early stopping enabled: mode=patience
2025-11-05 00:12:45,846: Epoch 1 average loss: avg_loss: 3.55e-06, avg_total_loss: 3.55e-06
2025-11-05 00:12:46,457: Epoch 2 average loss: avg_loss: 1.61e-06, avg_total_loss: 1.61e-06
2025-11-05 00:12:47,079: Epoch 3 average loss: avg_loss: 1.31e-06, avg_total_loss: 1.31e-06
2025-11-05 00:12:47,686: Epoch 4 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:12:48,288: Epoch 5 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:12:48,704: Epoch 5 average validation loss: 9.95e-07 -- Median validation metrics: avg_loss: 9.95e-07, NSE: 0.77153, MSE: 39140.33984
2025-11-05 00:12:49,262: Epoch 6 average loss: avg_loss: 1.12e-06, avg_total_loss: 1.12e-06
2025-11-05 00:12:49,832: Epoch 7 average loss: avg_loss: 9.67e-07, avg_total_loss: 9.67e-07
2025-11-05 00:12:50,384: Epoch 8 average loss: avg_loss: 8.84e-07, avg_total_loss: 8.84e-07
2025-11-05 00:12:50,976: Epoch 9 average loss: avg_loss: 9.26e-07, avg_total_loss: 9.26e-07
2025-11-05 00:12:51,529: Epoch 10 average loss: avg_loss: 9.22e-07, avg_total_loss: 9.22e-07
2025-11-05 00:12:51,828: Epoch 10 average validation loss: 1.11e-06 -- Median validation metrics: avg_loss: 1.11e-06, NSE: 0.74489, MSE: 43703.89062
2025-11-05 00:12:52,357: Epoch 11 average loss: avg_loss: 9.89e-07, avg_total_loss: 9.89e-07
2025-11-05 00:12:52,936: Epoch 12 average loss: avg_loss: 8.32e-07, avg_total_loss: 8.32e-07
2025-11-05 00:12:53,522: Epoch 13 average loss: avg_loss: 8.69e-07, avg_total_loss: 8.69e-07
2025-11-05 00:12:54,078: Epoch 14 average loss: avg_loss: 6.77e-07, avg_total_loss: 6.77e-07
2025-11-05 00:12:54,657: Epoch 15 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:12:54,981: Epoch 15 average validation loss: 9.37e-07 -- Median validation metrics: avg_loss: 9.37e-07, NSE: 0.78446, MSE: 36924.37109
2025-11-05 00:12:54,982: Setting learning rate to 0.005
2025-11-05 00:12:55,530: Epoch 16 average loss: avg_loss: 6.12e-07, avg_total_loss: 6.12e-07
2025-11-05 00:12:56,061: Epoch 17 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:12:56,616: Epoch 18 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:12:57,137: Epoch 19 average loss: avg_loss: 4.61e-07, avg_total_loss: 4.61e-07
2025-11-05 00:12:57,693: Epoch 20 average loss: avg_loss: 4.87e-07, avg_total_loss: 4.87e-07
2025-11-05 00:12:58,026: Epoch 20 average validation loss: 8.80e-07 -- Median validation metrics: avg_loss: 8.80e-07, NSE: 0.79800, MSE: 34604.81250
2025-11-05 00:12:58,564: Epoch 21 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:12:59,138: Epoch 22 average loss: avg_loss: 3.74e-07, avg_total_loss: 3.74e-07
2025-11-05 00:12:59,679: Epoch 23 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:12:59,680: Setting learning rate to 0.001
2025-11-05 00:13:00,232: Epoch 24 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:13:00,819: Epoch 25 average loss: avg_loss: 3.89e-07, avg_total_loss: 3.89e-07
2025-11-05 00:13:01,156: Epoch 25 average validation loss: 8.89e-07 -- Median validation metrics: avg_loss: 8.89e-07, NSE: 0.79537, MSE: 35055.54297
2025-11-05 00:13:01,684: Epoch 26 average loss: avg_loss: 3.70e-07, avg_total_loss: 3.70e-07
2025-11-05 00:13:02,229: Epoch 27 average loss: avg_loss: 3.34e-07, avg_total_loss: 3.34e-07
2025-11-05 00:13:02,793: Epoch 28 average loss: avg_loss: 3.31e-07, avg_total_loss: 3.31e-07
2025-11-05 00:13:03,334: Epoch 29 average loss: avg_loss: 3.53e-07, avg_total_loss: 3.53e-07
2025-11-05 00:13:03,892: Epoch 30 average loss: avg_loss: 3.23e-07, avg_total_loss: 3.23e-07
2025-11-05 00:13:04,211: Epoch 30 average validation loss: 9.65e-07 -- Median validation metrics: avg_loss: 9.65e-07, NSE: 0.77813, MSE: 38009.04688
2025-11-05 00:13:04,769: Epoch 31 average loss: avg_loss: 3.08e-07, avg_total_loss: 3.08e-07
2025-11-05 00:13:05,356: Epoch 32 average loss: avg_loss: 3.08e-07, avg_total_loss: 3.08e-07
2025-11-05 00:13:05,376: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\model_epoch032.pt
2025-11-05 00:13:05,595: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:13:05,597: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001244\validation\model_epoch032\validation_results.p
2025-11-05 00:13:06,296: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\output.log initialized.
2025-11-05 00:13:06,297: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306
2025-11-05 00:13:06,297: ### Run configurations for testing_run
2025-11-05 00:13:06,298: experiment_name: testing_run
2025-11-05 00:13:06,299: train_basin_file: calpella
2025-11-05 00:13:06,300: validation_basin_file: calpella
2025-11-05 00:13:06,301: test_basin_file: calpella
2025-11-05 00:13:06,302: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:13:06,302: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:13:06,303: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:13:06,304: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:13:06,304: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:13:06,305: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:13:06,305: device: cuda:0
2025-11-05 00:13:06,306: physics_informed: False
2025-11-05 00:13:06,307: physics_data_file: None
2025-11-05 00:13:06,308: validate_every: 5
2025-11-05 00:13:06,308: validate_n_random_basins: 1
2025-11-05 00:13:06,309: metrics: ['NSE', 'MSE']
2025-11-05 00:13:06,310: model: cudalstm
2025-11-05 00:13:06,311: head: regression
2025-11-05 00:13:06,311: output_activation: linear
2025-11-05 00:13:06,312: hidden_size: 256
2025-11-05 00:13:06,313: initial_forget_bias: 3
2025-11-05 00:13:06,313: output_dropout: 0.4
2025-11-05 00:13:06,314: num_layers: 1
2025-11-05 00:13:06,315: dev_mode: True
2025-11-05 00:13:06,315: optimizer: Adam
2025-11-05 00:13:06,316: loss: NSE
2025-11-05 00:13:06,317: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:13:06,318: batch_size: 128
2025-11-05 00:13:06,318: epochs: 32
2025-11-05 00:13:06,319: clip_gradient_norm: 1
2025-11-05 00:13:06,320: predict_last_n: 1
2025-11-05 00:13:06,320: seq_length: 90
2025-11-05 00:13:06,321: log_interval: 16
2025-11-05 00:13:06,322: log_tensorboard: True
2025-11-05 00:13:06,323: log_n_figures: 1
2025-11-05 00:13:06,323: save_weights_every: 32
2025-11-05 00:13:06,324: early_stopping: True
2025-11-05 00:13:06,324: early_stopping_mode: patience
2025-11-05 00:13:06,325: patience_early_stopping: 3
2025-11-05 00:13:06,326: min_delta_early_stopping: 0.0
2025-11-05 00:13:06,326: minimum_epochs_before_early_stopping: 10
2025-11-05 00:13:06,327: early_stopping_slope_window: 7
2025-11-05 00:13:06,327: early_stopping_slope_patience: 2
2025-11-05 00:13:06,328: early_stopping_slope_min_epoch: 8
2025-11-05 00:13:06,329: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:13:06,329: early_stopping_slope_use_log: True
2025-11-05 00:13:06,330: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:13:06,331: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:13:06,331: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:13:06,332: early_stopping_slope_variance_guard: True
2025-11-05 00:13:06,333: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:13:06,334: dataset: russian_river
2025-11-05 00:13:06,335: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:13:06,336: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:13:06,337: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:13:06,338: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:13:06,340: hourly: False
2025-11-05 00:13:06,341: is_mts: False
2025-11-05 00:13:06,342: is_mts_data: False
2025-11-05 00:13:06,343: verbose: True
2025-11-05 00:13:06,345: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306
2025-11-05 00:13:06,346: run_label: BASELINE
2025-11-05 00:13:06,348: number_of_basins: 1
2025-11-05 00:13:06,349: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\train_data
2025-11-05 00:13:06,350: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\img_log
2025-11-05 00:13:06,353: ### Device cuda:0 will be used for training
2025-11-05 00:13:06,355: Loading basin data into xarray data set.
2025-11-05 00:13:06,509: Calculating target variable stds per basin
2025-11-05 00:13:06,517: Create lookup table and convert to pytorch tensor
2025-11-05 00:13:06,637: Early stopping enabled: mode=patience
2025-11-05 00:13:07,097: Epoch 1 average loss: avg_loss: 3.92e-06, avg_total_loss: 3.92e-06
2025-11-05 00:13:07,393: Epoch 2 average loss: avg_loss: 1.92e-06, avg_total_loss: 1.92e-06
2025-11-05 00:13:07,703: Epoch 3 average loss: avg_loss: 1.57e-06, avg_total_loss: 1.57e-06
2025-11-05 00:13:08,006: Epoch 4 average loss: avg_loss: 1.31e-06, avg_total_loss: 1.31e-06
2025-11-05 00:13:08,328: Epoch 5 average loss: avg_loss: 1.17e-06, avg_total_loss: 1.17e-06
2025-11-05 00:13:08,751: Epoch 5 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.76841, MSE: 39673.97656
2025-11-05 00:13:09,036: Epoch 6 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:13:09,322: Epoch 7 average loss: avg_loss: 9.37e-07, avg_total_loss: 9.37e-07
2025-11-05 00:13:09,622: Epoch 8 average loss: avg_loss: 9.16e-07, avg_total_loss: 9.16e-07
2025-11-05 00:13:09,895: Epoch 9 average loss: avg_loss: 8.87e-07, avg_total_loss: 8.87e-07
2025-11-05 00:13:10,188: Epoch 10 average loss: avg_loss: 7.84e-07, avg_total_loss: 7.84e-07
2025-11-05 00:13:10,451: Epoch 10 average validation loss: 8.93e-07 -- Median validation metrics: avg_loss: 8.93e-07, NSE: 0.79499, MSE: 35121.00391
2025-11-05 00:13:10,746: Epoch 11 average loss: avg_loss: 7.63e-07, avg_total_loss: 7.63e-07
2025-11-05 00:13:11,035: Epoch 12 average loss: avg_loss: 8.83e-07, avg_total_loss: 8.83e-07
2025-11-05 00:13:11,346: Epoch 13 average loss: avg_loss: 7.69e-07, avg_total_loss: 7.69e-07
2025-11-05 00:13:11,615: Epoch 14 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:13:11,930: Epoch 15 average loss: avg_loss: 1.98e-06, avg_total_loss: 1.98e-06
2025-11-05 00:13:12,230: Epoch 15 average validation loss: 1.14e-06 -- Median validation metrics: avg_loss: 1.14e-06, NSE: 0.73840, MSE: 44815.50781
2025-11-05 00:13:12,232: Setting learning rate to 0.005
2025-11-05 00:13:12,533: Epoch 16 average loss: avg_loss: 1.27e-06, avg_total_loss: 1.27e-06
2025-11-05 00:13:12,814: Epoch 17 average loss: avg_loss: 9.54e-07, avg_total_loss: 9.54e-07
2025-11-05 00:13:13,106: Epoch 18 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:13:13,418: Epoch 19 average loss: avg_loss: 8.15e-07, avg_total_loss: 8.15e-07
2025-11-05 00:13:13,696: Epoch 20 average loss: avg_loss: 6.89e-07, avg_total_loss: 6.89e-07
2025-11-05 00:13:13,965: Epoch 20 average validation loss: 8.23e-07 -- Median validation metrics: avg_loss: 8.23e-07, NSE: 0.81144, MSE: 32303.20312
2025-11-05 00:13:14,268: Epoch 21 average loss: avg_loss: 7.45e-07, avg_total_loss: 7.45e-07
2025-11-05 00:13:14,577: Epoch 22 average loss: avg_loss: 6.94e-07, avg_total_loss: 6.94e-07
2025-11-05 00:13:14,868: Epoch 23 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:13:14,869: Setting learning rate to 0.001
2025-11-05 00:13:15,172: Epoch 24 average loss: avg_loss: 6.36e-07, avg_total_loss: 6.36e-07
2025-11-05 00:13:15,464: Epoch 25 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:13:15,764: Epoch 25 average validation loss: 9.15e-07 -- Median validation metrics: avg_loss: 9.15e-07, NSE: 0.78982, MSE: 36006.14062
2025-11-05 00:13:16,046: Epoch 26 average loss: avg_loss: 6.03e-07, avg_total_loss: 6.03e-07
2025-11-05 00:13:16,350: Epoch 27 average loss: avg_loss: 5.53e-07, avg_total_loss: 5.53e-07
2025-11-05 00:13:16,650: Epoch 28 average loss: avg_loss: 5.59e-07, avg_total_loss: 5.59e-07
2025-11-05 00:13:16,925: Epoch 29 average loss: avg_loss: 5.22e-07, avg_total_loss: 5.22e-07
2025-11-05 00:13:17,211: Epoch 30 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:13:17,477: Epoch 30 average validation loss: 9.77e-07 -- Median validation metrics: avg_loss: 9.77e-07, NSE: 0.77585, MSE: 38398.95703
2025-11-05 00:13:17,768: Epoch 31 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:13:18,058: Epoch 32 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:13:18,080: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\model_epoch032.pt
2025-11-05 00:13:18,290: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:13:18,291: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001306\validation\model_epoch032\validation_results.p
2025-11-05 00:13:18,987: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\output.log initialized.
2025-11-05 00:13:18,989: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318
2025-11-05 00:13:18,990: ### Run configurations for testing_run
2025-11-05 00:13:18,991: experiment_name: testing_run
2025-11-05 00:13:18,992: train_basin_file: calpella
2025-11-05 00:13:18,993: validation_basin_file: calpella
2025-11-05 00:13:18,994: test_basin_file: calpella
2025-11-05 00:13:18,994: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:13:18,995: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:13:18,996: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:13:18,996: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:13:18,997: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:13:18,998: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:13:18,998: device: cuda:0
2025-11-05 00:13:18,999: physics_informed: False
2025-11-05 00:13:19,000: physics_data_file: None
2025-11-05 00:13:19,000: validate_every: 5
2025-11-05 00:13:19,001: validate_n_random_basins: 1
2025-11-05 00:13:19,002: metrics: ['NSE', 'MSE']
2025-11-05 00:13:19,002: model: cudalstm
2025-11-05 00:13:19,003: head: regression
2025-11-05 00:13:19,004: output_activation: linear
2025-11-05 00:13:19,004: hidden_size: 256
2025-11-05 00:13:19,005: initial_forget_bias: 3
2025-11-05 00:13:19,005: output_dropout: 0.4
2025-11-05 00:13:19,006: num_layers: 1
2025-11-05 00:13:19,006: dev_mode: True
2025-11-05 00:13:19,007: optimizer: Adam
2025-11-05 00:13:19,008: loss: NSE
2025-11-05 00:13:19,008: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:13:19,009: batch_size: 256
2025-11-05 00:13:19,009: epochs: 32
2025-11-05 00:13:19,010: clip_gradient_norm: 1
2025-11-05 00:13:19,010: predict_last_n: 1
2025-11-05 00:13:19,011: seq_length: 90
2025-11-05 00:13:19,012: log_interval: 16
2025-11-05 00:13:19,012: log_tensorboard: True
2025-11-05 00:13:19,013: log_n_figures: 1
2025-11-05 00:13:19,014: save_weights_every: 32
2025-11-05 00:13:19,014: early_stopping: True
2025-11-05 00:13:19,015: early_stopping_mode: patience
2025-11-05 00:13:19,016: patience_early_stopping: 3
2025-11-05 00:13:19,017: min_delta_early_stopping: 0.0
2025-11-05 00:13:19,017: minimum_epochs_before_early_stopping: 10
2025-11-05 00:13:19,018: early_stopping_slope_window: 7
2025-11-05 00:13:19,019: early_stopping_slope_patience: 2
2025-11-05 00:13:19,019: early_stopping_slope_min_epoch: 8
2025-11-05 00:13:19,020: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:13:19,021: early_stopping_slope_use_log: True
2025-11-05 00:13:19,021: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:13:19,022: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:13:19,023: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:13:19,023: early_stopping_slope_variance_guard: True
2025-11-05 00:13:19,024: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:13:19,025: dataset: russian_river
2025-11-05 00:13:19,025: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:13:19,026: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:13:19,026: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:13:19,027: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:13:19,028: hourly: False
2025-11-05 00:13:19,028: is_mts: False
2025-11-05 00:13:19,029: is_mts_data: False
2025-11-05 00:13:19,029: verbose: True
2025-11-05 00:13:19,030: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318
2025-11-05 00:13:19,031: run_label: BASELINE
2025-11-05 00:13:19,032: number_of_basins: 1
2025-11-05 00:13:19,032: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\train_data
2025-11-05 00:13:19,033: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\img_log
2025-11-05 00:13:19,035: ### Device cuda:0 will be used for training
2025-11-05 00:13:19,035: Loading basin data into xarray data set.
2025-11-05 00:13:19,168: Calculating target variable stds per basin
2025-11-05 00:13:19,175: Create lookup table and convert to pytorch tensor
2025-11-05 00:13:19,276: Early stopping enabled: mode=patience
2025-11-05 00:13:19,480: Epoch 1 average loss: avg_loss: 4.26e-06, avg_total_loss: 4.26e-06
2025-11-05 00:13:19,664: Epoch 2 average loss: avg_loss: 2.74e-06, avg_total_loss: 2.74e-06
2025-11-05 00:13:19,851: Epoch 3 average loss: avg_loss: 1.96e-06, avg_total_loss: 1.96e-06
2025-11-05 00:13:20,071: Epoch 4 average loss: avg_loss: 1.61e-06, avg_total_loss: 1.61e-06
2025-11-05 00:13:20,272: Epoch 5 average loss: avg_loss: 1.26e-06, avg_total_loss: 1.26e-06
2025-11-05 00:13:20,794: Epoch 5 average validation loss: 1.14e-06 -- Median validation metrics: avg_loss: 1.14e-06, NSE: 0.71036, MSE: 49619.58203
2025-11-05 00:13:20,991: Epoch 6 average loss: avg_loss: 1.24e-06, avg_total_loss: 1.24e-06
2025-11-05 00:13:21,186: Epoch 7 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:13:21,374: Epoch 8 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:13:21,581: Epoch 9 average loss: avg_loss: 9.02e-07, avg_total_loss: 9.02e-07
2025-11-05 00:13:21,770: Epoch 10 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:13:22,042: Epoch 10 average validation loss: 7.93e-07 -- Median validation metrics: avg_loss: 7.93e-07, NSE: 0.80096, MSE: 34098.69922
2025-11-05 00:13:22,219: Epoch 11 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:13:22,419: Epoch 12 average loss: avg_loss: 7.16e-07, avg_total_loss: 7.16e-07
2025-11-05 00:13:22,606: Epoch 13 average loss: avg_loss: 7.40e-07, avg_total_loss: 7.40e-07
2025-11-05 00:13:22,788: Epoch 14 average loss: avg_loss: 7.23e-07, avg_total_loss: 7.23e-07
2025-11-05 00:13:22,992: Epoch 15 average loss: avg_loss: 8.09e-07, avg_total_loss: 8.09e-07
2025-11-05 00:13:23,252: Epoch 15 average validation loss: 9.41e-07 -- Median validation metrics: avg_loss: 9.41e-07, NSE: 0.75931, MSE: 41233.55469
2025-11-05 00:13:23,253: Setting learning rate to 0.005
2025-11-05 00:13:23,430: Epoch 16 average loss: avg_loss: 7.75e-07, avg_total_loss: 7.75e-07
2025-11-05 00:13:23,623: Epoch 17 average loss: avg_loss: 7.27e-07, avg_total_loss: 7.27e-07
2025-11-05 00:13:23,826: Epoch 18 average loss: avg_loss: 6.85e-07, avg_total_loss: 6.85e-07
2025-11-05 00:13:24,023: Epoch 19 average loss: avg_loss: 6.56e-07, avg_total_loss: 6.56e-07
2025-11-05 00:13:24,222: Epoch 20 average loss: avg_loss: 6.68e-07, avg_total_loss: 6.68e-07
2025-11-05 00:13:24,499: Epoch 20 average validation loss: 8.22e-07 -- Median validation metrics: avg_loss: 8.22e-07, NSE: 0.79096, MSE: 35811.69531
2025-11-05 00:13:24,681: Epoch 21 average loss: avg_loss: 6.71e-07, avg_total_loss: 6.71e-07
2025-11-05 00:13:24,864: Epoch 22 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:13:25,065: Epoch 23 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:13:25,066: Setting learning rate to 0.001
2025-11-05 00:13:25,248: Epoch 24 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:13:25,446: Epoch 25 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:13:25,728: Epoch 25 average validation loss: 8.78e-07 -- Median validation metrics: avg_loss: 8.78e-07, NSE: 0.77702, MSE: 38199.35938
2025-11-05 00:13:25,729: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:13:25,730: Early stopping triggered at epoch 25
2025-11-05 00:13:25,747: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\model_epoch025.pt
2025-11-05 00:13:25,920: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:13:25,921: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001318\validation\model_epoch025\validation_results.p
2025-11-05 00:13:26,582: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\output.log initialized.
2025-11-05 00:13:26,584: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326
2025-11-05 00:13:26,584: ### Run configurations for testing_run
2025-11-05 00:13:26,585: experiment_name: testing_run
2025-11-05 00:13:26,586: train_basin_file: calpella
2025-11-05 00:13:26,587: validation_basin_file: calpella
2025-11-05 00:13:26,588: test_basin_file: calpella
2025-11-05 00:13:26,589: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:13:26,589: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:13:26,590: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:13:26,590: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:13:26,592: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:13:26,592: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:13:26,594: device: cuda:0
2025-11-05 00:13:26,594: physics_informed: False
2025-11-05 00:13:26,596: physics_data_file: None
2025-11-05 00:13:26,597: validate_every: 5
2025-11-05 00:13:26,598: validate_n_random_basins: 1
2025-11-05 00:13:26,599: metrics: ['NSE', 'MSE']
2025-11-05 00:13:26,600: model: cudalstm
2025-11-05 00:13:26,601: head: regression
2025-11-05 00:13:26,602: output_activation: linear
2025-11-05 00:13:26,603: hidden_size: 256
2025-11-05 00:13:26,604: initial_forget_bias: 3
2025-11-05 00:13:26,605: output_dropout: 0.4
2025-11-05 00:13:26,606: num_layers: 1
2025-11-05 00:13:26,607: dev_mode: True
2025-11-05 00:13:26,608: optimizer: Adam
2025-11-05 00:13:26,608: loss: NSE
2025-11-05 00:13:26,609: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:13:26,609: batch_size: 64
2025-11-05 00:13:26,610: epochs: 48
2025-11-05 00:13:26,611: clip_gradient_norm: 1
2025-11-05 00:13:26,612: predict_last_n: 1
2025-11-05 00:13:26,612: seq_length: 90
2025-11-05 00:13:26,613: log_interval: 16
2025-11-05 00:13:26,613: log_tensorboard: True
2025-11-05 00:13:26,615: log_n_figures: 1
2025-11-05 00:13:26,615: save_weights_every: 48
2025-11-05 00:13:26,616: early_stopping: True
2025-11-05 00:13:26,617: early_stopping_mode: patience
2025-11-05 00:13:26,617: patience_early_stopping: 3
2025-11-05 00:13:26,618: min_delta_early_stopping: 0.0
2025-11-05 00:13:26,618: minimum_epochs_before_early_stopping: 10
2025-11-05 00:13:26,619: early_stopping_slope_window: 7
2025-11-05 00:13:26,620: early_stopping_slope_patience: 2
2025-11-05 00:13:26,621: early_stopping_slope_min_epoch: 8
2025-11-05 00:13:26,621: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:13:26,622: early_stopping_slope_use_log: True
2025-11-05 00:13:26,623: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:13:26,623: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:13:26,624: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:13:26,625: early_stopping_slope_variance_guard: True
2025-11-05 00:13:26,625: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:13:26,626: dataset: russian_river
2025-11-05 00:13:26,626: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:13:26,627: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:13:26,628: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:13:26,629: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:13:26,629: hourly: False
2025-11-05 00:13:26,630: is_mts: False
2025-11-05 00:13:26,631: is_mts_data: False
2025-11-05 00:13:26,632: verbose: True
2025-11-05 00:13:26,633: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326
2025-11-05 00:13:26,633: run_label: BASELINE
2025-11-05 00:13:26,634: number_of_basins: 1
2025-11-05 00:13:26,635: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\train_data
2025-11-05 00:13:26,635: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\img_log
2025-11-05 00:13:26,637: ### Device cuda:0 will be used for training
2025-11-05 00:13:26,638: Loading basin data into xarray data set.
2025-11-05 00:13:26,805: Calculating target variable stds per basin
2025-11-05 00:13:26,814: Create lookup table and convert to pytorch tensor
2025-11-05 00:13:26,933: Early stopping enabled: mode=patience
2025-11-05 00:13:27,471: Epoch 1 average loss: avg_loss: 3.43e-06, avg_total_loss: 3.43e-06
2025-11-05 00:13:28,042: Epoch 2 average loss: avg_loss: 1.59e-06, avg_total_loss: 1.59e-06
2025-11-05 00:13:28,604: Epoch 3 average loss: avg_loss: 1.21e-06, avg_total_loss: 1.21e-06
2025-11-05 00:13:29,193: Epoch 4 average loss: avg_loss: 1.33e-06, avg_total_loss: 1.33e-06
2025-11-05 00:13:29,773: Epoch 5 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:13:30,206: Epoch 5 average validation loss: 1.12e-06 -- Median validation metrics: avg_loss: 1.12e-06, NSE: 0.74160, MSE: 44267.12500
2025-11-05 00:13:30,758: Epoch 6 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:13:31,387: Epoch 7 average loss: avg_loss: 9.74e-07, avg_total_loss: 9.74e-07
2025-11-05 00:13:32,021: Epoch 8 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:13:32,628: Epoch 9 average loss: avg_loss: 8.64e-07, avg_total_loss: 8.64e-07
2025-11-05 00:13:33,256: Epoch 10 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:13:33,570: Epoch 10 average validation loss: 1.01e-06 -- Median validation metrics: avg_loss: 1.01e-06, NSE: 0.77012, MSE: 39381.93750
2025-11-05 00:13:34,189: Epoch 11 average loss: avg_loss: 1.22e-06, avg_total_loss: 1.22e-06
2025-11-05 00:13:34,887: Epoch 12 average loss: avg_loss: 2.21e-06, avg_total_loss: 2.21e-06
2025-11-05 00:13:35,507: Epoch 13 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:13:36,103: Epoch 14 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:13:36,706: Epoch 15 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:13:37,046: Epoch 15 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.75183, MSE: 42514.12500
2025-11-05 00:13:37,632: Epoch 16 average loss: avg_loss: 8.22e-07, avg_total_loss: 8.22e-07
2025-11-05 00:13:38,239: Epoch 17 average loss: avg_loss: 7.50e-07, avg_total_loss: 7.50e-07
2025-11-05 00:13:38,857: Epoch 18 average loss: avg_loss: 7.64e-07, avg_total_loss: 7.64e-07
2025-11-05 00:13:39,465: Epoch 19 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:13:40,054: Epoch 20 average loss: avg_loss: 7.30e-07, avg_total_loss: 7.30e-07
2025-11-05 00:13:40,353: Epoch 20 average validation loss: 1.14e-06 -- Median validation metrics: avg_loss: 1.14e-06, NSE: 0.73738, MSE: 44990.22656
2025-11-05 00:13:40,944: Epoch 21 average loss: avg_loss: 6.71e-07, avg_total_loss: 6.71e-07
2025-11-05 00:13:41,574: Epoch 22 average loss: avg_loss: 6.92e-07, avg_total_loss: 6.92e-07
2025-11-05 00:13:42,269: Epoch 23 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:13:42,269: Setting learning rate to 0.005
2025-11-05 00:13:42,855: Epoch 24 average loss: avg_loss: 5.93e-07, avg_total_loss: 5.93e-07
2025-11-05 00:13:43,455: Epoch 25 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:13:43,766: Epoch 25 average validation loss: 1.43e-06 -- Median validation metrics: avg_loss: 1.43e-06, NSE: 0.66979, MSE: 56568.46094
2025-11-05 00:13:43,767: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:13:43,769: Early stopping triggered at epoch 25
2025-11-05 00:13:43,788: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\model_epoch025.pt
2025-11-05 00:13:44,009: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:13:44,011: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001326\validation\model_epoch025\validation_results.p
2025-11-05 00:13:44,706: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\output.log initialized.
2025-11-05 00:13:44,707: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344
2025-11-05 00:13:44,708: ### Run configurations for testing_run
2025-11-05 00:13:44,709: experiment_name: testing_run
2025-11-05 00:13:44,709: train_basin_file: calpella
2025-11-05 00:13:44,710: validation_basin_file: calpella
2025-11-05 00:13:44,711: test_basin_file: calpella
2025-11-05 00:13:44,711: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:13:44,712: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:13:44,713: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:13:44,713: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:13:44,714: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:13:44,715: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:13:44,716: device: cuda:0
2025-11-05 00:13:44,717: physics_informed: False
2025-11-05 00:13:44,718: physics_data_file: None
2025-11-05 00:13:44,718: validate_every: 5
2025-11-05 00:13:44,719: validate_n_random_basins: 1
2025-11-05 00:13:44,720: metrics: ['NSE', 'MSE']
2025-11-05 00:13:44,721: model: cudalstm
2025-11-05 00:13:44,721: head: regression
2025-11-05 00:13:44,722: output_activation: linear
2025-11-05 00:13:44,723: hidden_size: 256
2025-11-05 00:13:44,723: initial_forget_bias: 3
2025-11-05 00:13:44,724: output_dropout: 0.4
2025-11-05 00:13:44,725: num_layers: 1
2025-11-05 00:13:44,725: dev_mode: True
2025-11-05 00:13:44,726: optimizer: Adam
2025-11-05 00:13:44,726: loss: NSE
2025-11-05 00:13:44,727: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:13:44,727: batch_size: 128
2025-11-05 00:13:44,728: epochs: 48
2025-11-05 00:13:44,729: clip_gradient_norm: 1
2025-11-05 00:13:44,729: predict_last_n: 1
2025-11-05 00:13:44,730: seq_length: 90
2025-11-05 00:13:44,731: log_interval: 16
2025-11-05 00:13:44,732: log_tensorboard: True
2025-11-05 00:13:44,733: log_n_figures: 1
2025-11-05 00:13:44,734: save_weights_every: 48
2025-11-05 00:13:44,735: early_stopping: True
2025-11-05 00:13:44,735: early_stopping_mode: patience
2025-11-05 00:13:44,736: patience_early_stopping: 3
2025-11-05 00:13:44,737: min_delta_early_stopping: 0.0
2025-11-05 00:13:44,738: minimum_epochs_before_early_stopping: 10
2025-11-05 00:13:44,738: early_stopping_slope_window: 7
2025-11-05 00:13:44,739: early_stopping_slope_patience: 2
2025-11-05 00:13:44,740: early_stopping_slope_min_epoch: 8
2025-11-05 00:13:44,740: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:13:44,741: early_stopping_slope_use_log: True
2025-11-05 00:13:44,742: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:13:44,743: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:13:44,744: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:13:44,745: early_stopping_slope_variance_guard: True
2025-11-05 00:13:44,746: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:13:44,748: dataset: russian_river
2025-11-05 00:13:44,748: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:13:44,749: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:13:44,750: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:13:44,751: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:13:44,752: hourly: False
2025-11-05 00:13:44,752: is_mts: False
2025-11-05 00:13:44,754: is_mts_data: False
2025-11-05 00:13:44,756: verbose: True
2025-11-05 00:13:44,757: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344
2025-11-05 00:13:44,758: run_label: BASELINE
2025-11-05 00:13:44,759: number_of_basins: 1
2025-11-05 00:13:44,761: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\train_data
2025-11-05 00:13:44,762: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\img_log
2025-11-05 00:13:44,766: ### Device cuda:0 will be used for training
2025-11-05 00:13:44,768: Loading basin data into xarray data set.
2025-11-05 00:13:44,955: Calculating target variable stds per basin
2025-11-05 00:13:44,966: Create lookup table and convert to pytorch tensor
2025-11-05 00:13:45,097: Early stopping enabled: mode=patience
2025-11-05 00:13:45,422: Epoch 1 average loss: avg_loss: 4.01e-06, avg_total_loss: 4.01e-06
2025-11-05 00:13:45,756: Epoch 2 average loss: avg_loss: 2.12e-06, avg_total_loss: 2.12e-06
2025-11-05 00:13:46,082: Epoch 3 average loss: avg_loss: 1.43e-06, avg_total_loss: 1.43e-06
2025-11-05 00:13:46,404: Epoch 4 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:13:46,702: Epoch 5 average loss: avg_loss: 1.00e-06, avg_total_loss: 1.00e-06
2025-11-05 00:13:47,165: Epoch 5 average validation loss: 9.67e-07 -- Median validation metrics: avg_loss: 9.67e-07, NSE: 0.77731, MSE: 38148.85547
2025-11-05 00:13:47,458: Epoch 6 average loss: avg_loss: 9.52e-07, avg_total_loss: 9.52e-07
2025-11-05 00:13:47,781: Epoch 7 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:13:48,070: Epoch 8 average loss: avg_loss: 8.85e-07, avg_total_loss: 8.85e-07
2025-11-05 00:13:48,382: Epoch 9 average loss: avg_loss: 8.43e-07, avg_total_loss: 8.43e-07
2025-11-05 00:13:48,702: Epoch 10 average loss: avg_loss: 7.95e-07, avg_total_loss: 7.95e-07
2025-11-05 00:13:49,013: Epoch 10 average validation loss: 9.82e-07 -- Median validation metrics: avg_loss: 9.82e-07, NSE: 0.77471, MSE: 38594.41406
2025-11-05 00:13:49,288: Epoch 11 average loss: avg_loss: 8.23e-07, avg_total_loss: 8.23e-07
2025-11-05 00:13:49,618: Epoch 12 average loss: avg_loss: 9.20e-07, avg_total_loss: 9.20e-07
2025-11-05 00:13:49,919: Epoch 13 average loss: avg_loss: 8.04e-07, avg_total_loss: 8.04e-07
2025-11-05 00:13:50,280: Epoch 14 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:13:50,587: Epoch 15 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:13:50,873: Epoch 15 average validation loss: 9.43e-07 -- Median validation metrics: avg_loss: 9.43e-07, NSE: 0.78288, MSE: 37194.91016
2025-11-05 00:13:51,159: Epoch 16 average loss: avg_loss: 6.38e-07, avg_total_loss: 6.38e-07
2025-11-05 00:13:51,472: Epoch 17 average loss: avg_loss: 7.27e-07, avg_total_loss: 7.27e-07
2025-11-05 00:13:51,755: Epoch 18 average loss: avg_loss: 7.45e-07, avg_total_loss: 7.45e-07
2025-11-05 00:13:52,031: Epoch 19 average loss: avg_loss: 7.10e-07, avg_total_loss: 7.10e-07
2025-11-05 00:13:52,327: Epoch 20 average loss: avg_loss: 6.25e-07, avg_total_loss: 6.25e-07
2025-11-05 00:13:52,580: Epoch 20 average validation loss: 9.22e-07 -- Median validation metrics: avg_loss: 9.22e-07, NSE: 0.78840, MSE: 36249.42969
2025-11-05 00:13:52,881: Epoch 21 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:13:53,168: Epoch 22 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:13:53,463: Epoch 23 average loss: avg_loss: 8.70e-07, avg_total_loss: 8.70e-07
2025-11-05 00:13:53,464: Setting learning rate to 0.005
2025-11-05 00:13:53,765: Epoch 24 average loss: avg_loss: 7.07e-07, avg_total_loss: 7.07e-07
2025-11-05 00:13:54,067: Epoch 25 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:13:54,377: Epoch 25 average validation loss: 9.27e-07 -- Median validation metrics: avg_loss: 9.27e-07, NSE: 0.78644, MSE: 36585.53906
2025-11-05 00:13:54,686: Epoch 26 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:13:54,997: Epoch 27 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:13:55,292: Epoch 28 average loss: avg_loss: 4.71e-07, avg_total_loss: 4.71e-07
2025-11-05 00:13:55,581: Epoch 29 average loss: avg_loss: 5.24e-07, avg_total_loss: 5.24e-07
2025-11-05 00:13:55,857: Epoch 30 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:13:56,181: Epoch 30 average validation loss: 9.04e-07 -- Median validation metrics: avg_loss: 9.04e-07, NSE: 0.79248, MSE: 35550.52734
2025-11-05 00:13:56,467: Epoch 31 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:13:56,789: Epoch 32 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:13:57,126: Epoch 33 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:13:57,437: Epoch 34 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:13:57,774: Epoch 35 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:13:58,064: Epoch 35 average validation loss: 1.06e-06 -- Median validation metrics: avg_loss: 1.06e-06, NSE: 0.75706, MSE: 41619.01562
2025-11-05 00:13:58,065: Setting learning rate to 0.001
2025-11-05 00:13:58,393: Epoch 36 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:13:58,701: Epoch 37 average loss: avg_loss: 4.27e-07, avg_total_loss: 4.27e-07
2025-11-05 00:13:59,023: Epoch 38 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:13:59,323: Epoch 39 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:13:59,646: Epoch 40 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:13:59,917: Epoch 40 average validation loss: 8.85e-07 -- Median validation metrics: avg_loss: 8.85e-07, NSE: 0.79648, MSE: 34866.30078
2025-11-05 00:14:00,192: Epoch 41 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:14:00,518: Epoch 42 average loss: avg_loss: 4.05e-07, avg_total_loss: 4.05e-07
2025-11-05 00:14:00,854: Epoch 43 average loss: avg_loss: 3.89e-07, avg_total_loss: 3.89e-07
2025-11-05 00:14:01,156: Epoch 44 average loss: avg_loss: 3.95e-07, avg_total_loss: 3.95e-07
2025-11-05 00:14:01,490: Epoch 45 average loss: avg_loss: 4.00e-07, avg_total_loss: 4.00e-07
2025-11-05 00:14:01,766: Epoch 45 average validation loss: 9.72e-07 -- Median validation metrics: avg_loss: 9.72e-07, NSE: 0.77647, MSE: 38293.10547
2025-11-05 00:14:02,084: Epoch 46 average loss: avg_loss: 3.71e-07, avg_total_loss: 3.71e-07
2025-11-05 00:14:02,387: Epoch 47 average loss: avg_loss: 4.00e-07, avg_total_loss: 4.00e-07
2025-11-05 00:14:02,718: Epoch 48 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:14:02,740: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\model_epoch048.pt
2025-11-05 00:14:03,077: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\validation\model_epoch048\validation_metrics.csv
2025-11-05 00:14:03,079: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001344\validation\model_epoch048\validation_results.p
2025-11-05 00:14:03,837: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\output.log initialized.
2025-11-05 00:14:03,838: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403
2025-11-05 00:14:03,839: ### Run configurations for testing_run
2025-11-05 00:14:03,840: experiment_name: testing_run
2025-11-05 00:14:03,841: train_basin_file: calpella
2025-11-05 00:14:03,842: validation_basin_file: calpella
2025-11-05 00:14:03,843: test_basin_file: calpella
2025-11-05 00:14:03,843: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:14:03,844: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:14:03,844: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:14:03,845: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:14:03,846: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:14:03,847: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:14:03,847: device: cuda:0
2025-11-05 00:14:03,848: physics_informed: False
2025-11-05 00:14:03,849: physics_data_file: None
2025-11-05 00:14:03,849: validate_every: 5
2025-11-05 00:14:03,850: validate_n_random_basins: 1
2025-11-05 00:14:03,851: metrics: ['NSE', 'MSE']
2025-11-05 00:14:03,851: model: cudalstm
2025-11-05 00:14:03,852: head: regression
2025-11-05 00:14:03,853: output_activation: linear
2025-11-05 00:14:03,853: hidden_size: 256
2025-11-05 00:14:03,854: initial_forget_bias: 3
2025-11-05 00:14:03,855: output_dropout: 0.4
2025-11-05 00:14:03,855: num_layers: 1
2025-11-05 00:14:03,856: dev_mode: True
2025-11-05 00:14:03,856: optimizer: Adam
2025-11-05 00:14:03,857: loss: NSE
2025-11-05 00:14:03,858: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:14:03,859: batch_size: 256
2025-11-05 00:14:03,859: epochs: 48
2025-11-05 00:14:03,860: clip_gradient_norm: 1
2025-11-05 00:14:03,861: predict_last_n: 1
2025-11-05 00:14:03,862: seq_length: 90
2025-11-05 00:14:03,862: log_interval: 16
2025-11-05 00:14:03,863: log_tensorboard: True
2025-11-05 00:14:03,864: log_n_figures: 1
2025-11-05 00:14:03,865: save_weights_every: 48
2025-11-05 00:14:03,866: early_stopping: True
2025-11-05 00:14:03,867: early_stopping_mode: patience
2025-11-05 00:14:03,867: patience_early_stopping: 3
2025-11-05 00:14:03,868: min_delta_early_stopping: 0.0
2025-11-05 00:14:03,869: minimum_epochs_before_early_stopping: 10
2025-11-05 00:14:03,869: early_stopping_slope_window: 7
2025-11-05 00:14:03,870: early_stopping_slope_patience: 2
2025-11-05 00:14:03,870: early_stopping_slope_min_epoch: 8
2025-11-05 00:14:03,871: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:14:03,871: early_stopping_slope_use_log: True
2025-11-05 00:14:03,872: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:14:03,873: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:14:03,873: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:14:03,874: early_stopping_slope_variance_guard: True
2025-11-05 00:14:03,875: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:14:03,876: dataset: russian_river
2025-11-05 00:14:03,876: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:14:03,877: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:14:03,878: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:14:03,879: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:14:03,879: hourly: False
2025-11-05 00:14:03,880: is_mts: False
2025-11-05 00:14:03,881: is_mts_data: False
2025-11-05 00:14:03,881: verbose: True
2025-11-05 00:14:03,882: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403
2025-11-05 00:14:03,883: run_label: BASELINE
2025-11-05 00:14:03,884: number_of_basins: 1
2025-11-05 00:14:03,884: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\train_data
2025-11-05 00:14:03,885: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\img_log
2025-11-05 00:14:03,887: ### Device cuda:0 will be used for training
2025-11-05 00:14:03,888: Loading basin data into xarray data set.
2025-11-05 00:14:04,036: Calculating target variable stds per basin
2025-11-05 00:14:04,044: Create lookup table and convert to pytorch tensor
2025-11-05 00:14:04,163: Early stopping enabled: mode=patience
2025-11-05 00:14:04,356: Epoch 1 average loss: avg_loss: 4.69e-06, avg_total_loss: 4.69e-06
2025-11-05 00:14:04,548: Epoch 2 average loss: avg_loss: 2.85e-06, avg_total_loss: 2.85e-06
2025-11-05 00:14:04,756: Epoch 3 average loss: avg_loss: 2.02e-06, avg_total_loss: 2.02e-06
2025-11-05 00:14:04,948: Epoch 4 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:14:05,132: Epoch 5 average loss: avg_loss: 1.26e-06, avg_total_loss: 1.26e-06
2025-11-05 00:14:05,526: Epoch 5 average validation loss: 1.14e-06 -- Median validation metrics: avg_loss: 1.14e-06, NSE: 0.71315, MSE: 49140.42188
2025-11-05 00:14:05,732: Epoch 6 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:14:05,923: Epoch 7 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:14:06,117: Epoch 8 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:14:06,332: Epoch 9 average loss: avg_loss: 9.15e-07, avg_total_loss: 9.15e-07
2025-11-05 00:14:06,529: Epoch 10 average loss: avg_loss: 7.47e-07, avg_total_loss: 7.47e-07
2025-11-05 00:14:06,828: Epoch 10 average validation loss: 9.87e-07 -- Median validation metrics: avg_loss: 9.87e-07, NSE: 0.75046, MSE: 42749.82422
2025-11-05 00:14:07,026: Epoch 11 average loss: avg_loss: 7.21e-07, avg_total_loss: 7.21e-07
2025-11-05 00:14:07,226: Epoch 12 average loss: avg_loss: 7.17e-07, avg_total_loss: 7.17e-07
2025-11-05 00:14:07,414: Epoch 13 average loss: avg_loss: 9.14e-07, avg_total_loss: 9.14e-07
2025-11-05 00:14:07,619: Epoch 14 average loss: avg_loss: 9.90e-07, avg_total_loss: 9.90e-07
2025-11-05 00:14:07,809: Epoch 15 average loss: avg_loss: 8.34e-07, avg_total_loss: 8.34e-07
2025-11-05 00:14:08,068: Epoch 15 average validation loss: 8.38e-07 -- Median validation metrics: avg_loss: 8.38e-07, NSE: 0.78575, MSE: 36703.21875
2025-11-05 00:14:08,252: Epoch 16 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:14:08,463: Epoch 17 average loss: avg_loss: 6.82e-07, avg_total_loss: 6.82e-07
2025-11-05 00:14:08,658: Epoch 18 average loss: avg_loss: 7.10e-07, avg_total_loss: 7.10e-07
2025-11-05 00:14:08,841: Epoch 19 average loss: avg_loss: 6.56e-07, avg_total_loss: 6.56e-07
2025-11-05 00:14:09,047: Epoch 20 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:14:09,297: Epoch 20 average validation loss: 9.56e-07 -- Median validation metrics: avg_loss: 9.56e-07, NSE: 0.75969, MSE: 41167.76172
2025-11-05 00:14:09,476: Epoch 21 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:14:09,670: Epoch 22 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:14:09,865: Epoch 23 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:14:09,865: Setting learning rate to 0.005
2025-11-05 00:14:10,057: Epoch 24 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:14:10,262: Epoch 25 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:14:10,524: Epoch 25 average validation loss: 9.96e-07 -- Median validation metrics: avg_loss: 9.96e-07, NSE: 0.74781, MSE: 43202.80469
2025-11-05 00:14:10,700: Epoch 26 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:14:10,896: Epoch 27 average loss: avg_loss: 5.17e-07, avg_total_loss: 5.17e-07
2025-11-05 00:14:11,103: Epoch 28 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:14:11,293: Epoch 29 average loss: avg_loss: 5.08e-07, avg_total_loss: 5.08e-07
2025-11-05 00:14:11,501: Epoch 30 average loss: avg_loss: 5.16e-07, avg_total_loss: 5.16e-07
2025-11-05 00:14:11,781: Epoch 30 average validation loss: 9.11e-07 -- Median validation metrics: avg_loss: 9.11e-07, NSE: 0.76718, MSE: 39884.22656
2025-11-05 00:14:11,782: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:14:11,783: Early stopping triggered at epoch 30
2025-11-05 00:14:11,801: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\model_epoch030.pt
2025-11-05 00:14:11,970: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:14:11,972: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001403\validation\model_epoch030\validation_results.p
2025-11-05 00:14:12,636: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\output.log initialized.
2025-11-05 00:14:12,637: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412
2025-11-05 00:14:12,638: ### Run configurations for testing_run
2025-11-05 00:14:12,640: experiment_name: testing_run
2025-11-05 00:14:12,641: train_basin_file: calpella
2025-11-05 00:14:12,642: validation_basin_file: calpella
2025-11-05 00:14:12,643: test_basin_file: calpella
2025-11-05 00:14:12,644: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:14:12,646: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:14:12,647: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:14:12,648: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:14:12,650: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:14:12,651: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:14:12,653: device: cuda:0
2025-11-05 00:14:12,654: physics_informed: False
2025-11-05 00:14:12,655: physics_data_file: None
2025-11-05 00:14:12,656: validate_every: 5
2025-11-05 00:14:12,657: validate_n_random_basins: 1
2025-11-05 00:14:12,658: metrics: ['NSE', 'MSE']
2025-11-05 00:14:12,660: model: cudalstm
2025-11-05 00:14:12,660: head: regression
2025-11-05 00:14:12,661: output_activation: linear
2025-11-05 00:14:12,662: hidden_size: 256
2025-11-05 00:14:12,664: initial_forget_bias: 3
2025-11-05 00:14:12,665: output_dropout: 0.4
2025-11-05 00:14:12,666: num_layers: 1
2025-11-05 00:14:12,668: dev_mode: True
2025-11-05 00:14:12,669: optimizer: Adam
2025-11-05 00:14:12,671: loss: NSE
2025-11-05 00:14:12,672: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:14:12,673: batch_size: 64
2025-11-05 00:14:12,674: epochs: 16
2025-11-05 00:14:12,675: clip_gradient_norm: 1
2025-11-05 00:14:12,676: predict_last_n: 1
2025-11-05 00:14:12,678: seq_length: 120
2025-11-05 00:14:12,679: log_interval: 16
2025-11-05 00:14:12,680: log_tensorboard: True
2025-11-05 00:14:12,681: log_n_figures: 1
2025-11-05 00:14:12,682: save_weights_every: 16
2025-11-05 00:14:12,683: early_stopping: True
2025-11-05 00:14:12,683: early_stopping_mode: patience
2025-11-05 00:14:12,684: patience_early_stopping: 3
2025-11-05 00:14:12,684: min_delta_early_stopping: 0.0
2025-11-05 00:14:12,685: minimum_epochs_before_early_stopping: 10
2025-11-05 00:14:12,686: early_stopping_slope_window: 7
2025-11-05 00:14:12,686: early_stopping_slope_patience: 2
2025-11-05 00:14:12,687: early_stopping_slope_min_epoch: 8
2025-11-05 00:14:12,688: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:14:12,688: early_stopping_slope_use_log: True
2025-11-05 00:14:12,689: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:14:12,690: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:14:12,690: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:14:12,691: early_stopping_slope_variance_guard: True
2025-11-05 00:14:12,692: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:14:12,693: dataset: russian_river
2025-11-05 00:14:12,693: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:14:12,695: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:14:12,696: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:14:12,697: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:14:12,698: hourly: False
2025-11-05 00:14:12,699: is_mts: False
2025-11-05 00:14:12,700: is_mts_data: False
2025-11-05 00:14:12,701: verbose: True
2025-11-05 00:14:12,702: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412
2025-11-05 00:14:12,703: run_label: BASELINE
2025-11-05 00:14:12,704: number_of_basins: 1
2025-11-05 00:14:12,705: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\train_data
2025-11-05 00:14:12,705: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\img_log
2025-11-05 00:14:12,707: ### Device cuda:0 will be used for training
2025-11-05 00:14:12,709: Loading basin data into xarray data set.
2025-11-05 00:14:12,842: Calculating target variable stds per basin
2025-11-05 00:14:12,849: Create lookup table and convert to pytorch tensor
2025-11-05 00:14:12,966: Early stopping enabled: mode=patience
2025-11-05 00:14:13,545: Epoch 1 average loss: avg_loss: 3.36e-06, avg_total_loss: 3.36e-06
2025-11-05 00:14:14,205: Epoch 2 average loss: avg_loss: 2.11e-06, avg_total_loss: 2.11e-06
2025-11-05 00:14:14,907: Epoch 3 average loss: avg_loss: 1.47e-06, avg_total_loss: 1.47e-06
2025-11-05 00:14:15,541: Epoch 4 average loss: avg_loss: 1.32e-06, avg_total_loss: 1.32e-06
2025-11-05 00:14:16,178: Epoch 5 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:14:16,615: Epoch 5 average validation loss: 1.03e-06 -- Median validation metrics: avg_loss: 1.03e-06, NSE: 0.76279, MSE: 40636.33984
2025-11-05 00:14:17,208: Epoch 6 average loss: avg_loss: 1.38e-06, avg_total_loss: 1.38e-06
2025-11-05 00:14:17,822: Epoch 7 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:14:17,823: Setting learning rate to 0.005
2025-11-05 00:14:18,442: Epoch 8 average loss: avg_loss: 8.40e-07, avg_total_loss: 8.40e-07
2025-11-05 00:14:19,056: Epoch 9 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:14:19,695: Epoch 10 average loss: avg_loss: 8.92e-07, avg_total_loss: 8.92e-07
2025-11-05 00:14:20,039: Epoch 10 average validation loss: 1.24e-06 -- Median validation metrics: avg_loss: 1.24e-06, NSE: 0.71566, MSE: 48710.17578
2025-11-05 00:14:20,666: Epoch 11 average loss: avg_loss: 7.87e-07, avg_total_loss: 7.87e-07
2025-11-05 00:14:20,669: Setting learning rate to 0.001
2025-11-05 00:14:21,285: Epoch 12 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:14:21,869: Epoch 13 average loss: avg_loss: 6.64e-07, avg_total_loss: 6.64e-07
2025-11-05 00:14:22,479: Epoch 14 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:14:23,103: Epoch 15 average loss: avg_loss: 7.06e-07, avg_total_loss: 7.06e-07
2025-11-05 00:14:23,436: Epoch 15 average validation loss: 9.97e-07 -- Median validation metrics: avg_loss: 9.97e-07, NSE: 0.77095, MSE: 39238.69922
2025-11-05 00:14:24,043: Epoch 16 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:14:24,064: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\model_epoch016.pt
2025-11-05 00:14:24,314: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:14:24,316: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001412\validation\model_epoch016\validation_results.p
2025-11-05 00:14:25,009: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\output.log initialized.
2025-11-05 00:14:25,010: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425
2025-11-05 00:14:25,011: ### Run configurations for testing_run
2025-11-05 00:14:25,011: experiment_name: testing_run
2025-11-05 00:14:25,012: train_basin_file: calpella
2025-11-05 00:14:25,012: validation_basin_file: calpella
2025-11-05 00:14:25,013: test_basin_file: calpella
2025-11-05 00:14:25,014: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:14:25,015: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:14:25,015: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:14:25,016: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:14:25,017: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:14:25,017: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:14:25,019: device: cuda:0
2025-11-05 00:14:25,020: physics_informed: False
2025-11-05 00:14:25,021: physics_data_file: None
2025-11-05 00:14:25,022: validate_every: 5
2025-11-05 00:14:25,023: validate_n_random_basins: 1
2025-11-05 00:14:25,024: metrics: ['NSE', 'MSE']
2025-11-05 00:14:25,025: model: cudalstm
2025-11-05 00:14:25,025: head: regression
2025-11-05 00:14:25,026: output_activation: linear
2025-11-05 00:14:25,027: hidden_size: 256
2025-11-05 00:14:25,027: initial_forget_bias: 3
2025-11-05 00:14:25,028: output_dropout: 0.4
2025-11-05 00:14:25,029: num_layers: 1
2025-11-05 00:14:25,030: dev_mode: True
2025-11-05 00:14:25,030: optimizer: Adam
2025-11-05 00:14:25,031: loss: NSE
2025-11-05 00:14:25,031: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:14:25,032: batch_size: 128
2025-11-05 00:14:25,033: epochs: 16
2025-11-05 00:14:25,033: clip_gradient_norm: 1
2025-11-05 00:14:25,034: predict_last_n: 1
2025-11-05 00:14:25,035: seq_length: 120
2025-11-05 00:14:25,036: log_interval: 16
2025-11-05 00:14:25,036: log_tensorboard: True
2025-11-05 00:14:25,037: log_n_figures: 1
2025-11-05 00:14:25,037: save_weights_every: 16
2025-11-05 00:14:25,038: early_stopping: True
2025-11-05 00:14:25,039: early_stopping_mode: patience
2025-11-05 00:14:25,039: patience_early_stopping: 3
2025-11-05 00:14:25,040: min_delta_early_stopping: 0.0
2025-11-05 00:14:25,041: minimum_epochs_before_early_stopping: 10
2025-11-05 00:14:25,041: early_stopping_slope_window: 7
2025-11-05 00:14:25,042: early_stopping_slope_patience: 2
2025-11-05 00:14:25,042: early_stopping_slope_min_epoch: 8
2025-11-05 00:14:25,043: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:14:25,044: early_stopping_slope_use_log: True
2025-11-05 00:14:25,045: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:14:25,046: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:14:25,047: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:14:25,047: early_stopping_slope_variance_guard: True
2025-11-05 00:14:25,048: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:14:25,048: dataset: russian_river
2025-11-05 00:14:25,049: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:14:25,050: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:14:25,050: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:14:25,051: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:14:25,052: hourly: False
2025-11-05 00:14:25,052: is_mts: False
2025-11-05 00:14:25,053: is_mts_data: False
2025-11-05 00:14:25,054: verbose: True
2025-11-05 00:14:25,055: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425
2025-11-05 00:14:25,055: run_label: BASELINE
2025-11-05 00:14:25,056: number_of_basins: 1
2025-11-05 00:14:25,057: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\train_data
2025-11-05 00:14:25,057: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\img_log
2025-11-05 00:14:25,060: ### Device cuda:0 will be used for training
2025-11-05 00:14:25,061: Loading basin data into xarray data set.
2025-11-05 00:14:25,213: Calculating target variable stds per basin
2025-11-05 00:14:25,220: Create lookup table and convert to pytorch tensor
2025-11-05 00:14:25,360: Early stopping enabled: mode=patience
2025-11-05 00:14:25,789: Epoch 1 average loss: avg_loss: 3.07e-06, avg_total_loss: 3.07e-06
2025-11-05 00:14:26,151: Epoch 2 average loss: avg_loss: 1.70e-06, avg_total_loss: 1.70e-06
2025-11-05 00:14:26,487: Epoch 3 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:14:26,833: Epoch 4 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:14:27,181: Epoch 5 average loss: avg_loss: 8.93e-07, avg_total_loss: 8.93e-07
2025-11-05 00:14:27,630: Epoch 5 average validation loss: 9.37e-07 -- Median validation metrics: avg_loss: 9.37e-07, NSE: 0.78395, MSE: 37011.91797
2025-11-05 00:14:27,923: Epoch 6 average loss: avg_loss: 8.53e-07, avg_total_loss: 8.53e-07
2025-11-05 00:14:28,253: Epoch 7 average loss: avg_loss: 9.25e-07, avg_total_loss: 9.25e-07
2025-11-05 00:14:28,253: Setting learning rate to 0.005
2025-11-05 00:14:28,567: Epoch 8 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:14:28,926: Epoch 9 average loss: avg_loss: 7.65e-07, avg_total_loss: 7.65e-07
2025-11-05 00:14:29,264: Epoch 10 average loss: avg_loss: 5.95e-07, avg_total_loss: 5.95e-07
2025-11-05 00:14:29,561: Epoch 10 average validation loss: 9.44e-07 -- Median validation metrics: avg_loss: 9.44e-07, NSE: 0.78339, MSE: 37107.46094
2025-11-05 00:14:29,862: Epoch 11 average loss: avg_loss: 6.44e-07, avg_total_loss: 6.44e-07
2025-11-05 00:14:29,863: Setting learning rate to 0.001
2025-11-05 00:14:30,187: Epoch 12 average loss: avg_loss: 5.57e-07, avg_total_loss: 5.57e-07
2025-11-05 00:14:30,511: Epoch 13 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:14:30,815: Epoch 14 average loss: avg_loss: 6.10e-07, avg_total_loss: 6.10e-07
2025-11-05 00:14:31,136: Epoch 15 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:14:31,417: Epoch 15 average validation loss: 9.78e-07 -- Median validation metrics: avg_loss: 9.78e-07, NSE: 0.77517, MSE: 38516.19922
2025-11-05 00:14:31,721: Epoch 16 average loss: avg_loss: 6.43e-07, avg_total_loss: 6.43e-07
2025-11-05 00:14:31,747: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\model_epoch016.pt
2025-11-05 00:14:31,970: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:14:31,972: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001425\validation\model_epoch016\validation_results.p
2025-11-05 00:14:32,801: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\output.log initialized.
2025-11-05 00:14:32,802: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432
2025-11-05 00:14:32,802: ### Run configurations for testing_run
2025-11-05 00:14:32,803: experiment_name: testing_run
2025-11-05 00:14:32,804: train_basin_file: calpella
2025-11-05 00:14:32,804: validation_basin_file: calpella
2025-11-05 00:14:32,805: test_basin_file: calpella
2025-11-05 00:14:32,806: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:14:32,806: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:14:32,807: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:14:32,808: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:14:32,808: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:14:32,809: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:14:32,810: device: cuda:0
2025-11-05 00:14:32,810: physics_informed: False
2025-11-05 00:14:32,812: physics_data_file: None
2025-11-05 00:14:32,812: validate_every: 5
2025-11-05 00:14:32,813: validate_n_random_basins: 1
2025-11-05 00:14:32,813: metrics: ['NSE', 'MSE']
2025-11-05 00:14:32,814: model: cudalstm
2025-11-05 00:14:32,814: head: regression
2025-11-05 00:14:32,815: output_activation: linear
2025-11-05 00:14:32,816: hidden_size: 256
2025-11-05 00:14:32,817: initial_forget_bias: 3
2025-11-05 00:14:32,817: output_dropout: 0.4
2025-11-05 00:14:32,818: num_layers: 1
2025-11-05 00:14:32,819: dev_mode: True
2025-11-05 00:14:32,819: optimizer: Adam
2025-11-05 00:14:32,820: loss: NSE
2025-11-05 00:14:32,821: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:14:32,822: batch_size: 256
2025-11-05 00:14:32,823: epochs: 16
2025-11-05 00:14:32,824: clip_gradient_norm: 1
2025-11-05 00:14:32,824: predict_last_n: 1
2025-11-05 00:14:32,825: seq_length: 120
2025-11-05 00:14:32,826: log_interval: 16
2025-11-05 00:14:32,826: log_tensorboard: True
2025-11-05 00:14:32,827: log_n_figures: 1
2025-11-05 00:14:32,828: save_weights_every: 16
2025-11-05 00:14:32,828: early_stopping: True
2025-11-05 00:14:32,829: early_stopping_mode: patience
2025-11-05 00:14:32,830: patience_early_stopping: 3
2025-11-05 00:14:32,830: min_delta_early_stopping: 0.0
2025-11-05 00:14:32,831: minimum_epochs_before_early_stopping: 10
2025-11-05 00:14:32,832: early_stopping_slope_window: 7
2025-11-05 00:14:32,833: early_stopping_slope_patience: 2
2025-11-05 00:14:32,834: early_stopping_slope_min_epoch: 8
2025-11-05 00:14:32,835: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:14:32,835: early_stopping_slope_use_log: True
2025-11-05 00:14:32,836: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:14:32,837: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:14:32,838: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:14:32,838: early_stopping_slope_variance_guard: True
2025-11-05 00:14:32,839: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:14:32,839: dataset: russian_river
2025-11-05 00:14:32,840: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:14:32,841: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:14:32,842: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:14:32,843: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:14:32,844: hourly: False
2025-11-05 00:14:32,845: is_mts: False
2025-11-05 00:14:32,846: is_mts_data: False
2025-11-05 00:14:32,848: verbose: True
2025-11-05 00:14:32,849: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432
2025-11-05 00:14:32,851: run_label: BASELINE
2025-11-05 00:14:32,852: number_of_basins: 1
2025-11-05 00:14:32,854: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\train_data
2025-11-05 00:14:32,855: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\img_log
2025-11-05 00:14:32,859: ### Device cuda:0 will be used for training
2025-11-05 00:14:32,861: Loading basin data into xarray data set.
2025-11-05 00:14:33,020: Calculating target variable stds per basin
2025-11-05 00:14:33,028: Create lookup table and convert to pytorch tensor
2025-11-05 00:14:33,138: Early stopping enabled: mode=patience
2025-11-05 00:14:33,332: Epoch 1 average loss: avg_loss: 3.81e-06, avg_total_loss: 3.81e-06
2025-11-05 00:14:33,524: Epoch 2 average loss: avg_loss: 2.78e-06, avg_total_loss: 2.78e-06
2025-11-05 00:14:33,740: Epoch 3 average loss: avg_loss: 1.78e-06, avg_total_loss: 1.78e-06
2025-11-05 00:14:33,943: Epoch 4 average loss: avg_loss: 1.38e-06, avg_total_loss: 1.38e-06
2025-11-05 00:14:34,149: Epoch 5 average loss: avg_loss: 9.76e-07, avg_total_loss: 9.76e-07
2025-11-05 00:14:34,542: Epoch 5 average validation loss: 9.82e-07 -- Median validation metrics: avg_loss: 9.82e-07, NSE: 0.75268, MSE: 42369.73828
2025-11-05 00:14:34,750: Epoch 6 average loss: avg_loss: 9.84e-07, avg_total_loss: 9.84e-07
2025-11-05 00:14:34,980: Epoch 7 average loss: avg_loss: 8.44e-07, avg_total_loss: 8.44e-07
2025-11-05 00:14:34,981: Setting learning rate to 0.005
2025-11-05 00:14:35,196: Epoch 8 average loss: avg_loss: 7.78e-07, avg_total_loss: 7.78e-07
2025-11-05 00:14:35,418: Epoch 9 average loss: avg_loss: 7.70e-07, avg_total_loss: 7.70e-07
2025-11-05 00:14:35,630: Epoch 10 average loss: avg_loss: 7.63e-07, avg_total_loss: 7.63e-07
2025-11-05 00:14:35,876: Epoch 10 average validation loss: 9.61e-07 -- Median validation metrics: avg_loss: 9.61e-07, NSE: 0.75527, MSE: 41926.05469
2025-11-05 00:14:36,077: Epoch 11 average loss: avg_loss: 7.18e-07, avg_total_loss: 7.18e-07
2025-11-05 00:14:36,078: Setting learning rate to 0.001
2025-11-05 00:14:36,300: Epoch 12 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:14:36,518: Epoch 13 average loss: avg_loss: 6.48e-07, avg_total_loss: 6.48e-07
2025-11-05 00:14:36,725: Epoch 14 average loss: avg_loss: 7.23e-07, avg_total_loss: 7.23e-07
2025-11-05 00:14:36,950: Epoch 15 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:14:37,219: Epoch 15 average validation loss: 9.75e-07 -- Median validation metrics: avg_loss: 9.75e-07, NSE: 0.75133, MSE: 42600.15625
2025-11-05 00:14:37,419: Epoch 16 average loss: avg_loss: 6.39e-07, avg_total_loss: 6.39e-07
2025-11-05 00:14:37,438: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\model_epoch016.pt
2025-11-05 00:14:37,632: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:14:37,634: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001432\validation\model_epoch016\validation_results.p
2025-11-05 00:14:38,311: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\output.log initialized.
2025-11-05 00:14:38,312: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438
2025-11-05 00:14:38,313: ### Run configurations for testing_run
2025-11-05 00:14:38,314: experiment_name: testing_run
2025-11-05 00:14:38,315: train_basin_file: calpella
2025-11-05 00:14:38,317: validation_basin_file: calpella
2025-11-05 00:14:38,318: test_basin_file: calpella
2025-11-05 00:14:38,319: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:14:38,320: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:14:38,321: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:14:38,321: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:14:38,322: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:14:38,323: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:14:38,325: device: cuda:0
2025-11-05 00:14:38,326: physics_informed: False
2025-11-05 00:14:38,327: physics_data_file: None
2025-11-05 00:14:38,328: validate_every: 5
2025-11-05 00:14:38,329: validate_n_random_basins: 1
2025-11-05 00:14:38,330: metrics: ['NSE', 'MSE']
2025-11-05 00:14:38,331: model: cudalstm
2025-11-05 00:14:38,332: head: regression
2025-11-05 00:14:38,332: output_activation: linear
2025-11-05 00:14:38,333: hidden_size: 256
2025-11-05 00:14:38,334: initial_forget_bias: 3
2025-11-05 00:14:38,335: output_dropout: 0.4
2025-11-05 00:14:38,336: num_layers: 1
2025-11-05 00:14:38,337: dev_mode: True
2025-11-05 00:14:38,338: optimizer: Adam
2025-11-05 00:14:38,339: loss: NSE
2025-11-05 00:14:38,340: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:14:38,340: batch_size: 64
2025-11-05 00:14:38,341: epochs: 32
2025-11-05 00:14:38,341: clip_gradient_norm: 1
2025-11-05 00:14:38,342: predict_last_n: 1
2025-11-05 00:14:38,344: seq_length: 120
2025-11-05 00:14:38,345: log_interval: 16
2025-11-05 00:14:38,346: log_tensorboard: True
2025-11-05 00:14:38,347: log_n_figures: 1
2025-11-05 00:14:38,348: save_weights_every: 32
2025-11-05 00:14:38,349: early_stopping: True
2025-11-05 00:14:38,351: early_stopping_mode: patience
2025-11-05 00:14:38,352: patience_early_stopping: 3
2025-11-05 00:14:38,353: min_delta_early_stopping: 0.0
2025-11-05 00:14:38,353: minimum_epochs_before_early_stopping: 10
2025-11-05 00:14:38,354: early_stopping_slope_window: 7
2025-11-05 00:14:38,355: early_stopping_slope_patience: 2
2025-11-05 00:14:38,356: early_stopping_slope_min_epoch: 8
2025-11-05 00:14:38,357: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:14:38,358: early_stopping_slope_use_log: True
2025-11-05 00:14:38,359: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:14:38,360: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:14:38,361: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:14:38,362: early_stopping_slope_variance_guard: True
2025-11-05 00:14:38,363: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:14:38,364: dataset: russian_river
2025-11-05 00:14:38,365: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:14:38,366: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:14:38,367: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:14:38,368: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:14:38,369: hourly: False
2025-11-05 00:14:38,370: is_mts: False
2025-11-05 00:14:38,371: is_mts_data: False
2025-11-05 00:14:38,372: verbose: True
2025-11-05 00:14:38,373: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438
2025-11-05 00:14:38,374: run_label: BASELINE
2025-11-05 00:14:38,375: number_of_basins: 1
2025-11-05 00:14:38,375: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\train_data
2025-11-05 00:14:38,376: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\img_log
2025-11-05 00:14:38,378: ### Device cuda:0 will be used for training
2025-11-05 00:14:38,379: Loading basin data into xarray data set.
2025-11-05 00:14:38,524: Calculating target variable stds per basin
2025-11-05 00:14:38,531: Create lookup table and convert to pytorch tensor
2025-11-05 00:14:38,654: Early stopping enabled: mode=patience
2025-11-05 00:14:39,274: Epoch 1 average loss: avg_loss: 2.94e-06, avg_total_loss: 2.94e-06
2025-11-05 00:14:39,926: Epoch 2 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:14:40,561: Epoch 3 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:14:41,235: Epoch 4 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:14:41,876: Epoch 5 average loss: avg_loss: 9.39e-07, avg_total_loss: 9.39e-07
2025-11-05 00:14:42,313: Epoch 5 average validation loss: 1.54e-06 -- Median validation metrics: avg_loss: 1.54e-06, NSE: 0.64721, MSE: 60437.30859
2025-11-05 00:14:42,916: Epoch 6 average loss: avg_loss: 9.88e-07, avg_total_loss: 9.88e-07
2025-11-05 00:14:43,546: Epoch 7 average loss: avg_loss: 8.74e-07, avg_total_loss: 8.74e-07
2025-11-05 00:14:44,184: Epoch 8 average loss: avg_loss: 7.82e-07, avg_total_loss: 7.82e-07
2025-11-05 00:14:44,836: Epoch 9 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:14:45,459: Epoch 10 average loss: avg_loss: 7.15e-07, avg_total_loss: 7.15e-07
2025-11-05 00:14:45,803: Epoch 10 average validation loss: 9.91e-07 -- Median validation metrics: avg_loss: 9.91e-07, NSE: 0.77165, MSE: 39118.59375
2025-11-05 00:14:46,373: Epoch 11 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:14:46,996: Epoch 12 average loss: avg_loss: 9.31e-07, avg_total_loss: 9.31e-07
2025-11-05 00:14:47,611: Epoch 13 average loss: avg_loss: 8.72e-07, avg_total_loss: 8.72e-07
2025-11-05 00:14:48,244: Epoch 14 average loss: avg_loss: 6.76e-07, avg_total_loss: 6.76e-07
2025-11-05 00:14:48,889: Epoch 15 average loss: avg_loss: 6.52e-07, avg_total_loss: 6.52e-07
2025-11-05 00:14:49,229: Epoch 15 average validation loss: 1.13e-06 -- Median validation metrics: avg_loss: 1.13e-06, NSE: 0.74565, MSE: 43573.12109
2025-11-05 00:14:49,230: Setting learning rate to 0.005
2025-11-05 00:14:49,845: Epoch 16 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:14:50,424: Epoch 17 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:14:51,073: Epoch 18 average loss: avg_loss: 7.04e-07, avg_total_loss: 7.04e-07
2025-11-05 00:14:51,675: Epoch 19 average loss: avg_loss: 6.97e-07, avg_total_loss: 6.97e-07
2025-11-05 00:14:52,294: Epoch 20 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:14:52,654: Epoch 20 average validation loss: 8.12e-07 -- Median validation metrics: avg_loss: 8.12e-07, NSE: 0.81302, MSE: 32031.11328
2025-11-05 00:14:53,234: Epoch 21 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:14:53,855: Epoch 22 average loss: avg_loss: 4.64e-07, avg_total_loss: 4.64e-07
2025-11-05 00:14:54,472: Epoch 23 average loss: avg_loss: 5.13e-07, avg_total_loss: 5.13e-07
2025-11-05 00:14:54,473: Setting learning rate to 0.001
2025-11-05 00:14:55,099: Epoch 24 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:14:55,722: Epoch 25 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:14:56,010: Epoch 25 average validation loss: 9.06e-07 -- Median validation metrics: avg_loss: 9.06e-07, NSE: 0.79169, MSE: 35685.47266
2025-11-05 00:14:56,628: Epoch 26 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:14:57,272: Epoch 27 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:14:57,941: Epoch 28 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:14:58,543: Epoch 29 average loss: avg_loss: 4.24e-07, avg_total_loss: 4.24e-07
2025-11-05 00:14:59,219: Epoch 30 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:14:59,528: Epoch 30 average validation loss: 9.39e-07 -- Median validation metrics: avg_loss: 9.39e-07, NSE: 0.78424, MSE: 36962.43750
2025-11-05 00:15:00,168: Epoch 31 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:15:00,785: Epoch 32 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:15:00,805: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\model_epoch032.pt
2025-11-05 00:15:01,057: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:15:01,059: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001438\validation\model_epoch032\validation_results.p
2025-11-05 00:15:01,764: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\output.log initialized.
2025-11-05 00:15:01,766: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501
2025-11-05 00:15:01,767: ### Run configurations for testing_run
2025-11-05 00:15:01,767: experiment_name: testing_run
2025-11-05 00:15:01,768: train_basin_file: calpella
2025-11-05 00:15:01,769: validation_basin_file: calpella
2025-11-05 00:15:01,769: test_basin_file: calpella
2025-11-05 00:15:01,770: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:15:01,771: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:15:01,772: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:15:01,773: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:15:01,773: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:15:01,774: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:15:01,775: device: cuda:0
2025-11-05 00:15:01,775: physics_informed: False
2025-11-05 00:15:01,776: physics_data_file: None
2025-11-05 00:15:01,777: validate_every: 5
2025-11-05 00:15:01,777: validate_n_random_basins: 1
2025-11-05 00:15:01,778: metrics: ['NSE', 'MSE']
2025-11-05 00:15:01,779: model: cudalstm
2025-11-05 00:15:01,779: head: regression
2025-11-05 00:15:01,780: output_activation: linear
2025-11-05 00:15:01,780: hidden_size: 256
2025-11-05 00:15:01,781: initial_forget_bias: 3
2025-11-05 00:15:01,781: output_dropout: 0.4
2025-11-05 00:15:01,782: num_layers: 1
2025-11-05 00:15:01,783: dev_mode: True
2025-11-05 00:15:01,783: optimizer: Adam
2025-11-05 00:15:01,784: loss: NSE
2025-11-05 00:15:01,785: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:15:01,785: batch_size: 128
2025-11-05 00:15:01,786: epochs: 32
2025-11-05 00:15:01,786: clip_gradient_norm: 1
2025-11-05 00:15:01,787: predict_last_n: 1
2025-11-05 00:15:01,788: seq_length: 120
2025-11-05 00:15:01,788: log_interval: 16
2025-11-05 00:15:01,789: log_tensorboard: True
2025-11-05 00:15:01,789: log_n_figures: 1
2025-11-05 00:15:01,790: save_weights_every: 32
2025-11-05 00:15:01,791: early_stopping: True
2025-11-05 00:15:01,791: early_stopping_mode: patience
2025-11-05 00:15:01,792: patience_early_stopping: 3
2025-11-05 00:15:01,793: min_delta_early_stopping: 0.0
2025-11-05 00:15:01,793: minimum_epochs_before_early_stopping: 10
2025-11-05 00:15:01,794: early_stopping_slope_window: 7
2025-11-05 00:15:01,795: early_stopping_slope_patience: 2
2025-11-05 00:15:01,796: early_stopping_slope_min_epoch: 8
2025-11-05 00:15:01,796: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:15:01,797: early_stopping_slope_use_log: True
2025-11-05 00:15:01,798: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:15:01,799: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:15:01,799: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:15:01,800: early_stopping_slope_variance_guard: True
2025-11-05 00:15:01,801: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:15:01,801: dataset: russian_river
2025-11-05 00:15:01,802: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:15:01,803: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:15:01,804: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:15:01,804: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:15:01,805: hourly: False
2025-11-05 00:15:01,806: is_mts: False
2025-11-05 00:15:01,806: is_mts_data: False
2025-11-05 00:15:01,807: verbose: True
2025-11-05 00:15:01,808: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501
2025-11-05 00:15:01,809: run_label: BASELINE
2025-11-05 00:15:01,810: number_of_basins: 1
2025-11-05 00:15:01,810: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\train_data
2025-11-05 00:15:01,811: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\img_log
2025-11-05 00:15:01,813: ### Device cuda:0 will be used for training
2025-11-05 00:15:01,814: Loading basin data into xarray data set.
2025-11-05 00:15:01,974: Calculating target variable stds per basin
2025-11-05 00:15:01,982: Create lookup table and convert to pytorch tensor
2025-11-05 00:15:02,098: Early stopping enabled: mode=patience
2025-11-05 00:15:02,467: Epoch 1 average loss: avg_loss: 4.23e-06, avg_total_loss: 4.23e-06
2025-11-05 00:15:02,824: Epoch 2 average loss: avg_loss: 3.07e-06, avg_total_loss: 3.07e-06
2025-11-05 00:15:03,181: Epoch 3 average loss: avg_loss: 2.32e-06, avg_total_loss: 2.32e-06
2025-11-05 00:15:03,561: Epoch 4 average loss: avg_loss: 1.37e-06, avg_total_loss: 1.37e-06
2025-11-05 00:15:03,910: Epoch 5 average loss: avg_loss: 1.22e-06, avg_total_loss: 1.22e-06
2025-11-05 00:15:04,344: Epoch 5 average validation loss: 1.47e-06 -- Median validation metrics: avg_loss: 1.47e-06, NSE: 0.66298, MSE: 57735.46484
2025-11-05 00:15:04,651: Epoch 6 average loss: avg_loss: 1.19e-06, avg_total_loss: 1.19e-06
2025-11-05 00:15:05,009: Epoch 7 average loss: avg_loss: 9.24e-07, avg_total_loss: 9.24e-07
2025-11-05 00:15:05,358: Epoch 8 average loss: avg_loss: 9.41e-07, avg_total_loss: 9.41e-07
2025-11-05 00:15:05,706: Epoch 9 average loss: avg_loss: 9.55e-07, avg_total_loss: 9.55e-07
2025-11-05 00:15:06,036: Epoch 10 average loss: avg_loss: 7.41e-07, avg_total_loss: 7.41e-07
2025-11-05 00:15:06,353: Epoch 10 average validation loss: 1.00e-06 -- Median validation metrics: avg_loss: 1.00e-06, NSE: 0.76954, MSE: 39481.06641
2025-11-05 00:15:06,679: Epoch 11 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:15:07,030: Epoch 12 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:15:07,367: Epoch 13 average loss: avg_loss: 8.56e-07, avg_total_loss: 8.56e-07
2025-11-05 00:15:07,727: Epoch 14 average loss: avg_loss: 6.32e-07, avg_total_loss: 6.32e-07
2025-11-05 00:15:08,088: Epoch 15 average loss: avg_loss: 7.49e-07, avg_total_loss: 7.49e-07
2025-11-05 00:15:08,366: Epoch 15 average validation loss: 8.86e-07 -- Median validation metrics: avg_loss: 8.86e-07, NSE: 0.79635, MSE: 34886.93750
2025-11-05 00:15:08,367: Setting learning rate to 0.005
2025-11-05 00:15:08,679: Epoch 16 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:15:09,017: Epoch 17 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:15:09,328: Epoch 18 average loss: avg_loss: 6.70e-07, avg_total_loss: 6.70e-07
2025-11-05 00:15:09,653: Epoch 19 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:15:09,997: Epoch 20 average loss: avg_loss: 5.29e-07, avg_total_loss: 5.29e-07
2025-11-05 00:15:10,270: Epoch 20 average validation loss: 9.96e-07 -- Median validation metrics: avg_loss: 9.96e-07, NSE: 0.77092, MSE: 39244.47266
2025-11-05 00:15:10,596: Epoch 21 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:15:10,940: Epoch 22 average loss: avg_loss: 5.55e-07, avg_total_loss: 5.55e-07
2025-11-05 00:15:11,311: Epoch 23 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:15:11,312: Setting learning rate to 0.001
2025-11-05 00:15:11,628: Epoch 24 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:15:12,000: Epoch 25 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:15:12,263: Epoch 25 average validation loss: 9.86e-07 -- Median validation metrics: avg_loss: 9.86e-07, NSE: 0.77304, MSE: 38881.57812
2025-11-05 00:15:12,597: Epoch 26 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:15:12,922: Epoch 27 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:15:13,275: Epoch 28 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:15:13,608: Epoch 29 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:15:13,967: Epoch 30 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:15:14,271: Epoch 30 average validation loss: 9.35e-07 -- Median validation metrics: avg_loss: 9.35e-07, NSE: 0.78502, MSE: 36828.46875
2025-11-05 00:15:14,272: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:15:14,273: Early stopping triggered at epoch 30
2025-11-05 00:15:14,290: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\model_epoch030.pt
2025-11-05 00:15:14,483: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:15:14,485: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001501\validation\model_epoch030\validation_results.p
2025-11-05 00:15:15,341: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\output.log initialized.
2025-11-05 00:15:15,343: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515
2025-11-05 00:15:15,343: ### Run configurations for testing_run
2025-11-05 00:15:15,345: experiment_name: testing_run
2025-11-05 00:15:15,346: train_basin_file: calpella
2025-11-05 00:15:15,347: validation_basin_file: calpella
2025-11-05 00:15:15,348: test_basin_file: calpella
2025-11-05 00:15:15,349: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:15:15,350: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:15:15,351: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:15:15,352: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:15:15,353: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:15:15,353: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:15:15,354: device: cuda:0
2025-11-05 00:15:15,355: physics_informed: False
2025-11-05 00:15:15,356: physics_data_file: None
2025-11-05 00:15:15,356: validate_every: 5
2025-11-05 00:15:15,357: validate_n_random_basins: 1
2025-11-05 00:15:15,358: metrics: ['NSE', 'MSE']
2025-11-05 00:15:15,358: model: cudalstm
2025-11-05 00:15:15,359: head: regression
2025-11-05 00:15:15,360: output_activation: linear
2025-11-05 00:15:15,361: hidden_size: 256
2025-11-05 00:15:15,361: initial_forget_bias: 3
2025-11-05 00:15:15,361: output_dropout: 0.4
2025-11-05 00:15:15,362: num_layers: 1
2025-11-05 00:15:15,363: dev_mode: True
2025-11-05 00:15:15,364: optimizer: Adam
2025-11-05 00:15:15,364: loss: NSE
2025-11-05 00:15:15,365: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:15:15,366: batch_size: 256
2025-11-05 00:15:15,366: epochs: 32
2025-11-05 00:15:15,367: clip_gradient_norm: 1
2025-11-05 00:15:15,368: predict_last_n: 1
2025-11-05 00:15:15,368: seq_length: 120
2025-11-05 00:15:15,369: log_interval: 16
2025-11-05 00:15:15,369: log_tensorboard: True
2025-11-05 00:15:15,370: log_n_figures: 1
2025-11-05 00:15:15,371: save_weights_every: 32
2025-11-05 00:15:15,371: early_stopping: True
2025-11-05 00:15:15,372: early_stopping_mode: patience
2025-11-05 00:15:15,373: patience_early_stopping: 3
2025-11-05 00:15:15,373: min_delta_early_stopping: 0.0
2025-11-05 00:15:15,374: minimum_epochs_before_early_stopping: 10
2025-11-05 00:15:15,375: early_stopping_slope_window: 7
2025-11-05 00:15:15,375: early_stopping_slope_patience: 2
2025-11-05 00:15:15,376: early_stopping_slope_min_epoch: 8
2025-11-05 00:15:15,377: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:15:15,378: early_stopping_slope_use_log: True
2025-11-05 00:15:15,378: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:15:15,379: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:15:15,380: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:15:15,380: early_stopping_slope_variance_guard: True
2025-11-05 00:15:15,381: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:15:15,382: dataset: russian_river
2025-11-05 00:15:15,382: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:15:15,383: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:15:15,384: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:15:15,384: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:15:15,385: hourly: False
2025-11-05 00:15:15,385: is_mts: False
2025-11-05 00:15:15,386: is_mts_data: False
2025-11-05 00:15:15,387: verbose: True
2025-11-05 00:15:15,387: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515
2025-11-05 00:15:15,388: run_label: BASELINE
2025-11-05 00:15:15,389: number_of_basins: 1
2025-11-05 00:15:15,390: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\train_data
2025-11-05 00:15:15,390: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\img_log
2025-11-05 00:15:15,392: ### Device cuda:0 will be used for training
2025-11-05 00:15:15,393: Loading basin data into xarray data set.
2025-11-05 00:15:15,554: Calculating target variable stds per basin
2025-11-05 00:15:15,561: Create lookup table and convert to pytorch tensor
2025-11-05 00:15:15,680: Early stopping enabled: mode=patience
2025-11-05 00:15:15,960: Epoch 1 average loss: avg_loss: 4.28e-06, avg_total_loss: 4.28e-06
2025-11-05 00:15:16,199: Epoch 2 average loss: avg_loss: 2.58e-06, avg_total_loss: 2.58e-06
2025-11-05 00:15:16,450: Epoch 3 average loss: avg_loss: 2.22e-06, avg_total_loss: 2.22e-06
2025-11-05 00:15:16,679: Epoch 4 average loss: avg_loss: 1.67e-06, avg_total_loss: 1.67e-06
2025-11-05 00:15:16,915: Epoch 5 average loss: avg_loss: 1.42e-06, avg_total_loss: 1.42e-06
2025-11-05 00:15:17,332: Epoch 5 average validation loss: 1.17e-06 -- Median validation metrics: avg_loss: 1.17e-06, NSE: 0.70844, MSE: 49948.31250
2025-11-05 00:15:17,545: Epoch 6 average loss: avg_loss: 1.47e-06, avg_total_loss: 1.47e-06
2025-11-05 00:15:17,770: Epoch 7 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:15:18,020: Epoch 8 average loss: avg_loss: 9.67e-07, avg_total_loss: 9.67e-07
2025-11-05 00:15:18,234: Epoch 9 average loss: avg_loss: 9.92e-07, avg_total_loss: 9.92e-07
2025-11-05 00:15:18,468: Epoch 10 average loss: avg_loss: 7.85e-07, avg_total_loss: 7.85e-07
2025-11-05 00:15:18,766: Epoch 10 average validation loss: 8.07e-07 -- Median validation metrics: avg_loss: 8.07e-07, NSE: 0.79677, MSE: 34816.46875
2025-11-05 00:15:18,980: Epoch 11 average loss: avg_loss: 7.94e-07, avg_total_loss: 7.94e-07
2025-11-05 00:15:19,180: Epoch 12 average loss: avg_loss: 7.81e-07, avg_total_loss: 7.81e-07
2025-11-05 00:15:19,385: Epoch 13 average loss: avg_loss: 8.65e-07, avg_total_loss: 8.65e-07
2025-11-05 00:15:19,619: Epoch 14 average loss: avg_loss: 6.89e-07, avg_total_loss: 6.89e-07
2025-11-05 00:15:19,834: Epoch 15 average loss: avg_loss: 7.58e-07, avg_total_loss: 7.58e-07
2025-11-05 00:15:20,123: Epoch 15 average validation loss: 8.52e-07 -- Median validation metrics: avg_loss: 8.52e-07, NSE: 0.78276, MSE: 37215.10156
2025-11-05 00:15:20,124: Setting learning rate to 0.005
2025-11-05 00:15:20,347: Epoch 16 average loss: avg_loss: 7.78e-07, avg_total_loss: 7.78e-07
2025-11-05 00:15:20,560: Epoch 17 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:15:20,758: Epoch 18 average loss: avg_loss: 7.11e-07, avg_total_loss: 7.11e-07
2025-11-05 00:15:20,984: Epoch 19 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:15:21,193: Epoch 20 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:15:21,462: Epoch 20 average validation loss: 9.31e-07 -- Median validation metrics: avg_loss: 9.31e-07, NSE: 0.76294, MSE: 40611.75000
2025-11-05 00:15:21,671: Epoch 21 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:15:21,918: Epoch 22 average loss: avg_loss: 6.10e-07, avg_total_loss: 6.10e-07
2025-11-05 00:15:22,134: Epoch 23 average loss: avg_loss: 6.09e-07, avg_total_loss: 6.09e-07
2025-11-05 00:15:22,135: Setting learning rate to 0.001
2025-11-05 00:15:22,344: Epoch 24 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:15:22,569: Epoch 25 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:15:22,835: Epoch 25 average validation loss: 8.75e-07 -- Median validation metrics: avg_loss: 8.75e-07, NSE: 0.77805, MSE: 38022.80469
2025-11-05 00:15:22,836: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:15:22,837: Early stopping triggered at epoch 25
2025-11-05 00:15:22,856: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\model_epoch025.pt
2025-11-05 00:15:23,043: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:15:23,044: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001515\validation\model_epoch025\validation_results.p
2025-11-05 00:15:23,731: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\output.log initialized.
2025-11-05 00:15:23,733: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523
2025-11-05 00:15:23,734: ### Run configurations for testing_run
2025-11-05 00:15:23,735: experiment_name: testing_run
2025-11-05 00:15:23,736: train_basin_file: calpella
2025-11-05 00:15:23,737: validation_basin_file: calpella
2025-11-05 00:15:23,739: test_basin_file: calpella
2025-11-05 00:15:23,740: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:15:23,741: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:15:23,743: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:15:23,745: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:15:23,746: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:15:23,747: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:15:23,748: device: cuda:0
2025-11-05 00:15:23,750: physics_informed: False
2025-11-05 00:15:23,751: physics_data_file: None
2025-11-05 00:15:23,753: validate_every: 5
2025-11-05 00:15:23,754: validate_n_random_basins: 1
2025-11-05 00:15:23,756: metrics: ['NSE', 'MSE']
2025-11-05 00:15:23,757: model: cudalstm
2025-11-05 00:15:23,758: head: regression
2025-11-05 00:15:23,759: output_activation: linear
2025-11-05 00:15:23,760: hidden_size: 256
2025-11-05 00:15:23,761: initial_forget_bias: 3
2025-11-05 00:15:23,762: output_dropout: 0.4
2025-11-05 00:15:23,764: num_layers: 1
2025-11-05 00:15:23,765: dev_mode: True
2025-11-05 00:15:23,766: optimizer: Adam
2025-11-05 00:15:23,767: loss: NSE
2025-11-05 00:15:23,768: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:15:23,769: batch_size: 64
2025-11-05 00:15:23,770: epochs: 48
2025-11-05 00:15:23,772: clip_gradient_norm: 1
2025-11-05 00:15:23,772: predict_last_n: 1
2025-11-05 00:15:23,774: seq_length: 120
2025-11-05 00:15:23,776: log_interval: 16
2025-11-05 00:15:23,777: log_tensorboard: True
2025-11-05 00:15:23,778: log_n_figures: 1
2025-11-05 00:15:23,778: save_weights_every: 48
2025-11-05 00:15:23,780: early_stopping: True
2025-11-05 00:15:23,781: early_stopping_mode: patience
2025-11-05 00:15:23,781: patience_early_stopping: 3
2025-11-05 00:15:23,782: min_delta_early_stopping: 0.0
2025-11-05 00:15:23,783: minimum_epochs_before_early_stopping: 10
2025-11-05 00:15:23,784: early_stopping_slope_window: 7
2025-11-05 00:15:23,785: early_stopping_slope_patience: 2
2025-11-05 00:15:23,785: early_stopping_slope_min_epoch: 8
2025-11-05 00:15:23,787: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:15:23,788: early_stopping_slope_use_log: True
2025-11-05 00:15:23,789: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:15:23,790: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:15:23,791: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:15:23,793: early_stopping_slope_variance_guard: True
2025-11-05 00:15:23,794: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:15:23,796: dataset: russian_river
2025-11-05 00:15:23,797: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:15:23,798: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:15:23,799: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:15:23,801: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:15:23,802: hourly: False
2025-11-05 00:15:23,804: is_mts: False
2025-11-05 00:15:23,805: is_mts_data: False
2025-11-05 00:15:23,806: verbose: True
2025-11-05 00:15:23,807: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523
2025-11-05 00:15:23,808: run_label: BASELINE
2025-11-05 00:15:23,809: number_of_basins: 1
2025-11-05 00:15:23,810: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\train_data
2025-11-05 00:15:23,811: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\img_log
2025-11-05 00:15:23,814: ### Device cuda:0 will be used for training
2025-11-05 00:15:23,816: Loading basin data into xarray data set.
2025-11-05 00:15:23,965: Calculating target variable stds per basin
2025-11-05 00:15:23,973: Create lookup table and convert to pytorch tensor
2025-11-05 00:15:24,086: Early stopping enabled: mode=patience
2025-11-05 00:15:24,660: Epoch 1 average loss: avg_loss: 2.99e-06, avg_total_loss: 2.99e-06
2025-11-05 00:15:25,306: Epoch 2 average loss: avg_loss: 1.65e-06, avg_total_loss: 1.65e-06
2025-11-05 00:15:25,980: Epoch 3 average loss: avg_loss: 1.16e-06, avg_total_loss: 1.16e-06
2025-11-05 00:15:26,637: Epoch 4 average loss: avg_loss: 9.86e-07, avg_total_loss: 9.86e-07
2025-11-05 00:15:27,266: Epoch 5 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:15:27,738: Epoch 5 average validation loss: 1.64e-06 -- Median validation metrics: avg_loss: 1.64e-06, NSE: 0.63071, MSE: 63263.50391
2025-11-05 00:15:28,330: Epoch 6 average loss: avg_loss: 9.56e-07, avg_total_loss: 9.56e-07
2025-11-05 00:15:28,952: Epoch 7 average loss: avg_loss: 9.21e-07, avg_total_loss: 9.21e-07
2025-11-05 00:15:29,569: Epoch 8 average loss: avg_loss: 9.64e-07, avg_total_loss: 9.64e-07
2025-11-05 00:15:30,195: Epoch 9 average loss: avg_loss: 7.93e-07, avg_total_loss: 7.93e-07
2025-11-05 00:15:30,806: Epoch 10 average loss: avg_loss: 8.66e-07, avg_total_loss: 8.66e-07
2025-11-05 00:15:31,134: Epoch 10 average validation loss: 9.64e-07 -- Median validation metrics: avg_loss: 9.64e-07, NSE: 0.77911, MSE: 37841.54297
2025-11-05 00:15:31,755: Epoch 11 average loss: avg_loss: 6.59e-07, avg_total_loss: 6.59e-07
2025-11-05 00:15:32,401: Epoch 12 average loss: avg_loss: 7.85e-07, avg_total_loss: 7.85e-07
2025-11-05 00:15:33,075: Epoch 13 average loss: avg_loss: 6.33e-07, avg_total_loss: 6.33e-07
2025-11-05 00:15:33,696: Epoch 14 average loss: avg_loss: 7.14e-07, avg_total_loss: 7.14e-07
2025-11-05 00:15:34,329: Epoch 15 average loss: avg_loss: 7.35e-07, avg_total_loss: 7.35e-07
2025-11-05 00:15:34,632: Epoch 15 average validation loss: 1.02e-06 -- Median validation metrics: avg_loss: 1.02e-06, NSE: 0.76654, MSE: 39993.87500
2025-11-05 00:15:35,267: Epoch 16 average loss: avg_loss: 5.97e-07, avg_total_loss: 5.97e-07
2025-11-05 00:15:35,891: Epoch 17 average loss: avg_loss: 6.22e-07, avg_total_loss: 6.22e-07
2025-11-05 00:15:36,505: Epoch 18 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:15:37,125: Epoch 19 average loss: avg_loss: 6.32e-07, avg_total_loss: 6.32e-07
2025-11-05 00:15:37,728: Epoch 20 average loss: avg_loss: 6.59e-07, avg_total_loss: 6.59e-07
2025-11-05 00:15:38,028: Epoch 20 average validation loss: 8.42e-07 -- Median validation metrics: avg_loss: 8.42e-07, NSE: 0.80612, MSE: 33214.73438
2025-11-05 00:15:38,645: Epoch 21 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:15:39,312: Epoch 22 average loss: avg_loss: 7.64e-07, avg_total_loss: 7.64e-07
2025-11-05 00:15:39,925: Epoch 23 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:15:39,926: Setting learning rate to 0.005
2025-11-05 00:15:40,537: Epoch 24 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:15:41,174: Epoch 25 average loss: avg_loss: 6.43e-07, avg_total_loss: 6.43e-07
2025-11-05 00:15:41,505: Epoch 25 average validation loss: 8.47e-07 -- Median validation metrics: avg_loss: 8.47e-07, NSE: 0.80584, MSE: 33261.32031
2025-11-05 00:15:42,098: Epoch 26 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:15:42,737: Epoch 27 average loss: avg_loss: 4.48e-07, avg_total_loss: 4.48e-07
2025-11-05 00:15:43,351: Epoch 28 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:15:43,961: Epoch 29 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:15:44,566: Epoch 30 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:15:44,868: Epoch 30 average validation loss: 9.45e-07 -- Median validation metrics: avg_loss: 9.45e-07, NSE: 0.78460, MSE: 36900.85938
2025-11-05 00:15:45,495: Epoch 31 average loss: avg_loss: 4.81e-07, avg_total_loss: 4.81e-07
2025-11-05 00:15:46,128: Epoch 32 average loss: avg_loss: 3.87e-07, avg_total_loss: 3.87e-07
2025-11-05 00:15:46,762: Epoch 33 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:15:47,412: Epoch 34 average loss: avg_loss: 4.43e-07, avg_total_loss: 4.43e-07
2025-11-05 00:15:48,007: Epoch 35 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:15:48,365: Epoch 35 average validation loss: 9.92e-07 -- Median validation metrics: avg_loss: 9.92e-07, NSE: 0.77291, MSE: 38903.09375
2025-11-05 00:15:48,367: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:15:48,368: Early stopping triggered at epoch 35
2025-11-05 00:15:48,385: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\model_epoch035.pt
2025-11-05 00:15:48,612: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:15:48,614: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001523\validation\model_epoch035\validation_results.p
2025-11-05 00:15:49,317: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\output.log initialized.
2025-11-05 00:15:49,318: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549
2025-11-05 00:15:49,319: ### Run configurations for testing_run
2025-11-05 00:15:49,320: experiment_name: testing_run
2025-11-05 00:15:49,322: train_basin_file: calpella
2025-11-05 00:15:49,323: validation_basin_file: calpella
2025-11-05 00:15:49,323: test_basin_file: calpella
2025-11-05 00:15:49,324: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:15:49,325: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:15:49,326: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:15:49,328: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:15:49,329: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:15:49,330: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:15:49,332: device: cuda:0
2025-11-05 00:15:49,333: physics_informed: False
2025-11-05 00:15:49,333: physics_data_file: None
2025-11-05 00:15:49,334: validate_every: 5
2025-11-05 00:15:49,335: validate_n_random_basins: 1
2025-11-05 00:15:49,336: metrics: ['NSE', 'MSE']
2025-11-05 00:15:49,337: model: cudalstm
2025-11-05 00:15:49,338: head: regression
2025-11-05 00:15:49,338: output_activation: linear
2025-11-05 00:15:49,339: hidden_size: 256
2025-11-05 00:15:49,340: initial_forget_bias: 3
2025-11-05 00:15:49,341: output_dropout: 0.4
2025-11-05 00:15:49,342: num_layers: 1
2025-11-05 00:15:49,343: dev_mode: True
2025-11-05 00:15:49,343: optimizer: Adam
2025-11-05 00:15:49,344: loss: NSE
2025-11-05 00:15:49,344: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:15:49,345: batch_size: 128
2025-11-05 00:15:49,345: epochs: 48
2025-11-05 00:15:49,346: clip_gradient_norm: 1
2025-11-05 00:15:49,347: predict_last_n: 1
2025-11-05 00:15:49,347: seq_length: 120
2025-11-05 00:15:49,348: log_interval: 16
2025-11-05 00:15:49,349: log_tensorboard: True
2025-11-05 00:15:49,349: log_n_figures: 1
2025-11-05 00:15:49,350: save_weights_every: 48
2025-11-05 00:15:49,351: early_stopping: True
2025-11-05 00:15:49,352: early_stopping_mode: patience
2025-11-05 00:15:49,353: patience_early_stopping: 3
2025-11-05 00:15:49,354: min_delta_early_stopping: 0.0
2025-11-05 00:15:49,355: minimum_epochs_before_early_stopping: 10
2025-11-05 00:15:49,356: early_stopping_slope_window: 7
2025-11-05 00:15:49,357: early_stopping_slope_patience: 2
2025-11-05 00:15:49,357: early_stopping_slope_min_epoch: 8
2025-11-05 00:15:49,359: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:15:49,359: early_stopping_slope_use_log: True
2025-11-05 00:15:49,360: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:15:49,361: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:15:49,362: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:15:49,363: early_stopping_slope_variance_guard: True
2025-11-05 00:15:49,364: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:15:49,364: dataset: russian_river
2025-11-05 00:15:49,365: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:15:49,366: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:15:49,366: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:15:49,367: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:15:49,368: hourly: False
2025-11-05 00:15:49,369: is_mts: False
2025-11-05 00:15:49,369: is_mts_data: False
2025-11-05 00:15:49,370: verbose: True
2025-11-05 00:15:49,371: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549
2025-11-05 00:15:49,372: run_label: BASELINE
2025-11-05 00:15:49,373: number_of_basins: 1
2025-11-05 00:15:49,374: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\train_data
2025-11-05 00:15:49,374: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\img_log
2025-11-05 00:15:49,377: ### Device cuda:0 will be used for training
2025-11-05 00:15:49,378: Loading basin data into xarray data set.
2025-11-05 00:15:49,519: Calculating target variable stds per basin
2025-11-05 00:15:49,526: Create lookup table and convert to pytorch tensor
2025-11-05 00:15:49,650: Early stopping enabled: mode=patience
2025-11-05 00:15:50,047: Epoch 1 average loss: avg_loss: 3.81e-06, avg_total_loss: 3.81e-06
2025-11-05 00:15:50,386: Epoch 2 average loss: avg_loss: 2.48e-06, avg_total_loss: 2.48e-06
2025-11-05 00:15:50,734: Epoch 3 average loss: avg_loss: 1.85e-06, avg_total_loss: 1.85e-06
2025-11-05 00:15:51,072: Epoch 4 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:15:51,446: Epoch 5 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:15:51,864: Epoch 5 average validation loss: 1.16e-06 -- Median validation metrics: avg_loss: 1.16e-06, NSE: 0.73327, MSE: 45694.65234
2025-11-05 00:15:52,189: Epoch 6 average loss: avg_loss: 8.97e-07, avg_total_loss: 8.97e-07
2025-11-05 00:15:52,512: Epoch 7 average loss: avg_loss: 9.34e-07, avg_total_loss: 9.34e-07
2025-11-05 00:15:52,869: Epoch 8 average loss: avg_loss: 1.46e-06, avg_total_loss: 1.46e-06
2025-11-05 00:15:53,184: Epoch 9 average loss: avg_loss: 8.37e-07, avg_total_loss: 8.37e-07
2025-11-05 00:15:53,515: Epoch 10 average loss: avg_loss: 9.15e-07, avg_total_loss: 9.15e-07
2025-11-05 00:15:53,790: Epoch 10 average validation loss: 1.10e-06 -- Median validation metrics: avg_loss: 1.10e-06, NSE: 0.75135, MSE: 42597.13672
2025-11-05 00:15:54,115: Epoch 11 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:15:54,446: Epoch 12 average loss: avg_loss: 7.25e-07, avg_total_loss: 7.25e-07
2025-11-05 00:15:54,799: Epoch 13 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:15:55,107: Epoch 14 average loss: avg_loss: 6.84e-07, avg_total_loss: 6.84e-07
2025-11-05 00:15:55,434: Epoch 15 average loss: avg_loss: 7.28e-07, avg_total_loss: 7.28e-07
2025-11-05 00:15:55,722: Epoch 15 average validation loss: 1.00e-06 -- Median validation metrics: avg_loss: 1.00e-06, NSE: 0.77039, MSE: 39334.32422
2025-11-05 00:15:56,044: Epoch 16 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:15:56,364: Epoch 17 average loss: avg_loss: 6.68e-07, avg_total_loss: 6.68e-07
2025-11-05 00:15:56,697: Epoch 18 average loss: avg_loss: 6.52e-07, avg_total_loss: 6.52e-07
2025-11-05 00:15:57,015: Epoch 19 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:15:57,338: Epoch 20 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:15:57,813: Epoch 20 average validation loss: 8.98e-07 -- Median validation metrics: avg_loss: 8.98e-07, NSE: 0.79306, MSE: 35451.29297
2025-11-05 00:15:58,131: Epoch 21 average loss: avg_loss: 5.29e-07, avg_total_loss: 5.29e-07
2025-11-05 00:15:58,455: Epoch 22 average loss: avg_loss: 5.17e-07, avg_total_loss: 5.17e-07
2025-11-05 00:15:58,774: Epoch 23 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:15:58,775: Setting learning rate to 0.005
2025-11-05 00:15:59,119: Epoch 24 average loss: avg_loss: 4.66e-07, avg_total_loss: 4.66e-07
2025-11-05 00:15:59,430: Epoch 25 average loss: avg_loss: 4.40e-07, avg_total_loss: 4.40e-07
2025-11-05 00:15:59,751: Epoch 25 average validation loss: 9.46e-07 -- Median validation metrics: avg_loss: 9.46e-07, NSE: 0.78222, MSE: 37307.90234
2025-11-05 00:16:00,061: Epoch 26 average loss: avg_loss: 4.36e-07, avg_total_loss: 4.36e-07
2025-11-05 00:16:00,391: Epoch 27 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:16:00,707: Epoch 28 average loss: avg_loss: 4.36e-07, avg_total_loss: 4.36e-07
2025-11-05 00:16:01,051: Epoch 29 average loss: avg_loss: 3.83e-07, avg_total_loss: 3.83e-07
2025-11-05 00:16:01,408: Epoch 30 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:16:01,683: Epoch 30 average validation loss: 1.00e-06 -- Median validation metrics: avg_loss: 1.00e-06, NSE: 0.76957, MSE: 39474.73047
2025-11-05 00:16:01,995: Epoch 31 average loss: avg_loss: 3.58e-07, avg_total_loss: 3.58e-07
2025-11-05 00:16:02,356: Epoch 32 average loss: avg_loss: 3.63e-07, avg_total_loss: 3.63e-07
2025-11-05 00:16:02,685: Epoch 33 average loss: avg_loss: 3.82e-07, avg_total_loss: 3.82e-07
2025-11-05 00:16:02,982: Epoch 34 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:16:03,328: Epoch 35 average loss: avg_loss: 3.66e-07, avg_total_loss: 3.66e-07
2025-11-05 00:16:03,601: Epoch 35 average validation loss: 9.83e-07 -- Median validation metrics: avg_loss: 9.83e-07, NSE: 0.77380, MSE: 38750.57031
2025-11-05 00:16:03,602: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:16:03,603: Early stopping triggered at epoch 35
2025-11-05 00:16:03,620: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\model_epoch035.pt
2025-11-05 00:16:03,820: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:16:03,822: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001549\validation\model_epoch035\validation_results.p
2025-11-05 00:16:04,534: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\output.log initialized.
2025-11-05 00:16:04,536: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604
2025-11-05 00:16:04,536: ### Run configurations for testing_run
2025-11-05 00:16:04,537: experiment_name: testing_run
2025-11-05 00:16:04,538: train_basin_file: calpella
2025-11-05 00:16:04,539: validation_basin_file: calpella
2025-11-05 00:16:04,539: test_basin_file: calpella
2025-11-05 00:16:04,541: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:04,542: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:04,542: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:04,543: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:04,544: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:04,545: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:04,546: device: cuda:0
2025-11-05 00:16:04,547: physics_informed: False
2025-11-05 00:16:04,548: physics_data_file: None
2025-11-05 00:16:04,548: validate_every: 5
2025-11-05 00:16:04,550: validate_n_random_basins: 1
2025-11-05 00:16:04,550: metrics: ['NSE', 'MSE']
2025-11-05 00:16:04,551: model: cudalstm
2025-11-05 00:16:04,552: head: regression
2025-11-05 00:16:04,553: output_activation: linear
2025-11-05 00:16:04,554: hidden_size: 256
2025-11-05 00:16:04,554: initial_forget_bias: 3
2025-11-05 00:16:04,555: output_dropout: 0.4
2025-11-05 00:16:04,556: num_layers: 1
2025-11-05 00:16:04,556: dev_mode: True
2025-11-05 00:16:04,557: optimizer: Adam
2025-11-05 00:16:04,557: loss: NSE
2025-11-05 00:16:04,558: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:16:04,558: batch_size: 256
2025-11-05 00:16:04,559: epochs: 48
2025-11-05 00:16:04,560: clip_gradient_norm: 1
2025-11-05 00:16:04,561: predict_last_n: 1
2025-11-05 00:16:04,561: seq_length: 120
2025-11-05 00:16:04,562: log_interval: 16
2025-11-05 00:16:04,562: log_tensorboard: True
2025-11-05 00:16:04,563: log_n_figures: 1
2025-11-05 00:16:04,563: save_weights_every: 48
2025-11-05 00:16:04,564: early_stopping: True
2025-11-05 00:16:04,564: early_stopping_mode: patience
2025-11-05 00:16:04,565: patience_early_stopping: 3
2025-11-05 00:16:04,565: min_delta_early_stopping: 0.0
2025-11-05 00:16:04,566: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:04,566: early_stopping_slope_window: 7
2025-11-05 00:16:04,567: early_stopping_slope_patience: 2
2025-11-05 00:16:04,568: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:04,569: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:04,569: early_stopping_slope_use_log: True
2025-11-05 00:16:04,570: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:04,571: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:04,571: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:04,572: early_stopping_slope_variance_guard: True
2025-11-05 00:16:04,573: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:04,573: dataset: russian_river
2025-11-05 00:16:04,574: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:04,575: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA']
2025-11-05 00:16:04,575: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:04,576: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:04,576: hourly: False
2025-11-05 00:16:04,577: is_mts: False
2025-11-05 00:16:04,578: is_mts_data: False
2025-11-05 00:16:04,579: verbose: True
2025-11-05 00:16:04,579: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604
2025-11-05 00:16:04,580: run_label: BASELINE
2025-11-05 00:16:04,581: number_of_basins: 1
2025-11-05 00:16:04,582: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\train_data
2025-11-05 00:16:04,582: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\img_log
2025-11-05 00:16:04,584: ### Device cuda:0 will be used for training
2025-11-05 00:16:04,585: Loading basin data into xarray data set.
2025-11-05 00:16:04,736: Calculating target variable stds per basin
2025-11-05 00:16:04,744: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:04,890: Early stopping enabled: mode=patience
2025-11-05 00:16:05,162: Epoch 1 average loss: avg_loss: 4.17e-06, avg_total_loss: 4.17e-06
2025-11-05 00:16:05,395: Epoch 2 average loss: avg_loss: 2.74e-06, avg_total_loss: 2.74e-06
2025-11-05 00:16:05,609: Epoch 3 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:16:05,826: Epoch 4 average loss: avg_loss: 1.67e-06, avg_total_loss: 1.67e-06
2025-11-05 00:16:06,037: Epoch 5 average loss: avg_loss: 1.51e-06, avg_total_loss: 1.51e-06
2025-11-05 00:16:06,454: Epoch 5 average validation loss: 1.30e-06 -- Median validation metrics: avg_loss: 1.30e-06, NSE: 0.67139, MSE: 56295.25781
2025-11-05 00:16:06,687: Epoch 6 average loss: avg_loss: 1.34e-06, avg_total_loss: 1.34e-06
2025-11-05 00:16:06,902: Epoch 7 average loss: avg_loss: 1.52e-06, avg_total_loss: 1.52e-06
2025-11-05 00:16:07,126: Epoch 8 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:16:07,358: Epoch 9 average loss: avg_loss: 1.17e-06, avg_total_loss: 1.17e-06
2025-11-05 00:16:07,572: Epoch 10 average loss: avg_loss: 1.07e-06, avg_total_loss: 1.07e-06
2025-11-05 00:16:07,859: Epoch 10 average validation loss: 9.70e-07 -- Median validation metrics: avg_loss: 9.70e-07, NSE: 0.76021, MSE: 41078.93359
2025-11-05 00:16:08,060: Epoch 11 average loss: avg_loss: 9.40e-07, avg_total_loss: 9.40e-07
2025-11-05 00:16:08,298: Epoch 12 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:16:08,499: Epoch 13 average loss: avg_loss: 9.13e-07, avg_total_loss: 9.13e-07
2025-11-05 00:16:08,718: Epoch 14 average loss: avg_loss: 8.12e-07, avg_total_loss: 8.12e-07
2025-11-05 00:16:08,936: Epoch 15 average loss: avg_loss: 8.03e-07, avg_total_loss: 8.03e-07
2025-11-05 00:16:09,196: Epoch 15 average validation loss: 1.04e-06 -- Median validation metrics: avg_loss: 1.04e-06, NSE: 0.74028, MSE: 44492.76172
2025-11-05 00:16:09,402: Epoch 16 average loss: avg_loss: 8.51e-07, avg_total_loss: 8.51e-07
2025-11-05 00:16:09,615: Epoch 17 average loss: avg_loss: 9.70e-07, avg_total_loss: 9.70e-07
2025-11-05 00:16:09,821: Epoch 18 average loss: avg_loss: 8.57e-07, avg_total_loss: 8.57e-07
2025-11-05 00:16:10,029: Epoch 19 average loss: avg_loss: 8.19e-07, avg_total_loss: 8.19e-07
2025-11-05 00:16:10,251: Epoch 20 average loss: avg_loss: 7.86e-07, avg_total_loss: 7.86e-07
2025-11-05 00:16:10,526: Epoch 20 average validation loss: 8.93e-07 -- Median validation metrics: avg_loss: 8.93e-07, NSE: 0.77684, MSE: 38230.64062
2025-11-05 00:16:10,730: Epoch 21 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:16:10,958: Epoch 22 average loss: avg_loss: 7.21e-07, avg_total_loss: 7.21e-07
2025-11-05 00:16:11,165: Epoch 23 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:16:11,165: Setting learning rate to 0.005
2025-11-05 00:16:11,378: Epoch 24 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:16:11,604: Epoch 25 average loss: avg_loss: 7.01e-07, avg_total_loss: 7.01e-07
2025-11-05 00:16:11,884: Epoch 25 average validation loss: 8.09e-07 -- Median validation metrics: avg_loss: 8.09e-07, NSE: 0.79580, MSE: 34981.29688
2025-11-05 00:16:12,089: Epoch 26 average loss: avg_loss: 6.39e-07, avg_total_loss: 6.39e-07
2025-11-05 00:16:12,310: Epoch 27 average loss: avg_loss: 6.12e-07, avg_total_loss: 6.12e-07
2025-11-05 00:16:12,523: Epoch 28 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:16:12,727: Epoch 29 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:16:12,947: Epoch 30 average loss: avg_loss: 5.84e-07, avg_total_loss: 5.84e-07
2025-11-05 00:16:13,200: Epoch 30 average validation loss: 9.50e-07 -- Median validation metrics: avg_loss: 9.50e-07, NSE: 0.76127, MSE: 40897.39844
2025-11-05 00:16:13,403: Epoch 31 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:16:13,609: Epoch 32 average loss: avg_loss: 6.35e-07, avg_total_loss: 6.35e-07
2025-11-05 00:16:13,842: Epoch 33 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:16:14,059: Epoch 34 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:16:14,289: Epoch 35 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:16:14,594: Epoch 35 average validation loss: 8.09e-07 -- Median validation metrics: avg_loss: 8.09e-07, NSE: 0.79588, MSE: 34968.87109
2025-11-05 00:16:14,595: Setting learning rate to 0.001
2025-11-05 00:16:14,800: Epoch 36 average loss: avg_loss: 5.93e-07, avg_total_loss: 5.93e-07
2025-11-05 00:16:15,009: Epoch 37 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:16:15,237: Epoch 38 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:16:15,449: Epoch 39 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:16:15,673: Epoch 40 average loss: avg_loss: 4.70e-07, avg_total_loss: 4.70e-07
2025-11-05 00:16:15,971: Epoch 40 average validation loss: 8.48e-07 -- Median validation metrics: avg_loss: 8.48e-07, NSE: 0.78436, MSE: 36941.06250
2025-11-05 00:16:15,972: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:16:15,973: Early stopping triggered at epoch 40
2025-11-05 00:16:15,993: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\model_epoch040.pt
2025-11-05 00:16:16,206: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:16:16,208: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001604\validation\model_epoch040\validation_results.p
2025-11-05 00:16:17,169: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\output.log initialized.
2025-11-05 00:16:17,171: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617
2025-11-05 00:16:17,172: ### Run configurations for testing_run
2025-11-05 00:16:17,173: experiment_name: testing_run
2025-11-05 00:16:17,174: train_basin_file: calpella
2025-11-05 00:16:17,175: validation_basin_file: calpella
2025-11-05 00:16:17,176: test_basin_file: calpella
2025-11-05 00:16:17,178: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:17,179: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:17,181: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:17,182: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:17,184: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:17,186: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:17,188: device: cuda:0
2025-11-05 00:16:17,189: physics_informed: True
2025-11-05 00:16:17,192: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:16:17,193: validate_every: 5
2025-11-05 00:16:17,194: validate_n_random_basins: 1
2025-11-05 00:16:17,195: metrics: ['NSE', 'MSE']
2025-11-05 00:16:17,196: model: cudalstm
2025-11-05 00:16:17,197: head: regression
2025-11-05 00:16:17,199: output_activation: linear
2025-11-05 00:16:17,200: hidden_size: 64
2025-11-05 00:16:17,200: initial_forget_bias: 3
2025-11-05 00:16:17,202: output_dropout: 0.4
2025-11-05 00:16:17,203: num_layers: 1
2025-11-05 00:16:17,203: dev_mode: True
2025-11-05 00:16:17,204: optimizer: Adam
2025-11-05 00:16:17,205: loss: NSE
2025-11-05 00:16:17,206: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:16:17,208: batch_size: 64
2025-11-05 00:16:17,209: epochs: 16
2025-11-05 00:16:17,210: clip_gradient_norm: 1
2025-11-05 00:16:17,212: predict_last_n: 1
2025-11-05 00:16:17,214: seq_length: 90
2025-11-05 00:16:17,215: log_interval: 16
2025-11-05 00:16:17,215: log_tensorboard: True
2025-11-05 00:16:17,216: log_n_figures: 1
2025-11-05 00:16:17,217: save_weights_every: 16
2025-11-05 00:16:17,218: early_stopping: True
2025-11-05 00:16:17,220: early_stopping_mode: patience
2025-11-05 00:16:17,221: patience_early_stopping: 3
2025-11-05 00:16:17,221: min_delta_early_stopping: 0.0
2025-11-05 00:16:17,223: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:17,223: early_stopping_slope_window: 7
2025-11-05 00:16:17,224: early_stopping_slope_patience: 2
2025-11-05 00:16:17,225: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:17,226: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:17,227: early_stopping_slope_use_log: True
2025-11-05 00:16:17,228: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:17,229: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:17,230: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:17,232: early_stopping_slope_variance_guard: True
2025-11-05 00:16:17,233: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:17,234: dataset: russian_river
2025-11-05 00:16:17,234: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:17,236: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:16:17,236: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:17,237: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:17,237: hourly: False
2025-11-05 00:16:17,238: is_mts: False
2025-11-05 00:16:17,239: is_mts_data: False
2025-11-05 00:16:17,240: verbose: True
2025-11-05 00:16:17,240: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617
2025-11-05 00:16:17,242: run_label: BASELINE
2025-11-05 00:16:17,242: number_of_basins: 1
2025-11-05 00:16:17,244: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\train_data
2025-11-05 00:16:17,244: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\img_log
2025-11-05 00:16:17,247: ### Device cuda:0 will be used for training
2025-11-05 00:16:17,248: Loading basin data into xarray data set.
2025-11-05 00:16:17,560: Calculating target variable stds per basin
2025-11-05 00:16:17,574: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:17,728: Early stopping enabled: mode=patience
2025-11-05 00:16:18,154: Epoch 1 average loss: avg_loss: 2.06e-06, avg_total_loss: 2.06e-06
2025-11-05 00:16:18,626: Epoch 2 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:16:19,100: Epoch 3 average loss: avg_loss: 8.65e-07, avg_total_loss: 8.65e-07
2025-11-05 00:16:19,548: Epoch 4 average loss: avg_loss: 7.84e-07, avg_total_loss: 7.84e-07
2025-11-05 00:16:19,928: Epoch 5 average loss: avg_loss: 7.56e-07, avg_total_loss: 7.56e-07
2025-11-05 00:16:20,420: Epoch 5 average validation loss: 6.79e-07 -- Median validation metrics: avg_loss: 6.79e-07, NSE: 0.84362, MSE: 26789.27148
2025-11-05 00:16:20,887: Epoch 6 average loss: avg_loss: 8.13e-07, avg_total_loss: 8.13e-07
2025-11-05 00:16:21,344: Epoch 7 average loss: avg_loss: 7.83e-07, avg_total_loss: 7.83e-07
2025-11-05 00:16:21,345: Setting learning rate to 0.005
2025-11-05 00:16:21,834: Epoch 8 average loss: avg_loss: 6.52e-07, avg_total_loss: 6.52e-07
2025-11-05 00:16:22,263: Epoch 9 average loss: avg_loss: 6.02e-07, avg_total_loss: 6.02e-07
2025-11-05 00:16:22,751: Epoch 10 average loss: avg_loss: 6.77e-07, avg_total_loss: 6.77e-07
2025-11-05 00:16:23,094: Epoch 10 average validation loss: 7.22e-07 -- Median validation metrics: avg_loss: 7.22e-07, NSE: 0.83459, MSE: 28336.00195
2025-11-05 00:16:23,826: Epoch 11 average loss: avg_loss: 6.76e-07, avg_total_loss: 6.76e-07
2025-11-05 00:16:23,826: Setting learning rate to 0.001
2025-11-05 00:16:24,322: Epoch 12 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:16:24,803: Epoch 13 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:16:25,272: Epoch 14 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:16:25,842: Epoch 15 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:16:26,166: Epoch 15 average validation loss: 6.95e-07 -- Median validation metrics: avg_loss: 6.95e-07, NSE: 0.84070, MSE: 27290.53711
2025-11-05 00:16:26,642: Epoch 16 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:16:26,667: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\model_epoch016.pt
2025-11-05 00:16:27,017: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:16:27,019: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001617\validation\model_epoch016\validation_results.p
2025-11-05 00:16:28,089: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\output.log initialized.
2025-11-05 00:16:28,090: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628
2025-11-05 00:16:28,091: ### Run configurations for testing_run
2025-11-05 00:16:28,092: experiment_name: testing_run
2025-11-05 00:16:28,093: train_basin_file: calpella
2025-11-05 00:16:28,094: validation_basin_file: calpella
2025-11-05 00:16:28,094: test_basin_file: calpella
2025-11-05 00:16:28,095: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:28,096: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:28,096: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:28,097: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:28,098: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:28,099: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:28,099: device: cuda:0
2025-11-05 00:16:28,100: physics_informed: True
2025-11-05 00:16:28,101: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:16:28,102: validate_every: 5
2025-11-05 00:16:28,102: validate_n_random_basins: 1
2025-11-05 00:16:28,103: metrics: ['NSE', 'MSE']
2025-11-05 00:16:28,104: model: cudalstm
2025-11-05 00:16:28,105: head: regression
2025-11-05 00:16:28,106: output_activation: linear
2025-11-05 00:16:28,107: hidden_size: 64
2025-11-05 00:16:28,108: initial_forget_bias: 3
2025-11-05 00:16:28,108: output_dropout: 0.4
2025-11-05 00:16:28,109: num_layers: 1
2025-11-05 00:16:28,110: dev_mode: True
2025-11-05 00:16:28,111: optimizer: Adam
2025-11-05 00:16:28,112: loss: NSE
2025-11-05 00:16:28,112: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:16:28,113: batch_size: 128
2025-11-05 00:16:28,114: epochs: 16
2025-11-05 00:16:28,115: clip_gradient_norm: 1
2025-11-05 00:16:28,115: predict_last_n: 1
2025-11-05 00:16:28,116: seq_length: 90
2025-11-05 00:16:28,117: log_interval: 16
2025-11-05 00:16:28,118: log_tensorboard: True
2025-11-05 00:16:28,119: log_n_figures: 1
2025-11-05 00:16:28,120: save_weights_every: 16
2025-11-05 00:16:28,121: early_stopping: True
2025-11-05 00:16:28,122: early_stopping_mode: patience
2025-11-05 00:16:28,122: patience_early_stopping: 3
2025-11-05 00:16:28,123: min_delta_early_stopping: 0.0
2025-11-05 00:16:28,124: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:28,125: early_stopping_slope_window: 7
2025-11-05 00:16:28,126: early_stopping_slope_patience: 2
2025-11-05 00:16:28,127: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:28,128: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:28,129: early_stopping_slope_use_log: True
2025-11-05 00:16:28,130: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:28,130: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:28,131: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:28,132: early_stopping_slope_variance_guard: True
2025-11-05 00:16:28,133: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:28,134: dataset: russian_river
2025-11-05 00:16:28,135: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:28,136: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:16:28,136: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:28,137: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:28,138: hourly: False
2025-11-05 00:16:28,139: is_mts: False
2025-11-05 00:16:28,140: is_mts_data: False
2025-11-05 00:16:28,140: verbose: True
2025-11-05 00:16:28,141: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628
2025-11-05 00:16:28,143: run_label: BASELINE
2025-11-05 00:16:28,143: number_of_basins: 1
2025-11-05 00:16:28,144: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\train_data
2025-11-05 00:16:28,145: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\img_log
2025-11-05 00:16:28,148: ### Device cuda:0 will be used for training
2025-11-05 00:16:28,149: Loading basin data into xarray data set.
2025-11-05 00:16:28,430: Calculating target variable stds per basin
2025-11-05 00:16:28,443: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:28,611: Early stopping enabled: mode=patience
2025-11-05 00:16:29,190: Epoch 1 average loss: avg_loss: 2.51e-06, avg_total_loss: 2.51e-06
2025-11-05 00:16:29,505: Epoch 2 average loss: avg_loss: 1.37e-06, avg_total_loss: 1.37e-06
2025-11-05 00:16:29,804: Epoch 3 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:16:30,112: Epoch 4 average loss: avg_loss: 8.87e-07, avg_total_loss: 8.87e-07
2025-11-05 00:16:30,407: Epoch 5 average loss: avg_loss: 8.05e-07, avg_total_loss: 8.05e-07
2025-11-05 00:16:30,942: Epoch 5 average validation loss: 8.27e-07 -- Median validation metrics: avg_loss: 8.27e-07, NSE: 0.81149, MSE: 32294.00977
2025-11-05 00:16:31,213: Epoch 6 average loss: avg_loss: 7.68e-07, avg_total_loss: 7.68e-07
2025-11-05 00:16:31,513: Epoch 7 average loss: avg_loss: 6.87e-07, avg_total_loss: 6.87e-07
2025-11-05 00:16:31,514: Setting learning rate to 0.005
2025-11-05 00:16:31,800: Epoch 8 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:16:32,106: Epoch 9 average loss: avg_loss: 6.70e-07, avg_total_loss: 6.70e-07
2025-11-05 00:16:32,387: Epoch 10 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:16:32,723: Epoch 10 average validation loss: 7.23e-07 -- Median validation metrics: avg_loss: 7.23e-07, NSE: 0.83409, MSE: 28421.63086
2025-11-05 00:16:32,991: Epoch 11 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:16:32,992: Setting learning rate to 0.001
2025-11-05 00:16:33,219: Epoch 12 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:16:33,431: Epoch 13 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:16:33,683: Epoch 14 average loss: avg_loss: 5.09e-07, avg_total_loss: 5.09e-07
2025-11-05 00:16:33,896: Epoch 15 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:16:34,180: Epoch 15 average validation loss: 7.19e-07 -- Median validation metrics: avg_loss: 7.19e-07, NSE: 0.83487, MSE: 28288.09570
2025-11-05 00:16:34,392: Epoch 16 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:16:34,413: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\model_epoch016.pt
2025-11-05 00:16:34,699: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:16:34,701: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001628\validation\model_epoch016\validation_results.p
2025-11-05 00:16:35,405: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\output.log initialized.
2025-11-05 00:16:35,406: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635
2025-11-05 00:16:35,406: ### Run configurations for testing_run
2025-11-05 00:16:35,408: experiment_name: testing_run
2025-11-05 00:16:35,408: train_basin_file: calpella
2025-11-05 00:16:35,409: validation_basin_file: calpella
2025-11-05 00:16:35,410: test_basin_file: calpella
2025-11-05 00:16:35,411: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:35,411: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:35,412: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:35,412: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:35,413: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:35,414: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:35,414: device: cuda:0
2025-11-05 00:16:35,415: physics_informed: True
2025-11-05 00:16:35,416: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:16:35,416: validate_every: 5
2025-11-05 00:16:35,417: validate_n_random_basins: 1
2025-11-05 00:16:35,417: metrics: ['NSE', 'MSE']
2025-11-05 00:16:35,418: model: cudalstm
2025-11-05 00:16:35,418: head: regression
2025-11-05 00:16:35,419: output_activation: linear
2025-11-05 00:16:35,419: hidden_size: 64
2025-11-05 00:16:35,420: initial_forget_bias: 3
2025-11-05 00:16:35,421: output_dropout: 0.4
2025-11-05 00:16:35,421: num_layers: 1
2025-11-05 00:16:35,422: dev_mode: True
2025-11-05 00:16:35,423: optimizer: Adam
2025-11-05 00:16:35,423: loss: NSE
2025-11-05 00:16:35,424: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:16:35,424: batch_size: 256
2025-11-05 00:16:35,425: epochs: 16
2025-11-05 00:16:35,425: clip_gradient_norm: 1
2025-11-05 00:16:35,426: predict_last_n: 1
2025-11-05 00:16:35,427: seq_length: 90
2025-11-05 00:16:35,427: log_interval: 16
2025-11-05 00:16:35,428: log_tensorboard: True
2025-11-05 00:16:35,429: log_n_figures: 1
2025-11-05 00:16:35,430: save_weights_every: 16
2025-11-05 00:16:35,431: early_stopping: True
2025-11-05 00:16:35,431: early_stopping_mode: patience
2025-11-05 00:16:35,432: patience_early_stopping: 3
2025-11-05 00:16:35,432: min_delta_early_stopping: 0.0
2025-11-05 00:16:35,433: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:35,434: early_stopping_slope_window: 7
2025-11-05 00:16:35,434: early_stopping_slope_patience: 2
2025-11-05 00:16:35,435: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:35,435: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:35,436: early_stopping_slope_use_log: True
2025-11-05 00:16:35,437: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:35,437: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:35,438: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:35,439: early_stopping_slope_variance_guard: True
2025-11-05 00:16:35,439: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:35,440: dataset: russian_river
2025-11-05 00:16:35,440: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:35,441: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:16:35,441: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:35,442: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:35,443: hourly: False
2025-11-05 00:16:35,443: is_mts: False
2025-11-05 00:16:35,444: is_mts_data: False
2025-11-05 00:16:35,445: verbose: True
2025-11-05 00:16:35,445: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635
2025-11-05 00:16:35,446: run_label: BASELINE
2025-11-05 00:16:35,447: number_of_basins: 1
2025-11-05 00:16:35,448: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\train_data
2025-11-05 00:16:35,448: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\img_log
2025-11-05 00:16:35,450: ### Device cuda:0 will be used for training
2025-11-05 00:16:35,451: Loading basin data into xarray data set.
2025-11-05 00:16:35,693: Calculating target variable stds per basin
2025-11-05 00:16:35,701: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:35,816: Early stopping enabled: mode=patience
2025-11-05 00:16:36,024: Epoch 1 average loss: avg_loss: 2.58e-06, avg_total_loss: 2.58e-06
2025-11-05 00:16:36,237: Epoch 2 average loss: avg_loss: 1.55e-06, avg_total_loss: 1.55e-06
2025-11-05 00:16:36,450: Epoch 3 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:16:36,663: Epoch 4 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:16:36,791: Epoch 5 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:16:37,269: Epoch 5 average validation loss: 7.41e-07 -- Median validation metrics: avg_loss: 7.41e-07, NSE: 0.81159, MSE: 32276.58008
2025-11-05 00:16:37,410: Epoch 6 average loss: avg_loss: 8.18e-07, avg_total_loss: 8.18e-07
2025-11-05 00:16:37,545: Epoch 7 average loss: avg_loss: 7.19e-07, avg_total_loss: 7.19e-07
2025-11-05 00:16:37,546: Setting learning rate to 0.005
2025-11-05 00:16:37,674: Epoch 8 average loss: avg_loss: 7.47e-07, avg_total_loss: 7.47e-07
2025-11-05 00:16:37,834: Epoch 9 average loss: avg_loss: 7.66e-07, avg_total_loss: 7.66e-07
2025-11-05 00:16:37,969: Epoch 10 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:16:38,251: Epoch 10 average validation loss: 7.26e-07 -- Median validation metrics: avg_loss: 7.26e-07, NSE: 0.81681, MSE: 31382.40820
2025-11-05 00:16:38,362: Epoch 11 average loss: avg_loss: 6.51e-07, avg_total_loss: 6.51e-07
2025-11-05 00:16:38,363: Setting learning rate to 0.001
2025-11-05 00:16:38,514: Epoch 12 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:16:38,660: Epoch 13 average loss: avg_loss: 6.16e-07, avg_total_loss: 6.16e-07
2025-11-05 00:16:38,804: Epoch 14 average loss: avg_loss: 7.96e-07, avg_total_loss: 7.96e-07
2025-11-05 00:16:38,969: Epoch 15 average loss: avg_loss: 5.95e-07, avg_total_loss: 5.95e-07
2025-11-05 00:16:39,248: Epoch 15 average validation loss: 6.58e-07 -- Median validation metrics: avg_loss: 6.58e-07, NSE: 0.83307, MSE: 28597.63281
2025-11-05 00:16:39,375: Epoch 16 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:16:39,394: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\model_epoch016.pt
2025-11-05 00:16:39,654: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:16:39,656: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001635\validation\model_epoch016\validation_results.p
2025-11-05 00:16:40,527: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\output.log initialized.
2025-11-05 00:16:40,529: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640
2025-11-05 00:16:40,530: ### Run configurations for testing_run
2025-11-05 00:16:40,530: experiment_name: testing_run
2025-11-05 00:16:40,531: train_basin_file: calpella
2025-11-05 00:16:40,532: validation_basin_file: calpella
2025-11-05 00:16:40,533: test_basin_file: calpella
2025-11-05 00:16:40,534: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:40,535: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:40,536: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:40,537: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:40,538: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:40,539: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:40,540: device: cuda:0
2025-11-05 00:16:40,541: physics_informed: True
2025-11-05 00:16:40,542: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:16:40,543: validate_every: 5
2025-11-05 00:16:40,544: validate_n_random_basins: 1
2025-11-05 00:16:40,545: metrics: ['NSE', 'MSE']
2025-11-05 00:16:40,545: model: cudalstm
2025-11-05 00:16:40,546: head: regression
2025-11-05 00:16:40,547: output_activation: linear
2025-11-05 00:16:40,548: hidden_size: 64
2025-11-05 00:16:40,549: initial_forget_bias: 3
2025-11-05 00:16:40,550: output_dropout: 0.4
2025-11-05 00:16:40,551: num_layers: 1
2025-11-05 00:16:40,552: dev_mode: True
2025-11-05 00:16:40,553: optimizer: Adam
2025-11-05 00:16:40,554: loss: NSE
2025-11-05 00:16:40,555: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:16:40,556: batch_size: 64
2025-11-05 00:16:40,556: epochs: 32
2025-11-05 00:16:40,557: clip_gradient_norm: 1
2025-11-05 00:16:40,558: predict_last_n: 1
2025-11-05 00:16:40,559: seq_length: 90
2025-11-05 00:16:40,559: log_interval: 16
2025-11-05 00:16:40,560: log_tensorboard: True
2025-11-05 00:16:40,561: log_n_figures: 1
2025-11-05 00:16:40,562: save_weights_every: 32
2025-11-05 00:16:40,563: early_stopping: True
2025-11-05 00:16:40,563: early_stopping_mode: patience
2025-11-05 00:16:40,564: patience_early_stopping: 3
2025-11-05 00:16:40,565: min_delta_early_stopping: 0.0
2025-11-05 00:16:40,566: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:40,567: early_stopping_slope_window: 7
2025-11-05 00:16:40,567: early_stopping_slope_patience: 2
2025-11-05 00:16:40,568: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:40,569: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:40,570: early_stopping_slope_use_log: True
2025-11-05 00:16:40,571: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:40,571: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:40,572: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:40,573: early_stopping_slope_variance_guard: True
2025-11-05 00:16:40,574: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:40,575: dataset: russian_river
2025-11-05 00:16:40,576: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:40,577: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:16:40,578: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:40,579: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:40,579: hourly: False
2025-11-05 00:16:40,580: is_mts: False
2025-11-05 00:16:40,581: is_mts_data: False
2025-11-05 00:16:40,581: verbose: True
2025-11-05 00:16:40,582: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640
2025-11-05 00:16:40,583: run_label: BASELINE
2025-11-05 00:16:40,584: number_of_basins: 1
2025-11-05 00:16:40,585: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\train_data
2025-11-05 00:16:40,586: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\img_log
2025-11-05 00:16:40,588: ### Device cuda:0 will be used for training
2025-11-05 00:16:40,590: Loading basin data into xarray data set.
2025-11-05 00:16:40,857: Calculating target variable stds per basin
2025-11-05 00:16:40,871: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:41,017: Early stopping enabled: mode=patience
2025-11-05 00:16:41,559: Epoch 1 average loss: avg_loss: 2.29e-06, avg_total_loss: 2.29e-06
2025-11-05 00:16:42,482: Epoch 2 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:16:42,964: Epoch 3 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:16:43,418: Epoch 4 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:16:43,892: Epoch 5 average loss: avg_loss: 8.49e-07, avg_total_loss: 8.49e-07
2025-11-05 00:16:44,418: Epoch 5 average validation loss: 6.94e-07 -- Median validation metrics: avg_loss: 6.94e-07, NSE: 0.84005, MSE: 27401.11328
2025-11-05 00:16:45,067: Epoch 6 average loss: avg_loss: 7.00e-07, avg_total_loss: 7.00e-07
2025-11-05 00:16:45,515: Epoch 7 average loss: avg_loss: 7.58e-07, avg_total_loss: 7.58e-07
2025-11-05 00:16:45,980: Epoch 8 average loss: avg_loss: 6.78e-07, avg_total_loss: 6.78e-07
2025-11-05 00:16:46,434: Epoch 9 average loss: avg_loss: 7.66e-07, avg_total_loss: 7.66e-07
2025-11-05 00:16:46,972: Epoch 10 average loss: avg_loss: 6.79e-07, avg_total_loss: 6.79e-07
2025-11-05 00:16:47,279: Epoch 10 average validation loss: 7.24e-07 -- Median validation metrics: avg_loss: 7.24e-07, NSE: 0.83365, MSE: 28498.59961
2025-11-05 00:16:47,714: Epoch 11 average loss: avg_loss: 7.71e-07, avg_total_loss: 7.71e-07
2025-11-05 00:16:48,159: Epoch 12 average loss: avg_loss: 7.18e-07, avg_total_loss: 7.18e-07
2025-11-05 00:16:48,603: Epoch 13 average loss: avg_loss: 6.95e-07, avg_total_loss: 6.95e-07
2025-11-05 00:16:49,131: Epoch 14 average loss: avg_loss: 6.64e-07, avg_total_loss: 6.64e-07
2025-11-05 00:16:49,577: Epoch 15 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:16:49,860: Epoch 15 average validation loss: 6.86e-07 -- Median validation metrics: avg_loss: 6.86e-07, NSE: 0.84210, MSE: 27050.75781
2025-11-05 00:16:49,861: Setting learning rate to 0.005
2025-11-05 00:16:50,290: Epoch 16 average loss: avg_loss: 5.83e-07, avg_total_loss: 5.83e-07
2025-11-05 00:16:50,898: Epoch 17 average loss: avg_loss: 5.69e-07, avg_total_loss: 5.69e-07
2025-11-05 00:16:51,365: Epoch 18 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:16:51,855: Epoch 19 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:16:52,344: Epoch 20 average loss: avg_loss: 4.98e-07, avg_total_loss: 4.98e-07
2025-11-05 00:16:52,735: Epoch 20 average validation loss: 7.14e-07 -- Median validation metrics: avg_loss: 7.14e-07, NSE: 0.83614, MSE: 28071.65820
2025-11-05 00:16:53,419: Epoch 21 average loss: avg_loss: 5.23e-07, avg_total_loss: 5.23e-07
2025-11-05 00:16:53,869: Epoch 22 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:16:54,317: Epoch 23 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:16:54,318: Setting learning rate to 0.001
2025-11-05 00:16:54,800: Epoch 24 average loss: avg_loss: 4.69e-07, avg_total_loss: 4.69e-07
2025-11-05 00:16:55,371: Epoch 25 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:16:55,671: Epoch 25 average validation loss: 7.33e-07 -- Median validation metrics: avg_loss: 7.33e-07, NSE: 0.83172, MSE: 28827.89844
2025-11-05 00:16:56,081: Epoch 26 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:16:56,521: Epoch 27 average loss: avg_loss: 3.86e-07, avg_total_loss: 3.86e-07
2025-11-05 00:16:56,982: Epoch 28 average loss: avg_loss: 5.16e-07, avg_total_loss: 5.16e-07
2025-11-05 00:16:57,526: Epoch 29 average loss: avg_loss: 4.38e-07, avg_total_loss: 4.38e-07
2025-11-05 00:16:57,984: Epoch 30 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:16:58,266: Epoch 30 average validation loss: 7.31e-07 -- Median validation metrics: avg_loss: 7.31e-07, NSE: 0.83226, MSE: 28736.73633
2025-11-05 00:16:58,267: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:16:58,268: Early stopping triggered at epoch 30
2025-11-05 00:16:58,286: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\model_epoch030.pt
2025-11-05 00:16:58,557: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:16:58,569: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001640\validation\model_epoch030\validation_results.p
2025-11-05 00:16:59,279: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\output.log initialized.
2025-11-05 00:16:59,280: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659
2025-11-05 00:16:59,281: ### Run configurations for testing_run
2025-11-05 00:16:59,281: experiment_name: testing_run
2025-11-05 00:16:59,282: train_basin_file: calpella
2025-11-05 00:16:59,283: validation_basin_file: calpella
2025-11-05 00:16:59,283: test_basin_file: calpella
2025-11-05 00:16:59,284: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:16:59,285: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:16:59,285: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:16:59,286: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:16:59,287: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:16:59,288: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:16:59,288: device: cuda:0
2025-11-05 00:16:59,289: physics_informed: True
2025-11-05 00:16:59,290: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:16:59,291: validate_every: 5
2025-11-05 00:16:59,291: validate_n_random_basins: 1
2025-11-05 00:16:59,292: metrics: ['NSE', 'MSE']
2025-11-05 00:16:59,293: model: cudalstm
2025-11-05 00:16:59,293: head: regression
2025-11-05 00:16:59,294: output_activation: linear
2025-11-05 00:16:59,295: hidden_size: 64
2025-11-05 00:16:59,295: initial_forget_bias: 3
2025-11-05 00:16:59,296: output_dropout: 0.4
2025-11-05 00:16:59,297: num_layers: 1
2025-11-05 00:16:59,297: dev_mode: True
2025-11-05 00:16:59,298: optimizer: Adam
2025-11-05 00:16:59,298: loss: NSE
2025-11-05 00:16:59,299: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:16:59,299: batch_size: 128
2025-11-05 00:16:59,300: epochs: 32
2025-11-05 00:16:59,301: clip_gradient_norm: 1
2025-11-05 00:16:59,301: predict_last_n: 1
2025-11-05 00:16:59,302: seq_length: 90
2025-11-05 00:16:59,303: log_interval: 16
2025-11-05 00:16:59,304: log_tensorboard: True
2025-11-05 00:16:59,304: log_n_figures: 1
2025-11-05 00:16:59,305: save_weights_every: 32
2025-11-05 00:16:59,306: early_stopping: True
2025-11-05 00:16:59,306: early_stopping_mode: patience
2025-11-05 00:16:59,307: patience_early_stopping: 3
2025-11-05 00:16:59,308: min_delta_early_stopping: 0.0
2025-11-05 00:16:59,309: minimum_epochs_before_early_stopping: 10
2025-11-05 00:16:59,309: early_stopping_slope_window: 7
2025-11-05 00:16:59,310: early_stopping_slope_patience: 2
2025-11-05 00:16:59,311: early_stopping_slope_min_epoch: 8
2025-11-05 00:16:59,311: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:16:59,312: early_stopping_slope_use_log: True
2025-11-05 00:16:59,313: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:16:59,313: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:16:59,314: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:16:59,314: early_stopping_slope_variance_guard: True
2025-11-05 00:16:59,315: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:16:59,316: dataset: russian_river
2025-11-05 00:16:59,317: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:16:59,318: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:16:59,318: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:16:59,319: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:16:59,320: hourly: False
2025-11-05 00:16:59,321: is_mts: False
2025-11-05 00:16:59,322: is_mts_data: False
2025-11-05 00:16:59,322: verbose: True
2025-11-05 00:16:59,323: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659
2025-11-05 00:16:59,323: run_label: BASELINE
2025-11-05 00:16:59,324: number_of_basins: 1
2025-11-05 00:16:59,325: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\train_data
2025-11-05 00:16:59,326: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\img_log
2025-11-05 00:16:59,328: ### Device cuda:0 will be used for training
2025-11-05 00:16:59,329: Loading basin data into xarray data set.
2025-11-05 00:16:59,542: Calculating target variable stds per basin
2025-11-05 00:16:59,551: Create lookup table and convert to pytorch tensor
2025-11-05 00:16:59,831: Early stopping enabled: mode=patience
2025-11-05 00:17:00,347: Epoch 1 average loss: avg_loss: 2.39e-06, avg_total_loss: 2.39e-06
2025-11-05 00:17:00,636: Epoch 2 average loss: avg_loss: 1.45e-06, avg_total_loss: 1.45e-06
2025-11-05 00:17:00,944: Epoch 3 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:17:01,238: Epoch 4 average loss: avg_loss: 9.40e-07, avg_total_loss: 9.40e-07
2025-11-05 00:17:01,542: Epoch 5 average loss: avg_loss: 7.98e-07, avg_total_loss: 7.98e-07
2025-11-05 00:17:02,031: Epoch 5 average validation loss: 7.21e-07 -- Median validation metrics: avg_loss: 7.21e-07, NSE: 0.83390, MSE: 28455.23438
2025-11-05 00:17:02,301: Epoch 6 average loss: avg_loss: 7.65e-07, avg_total_loss: 7.65e-07
2025-11-05 00:17:02,512: Epoch 7 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:17:02,725: Epoch 8 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:17:02,988: Epoch 9 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:17:03,228: Epoch 10 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:17:03,526: Epoch 10 average validation loss: 7.54e-07 -- Median validation metrics: avg_loss: 7.54e-07, NSE: 0.82679, MSE: 29673.38477
2025-11-05 00:17:03,710: Epoch 11 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:17:03,931: Epoch 12 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:17:04,163: Epoch 13 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:17:04,420: Epoch 14 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:17:04,636: Epoch 15 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:17:04,931: Epoch 15 average validation loss: 7.89e-07 -- Median validation metrics: avg_loss: 7.89e-07, NSE: 0.81916, MSE: 30979.31641
2025-11-05 00:17:04,932: Setting learning rate to 0.005
2025-11-05 00:17:05,158: Epoch 16 average loss: avg_loss: 5.59e-07, avg_total_loss: 5.59e-07
2025-11-05 00:17:05,359: Epoch 17 average loss: avg_loss: 5.22e-07, avg_total_loss: 5.22e-07
2025-11-05 00:17:05,623: Epoch 18 average loss: avg_loss: 5.59e-07, avg_total_loss: 5.59e-07
2025-11-05 00:17:05,908: Epoch 19 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:17:06,190: Epoch 20 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:17:06,466: Epoch 20 average validation loss: 6.69e-07 -- Median validation metrics: avg_loss: 6.69e-07, NSE: 0.84652, MSE: 26293.35352
2025-11-05 00:17:06,744: Epoch 21 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:17:07,010: Epoch 22 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:17:07,310: Epoch 23 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:17:07,311: Setting learning rate to 0.001
2025-11-05 00:17:07,554: Epoch 24 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:17:07,816: Epoch 25 average loss: avg_loss: 5.04e-07, avg_total_loss: 5.04e-07
2025-11-05 00:17:08,104: Epoch 25 average validation loss: 6.68e-07 -- Median validation metrics: avg_loss: 6.68e-07, NSE: 0.84648, MSE: 26299.63867
2025-11-05 00:17:08,301: Epoch 26 average loss: avg_loss: 5.30e-07, avg_total_loss: 5.30e-07
2025-11-05 00:17:08,484: Epoch 27 average loss: avg_loss: 3.71e-07, avg_total_loss: 3.71e-07
2025-11-05 00:17:08,702: Epoch 28 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:17:08,932: Epoch 29 average loss: avg_loss: 4.58e-07, avg_total_loss: 4.58e-07
2025-11-05 00:17:09,174: Epoch 30 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:17:09,456: Epoch 30 average validation loss: 7.13e-07 -- Median validation metrics: avg_loss: 7.13e-07, NSE: 0.83617, MSE: 28065.69727
2025-11-05 00:17:09,648: Epoch 31 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:17:09,927: Epoch 32 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:17:09,947: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\model_epoch032.pt
2025-11-05 00:17:10,211: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:17:10,213: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001659\validation\model_epoch032\validation_results.p
2025-11-05 00:17:10,916: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\output.log initialized.
2025-11-05 00:17:10,917: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710
2025-11-05 00:17:10,918: ### Run configurations for testing_run
2025-11-05 00:17:10,918: experiment_name: testing_run
2025-11-05 00:17:10,919: train_basin_file: calpella
2025-11-05 00:17:10,920: validation_basin_file: calpella
2025-11-05 00:17:10,920: test_basin_file: calpella
2025-11-05 00:17:10,921: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:17:10,922: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:17:10,923: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:17:10,924: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:17:10,924: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:17:10,925: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:17:10,926: device: cuda:0
2025-11-05 00:17:10,926: physics_informed: True
2025-11-05 00:17:10,927: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:17:10,928: validate_every: 5
2025-11-05 00:17:10,929: validate_n_random_basins: 1
2025-11-05 00:17:10,929: metrics: ['NSE', 'MSE']
2025-11-05 00:17:10,930: model: cudalstm
2025-11-05 00:17:10,931: head: regression
2025-11-05 00:17:10,932: output_activation: linear
2025-11-05 00:17:10,932: hidden_size: 64
2025-11-05 00:17:10,933: initial_forget_bias: 3
2025-11-05 00:17:10,934: output_dropout: 0.4
2025-11-05 00:17:10,935: num_layers: 1
2025-11-05 00:17:10,936: dev_mode: True
2025-11-05 00:17:10,936: optimizer: Adam
2025-11-05 00:17:10,937: loss: NSE
2025-11-05 00:17:10,937: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:17:10,938: batch_size: 256
2025-11-05 00:17:10,939: epochs: 32
2025-11-05 00:17:10,939: clip_gradient_norm: 1
2025-11-05 00:17:10,940: predict_last_n: 1
2025-11-05 00:17:10,941: seq_length: 90
2025-11-05 00:17:10,941: log_interval: 16
2025-11-05 00:17:10,942: log_tensorboard: True
2025-11-05 00:17:10,943: log_n_figures: 1
2025-11-05 00:17:10,943: save_weights_every: 32
2025-11-05 00:17:10,944: early_stopping: True
2025-11-05 00:17:10,945: early_stopping_mode: patience
2025-11-05 00:17:10,946: patience_early_stopping: 3
2025-11-05 00:17:10,946: min_delta_early_stopping: 0.0
2025-11-05 00:17:10,947: minimum_epochs_before_early_stopping: 10
2025-11-05 00:17:10,947: early_stopping_slope_window: 7
2025-11-05 00:17:10,948: early_stopping_slope_patience: 2
2025-11-05 00:17:10,949: early_stopping_slope_min_epoch: 8
2025-11-05 00:17:10,950: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:17:10,950: early_stopping_slope_use_log: True
2025-11-05 00:17:10,951: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:17:10,951: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:17:10,952: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:17:10,953: early_stopping_slope_variance_guard: True
2025-11-05 00:17:10,954: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:17:10,954: dataset: russian_river
2025-11-05 00:17:10,955: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:17:10,956: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:17:10,956: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:17:10,957: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:17:10,958: hourly: False
2025-11-05 00:17:10,958: is_mts: False
2025-11-05 00:17:10,959: is_mts_data: False
2025-11-05 00:17:10,960: verbose: True
2025-11-05 00:17:10,960: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710
2025-11-05 00:17:10,961: run_label: BASELINE
2025-11-05 00:17:10,962: number_of_basins: 1
2025-11-05 00:17:10,963: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\train_data
2025-11-05 00:17:10,963: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\img_log
2025-11-05 00:17:10,966: ### Device cuda:0 will be used for training
2025-11-05 00:17:10,967: Loading basin data into xarray data set.
2025-11-05 00:17:11,166: Calculating target variable stds per basin
2025-11-05 00:17:11,175: Create lookup table and convert to pytorch tensor
2025-11-05 00:17:11,291: Early stopping enabled: mode=patience
2025-11-05 00:17:11,505: Epoch 1 average loss: avg_loss: 3.12e-06, avg_total_loss: 3.12e-06
2025-11-05 00:17:11,717: Epoch 2 average loss: avg_loss: 1.65e-06, avg_total_loss: 1.65e-06
2025-11-05 00:17:11,924: Epoch 3 average loss: avg_loss: 1.29e-06, avg_total_loss: 1.29e-06
2025-11-05 00:17:12,122: Epoch 4 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:17:12,249: Epoch 5 average loss: avg_loss: 1.00e-06, avg_total_loss: 1.00e-06
2025-11-05 00:17:12,703: Epoch 5 average validation loss: 7.44e-07 -- Median validation metrics: avg_loss: 7.44e-07, NSE: 0.81385, MSE: 31889.58203
2025-11-05 00:17:12,814: Epoch 6 average loss: avg_loss: 9.23e-07, avg_total_loss: 9.23e-07
2025-11-05 00:17:12,939: Epoch 7 average loss: avg_loss: 8.50e-07, avg_total_loss: 8.50e-07
2025-11-05 00:17:13,055: Epoch 8 average loss: avg_loss: 7.52e-07, avg_total_loss: 7.52e-07
2025-11-05 00:17:13,172: Epoch 9 average loss: avg_loss: 7.21e-07, avg_total_loss: 7.21e-07
2025-11-05 00:17:13,299: Epoch 10 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:17:13,617: Epoch 10 average validation loss: 6.15e-07 -- Median validation metrics: avg_loss: 6.15e-07, NSE: 0.84342, MSE: 26823.77344
2025-11-05 00:17:13,741: Epoch 11 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:17:13,877: Epoch 12 average loss: avg_loss: 6.23e-07, avg_total_loss: 6.23e-07
2025-11-05 00:17:14,032: Epoch 13 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:17:14,180: Epoch 14 average loss: avg_loss: 5.71e-07, avg_total_loss: 5.71e-07
2025-11-05 00:17:14,315: Epoch 15 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:17:14,590: Epoch 15 average validation loss: 7.14e-07 -- Median validation metrics: avg_loss: 7.14e-07, NSE: 0.81828, MSE: 31130.27539
2025-11-05 00:17:14,592: Setting learning rate to 0.005
2025-11-05 00:17:14,769: Epoch 16 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:17:14,934: Epoch 17 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:17:15,099: Epoch 18 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:17:15,278: Epoch 19 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:17:15,441: Epoch 20 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:17:15,757: Epoch 20 average validation loss: 6.04e-07 -- Median validation metrics: avg_loss: 6.04e-07, NSE: 0.84621, MSE: 26345.85938
2025-11-05 00:17:15,903: Epoch 21 average loss: avg_loss: 5.04e-07, avg_total_loss: 5.04e-07
2025-11-05 00:17:16,085: Epoch 22 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:17:16,240: Epoch 23 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:17:16,242: Setting learning rate to 0.001
2025-11-05 00:17:16,463: Epoch 24 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:17:16,721: Epoch 25 average loss: avg_loss: 4.72e-07, avg_total_loss: 4.72e-07
2025-11-05 00:17:17,028: Epoch 25 average validation loss: 6.31e-07 -- Median validation metrics: avg_loss: 6.31e-07, NSE: 0.84032, MSE: 27354.79492
2025-11-05 00:17:17,241: Epoch 26 average loss: avg_loss: 5.17e-07, avg_total_loss: 5.17e-07
2025-11-05 00:17:17,474: Epoch 27 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:17:17,674: Epoch 28 average loss: avg_loss: 4.20e-07, avg_total_loss: 4.20e-07
2025-11-05 00:17:17,829: Epoch 29 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:17:17,988: Epoch 30 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:17:18,272: Epoch 30 average validation loss: 6.29e-07 -- Median validation metrics: avg_loss: 6.29e-07, NSE: 0.84065, MSE: 27298.78906
2025-11-05 00:17:18,391: Epoch 31 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:17:18,527: Epoch 32 average loss: avg_loss: 4.64e-07, avg_total_loss: 4.64e-07
2025-11-05 00:17:18,550: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\model_epoch032.pt
2025-11-05 00:17:18,844: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:17:18,845: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001710\validation\model_epoch032\validation_results.p
2025-11-05 00:17:19,571: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\output.log initialized.
2025-11-05 00:17:19,572: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719
2025-11-05 00:17:19,572: ### Run configurations for testing_run
2025-11-05 00:17:19,574: experiment_name: testing_run
2025-11-05 00:17:19,574: train_basin_file: calpella
2025-11-05 00:17:19,575: validation_basin_file: calpella
2025-11-05 00:17:19,576: test_basin_file: calpella
2025-11-05 00:17:19,577: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:17:19,579: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:17:19,580: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:17:19,581: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:17:19,582: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:17:19,583: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:17:19,584: device: cuda:0
2025-11-05 00:17:19,585: physics_informed: True
2025-11-05 00:17:19,586: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:17:19,588: validate_every: 5
2025-11-05 00:17:19,589: validate_n_random_basins: 1
2025-11-05 00:17:19,589: metrics: ['NSE', 'MSE']
2025-11-05 00:17:19,590: model: cudalstm
2025-11-05 00:17:19,592: head: regression
2025-11-05 00:17:19,593: output_activation: linear
2025-11-05 00:17:19,595: hidden_size: 64
2025-11-05 00:17:19,596: initial_forget_bias: 3
2025-11-05 00:17:19,597: output_dropout: 0.4
2025-11-05 00:17:19,598: num_layers: 1
2025-11-05 00:17:19,599: dev_mode: True
2025-11-05 00:17:19,601: optimizer: Adam
2025-11-05 00:17:19,602: loss: NSE
2025-11-05 00:17:19,603: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:17:19,604: batch_size: 64
2025-11-05 00:17:19,605: epochs: 48
2025-11-05 00:17:19,606: clip_gradient_norm: 1
2025-11-05 00:17:19,607: predict_last_n: 1
2025-11-05 00:17:19,608: seq_length: 90
2025-11-05 00:17:19,609: log_interval: 16
2025-11-05 00:17:19,610: log_tensorboard: True
2025-11-05 00:17:19,611: log_n_figures: 1
2025-11-05 00:17:19,613: save_weights_every: 48
2025-11-05 00:17:19,614: early_stopping: True
2025-11-05 00:17:19,615: early_stopping_mode: patience
2025-11-05 00:17:19,616: patience_early_stopping: 3
2025-11-05 00:17:19,617: min_delta_early_stopping: 0.0
2025-11-05 00:17:19,618: minimum_epochs_before_early_stopping: 10
2025-11-05 00:17:19,619: early_stopping_slope_window: 7
2025-11-05 00:17:19,619: early_stopping_slope_patience: 2
2025-11-05 00:17:19,620: early_stopping_slope_min_epoch: 8
2025-11-05 00:17:19,621: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:17:19,621: early_stopping_slope_use_log: True
2025-11-05 00:17:19,622: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:17:19,623: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:17:19,624: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:17:19,625: early_stopping_slope_variance_guard: True
2025-11-05 00:17:19,625: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:17:19,626: dataset: russian_river
2025-11-05 00:17:19,627: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:17:19,627: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:17:19,629: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:17:19,630: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:17:19,630: hourly: False
2025-11-05 00:17:19,631: is_mts: False
2025-11-05 00:17:19,633: is_mts_data: False
2025-11-05 00:17:19,634: verbose: True
2025-11-05 00:17:19,635: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719
2025-11-05 00:17:19,636: run_label: BASELINE
2025-11-05 00:17:19,637: number_of_basins: 1
2025-11-05 00:17:19,638: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\train_data
2025-11-05 00:17:19,639: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\img_log
2025-11-05 00:17:19,642: ### Device cuda:0 will be used for training
2025-11-05 00:17:19,644: Loading basin data into xarray data set.
2025-11-05 00:17:19,885: Calculating target variable stds per basin
2025-11-05 00:17:19,896: Create lookup table and convert to pytorch tensor
2025-11-05 00:17:20,202: Early stopping enabled: mode=patience
2025-11-05 00:17:20,675: Epoch 1 average loss: avg_loss: 2.19e-06, avg_total_loss: 2.19e-06
2025-11-05 00:17:21,178: Epoch 2 average loss: avg_loss: 1.51e-06, avg_total_loss: 1.51e-06
2025-11-05 00:17:21,648: Epoch 3 average loss: avg_loss: 1.14e-06, avg_total_loss: 1.14e-06
2025-11-05 00:17:22,253: Epoch 4 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:17:22,651: Epoch 5 average loss: avg_loss: 8.79e-07, avg_total_loss: 8.79e-07
2025-11-05 00:17:23,176: Epoch 5 average validation loss: 7.75e-07 -- Median validation metrics: avg_loss: 7.75e-07, NSE: 0.82260, MSE: 30391.00000
2025-11-05 00:17:23,572: Epoch 6 average loss: avg_loss: 8.00e-07, avg_total_loss: 8.00e-07
2025-11-05 00:17:23,979: Epoch 7 average loss: avg_loss: 8.08e-07, avg_total_loss: 8.08e-07
2025-11-05 00:17:24,382: Epoch 8 average loss: avg_loss: 6.96e-07, avg_total_loss: 6.96e-07
2025-11-05 00:17:24,761: Epoch 9 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:17:25,186: Epoch 10 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:17:25,458: Epoch 10 average validation loss: 9.02e-07 -- Median validation metrics: avg_loss: 9.02e-07, NSE: 0.79322, MSE: 35424.04297
2025-11-05 00:17:25,874: Epoch 11 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:17:26,371: Epoch 12 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:17:26,871: Epoch 13 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:17:27,299: Epoch 14 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:17:27,710: Epoch 15 average loss: avg_loss: 6.64e-07, avg_total_loss: 6.64e-07
2025-11-05 00:17:27,997: Epoch 15 average validation loss: 7.40e-07 -- Median validation metrics: avg_loss: 7.40e-07, NSE: 0.83077, MSE: 28991.51562
2025-11-05 00:17:28,407: Epoch 16 average loss: avg_loss: 7.52e-07, avg_total_loss: 7.52e-07
2025-11-05 00:17:28,809: Epoch 17 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:17:29,217: Epoch 18 average loss: avg_loss: 7.39e-07, avg_total_loss: 7.39e-07
2025-11-05 00:17:29,627: Epoch 19 average loss: avg_loss: 6.86e-07, avg_total_loss: 6.86e-07
2025-11-05 00:17:30,040: Epoch 20 average loss: avg_loss: 7.85e-07, avg_total_loss: 7.85e-07
2025-11-05 00:17:30,391: Epoch 20 average validation loss: 8.05e-07 -- Median validation metrics: avg_loss: 8.05e-07, NSE: 0.81606, MSE: 31511.12305
2025-11-05 00:17:30,897: Epoch 21 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:17:31,298: Epoch 22 average loss: avg_loss: 6.15e-07, avg_total_loss: 6.15e-07
2025-11-05 00:17:31,734: Epoch 23 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:17:31,735: Setting learning rate to 0.005
2025-11-05 00:17:32,184: Epoch 24 average loss: avg_loss: 6.40e-07, avg_total_loss: 6.40e-07
2025-11-05 00:17:32,641: Epoch 25 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:17:32,952: Epoch 25 average validation loss: 6.76e-07 -- Median validation metrics: avg_loss: 6.76e-07, NSE: 0.84536, MSE: 26491.56055
2025-11-05 00:17:33,509: Epoch 26 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:17:33,929: Epoch 27 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:17:34,366: Epoch 28 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:17:34,777: Epoch 29 average loss: avg_loss: 5.16e-07, avg_total_loss: 5.16e-07
2025-11-05 00:17:35,172: Epoch 30 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:17:35,446: Epoch 30 average validation loss: 6.79e-07 -- Median validation metrics: avg_loss: 6.79e-07, NSE: 0.84375, MSE: 26767.96484
2025-11-05 00:17:35,963: Epoch 31 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:17:36,376: Epoch 32 average loss: avg_loss: 5.95e-07, avg_total_loss: 5.95e-07
2025-11-05 00:17:36,755: Epoch 33 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:17:37,161: Epoch 34 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:17:37,559: Epoch 35 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:17:37,828: Epoch 35 average validation loss: 6.85e-07 -- Median validation metrics: avg_loss: 6.85e-07, NSE: 0.84275, MSE: 26938.80664
2025-11-05 00:17:37,829: Setting learning rate to 0.001
2025-11-05 00:17:38,313: Epoch 36 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:17:38,705: Epoch 37 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:17:39,105: Epoch 38 average loss: avg_loss: 3.57e-07, avg_total_loss: 3.57e-07
2025-11-05 00:17:39,496: Epoch 39 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:17:39,898: Epoch 40 average loss: avg_loss: 4.23e-07, avg_total_loss: 4.23e-07
2025-11-05 00:17:40,164: Epoch 40 average validation loss: 7.25e-07 -- Median validation metrics: avg_loss: 7.25e-07, NSE: 0.83350, MSE: 28523.54688
2025-11-05 00:17:40,165: ES[patience]: STOP at epoch=40 after 3 checks without improvement
2025-11-05 00:17:40,166: Early stopping triggered at epoch 40
2025-11-05 00:17:40,184: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\model_epoch040.pt
2025-11-05 00:17:40,555: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\validation\model_epoch040\validation_metrics.csv
2025-11-05 00:17:40,557: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001719\validation\model_epoch040\validation_results.p
2025-11-05 00:17:41,247: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\output.log initialized.
2025-11-05 00:17:41,248: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741
2025-11-05 00:17:41,249: ### Run configurations for testing_run
2025-11-05 00:17:41,249: experiment_name: testing_run
2025-11-05 00:17:41,249: train_basin_file: calpella
2025-11-05 00:17:41,250: validation_basin_file: calpella
2025-11-05 00:17:41,251: test_basin_file: calpella
2025-11-05 00:17:41,251: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:17:41,252: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:17:41,253: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:17:41,253: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:17:41,254: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:17:41,255: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:17:41,255: device: cuda:0
2025-11-05 00:17:41,256: physics_informed: True
2025-11-05 00:17:41,256: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:17:41,257: validate_every: 5
2025-11-05 00:17:41,257: validate_n_random_basins: 1
2025-11-05 00:17:41,258: metrics: ['NSE', 'MSE']
2025-11-05 00:17:41,259: model: cudalstm
2025-11-05 00:17:41,259: head: regression
2025-11-05 00:17:41,260: output_activation: linear
2025-11-05 00:17:41,260: hidden_size: 64
2025-11-05 00:17:41,261: initial_forget_bias: 3
2025-11-05 00:17:41,261: output_dropout: 0.4
2025-11-05 00:17:41,262: num_layers: 1
2025-11-05 00:17:41,262: dev_mode: True
2025-11-05 00:17:41,263: optimizer: Adam
2025-11-05 00:17:41,263: loss: NSE
2025-11-05 00:17:41,264: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:17:41,265: batch_size: 128
2025-11-05 00:17:41,265: epochs: 48
2025-11-05 00:17:41,266: clip_gradient_norm: 1
2025-11-05 00:17:41,266: predict_last_n: 1
2025-11-05 00:17:41,267: seq_length: 90
2025-11-05 00:17:41,267: log_interval: 16
2025-11-05 00:17:41,268: log_tensorboard: True
2025-11-05 00:17:41,269: log_n_figures: 1
2025-11-05 00:17:41,269: save_weights_every: 48
2025-11-05 00:17:41,270: early_stopping: True
2025-11-05 00:17:41,271: early_stopping_mode: patience
2025-11-05 00:17:41,271: patience_early_stopping: 3
2025-11-05 00:17:41,272: min_delta_early_stopping: 0.0
2025-11-05 00:17:41,272: minimum_epochs_before_early_stopping: 10
2025-11-05 00:17:41,273: early_stopping_slope_window: 7
2025-11-05 00:17:41,273: early_stopping_slope_patience: 2
2025-11-05 00:17:41,274: early_stopping_slope_min_epoch: 8
2025-11-05 00:17:41,274: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:17:41,275: early_stopping_slope_use_log: True
2025-11-05 00:17:41,276: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:17:41,276: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:17:41,277: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:17:41,277: early_stopping_slope_variance_guard: True
2025-11-05 00:17:41,278: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:17:41,278: dataset: russian_river
2025-11-05 00:17:41,279: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:17:41,280: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:17:41,280: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:17:41,281: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:17:41,281: hourly: False
2025-11-05 00:17:41,282: is_mts: False
2025-11-05 00:17:41,282: is_mts_data: False
2025-11-05 00:17:41,283: verbose: True
2025-11-05 00:17:41,283: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741
2025-11-05 00:17:41,284: run_label: BASELINE
2025-11-05 00:17:41,285: number_of_basins: 1
2025-11-05 00:17:41,285: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\train_data
2025-11-05 00:17:41,286: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\img_log
2025-11-05 00:17:41,288: ### Device cuda:0 will be used for training
2025-11-05 00:17:41,289: Loading basin data into xarray data set.
2025-11-05 00:17:41,477: Calculating target variable stds per basin
2025-11-05 00:17:41,486: Create lookup table and convert to pytorch tensor
2025-11-05 00:17:41,603: Early stopping enabled: mode=patience
2025-11-05 00:17:42,127: Epoch 1 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:17:42,395: Epoch 2 average loss: avg_loss: 1.33e-06, avg_total_loss: 1.33e-06
2025-11-05 00:17:42,653: Epoch 3 average loss: avg_loss: 1.19e-06, avg_total_loss: 1.19e-06
2025-11-05 00:17:42,848: Epoch 4 average loss: avg_loss: 9.69e-07, avg_total_loss: 9.69e-07
2025-11-05 00:17:43,032: Epoch 5 average loss: avg_loss: 8.95e-07, avg_total_loss: 8.95e-07
2025-11-05 00:17:43,459: Epoch 5 average validation loss: 7.52e-07 -- Median validation metrics: avg_loss: 7.52e-07, NSE: 0.82813, MSE: 29443.92188
2025-11-05 00:17:43,649: Epoch 6 average loss: avg_loss: 8.45e-07, avg_total_loss: 8.45e-07
2025-11-05 00:17:43,831: Epoch 7 average loss: avg_loss: 7.82e-07, avg_total_loss: 7.82e-07
2025-11-05 00:17:44,044: Epoch 8 average loss: avg_loss: 6.56e-07, avg_total_loss: 6.56e-07
2025-11-05 00:17:44,228: Epoch 9 average loss: avg_loss: 7.18e-07, avg_total_loss: 7.18e-07
2025-11-05 00:17:44,434: Epoch 10 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:17:44,689: Epoch 10 average validation loss: 7.02e-07 -- Median validation metrics: avg_loss: 7.02e-07, NSE: 0.83824, MSE: 27711.01367
2025-11-05 00:17:44,942: Epoch 11 average loss: avg_loss: 7.05e-07, avg_total_loss: 7.05e-07
2025-11-05 00:17:45,210: Epoch 12 average loss: avg_loss: 6.29e-07, avg_total_loss: 6.29e-07
2025-11-05 00:17:45,462: Epoch 13 average loss: avg_loss: 6.22e-07, avg_total_loss: 6.22e-07
2025-11-05 00:17:45,646: Epoch 14 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:17:45,830: Epoch 15 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:17:46,115: Epoch 15 average validation loss: 7.02e-07 -- Median validation metrics: avg_loss: 7.02e-07, NSE: 0.83900, MSE: 27581.18164
2025-11-05 00:17:46,272: Epoch 16 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:17:46,455: Epoch 17 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:17:46,638: Epoch 18 average loss: avg_loss: 4.79e-07, avg_total_loss: 4.79e-07
2025-11-05 00:17:46,813: Epoch 19 average loss: avg_loss: 5.06e-07, avg_total_loss: 5.06e-07
2025-11-05 00:17:47,019: Epoch 20 average loss: avg_loss: 5.46e-07, avg_total_loss: 5.46e-07
2025-11-05 00:17:47,269: Epoch 20 average validation loss: 7.28e-07 -- Median validation metrics: avg_loss: 7.28e-07, NSE: 0.83236, MSE: 28719.11328
2025-11-05 00:17:47,431: Epoch 21 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:17:47,695: Epoch 22 average loss: avg_loss: 5.17e-07, avg_total_loss: 5.17e-07
2025-11-05 00:17:47,968: Epoch 23 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:17:47,969: Setting learning rate to 0.005
2025-11-05 00:17:48,231: Epoch 24 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:17:48,478: Epoch 25 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:17:48,711: Epoch 25 average validation loss: 7.83e-07 -- Median validation metrics: avg_loss: 7.83e-07, NSE: 0.81995, MSE: 30844.86133
2025-11-05 00:17:48,864: Epoch 26 average loss: avg_loss: 4.53e-07, avg_total_loss: 4.53e-07
2025-11-05 00:17:49,058: Epoch 27 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:17:49,242: Epoch 28 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:17:49,448: Epoch 29 average loss: avg_loss: 5.07e-07, avg_total_loss: 5.07e-07
2025-11-05 00:17:49,619: Epoch 30 average loss: avg_loss: 4.69e-07, avg_total_loss: 4.69e-07
2025-11-05 00:17:49,891: Epoch 30 average validation loss: 7.15e-07 -- Median validation metrics: avg_loss: 7.15e-07, NSE: 0.83558, MSE: 28166.81445
2025-11-05 00:17:49,891: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:17:49,892: Early stopping triggered at epoch 30
2025-11-05 00:17:49,909: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\model_epoch030.pt
2025-11-05 00:17:50,150: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:17:50,151: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001741\validation\model_epoch030\validation_results.p
2025-11-05 00:17:50,817: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\output.log initialized.
2025-11-05 00:17:50,818: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750
2025-11-05 00:17:50,819: ### Run configurations for testing_run
2025-11-05 00:17:50,819: experiment_name: testing_run
2025-11-05 00:17:50,821: train_basin_file: calpella
2025-11-05 00:17:50,821: validation_basin_file: calpella
2025-11-05 00:17:50,822: test_basin_file: calpella
2025-11-05 00:17:50,822: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:17:50,823: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:17:50,823: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:17:50,824: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:17:50,824: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:17:50,825: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:17:50,826: device: cuda:0
2025-11-05 00:17:50,826: physics_informed: True
2025-11-05 00:17:50,827: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:17:50,827: validate_every: 5
2025-11-05 00:17:50,828: validate_n_random_basins: 1
2025-11-05 00:17:50,828: metrics: ['NSE', 'MSE']
2025-11-05 00:17:50,829: model: cudalstm
2025-11-05 00:17:50,829: head: regression
2025-11-05 00:17:50,830: output_activation: linear
2025-11-05 00:17:50,830: hidden_size: 64
2025-11-05 00:17:50,831: initial_forget_bias: 3
2025-11-05 00:17:50,832: output_dropout: 0.4
2025-11-05 00:17:50,832: num_layers: 1
2025-11-05 00:17:50,833: dev_mode: True
2025-11-05 00:17:50,833: optimizer: Adam
2025-11-05 00:17:50,834: loss: NSE
2025-11-05 00:17:50,834: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:17:50,835: batch_size: 256
2025-11-05 00:17:50,836: epochs: 48
2025-11-05 00:17:50,836: clip_gradient_norm: 1
2025-11-05 00:17:50,837: predict_last_n: 1
2025-11-05 00:17:50,837: seq_length: 90
2025-11-05 00:17:50,838: log_interval: 16
2025-11-05 00:17:50,838: log_tensorboard: True
2025-11-05 00:17:50,839: log_n_figures: 1
2025-11-05 00:17:50,840: save_weights_every: 48
2025-11-05 00:17:50,840: early_stopping: True
2025-11-05 00:17:50,841: early_stopping_mode: patience
2025-11-05 00:17:50,841: patience_early_stopping: 3
2025-11-05 00:17:50,842: min_delta_early_stopping: 0.0
2025-11-05 00:17:50,842: minimum_epochs_before_early_stopping: 10
2025-11-05 00:17:50,843: early_stopping_slope_window: 7
2025-11-05 00:17:50,843: early_stopping_slope_patience: 2
2025-11-05 00:17:50,844: early_stopping_slope_min_epoch: 8
2025-11-05 00:17:50,845: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:17:50,845: early_stopping_slope_use_log: True
2025-11-05 00:17:50,846: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:17:50,846: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:17:50,847: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:17:50,848: early_stopping_slope_variance_guard: True
2025-11-05 00:17:50,848: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:17:50,849: dataset: russian_river
2025-11-05 00:17:50,849: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:17:50,850: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:17:50,850: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:17:50,851: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:17:50,851: hourly: False
2025-11-05 00:17:50,852: is_mts: False
2025-11-05 00:17:50,852: is_mts_data: False
2025-11-05 00:17:50,853: verbose: True
2025-11-05 00:17:50,854: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750
2025-11-05 00:17:50,854: run_label: BASELINE
2025-11-05 00:17:50,855: number_of_basins: 1
2025-11-05 00:17:50,855: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\train_data
2025-11-05 00:17:50,856: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\img_log
2025-11-05 00:17:50,857: ### Device cuda:0 will be used for training
2025-11-05 00:17:50,858: Loading basin data into xarray data set.
2025-11-05 00:17:51,051: Calculating target variable stds per basin
2025-11-05 00:17:51,060: Create lookup table and convert to pytorch tensor
2025-11-05 00:17:51,170: Early stopping enabled: mode=patience
2025-11-05 00:17:51,385: Epoch 1 average loss: avg_loss: 2.87e-06, avg_total_loss: 2.87e-06
2025-11-05 00:17:51,584: Epoch 2 average loss: avg_loss: 1.67e-06, avg_total_loss: 1.67e-06
2025-11-05 00:17:51,781: Epoch 3 average loss: avg_loss: 1.32e-06, avg_total_loss: 1.32e-06
2025-11-05 00:17:51,984: Epoch 4 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:17:52,118: Epoch 5 average loss: avg_loss: 1.04e-06, avg_total_loss: 1.04e-06
2025-11-05 00:17:52,547: Epoch 5 average validation loss: 8.86e-07 -- Median validation metrics: avg_loss: 8.86e-07, NSE: 0.77517, MSE: 38516.25391
2025-11-05 00:17:52,639: Epoch 6 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:17:52,763: Epoch 7 average loss: avg_loss: 9.27e-07, avg_total_loss: 9.27e-07
2025-11-05 00:17:52,873: Epoch 8 average loss: avg_loss: 7.68e-07, avg_total_loss: 7.68e-07
2025-11-05 00:17:52,971: Epoch 9 average loss: avg_loss: 7.61e-07, avg_total_loss: 7.61e-07
2025-11-05 00:17:53,090: Epoch 10 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:17:53,354: Epoch 10 average validation loss: 6.92e-07 -- Median validation metrics: avg_loss: 6.92e-07, NSE: 0.82528, MSE: 29932.08008
2025-11-05 00:17:53,445: Epoch 11 average loss: avg_loss: 6.94e-07, avg_total_loss: 6.94e-07
2025-11-05 00:17:53,538: Epoch 12 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:17:53,632: Epoch 13 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:17:53,899: Epoch 14 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:17:53,999: Epoch 15 average loss: avg_loss: 7.12e-07, avg_total_loss: 7.12e-07
2025-11-05 00:17:54,237: Epoch 15 average validation loss: 6.73e-07 -- Median validation metrics: avg_loss: 6.73e-07, NSE: 0.83316, MSE: 28582.51758
2025-11-05 00:17:54,348: Epoch 16 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:17:54,465: Epoch 17 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:17:54,584: Epoch 18 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:17:54,696: Epoch 19 average loss: avg_loss: 4.49e-07, avg_total_loss: 4.49e-07
2025-11-05 00:17:54,813: Epoch 20 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:17:55,083: Epoch 20 average validation loss: 6.87e-07 -- Median validation metrics: avg_loss: 6.87e-07, NSE: 0.82745, MSE: 29560.03320
2025-11-05 00:17:55,195: Epoch 21 average loss: avg_loss: 4.98e-07, avg_total_loss: 4.98e-07
2025-11-05 00:17:55,303: Epoch 22 average loss: avg_loss: 5.43e-07, avg_total_loss: 5.43e-07
2025-11-05 00:17:55,420: Epoch 23 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:17:55,421: Setting learning rate to 0.005
2025-11-05 00:17:55,554: Epoch 24 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:17:55,672: Epoch 25 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:17:55,909: Epoch 25 average validation loss: 6.36e-07 -- Median validation metrics: avg_loss: 6.36e-07, NSE: 0.83814, MSE: 27728.93945
2025-11-05 00:17:56,037: Epoch 26 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:17:56,162: Epoch 27 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:17:56,284: Epoch 28 average loss: avg_loss: 4.25e-07, avg_total_loss: 4.25e-07
2025-11-05 00:17:56,417: Epoch 29 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:17:56,565: Epoch 30 average loss: avg_loss: 4.32e-07, avg_total_loss: 4.32e-07
2025-11-05 00:17:56,794: Epoch 30 average validation loss: 6.23e-07 -- Median validation metrics: avg_loss: 6.23e-07, NSE: 0.84211, MSE: 27049.06055
2025-11-05 00:17:56,913: Epoch 31 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:17:57,032: Epoch 32 average loss: avg_loss: 4.05e-07, avg_total_loss: 4.05e-07
2025-11-05 00:17:57,177: Epoch 33 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:17:57,301: Epoch 34 average loss: avg_loss: 4.18e-07, avg_total_loss: 4.18e-07
2025-11-05 00:17:57,448: Epoch 35 average loss: avg_loss: 3.71e-07, avg_total_loss: 3.71e-07
2025-11-05 00:17:57,715: Epoch 35 average validation loss: 6.33e-07 -- Median validation metrics: avg_loss: 6.33e-07, NSE: 0.83931, MSE: 27528.11328
2025-11-05 00:17:57,716: Setting learning rate to 0.001
2025-11-05 00:17:57,833: Epoch 36 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:17:57,952: Epoch 37 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:17:58,072: Epoch 38 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:17:58,214: Epoch 39 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:17:58,336: Epoch 40 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:17:58,561: Epoch 40 average validation loss: 6.25e-07 -- Median validation metrics: avg_loss: 6.25e-07, NSE: 0.84120, MSE: 27204.59375
2025-11-05 00:17:58,684: Epoch 41 average loss: avg_loss: 3.87e-07, avg_total_loss: 3.87e-07
2025-11-05 00:17:58,822: Epoch 42 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:17:58,948: Epoch 43 average loss: avg_loss: 4.49e-07, avg_total_loss: 4.49e-07
2025-11-05 00:17:59,089: Epoch 44 average loss: avg_loss: 3.50e-07, avg_total_loss: 3.50e-07
2025-11-05 00:17:59,226: Epoch 45 average loss: avg_loss: 3.69e-07, avg_total_loss: 3.69e-07
2025-11-05 00:17:59,475: Epoch 45 average validation loss: 6.64e-07 -- Median validation metrics: avg_loss: 6.64e-07, NSE: 0.83207, MSE: 28767.92578
2025-11-05 00:17:59,476: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:17:59,477: Early stopping triggered at epoch 45
2025-11-05 00:17:59,493: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\model_epoch045.pt
2025-11-05 00:17:59,719: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:17:59,720: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001750\validation\model_epoch045\validation_results.p
2025-11-05 00:18:00,408: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\output.log initialized.
2025-11-05 00:18:00,409: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800
2025-11-05 00:18:00,410: ### Run configurations for testing_run
2025-11-05 00:18:00,411: experiment_name: testing_run
2025-11-05 00:18:00,411: train_basin_file: calpella
2025-11-05 00:18:00,412: validation_basin_file: calpella
2025-11-05 00:18:00,412: test_basin_file: calpella
2025-11-05 00:18:00,413: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:00,413: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:00,414: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:00,415: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:00,416: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:00,416: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:00,418: device: cuda:0
2025-11-05 00:18:00,419: physics_informed: True
2025-11-05 00:18:00,420: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:00,421: validate_every: 5
2025-11-05 00:18:00,422: validate_n_random_basins: 1
2025-11-05 00:18:00,423: metrics: ['NSE', 'MSE']
2025-11-05 00:18:00,424: model: cudalstm
2025-11-05 00:18:00,426: head: regression
2025-11-05 00:18:00,426: output_activation: linear
2025-11-05 00:18:00,427: hidden_size: 64
2025-11-05 00:18:00,428: initial_forget_bias: 3
2025-11-05 00:18:00,429: output_dropout: 0.4
2025-11-05 00:18:00,431: num_layers: 1
2025-11-05 00:18:00,433: dev_mode: True
2025-11-05 00:18:00,435: optimizer: Adam
2025-11-05 00:18:00,435: loss: NSE
2025-11-05 00:18:00,436: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:18:00,438: batch_size: 64
2025-11-05 00:18:00,439: epochs: 16
2025-11-05 00:18:00,440: clip_gradient_norm: 1
2025-11-05 00:18:00,441: predict_last_n: 1
2025-11-05 00:18:00,442: seq_length: 120
2025-11-05 00:18:00,443: log_interval: 16
2025-11-05 00:18:00,444: log_tensorboard: True
2025-11-05 00:18:00,445: log_n_figures: 1
2025-11-05 00:18:00,446: save_weights_every: 16
2025-11-05 00:18:00,447: early_stopping: True
2025-11-05 00:18:00,448: early_stopping_mode: patience
2025-11-05 00:18:00,449: patience_early_stopping: 3
2025-11-05 00:18:00,450: min_delta_early_stopping: 0.0
2025-11-05 00:18:00,451: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:00,452: early_stopping_slope_window: 7
2025-11-05 00:18:00,453: early_stopping_slope_patience: 2
2025-11-05 00:18:00,454: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:00,454: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:00,455: early_stopping_slope_use_log: True
2025-11-05 00:18:00,456: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:00,456: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:00,457: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:00,457: early_stopping_slope_variance_guard: True
2025-11-05 00:18:00,458: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:00,458: dataset: russian_river
2025-11-05 00:18:00,459: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:00,460: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:00,461: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:00,462: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:00,462: hourly: False
2025-11-05 00:18:00,463: is_mts: False
2025-11-05 00:18:00,464: is_mts_data: False
2025-11-05 00:18:00,465: verbose: True
2025-11-05 00:18:00,466: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800
2025-11-05 00:18:00,467: run_label: BASELINE
2025-11-05 00:18:00,468: number_of_basins: 1
2025-11-05 00:18:00,468: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\train_data
2025-11-05 00:18:00,469: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\img_log
2025-11-05 00:18:00,471: ### Device cuda:0 will be used for training
2025-11-05 00:18:00,472: Loading basin data into xarray data set.
2025-11-05 00:18:00,668: Calculating target variable stds per basin
2025-11-05 00:18:00,679: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:00,787: Early stopping enabled: mode=patience
2025-11-05 00:18:01,216: Epoch 1 average loss: avg_loss: 1.71e-06, avg_total_loss: 1.71e-06
2025-11-05 00:18:01,645: Epoch 2 average loss: avg_loss: 9.17e-07, avg_total_loss: 9.17e-07
2025-11-05 00:18:02,039: Epoch 3 average loss: avg_loss: 9.44e-07, avg_total_loss: 9.44e-07
2025-11-05 00:18:02,446: Epoch 4 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:18:02,840: Epoch 5 average loss: avg_loss: 6.67e-07, avg_total_loss: 6.67e-07
2025-11-05 00:18:03,317: Epoch 5 average validation loss: 6.89e-07 -- Median validation metrics: avg_loss: 6.89e-07, NSE: 0.84261, MSE: 26963.11523
2025-11-05 00:18:03,715: Epoch 6 average loss: avg_loss: 6.06e-07, avg_total_loss: 6.06e-07
2025-11-05 00:18:04,117: Epoch 7 average loss: avg_loss: 5.99e-07, avg_total_loss: 5.99e-07
2025-11-05 00:18:04,118: Setting learning rate to 0.005
2025-11-05 00:18:04,514: Epoch 8 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:18:04,913: Epoch 9 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:18:05,305: Epoch 10 average loss: avg_loss: 5.63e-07, avg_total_loss: 5.63e-07
2025-11-05 00:18:05,601: Epoch 10 average validation loss: 6.84e-07 -- Median validation metrics: avg_loss: 6.84e-07, NSE: 0.84272, MSE: 26944.67383
2025-11-05 00:18:05,981: Epoch 11 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:18:05,982: Setting learning rate to 0.001
2025-11-05 00:18:06,384: Epoch 12 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:18:06,781: Epoch 13 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:18:07,167: Epoch 14 average loss: avg_loss: 4.66e-07, avg_total_loss: 4.66e-07
2025-11-05 00:18:07,567: Epoch 15 average loss: avg_loss: 4.20e-07, avg_total_loss: 4.20e-07
2025-11-05 00:18:07,865: Epoch 15 average validation loss: 6.59e-07 -- Median validation metrics: avg_loss: 6.59e-07, NSE: 0.84879, MSE: 25904.60742
2025-11-05 00:18:08,250: Epoch 16 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:18:08,269: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\model_epoch016.pt
2025-11-05 00:18:08,553: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:18:08,554: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001800\validation\model_epoch016\validation_results.p
2025-11-05 00:18:09,210: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\output.log initialized.
2025-11-05 00:18:09,210: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809
2025-11-05 00:18:09,211: ### Run configurations for testing_run
2025-11-05 00:18:09,212: experiment_name: testing_run
2025-11-05 00:18:09,212: train_basin_file: calpella
2025-11-05 00:18:09,213: validation_basin_file: calpella
2025-11-05 00:18:09,213: test_basin_file: calpella
2025-11-05 00:18:09,214: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:09,214: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:09,215: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:09,216: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:09,216: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:09,217: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:09,217: device: cuda:0
2025-11-05 00:18:09,218: physics_informed: True
2025-11-05 00:18:09,218: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:09,219: validate_every: 5
2025-11-05 00:18:09,219: validate_n_random_basins: 1
2025-11-05 00:18:09,220: metrics: ['NSE', 'MSE']
2025-11-05 00:18:09,220: model: cudalstm
2025-11-05 00:18:09,221: head: regression
2025-11-05 00:18:09,221: output_activation: linear
2025-11-05 00:18:09,222: hidden_size: 64
2025-11-05 00:18:09,223: initial_forget_bias: 3
2025-11-05 00:18:09,223: output_dropout: 0.4
2025-11-05 00:18:09,224: num_layers: 1
2025-11-05 00:18:09,224: dev_mode: True
2025-11-05 00:18:09,225: optimizer: Adam
2025-11-05 00:18:09,225: loss: NSE
2025-11-05 00:18:09,226: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:18:09,226: batch_size: 128
2025-11-05 00:18:09,227: epochs: 16
2025-11-05 00:18:09,227: clip_gradient_norm: 1
2025-11-05 00:18:09,228: predict_last_n: 1
2025-11-05 00:18:09,228: seq_length: 120
2025-11-05 00:18:09,229: log_interval: 16
2025-11-05 00:18:09,230: log_tensorboard: True
2025-11-05 00:18:09,231: log_n_figures: 1
2025-11-05 00:18:09,231: save_weights_every: 16
2025-11-05 00:18:09,232: early_stopping: True
2025-11-05 00:18:09,233: early_stopping_mode: patience
2025-11-05 00:18:09,233: patience_early_stopping: 3
2025-11-05 00:18:09,234: min_delta_early_stopping: 0.0
2025-11-05 00:18:09,234: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:09,235: early_stopping_slope_window: 7
2025-11-05 00:18:09,235: early_stopping_slope_patience: 2
2025-11-05 00:18:09,236: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:09,237: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:09,237: early_stopping_slope_use_log: True
2025-11-05 00:18:09,238: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:09,238: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:09,239: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:09,240: early_stopping_slope_variance_guard: True
2025-11-05 00:18:09,240: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:09,241: dataset: russian_river
2025-11-05 00:18:09,241: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:09,242: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:09,242: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:09,243: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:09,243: hourly: False
2025-11-05 00:18:09,244: is_mts: False
2025-11-05 00:18:09,244: is_mts_data: False
2025-11-05 00:18:09,245: verbose: True
2025-11-05 00:18:09,246: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809
2025-11-05 00:18:09,248: run_label: BASELINE
2025-11-05 00:18:09,249: number_of_basins: 1
2025-11-05 00:18:09,250: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\train_data
2025-11-05 00:18:09,251: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\img_log
2025-11-05 00:18:09,255: ### Device cuda:0 will be used for training
2025-11-05 00:18:09,257: Loading basin data into xarray data set.
2025-11-05 00:18:09,462: Calculating target variable stds per basin
2025-11-05 00:18:09,471: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:09,588: Early stopping enabled: mode=patience
2025-11-05 00:18:09,872: Epoch 1 average loss: avg_loss: 1.97e-06, avg_total_loss: 1.97e-06
2025-11-05 00:18:10,133: Epoch 2 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:18:10,318: Epoch 3 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:18:10,498: Epoch 4 average loss: avg_loss: 7.99e-07, avg_total_loss: 7.99e-07
2025-11-05 00:18:10,695: Epoch 5 average loss: avg_loss: 7.45e-07, avg_total_loss: 7.45e-07
2025-11-05 00:18:11,108: Epoch 5 average validation loss: 7.75e-07 -- Median validation metrics: avg_loss: 7.75e-07, NSE: 0.82222, MSE: 30455.44336
2025-11-05 00:18:11,273: Epoch 6 average loss: avg_loss: 7.33e-07, avg_total_loss: 7.33e-07
2025-11-05 00:18:11,466: Epoch 7 average loss: avg_loss: 6.56e-07, avg_total_loss: 6.56e-07
2025-11-05 00:18:11,467: Setting learning rate to 0.005
2025-11-05 00:18:11,639: Epoch 8 average loss: avg_loss: 6.40e-07, avg_total_loss: 6.40e-07
2025-11-05 00:18:11,849: Epoch 9 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:18:12,031: Epoch 10 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:18:12,320: Epoch 10 average validation loss: 6.84e-07 -- Median validation metrics: avg_loss: 6.84e-07, NSE: 0.84283, MSE: 26924.99219
2025-11-05 00:18:12,487: Epoch 11 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:18:12,487: Setting learning rate to 0.001
2025-11-05 00:18:12,673: Epoch 12 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:18:12,857: Epoch 13 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:18:13,057: Epoch 14 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:18:13,247: Epoch 15 average loss: avg_loss: 5.12e-07, avg_total_loss: 5.12e-07
2025-11-05 00:18:13,508: Epoch 15 average validation loss: 6.68e-07 -- Median validation metrics: avg_loss: 6.68e-07, NSE: 0.84684, MSE: 26237.49219
2025-11-05 00:18:13,707: Epoch 16 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:18:13,723: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\model_epoch016.pt
2025-11-05 00:18:13,964: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:18:13,965: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001809\validation\model_epoch016\validation_results.p
2025-11-05 00:18:14,749: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\output.log initialized.
2025-11-05 00:18:14,749: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814
2025-11-05 00:18:14,750: ### Run configurations for testing_run
2025-11-05 00:18:14,750: experiment_name: testing_run
2025-11-05 00:18:14,752: train_basin_file: calpella
2025-11-05 00:18:14,753: validation_basin_file: calpella
2025-11-05 00:18:14,753: test_basin_file: calpella
2025-11-05 00:18:14,754: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:14,755: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:14,755: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:14,755: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:14,756: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:14,756: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:14,757: device: cuda:0
2025-11-05 00:18:14,758: physics_informed: True
2025-11-05 00:18:14,759: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:14,759: validate_every: 5
2025-11-05 00:18:14,760: validate_n_random_basins: 1
2025-11-05 00:18:14,760: metrics: ['NSE', 'MSE']
2025-11-05 00:18:14,761: model: cudalstm
2025-11-05 00:18:14,762: head: regression
2025-11-05 00:18:14,763: output_activation: linear
2025-11-05 00:18:14,763: hidden_size: 64
2025-11-05 00:18:14,764: initial_forget_bias: 3
2025-11-05 00:18:14,765: output_dropout: 0.4
2025-11-05 00:18:14,765: num_layers: 1
2025-11-05 00:18:14,766: dev_mode: True
2025-11-05 00:18:14,767: optimizer: Adam
2025-11-05 00:18:14,767: loss: NSE
2025-11-05 00:18:14,768: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:18:14,768: batch_size: 256
2025-11-05 00:18:14,769: epochs: 16
2025-11-05 00:18:14,770: clip_gradient_norm: 1
2025-11-05 00:18:14,772: predict_last_n: 1
2025-11-05 00:18:14,773: seq_length: 120
2025-11-05 00:18:14,774: log_interval: 16
2025-11-05 00:18:14,775: log_tensorboard: True
2025-11-05 00:18:14,777: log_n_figures: 1
2025-11-05 00:18:14,778: save_weights_every: 16
2025-11-05 00:18:14,779: early_stopping: True
2025-11-05 00:18:14,781: early_stopping_mode: patience
2025-11-05 00:18:14,782: patience_early_stopping: 3
2025-11-05 00:18:14,783: min_delta_early_stopping: 0.0
2025-11-05 00:18:14,784: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:14,785: early_stopping_slope_window: 7
2025-11-05 00:18:14,786: early_stopping_slope_patience: 2
2025-11-05 00:18:14,787: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:14,788: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:14,789: early_stopping_slope_use_log: True
2025-11-05 00:18:14,790: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:14,790: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:14,791: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:14,793: early_stopping_slope_variance_guard: True
2025-11-05 00:18:14,795: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:14,796: dataset: russian_river
2025-11-05 00:18:14,797: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:14,798: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:14,799: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:14,801: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:14,802: hourly: False
2025-11-05 00:18:14,803: is_mts: False
2025-11-05 00:18:14,804: is_mts_data: False
2025-11-05 00:18:14,805: verbose: True
2025-11-05 00:18:14,806: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814
2025-11-05 00:18:14,807: run_label: BASELINE
2025-11-05 00:18:14,808: number_of_basins: 1
2025-11-05 00:18:14,809: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\train_data
2025-11-05 00:18:14,809: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\img_log
2025-11-05 00:18:14,811: ### Device cuda:0 will be used for training
2025-11-05 00:18:14,812: Loading basin data into xarray data set.
2025-11-05 00:18:15,016: Calculating target variable stds per basin
2025-11-05 00:18:15,025: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:15,139: Early stopping enabled: mode=patience
2025-11-05 00:18:15,384: Epoch 1 average loss: avg_loss: 2.24e-06, avg_total_loss: 2.24e-06
2025-11-05 00:18:15,613: Epoch 2 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:18:15,846: Epoch 3 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:18:15,967: Epoch 4 average loss: avg_loss: 9.66e-07, avg_total_loss: 9.66e-07
2025-11-05 00:18:16,083: Epoch 5 average loss: avg_loss: 8.89e-07, avg_total_loss: 8.89e-07
2025-11-05 00:18:16,509: Epoch 5 average validation loss: 8.10e-07 -- Median validation metrics: avg_loss: 8.10e-07, NSE: 0.79370, MSE: 35342.03516
2025-11-05 00:18:16,610: Epoch 6 average loss: avg_loss: 7.81e-07, avg_total_loss: 7.81e-07
2025-11-05 00:18:16,734: Epoch 7 average loss: avg_loss: 8.28e-07, avg_total_loss: 8.28e-07
2025-11-05 00:18:16,735: Setting learning rate to 0.005
2025-11-05 00:18:16,839: Epoch 8 average loss: avg_loss: 7.38e-07, avg_total_loss: 7.38e-07
2025-11-05 00:18:16,940: Epoch 9 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:18:17,041: Epoch 10 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:18:17,324: Epoch 10 average validation loss: 7.53e-07 -- Median validation metrics: avg_loss: 7.53e-07, NSE: 0.80819, MSE: 32859.43359
2025-11-05 00:18:17,431: Epoch 11 average loss: avg_loss: 5.68e-07, avg_total_loss: 5.68e-07
2025-11-05 00:18:17,432: Setting learning rate to 0.001
2025-11-05 00:18:17,533: Epoch 12 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:18:17,632: Epoch 13 average loss: avg_loss: 6.71e-07, avg_total_loss: 6.71e-07
2025-11-05 00:18:17,755: Epoch 14 average loss: avg_loss: 6.83e-07, avg_total_loss: 6.83e-07
2025-11-05 00:18:17,880: Epoch 15 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:18:18,178: Epoch 15 average validation loss: 6.67e-07 -- Median validation metrics: avg_loss: 6.67e-07, NSE: 0.83055, MSE: 29028.11914
2025-11-05 00:18:18,326: Epoch 16 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:18:18,346: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\model_epoch016.pt
2025-11-05 00:18:18,696: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:18:18,698: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001814\validation\model_epoch016\validation_results.p
2025-11-05 00:18:19,605: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\output.log initialized.
2025-11-05 00:18:19,606: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819
2025-11-05 00:18:19,607: ### Run configurations for testing_run
2025-11-05 00:18:19,607: experiment_name: testing_run
2025-11-05 00:18:19,609: train_basin_file: calpella
2025-11-05 00:18:19,610: validation_basin_file: calpella
2025-11-05 00:18:19,611: test_basin_file: calpella
2025-11-05 00:18:19,611: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:19,612: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:19,613: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:19,614: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:19,615: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:19,615: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:19,616: device: cuda:0
2025-11-05 00:18:19,617: physics_informed: True
2025-11-05 00:18:19,618: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:19,619: validate_every: 5
2025-11-05 00:18:19,620: validate_n_random_basins: 1
2025-11-05 00:18:19,620: metrics: ['NSE', 'MSE']
2025-11-05 00:18:19,621: model: cudalstm
2025-11-05 00:18:19,622: head: regression
2025-11-05 00:18:19,623: output_activation: linear
2025-11-05 00:18:19,624: hidden_size: 64
2025-11-05 00:18:19,625: initial_forget_bias: 3
2025-11-05 00:18:19,626: output_dropout: 0.4
2025-11-05 00:18:19,626: num_layers: 1
2025-11-05 00:18:19,627: dev_mode: True
2025-11-05 00:18:19,628: optimizer: Adam
2025-11-05 00:18:19,629: loss: NSE
2025-11-05 00:18:19,630: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:18:19,631: batch_size: 64
2025-11-05 00:18:19,632: epochs: 32
2025-11-05 00:18:19,632: clip_gradient_norm: 1
2025-11-05 00:18:19,633: predict_last_n: 1
2025-11-05 00:18:19,634: seq_length: 120
2025-11-05 00:18:19,634: log_interval: 16
2025-11-05 00:18:19,635: log_tensorboard: True
2025-11-05 00:18:19,636: log_n_figures: 1
2025-11-05 00:18:19,637: save_weights_every: 32
2025-11-05 00:18:19,638: early_stopping: True
2025-11-05 00:18:19,638: early_stopping_mode: patience
2025-11-05 00:18:19,639: patience_early_stopping: 3
2025-11-05 00:18:19,640: min_delta_early_stopping: 0.0
2025-11-05 00:18:19,641: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:19,642: early_stopping_slope_window: 7
2025-11-05 00:18:19,642: early_stopping_slope_patience: 2
2025-11-05 00:18:19,643: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:19,644: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:19,645: early_stopping_slope_use_log: True
2025-11-05 00:18:19,645: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:19,646: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:19,647: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:19,648: early_stopping_slope_variance_guard: True
2025-11-05 00:18:19,649: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:19,650: dataset: russian_river
2025-11-05 00:18:19,651: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:19,651: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:19,652: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:19,653: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:19,654: hourly: False
2025-11-05 00:18:19,655: is_mts: False
2025-11-05 00:18:19,655: is_mts_data: False
2025-11-05 00:18:19,656: verbose: True
2025-11-05 00:18:19,657: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819
2025-11-05 00:18:19,658: run_label: BASELINE
2025-11-05 00:18:19,659: number_of_basins: 1
2025-11-05 00:18:19,660: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\train_data
2025-11-05 00:18:19,660: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\img_log
2025-11-05 00:18:19,663: ### Device cuda:0 will be used for training
2025-11-05 00:18:19,664: Loading basin data into xarray data set.
2025-11-05 00:18:19,956: Calculating target variable stds per basin
2025-11-05 00:18:19,968: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:20,117: Early stopping enabled: mode=patience
2025-11-05 00:18:20,566: Epoch 1 average loss: avg_loss: 1.73e-06, avg_total_loss: 1.73e-06
2025-11-05 00:18:21,010: Epoch 2 average loss: avg_loss: 9.38e-07, avg_total_loss: 9.38e-07
2025-11-05 00:18:21,422: Epoch 3 average loss: avg_loss: 8.29e-07, avg_total_loss: 8.29e-07
2025-11-05 00:18:21,849: Epoch 4 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:18:22,281: Epoch 5 average loss: avg_loss: 6.78e-07, avg_total_loss: 6.78e-07
2025-11-05 00:18:22,787: Epoch 5 average validation loss: 7.08e-07 -- Median validation metrics: avg_loss: 7.08e-07, NSE: 0.83690, MSE: 27940.55273
2025-11-05 00:18:23,168: Epoch 6 average loss: avg_loss: 6.38e-07, avg_total_loss: 6.38e-07
2025-11-05 00:18:23,600: Epoch 7 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:18:24,034: Epoch 8 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:18:24,467: Epoch 9 average loss: avg_loss: 6.54e-07, avg_total_loss: 6.54e-07
2025-11-05 00:18:24,882: Epoch 10 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:18:25,159: Epoch 10 average validation loss: 7.00e-07 -- Median validation metrics: avg_loss: 7.00e-07, NSE: 0.83899, MSE: 27583.04102
2025-11-05 00:18:25,588: Epoch 11 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:18:26,068: Epoch 12 average loss: avg_loss: 6.81e-07, avg_total_loss: 6.81e-07
2025-11-05 00:18:26,592: Epoch 13 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:18:27,097: Epoch 14 average loss: avg_loss: 6.46e-07, avg_total_loss: 6.46e-07
2025-11-05 00:18:27,580: Epoch 15 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:18:27,898: Epoch 15 average validation loss: 6.30e-07 -- Median validation metrics: avg_loss: 6.30e-07, NSE: 0.85495, MSE: 24848.24609
2025-11-05 00:18:27,899: Setting learning rate to 0.005
2025-11-05 00:18:28,304: Epoch 16 average loss: avg_loss: 6.16e-07, avg_total_loss: 6.16e-07
2025-11-05 00:18:28,760: Epoch 17 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:18:29,179: Epoch 18 average loss: avg_loss: 5.55e-07, avg_total_loss: 5.55e-07
2025-11-05 00:18:29,604: Epoch 19 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:18:30,026: Epoch 20 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:18:30,283: Epoch 20 average validation loss: 7.33e-07 -- Median validation metrics: avg_loss: 7.33e-07, NSE: 0.83134, MSE: 28892.97461
2025-11-05 00:18:30,692: Epoch 21 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:18:31,097: Epoch 22 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:18:31,512: Epoch 23 average loss: avg_loss: 4.89e-07, avg_total_loss: 4.89e-07
2025-11-05 00:18:31,513: Setting learning rate to 0.001
2025-11-05 00:18:31,939: Epoch 24 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:18:32,383: Epoch 25 average loss: avg_loss: 4.25e-07, avg_total_loss: 4.25e-07
2025-11-05 00:18:32,685: Epoch 25 average validation loss: 6.88e-07 -- Median validation metrics: avg_loss: 6.88e-07, NSE: 0.84223, MSE: 27028.42773
2025-11-05 00:18:33,077: Epoch 26 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:18:33,538: Epoch 27 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:18:34,034: Epoch 28 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:18:34,529: Epoch 29 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:18:35,012: Epoch 30 average loss: avg_loss: 3.88e-07, avg_total_loss: 3.88e-07
2025-11-05 00:18:35,346: Epoch 30 average validation loss: 7.46e-07 -- Median validation metrics: avg_loss: 7.46e-07, NSE: 0.82863, MSE: 29358.02539
2025-11-05 00:18:35,347: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:18:35,348: Early stopping triggered at epoch 30
2025-11-05 00:18:35,372: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\model_epoch030.pt
2025-11-05 00:18:35,730: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:18:35,732: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001819\validation\model_epoch030\validation_results.p
2025-11-05 00:18:36,514: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\output.log initialized.
2025-11-05 00:18:36,514: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836
2025-11-05 00:18:36,515: ### Run configurations for testing_run
2025-11-05 00:18:36,516: experiment_name: testing_run
2025-11-05 00:18:36,516: train_basin_file: calpella
2025-11-05 00:18:36,518: validation_basin_file: calpella
2025-11-05 00:18:36,518: test_basin_file: calpella
2025-11-05 00:18:36,519: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:36,520: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:36,521: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:36,523: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:36,524: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:36,525: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:36,525: device: cuda:0
2025-11-05 00:18:36,525: physics_informed: True
2025-11-05 00:18:36,526: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:36,528: validate_every: 5
2025-11-05 00:18:36,528: validate_n_random_basins: 1
2025-11-05 00:18:36,528: metrics: ['NSE', 'MSE']
2025-11-05 00:18:36,530: model: cudalstm
2025-11-05 00:18:36,530: head: regression
2025-11-05 00:18:36,531: output_activation: linear
2025-11-05 00:18:36,532: hidden_size: 64
2025-11-05 00:18:36,533: initial_forget_bias: 3
2025-11-05 00:18:36,533: output_dropout: 0.4
2025-11-05 00:18:36,534: num_layers: 1
2025-11-05 00:18:36,535: dev_mode: True
2025-11-05 00:18:36,535: optimizer: Adam
2025-11-05 00:18:36,536: loss: NSE
2025-11-05 00:18:36,537: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:18:36,538: batch_size: 128
2025-11-05 00:18:36,538: epochs: 32
2025-11-05 00:18:36,539: clip_gradient_norm: 1
2025-11-05 00:18:36,540: predict_last_n: 1
2025-11-05 00:18:36,541: seq_length: 120
2025-11-05 00:18:36,541: log_interval: 16
2025-11-05 00:18:36,542: log_tensorboard: True
2025-11-05 00:18:36,543: log_n_figures: 1
2025-11-05 00:18:36,543: save_weights_every: 32
2025-11-05 00:18:36,544: early_stopping: True
2025-11-05 00:18:36,545: early_stopping_mode: patience
2025-11-05 00:18:36,545: patience_early_stopping: 3
2025-11-05 00:18:36,546: min_delta_early_stopping: 0.0
2025-11-05 00:18:36,547: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:36,548: early_stopping_slope_window: 7
2025-11-05 00:18:36,549: early_stopping_slope_patience: 2
2025-11-05 00:18:36,549: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:36,550: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:36,550: early_stopping_slope_use_log: True
2025-11-05 00:18:36,551: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:36,552: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:36,553: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:36,554: early_stopping_slope_variance_guard: True
2025-11-05 00:18:36,555: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:36,556: dataset: russian_river
2025-11-05 00:18:36,557: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:36,558: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:36,558: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:36,559: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:36,560: hourly: False
2025-11-05 00:18:36,561: is_mts: False
2025-11-05 00:18:36,561: is_mts_data: False
2025-11-05 00:18:36,562: verbose: True
2025-11-05 00:18:36,563: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836
2025-11-05 00:18:36,564: run_label: BASELINE
2025-11-05 00:18:36,564: number_of_basins: 1
2025-11-05 00:18:36,565: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\train_data
2025-11-05 00:18:36,566: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\img_log
2025-11-05 00:18:36,568: ### Device cuda:0 will be used for training
2025-11-05 00:18:36,569: Loading basin data into xarray data set.
2025-11-05 00:18:36,866: Calculating target variable stds per basin
2025-11-05 00:18:36,880: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:37,021: Early stopping enabled: mode=patience
2025-11-05 00:18:37,506: Epoch 1 average loss: avg_loss: 1.79e-06, avg_total_loss: 1.79e-06
2025-11-05 00:18:37,848: Epoch 2 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:18:38,104: Epoch 3 average loss: avg_loss: 9.30e-07, avg_total_loss: 9.30e-07
2025-11-05 00:18:38,326: Epoch 4 average loss: avg_loss: 8.40e-07, avg_total_loss: 8.40e-07
2025-11-05 00:18:38,571: Epoch 5 average loss: avg_loss: 7.68e-07, avg_total_loss: 7.68e-07
2025-11-05 00:18:39,163: Epoch 5 average validation loss: 8.36e-07 -- Median validation metrics: avg_loss: 8.36e-07, NSE: 0.80766, MSE: 32950.16406
2025-11-05 00:18:39,392: Epoch 6 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:18:39,660: Epoch 7 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:18:39,897: Epoch 8 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:18:40,157: Epoch 9 average loss: avg_loss: 5.59e-07, avg_total_loss: 5.59e-07
2025-11-05 00:18:40,430: Epoch 10 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:18:40,771: Epoch 10 average validation loss: 7.05e-07 -- Median validation metrics: avg_loss: 7.05e-07, NSE: 0.83833, MSE: 27695.82617
2025-11-05 00:18:41,057: Epoch 11 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:18:41,401: Epoch 12 average loss: avg_loss: 5.93e-07, avg_total_loss: 5.93e-07
2025-11-05 00:18:41,719: Epoch 13 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:18:41,983: Epoch 14 average loss: avg_loss: 5.79e-07, avg_total_loss: 5.79e-07
2025-11-05 00:18:42,250: Epoch 15 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:18:42,575: Epoch 15 average validation loss: 6.79e-07 -- Median validation metrics: avg_loss: 6.79e-07, NSE: 0.84375, MSE: 26767.80078
2025-11-05 00:18:42,576: Setting learning rate to 0.005
2025-11-05 00:18:42,778: Epoch 16 average loss: avg_loss: 5.53e-07, avg_total_loss: 5.53e-07
2025-11-05 00:18:43,007: Epoch 17 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:18:43,234: Epoch 18 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:18:43,512: Epoch 19 average loss: avg_loss: 4.47e-07, avg_total_loss: 4.47e-07
2025-11-05 00:18:43,767: Epoch 20 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:18:44,077: Epoch 20 average validation loss: 6.26e-07 -- Median validation metrics: avg_loss: 6.26e-07, NSE: 0.85597, MSE: 24673.43359
2025-11-05 00:18:44,324: Epoch 21 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:18:44,593: Epoch 22 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:18:44,914: Epoch 23 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:18:44,915: Setting learning rate to 0.001
2025-11-05 00:18:45,219: Epoch 24 average loss: avg_loss: 4.79e-07, avg_total_loss: 4.79e-07
2025-11-05 00:18:45,403: Epoch 25 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:18:45,739: Epoch 25 average validation loss: 6.75e-07 -- Median validation metrics: avg_loss: 6.75e-07, NSE: 0.84490, MSE: 26570.56055
2025-11-05 00:18:45,960: Epoch 26 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:18:46,177: Epoch 27 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:18:46,407: Epoch 28 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:18:46,654: Epoch 29 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:18:46,901: Epoch 30 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:18:47,235: Epoch 30 average validation loss: 6.45e-07 -- Median validation metrics: avg_loss: 6.45e-07, NSE: 0.85202, MSE: 25351.63672
2025-11-05 00:18:47,487: Epoch 31 average loss: avg_loss: 3.88e-07, avg_total_loss: 3.88e-07
2025-11-05 00:18:47,831: Epoch 32 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:18:47,855: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\model_epoch032.pt
2025-11-05 00:18:48,215: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:18:48,217: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001836\validation\model_epoch032\validation_results.p
2025-11-05 00:18:49,314: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\output.log initialized.
2025-11-05 00:18:49,315: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849
2025-11-05 00:18:49,316: ### Run configurations for testing_run
2025-11-05 00:18:49,317: experiment_name: testing_run
2025-11-05 00:18:49,317: train_basin_file: calpella
2025-11-05 00:18:49,318: validation_basin_file: calpella
2025-11-05 00:18:49,319: test_basin_file: calpella
2025-11-05 00:18:49,320: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:49,320: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:49,321: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:49,322: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:49,322: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:49,323: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:49,325: device: cuda:0
2025-11-05 00:18:49,325: physics_informed: True
2025-11-05 00:18:49,326: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:49,327: validate_every: 5
2025-11-05 00:18:49,328: validate_n_random_basins: 1
2025-11-05 00:18:49,328: metrics: ['NSE', 'MSE']
2025-11-05 00:18:49,329: model: cudalstm
2025-11-05 00:18:49,330: head: regression
2025-11-05 00:18:49,330: output_activation: linear
2025-11-05 00:18:49,331: hidden_size: 64
2025-11-05 00:18:49,332: initial_forget_bias: 3
2025-11-05 00:18:49,333: output_dropout: 0.4
2025-11-05 00:18:49,334: num_layers: 1
2025-11-05 00:18:49,335: dev_mode: True
2025-11-05 00:18:49,335: optimizer: Adam
2025-11-05 00:18:49,336: loss: NSE
2025-11-05 00:18:49,337: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:18:49,338: batch_size: 256
2025-11-05 00:18:49,338: epochs: 32
2025-11-05 00:18:49,339: clip_gradient_norm: 1
2025-11-05 00:18:49,340: predict_last_n: 1
2025-11-05 00:18:49,340: seq_length: 120
2025-11-05 00:18:49,341: log_interval: 16
2025-11-05 00:18:49,342: log_tensorboard: True
2025-11-05 00:18:49,342: log_n_figures: 1
2025-11-05 00:18:49,343: save_weights_every: 32
2025-11-05 00:18:49,343: early_stopping: True
2025-11-05 00:18:49,344: early_stopping_mode: patience
2025-11-05 00:18:49,345: patience_early_stopping: 3
2025-11-05 00:18:49,346: min_delta_early_stopping: 0.0
2025-11-05 00:18:49,346: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:49,347: early_stopping_slope_window: 7
2025-11-05 00:18:49,348: early_stopping_slope_patience: 2
2025-11-05 00:18:49,348: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:49,349: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:49,349: early_stopping_slope_use_log: True
2025-11-05 00:18:49,350: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:49,351: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:49,351: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:49,352: early_stopping_slope_variance_guard: True
2025-11-05 00:18:49,353: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:49,353: dataset: russian_river
2025-11-05 00:18:49,354: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:49,355: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:49,356: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:49,358: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:49,359: hourly: False
2025-11-05 00:18:49,359: is_mts: False
2025-11-05 00:18:49,360: is_mts_data: False
2025-11-05 00:18:49,361: verbose: True
2025-11-05 00:18:49,362: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849
2025-11-05 00:18:49,362: run_label: BASELINE
2025-11-05 00:18:49,363: number_of_basins: 1
2025-11-05 00:18:49,364: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\train_data
2025-11-05 00:18:49,364: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\img_log
2025-11-05 00:18:49,367: ### Device cuda:0 will be used for training
2025-11-05 00:18:49,368: Loading basin data into xarray data set.
2025-11-05 00:18:49,605: Calculating target variable stds per basin
2025-11-05 00:18:49,616: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:49,754: Early stopping enabled: mode=patience
2025-11-05 00:18:50,072: Epoch 1 average loss: avg_loss: 2.25e-06, avg_total_loss: 2.25e-06
2025-11-05 00:18:50,233: Epoch 2 average loss: avg_loss: 1.37e-06, avg_total_loss: 1.37e-06
2025-11-05 00:18:50,372: Epoch 3 average loss: avg_loss: 1.13e-06, avg_total_loss: 1.13e-06
2025-11-05 00:18:50,507: Epoch 4 average loss: avg_loss: 8.59e-07, avg_total_loss: 8.59e-07
2025-11-05 00:18:50,664: Epoch 5 average loss: avg_loss: 8.53e-07, avg_total_loss: 8.53e-07
2025-11-05 00:18:51,152: Epoch 5 average validation loss: 7.95e-07 -- Median validation metrics: avg_loss: 7.95e-07, NSE: 0.79678, MSE: 34813.71875
2025-11-05 00:18:51,288: Epoch 6 average loss: avg_loss: 7.94e-07, avg_total_loss: 7.94e-07
2025-11-05 00:18:51,432: Epoch 7 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:18:51,586: Epoch 8 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:18:51,739: Epoch 9 average loss: avg_loss: 6.74e-07, avg_total_loss: 6.74e-07
2025-11-05 00:18:51,895: Epoch 10 average loss: avg_loss: 6.34e-07, avg_total_loss: 6.34e-07
2025-11-05 00:18:52,217: Epoch 10 average validation loss: 8.84e-07 -- Median validation metrics: avg_loss: 8.84e-07, NSE: 0.77838, MSE: 37966.48438
2025-11-05 00:18:52,396: Epoch 11 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:18:52,562: Epoch 12 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:18:52,719: Epoch 13 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:18:52,909: Epoch 14 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:18:53,077: Epoch 15 average loss: avg_loss: 4.98e-07, avg_total_loss: 4.98e-07
2025-11-05 00:18:53,397: Epoch 15 average validation loss: 7.56e-07 -- Median validation metrics: avg_loss: 7.56e-07, NSE: 0.81320, MSE: 32000.38086
2025-11-05 00:18:53,399: Setting learning rate to 0.005
2025-11-05 00:18:53,568: Epoch 16 average loss: avg_loss: 5.08e-07, avg_total_loss: 5.08e-07
2025-11-05 00:18:53,725: Epoch 17 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:18:53,920: Epoch 18 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:18:54,102: Epoch 19 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:18:54,263: Epoch 20 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:18:54,594: Epoch 20 average validation loss: 7.52e-07 -- Median validation metrics: avg_loss: 7.52e-07, NSE: 0.81126, MSE: 32333.42383
2025-11-05 00:18:54,747: Epoch 21 average loss: avg_loss: 4.69e-07, avg_total_loss: 4.69e-07
2025-11-05 00:18:54,908: Epoch 22 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:18:55,075: Epoch 23 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:18:55,077: Setting learning rate to 0.001
2025-11-05 00:18:55,248: Epoch 24 average loss: avg_loss: 4.56e-07, avg_total_loss: 4.56e-07
2025-11-05 00:18:55,413: Epoch 25 average loss: avg_loss: 4.64e-07, avg_total_loss: 4.64e-07
2025-11-05 00:18:55,759: Epoch 25 average validation loss: 6.80e-07 -- Median validation metrics: avg_loss: 6.80e-07, NSE: 0.82746, MSE: 29558.52734
2025-11-05 00:18:55,942: Epoch 26 average loss: avg_loss: 4.12e-07, avg_total_loss: 4.12e-07
2025-11-05 00:18:56,130: Epoch 27 average loss: avg_loss: 4.39e-07, avg_total_loss: 4.39e-07
2025-11-05 00:18:56,299: Epoch 28 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:18:56,471: Epoch 29 average loss: avg_loss: 3.92e-07, avg_total_loss: 3.92e-07
2025-11-05 00:18:56,649: Epoch 30 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:18:57,003: Epoch 30 average validation loss: 6.95e-07 -- Median validation metrics: avg_loss: 6.95e-07, NSE: 0.82386, MSE: 30175.66992
2025-11-05 00:18:57,181: Epoch 31 average loss: avg_loss: 3.60e-07, avg_total_loss: 3.60e-07
2025-11-05 00:18:57,352: Epoch 32 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:18:57,371: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\model_epoch032.pt
2025-11-05 00:18:57,651: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:18:57,653: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001849\validation\model_epoch032\validation_results.p
2025-11-05 00:18:58,376: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\output.log initialized.
2025-11-05 00:18:58,377: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858
2025-11-05 00:18:58,378: ### Run configurations for testing_run
2025-11-05 00:18:58,379: experiment_name: testing_run
2025-11-05 00:18:58,380: train_basin_file: calpella
2025-11-05 00:18:58,381: validation_basin_file: calpella
2025-11-05 00:18:58,382: test_basin_file: calpella
2025-11-05 00:18:58,383: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:18:58,384: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:18:58,385: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:18:58,385: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:18:58,386: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:18:58,387: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:18:58,387: device: cuda:0
2025-11-05 00:18:58,388: physics_informed: True
2025-11-05 00:18:58,389: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:18:58,390: validate_every: 5
2025-11-05 00:18:58,390: validate_n_random_basins: 1
2025-11-05 00:18:58,391: metrics: ['NSE', 'MSE']
2025-11-05 00:18:58,392: model: cudalstm
2025-11-05 00:18:58,393: head: regression
2025-11-05 00:18:58,394: output_activation: linear
2025-11-05 00:18:58,395: hidden_size: 64
2025-11-05 00:18:58,396: initial_forget_bias: 3
2025-11-05 00:18:58,396: output_dropout: 0.4
2025-11-05 00:18:58,397: num_layers: 1
2025-11-05 00:18:58,398: dev_mode: True
2025-11-05 00:18:58,399: optimizer: Adam
2025-11-05 00:18:58,399: loss: NSE
2025-11-05 00:18:58,400: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:18:58,401: batch_size: 64
2025-11-05 00:18:58,401: epochs: 48
2025-11-05 00:18:58,402: clip_gradient_norm: 1
2025-11-05 00:18:58,403: predict_last_n: 1
2025-11-05 00:18:58,403: seq_length: 120
2025-11-05 00:18:58,404: log_interval: 16
2025-11-05 00:18:58,405: log_tensorboard: True
2025-11-05 00:18:58,406: log_n_figures: 1
2025-11-05 00:18:58,407: save_weights_every: 48
2025-11-05 00:18:58,407: early_stopping: True
2025-11-05 00:18:58,408: early_stopping_mode: patience
2025-11-05 00:18:58,409: patience_early_stopping: 3
2025-11-05 00:18:58,409: min_delta_early_stopping: 0.0
2025-11-05 00:18:58,410: minimum_epochs_before_early_stopping: 10
2025-11-05 00:18:58,411: early_stopping_slope_window: 7
2025-11-05 00:18:58,411: early_stopping_slope_patience: 2
2025-11-05 00:18:58,412: early_stopping_slope_min_epoch: 8
2025-11-05 00:18:58,413: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:18:58,414: early_stopping_slope_use_log: True
2025-11-05 00:18:58,414: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:18:58,415: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:18:58,416: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:18:58,417: early_stopping_slope_variance_guard: True
2025-11-05 00:18:58,417: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:18:58,418: dataset: russian_river
2025-11-05 00:18:58,419: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:18:58,419: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:18:58,420: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:18:58,421: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:18:58,421: hourly: False
2025-11-05 00:18:58,422: is_mts: False
2025-11-05 00:18:58,423: is_mts_data: False
2025-11-05 00:18:58,424: verbose: True
2025-11-05 00:18:58,424: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858
2025-11-05 00:18:58,425: run_label: BASELINE
2025-11-05 00:18:58,426: number_of_basins: 1
2025-11-05 00:18:58,426: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\train_data
2025-11-05 00:18:58,427: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\img_log
2025-11-05 00:18:58,429: ### Device cuda:0 will be used for training
2025-11-05 00:18:58,431: Loading basin data into xarray data set.
2025-11-05 00:18:58,645: Calculating target variable stds per basin
2025-11-05 00:18:58,656: Create lookup table and convert to pytorch tensor
2025-11-05 00:18:58,796: Early stopping enabled: mode=patience
2025-11-05 00:18:59,287: Epoch 1 average loss: avg_loss: 1.60e-06, avg_total_loss: 1.60e-06
2025-11-05 00:18:59,783: Epoch 2 average loss: avg_loss: 9.81e-07, avg_total_loss: 9.81e-07
2025-11-05 00:19:00,290: Epoch 3 average loss: avg_loss: 8.17e-07, avg_total_loss: 8.17e-07
2025-11-05 00:19:00,896: Epoch 4 average loss: avg_loss: 7.19e-07, avg_total_loss: 7.19e-07
2025-11-05 00:19:01,379: Epoch 5 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:19:01,987: Epoch 5 average validation loss: 7.51e-07 -- Median validation metrics: avg_loss: 7.51e-07, NSE: 0.82833, MSE: 29408.72070
2025-11-05 00:19:02,605: Epoch 6 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:19:03,391: Epoch 7 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:19:03,934: Epoch 8 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:19:04,449: Epoch 9 average loss: avg_loss: 6.64e-07, avg_total_loss: 6.64e-07
2025-11-05 00:19:04,988: Epoch 10 average loss: avg_loss: 6.22e-07, avg_total_loss: 6.22e-07
2025-11-05 00:19:05,329: Epoch 10 average validation loss: 8.86e-07 -- Median validation metrics: avg_loss: 8.86e-07, NSE: 0.79978, MSE: 34299.34766
2025-11-05 00:19:06,035: Epoch 11 average loss: avg_loss: 7.41e-07, avg_total_loss: 7.41e-07
2025-11-05 00:19:06,563: Epoch 12 average loss: avg_loss: 6.51e-07, avg_total_loss: 6.51e-07
2025-11-05 00:19:07,134: Epoch 13 average loss: avg_loss: 5.17e-07, avg_total_loss: 5.17e-07
2025-11-05 00:19:07,765: Epoch 14 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:19:08,248: Epoch 15 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:19:08,558: Epoch 15 average validation loss: 8.48e-07 -- Median validation metrics: avg_loss: 8.48e-07, NSE: 0.80531, MSE: 33352.19922
2025-11-05 00:19:09,059: Epoch 16 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:19:09,590: Epoch 17 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:19:10,089: Epoch 18 average loss: avg_loss: 7.29e-07, avg_total_loss: 7.29e-07
2025-11-05 00:19:10,575: Epoch 19 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:19:11,121: Epoch 20 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:19:11,440: Epoch 20 average validation loss: 6.54e-07 -- Median validation metrics: avg_loss: 6.54e-07, NSE: 0.84980, MSE: 25731.92383
2025-11-05 00:19:12,003: Epoch 21 average loss: avg_loss: 6.28e-07, avg_total_loss: 6.28e-07
2025-11-05 00:19:12,540: Epoch 22 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:19:13,041: Epoch 23 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:19:13,041: Setting learning rate to 0.005
2025-11-05 00:19:13,537: Epoch 24 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:19:14,111: Epoch 25 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:19:14,407: Epoch 25 average validation loss: 6.90e-07 -- Median validation metrics: avg_loss: 6.90e-07, NSE: 0.84111, MSE: 27220.07031
2025-11-05 00:19:15,012: Epoch 26 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:19:15,494: Epoch 27 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:19:15,995: Epoch 28 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:19:16,503: Epoch 29 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:19:17,003: Epoch 30 average loss: avg_loss: 4.61e-07, avg_total_loss: 4.61e-07
2025-11-05 00:19:17,315: Epoch 30 average validation loss: 6.80e-07 -- Median validation metrics: avg_loss: 6.80e-07, NSE: 0.84383, MSE: 26754.56445
2025-11-05 00:19:17,906: Epoch 31 average loss: avg_loss: 4.19e-07, avg_total_loss: 4.19e-07
2025-11-05 00:19:18,390: Epoch 32 average loss: avg_loss: 3.83e-07, avg_total_loss: 3.83e-07
2025-11-05 00:19:18,885: Epoch 33 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:19:19,396: Epoch 34 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:19:19,881: Epoch 35 average loss: avg_loss: 3.77e-07, avg_total_loss: 3.77e-07
2025-11-05 00:19:20,249: Epoch 35 average validation loss: 7.88e-07 -- Median validation metrics: avg_loss: 7.88e-07, NSE: 0.81888, MSE: 31028.21484
2025-11-05 00:19:20,250: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:19:20,251: Early stopping triggered at epoch 35
2025-11-05 00:19:20,269: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\model_epoch035.pt
2025-11-05 00:19:20,575: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:19:20,576: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001858\validation\model_epoch035\validation_results.p
2025-11-05 00:19:21,308: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\output.log initialized.
2025-11-05 00:19:21,309: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921
2025-11-05 00:19:21,310: ### Run configurations for testing_run
2025-11-05 00:19:21,311: experiment_name: testing_run
2025-11-05 00:19:21,311: train_basin_file: calpella
2025-11-05 00:19:21,312: validation_basin_file: calpella
2025-11-05 00:19:21,313: test_basin_file: calpella
2025-11-05 00:19:21,314: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:19:21,317: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:19:21,318: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:19:21,318: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:19:21,319: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:19:21,319: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:19:21,320: device: cuda:0
2025-11-05 00:19:21,322: physics_informed: True
2025-11-05 00:19:21,323: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:19:21,324: validate_every: 5
2025-11-05 00:19:21,325: validate_n_random_basins: 1
2025-11-05 00:19:21,326: metrics: ['NSE', 'MSE']
2025-11-05 00:19:21,327: model: cudalstm
2025-11-05 00:19:21,328: head: regression
2025-11-05 00:19:21,328: output_activation: linear
2025-11-05 00:19:21,329: hidden_size: 64
2025-11-05 00:19:21,330: initial_forget_bias: 3
2025-11-05 00:19:21,331: output_dropout: 0.4
2025-11-05 00:19:21,332: num_layers: 1
2025-11-05 00:19:21,332: dev_mode: True
2025-11-05 00:19:21,334: optimizer: Adam
2025-11-05 00:19:21,335: loss: NSE
2025-11-05 00:19:21,335: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:19:21,336: batch_size: 128
2025-11-05 00:19:21,336: epochs: 48
2025-11-05 00:19:21,337: clip_gradient_norm: 1
2025-11-05 00:19:21,338: predict_last_n: 1
2025-11-05 00:19:21,339: seq_length: 120
2025-11-05 00:19:21,340: log_interval: 16
2025-11-05 00:19:21,341: log_tensorboard: True
2025-11-05 00:19:21,342: log_n_figures: 1
2025-11-05 00:19:21,343: save_weights_every: 48
2025-11-05 00:19:21,344: early_stopping: True
2025-11-05 00:19:21,344: early_stopping_mode: patience
2025-11-05 00:19:21,345: patience_early_stopping: 3
2025-11-05 00:19:21,346: min_delta_early_stopping: 0.0
2025-11-05 00:19:21,347: minimum_epochs_before_early_stopping: 10
2025-11-05 00:19:21,348: early_stopping_slope_window: 7
2025-11-05 00:19:21,349: early_stopping_slope_patience: 2
2025-11-05 00:19:21,350: early_stopping_slope_min_epoch: 8
2025-11-05 00:19:21,351: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:19:21,351: early_stopping_slope_use_log: True
2025-11-05 00:19:21,352: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:19:21,353: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:19:21,354: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:19:21,355: early_stopping_slope_variance_guard: True
2025-11-05 00:19:21,356: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:19:21,357: dataset: russian_river
2025-11-05 00:19:21,357: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:19:21,358: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:19:21,359: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:19:21,360: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:19:21,361: hourly: False
2025-11-05 00:19:21,361: is_mts: False
2025-11-05 00:19:21,362: is_mts_data: False
2025-11-05 00:19:21,363: verbose: True
2025-11-05 00:19:21,364: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921
2025-11-05 00:19:21,365: run_label: BASELINE
2025-11-05 00:19:21,366: number_of_basins: 1
2025-11-05 00:19:21,367: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\train_data
2025-11-05 00:19:21,367: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\img_log
2025-11-05 00:19:21,369: ### Device cuda:0 will be used for training
2025-11-05 00:19:21,371: Loading basin data into xarray data set.
2025-11-05 00:19:21,582: Calculating target variable stds per basin
2025-11-05 00:19:21,593: Create lookup table and convert to pytorch tensor
2025-11-05 00:19:21,780: Early stopping enabled: mode=patience
2025-11-05 00:19:22,339: Epoch 1 average loss: avg_loss: 2.00e-06, avg_total_loss: 2.00e-06
2025-11-05 00:19:22,676: Epoch 2 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:19:23,031: Epoch 3 average loss: avg_loss: 9.41e-07, avg_total_loss: 9.41e-07
2025-11-05 00:19:23,306: Epoch 4 average loss: avg_loss: 8.52e-07, avg_total_loss: 8.52e-07
2025-11-05 00:19:23,522: Epoch 5 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:19:24,092: Epoch 5 average validation loss: 8.11e-07 -- Median validation metrics: avg_loss: 8.11e-07, NSE: 0.81331, MSE: 31982.92578
2025-11-05 00:19:24,277: Epoch 6 average loss: avg_loss: 7.48e-07, avg_total_loss: 7.48e-07
2025-11-05 00:19:24,517: Epoch 7 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:19:24,764: Epoch 8 average loss: avg_loss: 6.03e-07, avg_total_loss: 6.03e-07
2025-11-05 00:19:25,044: Epoch 9 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:19:25,274: Epoch 10 average loss: avg_loss: 6.46e-07, avg_total_loss: 6.46e-07
2025-11-05 00:19:25,588: Epoch 10 average validation loss: 7.09e-07 -- Median validation metrics: avg_loss: 7.09e-07, NSE: 0.83683, MSE: 27952.97656
2025-11-05 00:19:26,081: Epoch 11 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:19:26,402: Epoch 12 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:19:26,743: Epoch 13 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:19:27,100: Epoch 14 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:19:27,377: Epoch 15 average loss: avg_loss: 5.60e-07, avg_total_loss: 5.60e-07
2025-11-05 00:19:27,717: Epoch 15 average validation loss: 6.86e-07 -- Median validation metrics: avg_loss: 6.86e-07, NSE: 0.84198, MSE: 27070.42188
2025-11-05 00:19:27,949: Epoch 16 average loss: avg_loss: 5.04e-07, avg_total_loss: 5.04e-07
2025-11-05 00:19:28,194: Epoch 17 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:19:28,449: Epoch 18 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:19:28,660: Epoch 19 average loss: avg_loss: 4.89e-07, avg_total_loss: 4.89e-07
2025-11-05 00:19:28,960: Epoch 20 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:19:29,246: Epoch 20 average validation loss: 7.28e-07 -- Median validation metrics: avg_loss: 7.28e-07, NSE: 0.83262, MSE: 28673.87891
2025-11-05 00:19:29,447: Epoch 21 average loss: avg_loss: 4.98e-07, avg_total_loss: 4.98e-07
2025-11-05 00:19:29,798: Epoch 22 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:19:30,124: Epoch 23 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:19:30,125: Setting learning rate to 0.005
2025-11-05 00:19:30,511: Epoch 24 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:19:30,859: Epoch 25 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:19:31,160: Epoch 25 average validation loss: 6.97e-07 -- Median validation metrics: avg_loss: 6.97e-07, NSE: 0.83963, MSE: 27472.99609
2025-11-05 00:19:31,442: Epoch 26 average loss: avg_loss: 3.58e-07, avg_total_loss: 3.58e-07
2025-11-05 00:19:31,719: Epoch 27 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:19:31,966: Epoch 28 average loss: avg_loss: 4.33e-07, avg_total_loss: 4.33e-07
2025-11-05 00:19:32,218: Epoch 29 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:19:32,448: Epoch 30 average loss: avg_loss: 3.67e-07, avg_total_loss: 3.67e-07
2025-11-05 00:19:32,798: Epoch 30 average validation loss: 7.17e-07 -- Median validation metrics: avg_loss: 7.17e-07, NSE: 0.83531, MSE: 28213.37109
2025-11-05 00:19:32,799: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:19:32,799: Early stopping triggered at epoch 30
2025-11-05 00:19:32,816: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\model_epoch030.pt
2025-11-05 00:19:33,074: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:19:33,076: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001921\validation\model_epoch030\validation_results.p
2025-11-05 00:19:33,767: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\output.log initialized.
2025-11-05 00:19:33,768: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933
2025-11-05 00:19:33,769: ### Run configurations for testing_run
2025-11-05 00:19:33,770: experiment_name: testing_run
2025-11-05 00:19:33,770: train_basin_file: calpella
2025-11-05 00:19:33,771: validation_basin_file: calpella
2025-11-05 00:19:33,772: test_basin_file: calpella
2025-11-05 00:19:33,772: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:19:33,773: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:19:33,774: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:19:33,775: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:19:33,776: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:19:33,776: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:19:33,777: device: cuda:0
2025-11-05 00:19:33,778: physics_informed: True
2025-11-05 00:19:33,778: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:19:33,779: validate_every: 5
2025-11-05 00:19:33,779: validate_n_random_basins: 1
2025-11-05 00:19:33,780: metrics: ['NSE', 'MSE']
2025-11-05 00:19:33,781: model: cudalstm
2025-11-05 00:19:33,781: head: regression
2025-11-05 00:19:33,782: output_activation: linear
2025-11-05 00:19:33,783: hidden_size: 64
2025-11-05 00:19:33,783: initial_forget_bias: 3
2025-11-05 00:19:33,784: output_dropout: 0.4
2025-11-05 00:19:33,785: num_layers: 1
2025-11-05 00:19:33,785: dev_mode: True
2025-11-05 00:19:33,786: optimizer: Adam
2025-11-05 00:19:33,787: loss: NSE
2025-11-05 00:19:33,787: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:19:33,788: batch_size: 256
2025-11-05 00:19:33,789: epochs: 48
2025-11-05 00:19:33,789: clip_gradient_norm: 1
2025-11-05 00:19:33,790: predict_last_n: 1
2025-11-05 00:19:33,791: seq_length: 120
2025-11-05 00:19:33,791: log_interval: 16
2025-11-05 00:19:33,792: log_tensorboard: True
2025-11-05 00:19:33,793: log_n_figures: 1
2025-11-05 00:19:33,793: save_weights_every: 48
2025-11-05 00:19:33,794: early_stopping: True
2025-11-05 00:19:33,795: early_stopping_mode: patience
2025-11-05 00:19:33,795: patience_early_stopping: 3
2025-11-05 00:19:33,796: min_delta_early_stopping: 0.0
2025-11-05 00:19:33,797: minimum_epochs_before_early_stopping: 10
2025-11-05 00:19:33,797: early_stopping_slope_window: 7
2025-11-05 00:19:33,797: early_stopping_slope_patience: 2
2025-11-05 00:19:33,798: early_stopping_slope_min_epoch: 8
2025-11-05 00:19:33,799: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:19:33,800: early_stopping_slope_use_log: True
2025-11-05 00:19:33,800: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:19:33,801: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:19:33,802: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:19:33,802: early_stopping_slope_variance_guard: True
2025-11-05 00:19:33,803: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:19:33,804: dataset: russian_river
2025-11-05 00:19:33,805: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:19:33,805: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:19:33,806: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:19:33,806: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:19:33,807: hourly: False
2025-11-05 00:19:33,808: is_mts: False
2025-11-05 00:19:33,808: is_mts_data: False
2025-11-05 00:19:33,809: verbose: True
2025-11-05 00:19:33,810: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933
2025-11-05 00:19:33,810: run_label: BASELINE
2025-11-05 00:19:33,811: number_of_basins: 1
2025-11-05 00:19:33,812: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\train_data
2025-11-05 00:19:33,813: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\img_log
2025-11-05 00:19:33,815: ### Device cuda:0 will be used for training
2025-11-05 00:19:33,816: Loading basin data into xarray data set.
2025-11-05 00:19:34,085: Calculating target variable stds per basin
2025-11-05 00:19:34,096: Create lookup table and convert to pytorch tensor
2025-11-05 00:19:34,236: Early stopping enabled: mode=patience
2025-11-05 00:19:34,499: Epoch 1 average loss: avg_loss: 2.47e-06, avg_total_loss: 2.47e-06
2025-11-05 00:19:34,761: Epoch 2 average loss: avg_loss: 1.31e-06, avg_total_loss: 1.31e-06
2025-11-05 00:19:35,026: Epoch 3 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:19:35,157: Epoch 4 average loss: avg_loss: 9.40e-07, avg_total_loss: 9.40e-07
2025-11-05 00:19:35,304: Epoch 5 average loss: avg_loss: 9.05e-07, avg_total_loss: 9.05e-07
2025-11-05 00:19:35,851: Epoch 5 average validation loss: 7.78e-07 -- Median validation metrics: avg_loss: 7.78e-07, NSE: 0.80091, MSE: 34106.43359
2025-11-05 00:19:35,986: Epoch 6 average loss: avg_loss: 8.35e-07, avg_total_loss: 8.35e-07
2025-11-05 00:19:36,136: Epoch 7 average loss: avg_loss: 7.41e-07, avg_total_loss: 7.41e-07
2025-11-05 00:19:36,276: Epoch 8 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:19:36,447: Epoch 9 average loss: avg_loss: 6.72e-07, avg_total_loss: 6.72e-07
2025-11-05 00:19:36,591: Epoch 10 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:19:36,925: Epoch 10 average validation loss: 7.36e-07 -- Median validation metrics: avg_loss: 7.36e-07, NSE: 0.81352, MSE: 31946.98438
2025-11-05 00:19:37,058: Epoch 11 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:19:37,231: Epoch 12 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:19:37,383: Epoch 13 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:19:37,521: Epoch 14 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:19:37,701: Epoch 15 average loss: avg_loss: 4.80e-07, avg_total_loss: 4.80e-07
2025-11-05 00:19:38,049: Epoch 15 average validation loss: 7.71e-07 -- Median validation metrics: avg_loss: 7.71e-07, NSE: 0.80482, MSE: 33436.32031
2025-11-05 00:19:38,200: Epoch 16 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:19:38,358: Epoch 17 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:19:38,543: Epoch 18 average loss: avg_loss: 4.27e-07, avg_total_loss: 4.27e-07
2025-11-05 00:19:38,711: Epoch 19 average loss: avg_loss: 4.25e-07, avg_total_loss: 4.25e-07
2025-11-05 00:19:38,873: Epoch 20 average loss: avg_loss: 4.53e-07, avg_total_loss: 4.53e-07
2025-11-05 00:19:39,213: Epoch 20 average validation loss: 6.94e-07 -- Median validation metrics: avg_loss: 6.94e-07, NSE: 0.82464, MSE: 30041.84961
2025-11-05 00:19:39,362: Epoch 21 average loss: avg_loss: 4.58e-07, avg_total_loss: 4.58e-07
2025-11-05 00:19:39,513: Epoch 22 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:19:39,725: Epoch 23 average loss: avg_loss: 5.11e-07, avg_total_loss: 5.11e-07
2025-11-05 00:19:39,726: Setting learning rate to 0.005
2025-11-05 00:19:39,903: Epoch 24 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:19:40,072: Epoch 25 average loss: avg_loss: 4.61e-07, avg_total_loss: 4.61e-07
2025-11-05 00:19:40,369: Epoch 25 average validation loss: 6.80e-07 -- Median validation metrics: avg_loss: 6.80e-07, NSE: 0.82791, MSE: 29480.26367
2025-11-05 00:19:40,558: Epoch 26 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:19:40,713: Epoch 27 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:19:40,895: Epoch 28 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:19:41,100: Epoch 29 average loss: avg_loss: 3.50e-07, avg_total_loss: 3.50e-07
2025-11-05 00:19:41,280: Epoch 30 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:19:41,573: Epoch 30 average validation loss: 6.13e-07 -- Median validation metrics: avg_loss: 6.13e-07, NSE: 0.84472, MSE: 26601.68359
2025-11-05 00:19:41,750: Epoch 31 average loss: avg_loss: 3.84e-07, avg_total_loss: 3.84e-07
2025-11-05 00:19:41,930: Epoch 32 average loss: avg_loss: 3.93e-07, avg_total_loss: 3.93e-07
2025-11-05 00:19:42,094: Epoch 33 average loss: avg_loss: 3.72e-07, avg_total_loss: 3.72e-07
2025-11-05 00:19:42,261: Epoch 34 average loss: avg_loss: 3.84e-07, avg_total_loss: 3.84e-07
2025-11-05 00:19:42,448: Epoch 35 average loss: avg_loss: 3.70e-07, avg_total_loss: 3.70e-07
2025-11-05 00:19:42,739: Epoch 35 average validation loss: 7.39e-07 -- Median validation metrics: avg_loss: 7.39e-07, NSE: 0.81367, MSE: 31921.36914
2025-11-05 00:19:42,739: Setting learning rate to 0.001
2025-11-05 00:19:42,900: Epoch 36 average loss: avg_loss: 3.51e-07, avg_total_loss: 3.51e-07
2025-11-05 00:19:43,074: Epoch 37 average loss: avg_loss: 3.48e-07, avg_total_loss: 3.48e-07
2025-11-05 00:19:43,235: Epoch 38 average loss: avg_loss: 3.18e-07, avg_total_loss: 3.18e-07
2025-11-05 00:19:43,389: Epoch 39 average loss: avg_loss: 3.38e-07, avg_total_loss: 3.38e-07
2025-11-05 00:19:43,554: Epoch 40 average loss: avg_loss: 3.67e-07, avg_total_loss: 3.67e-07
2025-11-05 00:19:43,843: Epoch 40 average validation loss: 6.85e-07 -- Median validation metrics: avg_loss: 6.85e-07, NSE: 0.82644, MSE: 29733.33984
2025-11-05 00:19:43,991: Epoch 41 average loss: avg_loss: 3.32e-07, avg_total_loss: 3.32e-07
2025-11-05 00:19:44,138: Epoch 42 average loss: avg_loss: 3.28e-07, avg_total_loss: 3.28e-07
2025-11-05 00:19:44,308: Epoch 43 average loss: avg_loss: 3.19e-07, avg_total_loss: 3.19e-07
2025-11-05 00:19:44,461: Epoch 44 average loss: avg_loss: 3.07e-07, avg_total_loss: 3.07e-07
2025-11-05 00:19:44,612: Epoch 45 average loss: avg_loss: 3.51e-07, avg_total_loss: 3.51e-07
2025-11-05 00:19:44,893: Epoch 45 average validation loss: 6.81e-07 -- Median validation metrics: avg_loss: 6.81e-07, NSE: 0.82765, MSE: 29524.97461
2025-11-05 00:19:44,894: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:19:44,895: Early stopping triggered at epoch 45
2025-11-05 00:19:44,911: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\model_epoch045.pt
2025-11-05 00:19:45,150: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:19:45,152: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001933\validation\model_epoch045\validation_results.p
2025-11-05 00:19:45,886: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\output.log initialized.
2025-11-05 00:19:45,887: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945
2025-11-05 00:19:45,888: ### Run configurations for testing_run
2025-11-05 00:19:45,889: experiment_name: testing_run
2025-11-05 00:19:45,890: train_basin_file: calpella
2025-11-05 00:19:45,890: validation_basin_file: calpella
2025-11-05 00:19:45,891: test_basin_file: calpella
2025-11-05 00:19:45,892: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:19:45,893: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:19:45,894: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:19:45,894: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:19:45,896: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:19:45,896: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:19:45,897: device: cuda:0
2025-11-05 00:19:45,898: physics_informed: True
2025-11-05 00:19:45,898: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:19:45,899: validate_every: 5
2025-11-05 00:19:45,899: validate_n_random_basins: 1
2025-11-05 00:19:45,900: metrics: ['NSE', 'MSE']
2025-11-05 00:19:45,901: model: cudalstm
2025-11-05 00:19:45,901: head: regression
2025-11-05 00:19:45,902: output_activation: linear
2025-11-05 00:19:45,902: hidden_size: 128
2025-11-05 00:19:45,903: initial_forget_bias: 3
2025-11-05 00:19:45,904: output_dropout: 0.4
2025-11-05 00:19:45,905: num_layers: 1
2025-11-05 00:19:45,906: dev_mode: True
2025-11-05 00:19:45,906: optimizer: Adam
2025-11-05 00:19:45,907: loss: NSE
2025-11-05 00:19:45,908: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:19:45,909: batch_size: 64
2025-11-05 00:19:45,909: epochs: 16
2025-11-05 00:19:45,910: clip_gradient_norm: 1
2025-11-05 00:19:45,911: predict_last_n: 1
2025-11-05 00:19:45,912: seq_length: 90
2025-11-05 00:19:45,913: log_interval: 16
2025-11-05 00:19:45,913: log_tensorboard: True
2025-11-05 00:19:45,914: log_n_figures: 1
2025-11-05 00:19:45,915: save_weights_every: 16
2025-11-05 00:19:45,916: early_stopping: True
2025-11-05 00:19:45,917: early_stopping_mode: patience
2025-11-05 00:19:45,918: patience_early_stopping: 3
2025-11-05 00:19:45,918: min_delta_early_stopping: 0.0
2025-11-05 00:19:45,920: minimum_epochs_before_early_stopping: 10
2025-11-05 00:19:45,921: early_stopping_slope_window: 7
2025-11-05 00:19:45,922: early_stopping_slope_patience: 2
2025-11-05 00:19:45,923: early_stopping_slope_min_epoch: 8
2025-11-05 00:19:45,924: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:19:45,925: early_stopping_slope_use_log: True
2025-11-05 00:19:45,926: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:19:45,927: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:19:45,928: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:19:45,928: early_stopping_slope_variance_guard: True
2025-11-05 00:19:45,929: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:19:45,930: dataset: russian_river
2025-11-05 00:19:45,930: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:19:45,931: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:19:45,933: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:19:45,933: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:19:45,934: hourly: False
2025-11-05 00:19:45,935: is_mts: False
2025-11-05 00:19:45,935: is_mts_data: False
2025-11-05 00:19:45,936: verbose: True
2025-11-05 00:19:45,937: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945
2025-11-05 00:19:45,938: run_label: BASELINE
2025-11-05 00:19:45,938: number_of_basins: 1
2025-11-05 00:19:45,939: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\train_data
2025-11-05 00:19:45,940: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\img_log
2025-11-05 00:19:45,942: ### Device cuda:0 will be used for training
2025-11-05 00:19:45,943: Loading basin data into xarray data set.
2025-11-05 00:19:46,207: Calculating target variable stds per basin
2025-11-05 00:19:46,217: Create lookup table and convert to pytorch tensor
2025-11-05 00:19:46,537: Early stopping enabled: mode=patience
2025-11-05 00:19:47,252: Epoch 1 average loss: avg_loss: 1.73e-06, avg_total_loss: 1.73e-06
2025-11-05 00:19:47,870: Epoch 2 average loss: avg_loss: 9.23e-07, avg_total_loss: 9.23e-07
2025-11-05 00:19:48,464: Epoch 3 average loss: avg_loss: 9.60e-07, avg_total_loss: 9.60e-07
2025-11-05 00:19:48,986: Epoch 4 average loss: avg_loss: 1.23e-06, avg_total_loss: 1.23e-06
2025-11-05 00:19:49,473: Epoch 5 average loss: avg_loss: 7.99e-07, avg_total_loss: 7.99e-07
2025-11-05 00:19:50,084: Epoch 5 average validation loss: 7.72e-07 -- Median validation metrics: avg_loss: 7.72e-07, NSE: 0.82204, MSE: 30486.34375
2025-11-05 00:19:50,518: Epoch 6 average loss: avg_loss: 7.23e-07, avg_total_loss: 7.23e-07
2025-11-05 00:19:51,116: Epoch 7 average loss: avg_loss: 8.05e-07, avg_total_loss: 8.05e-07
2025-11-05 00:19:51,117: Setting learning rate to 0.005
2025-11-05 00:19:51,581: Epoch 8 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:19:52,097: Epoch 9 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:19:52,540: Epoch 10 average loss: avg_loss: 6.31e-07, avg_total_loss: 6.31e-07
2025-11-05 00:19:52,876: Epoch 10 average validation loss: 7.53e-07 -- Median validation metrics: avg_loss: 7.53e-07, NSE: 0.82701, MSE: 29634.56445
2025-11-05 00:19:53,306: Epoch 11 average loss: avg_loss: 6.12e-07, avg_total_loss: 6.12e-07
2025-11-05 00:19:53,307: Setting learning rate to 0.001
2025-11-05 00:19:53,778: Epoch 12 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:19:54,291: Epoch 13 average loss: avg_loss: 5.43e-07, avg_total_loss: 5.43e-07
2025-11-05 00:19:54,748: Epoch 14 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:19:55,211: Epoch 15 average loss: avg_loss: 5.26e-07, avg_total_loss: 5.26e-07
2025-11-05 00:19:55,531: Epoch 15 average validation loss: 7.54e-07 -- Median validation metrics: avg_loss: 7.54e-07, NSE: 0.82698, MSE: 29639.75391
2025-11-05 00:19:56,002: Epoch 16 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:19:56,025: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\model_epoch016.pt
2025-11-05 00:19:56,346: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:19:56,347: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001945\validation\model_epoch016\validation_results.p
2025-11-05 00:19:57,041: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\output.log initialized.
2025-11-05 00:19:57,042: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957
2025-11-05 00:19:57,043: ### Run configurations for testing_run
2025-11-05 00:19:57,044: experiment_name: testing_run
2025-11-05 00:19:57,045: train_basin_file: calpella
2025-11-05 00:19:57,045: validation_basin_file: calpella
2025-11-05 00:19:57,046: test_basin_file: calpella
2025-11-05 00:19:57,047: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:19:57,047: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:19:57,048: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:19:57,049: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:19:57,049: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:19:57,050: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:19:57,051: device: cuda:0
2025-11-05 00:19:57,052: physics_informed: True
2025-11-05 00:19:57,052: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:19:57,053: validate_every: 5
2025-11-05 00:19:57,054: validate_n_random_basins: 1
2025-11-05 00:19:57,055: metrics: ['NSE', 'MSE']
2025-11-05 00:19:57,056: model: cudalstm
2025-11-05 00:19:57,056: head: regression
2025-11-05 00:19:57,057: output_activation: linear
2025-11-05 00:19:57,058: hidden_size: 128
2025-11-05 00:19:57,058: initial_forget_bias: 3
2025-11-05 00:19:57,059: output_dropout: 0.4
2025-11-05 00:19:57,060: num_layers: 1
2025-11-05 00:19:57,061: dev_mode: True
2025-11-05 00:19:57,061: optimizer: Adam
2025-11-05 00:19:57,062: loss: NSE
2025-11-05 00:19:57,063: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:19:57,064: batch_size: 128
2025-11-05 00:19:57,064: epochs: 16
2025-11-05 00:19:57,065: clip_gradient_norm: 1
2025-11-05 00:19:57,066: predict_last_n: 1
2025-11-05 00:19:57,067: seq_length: 90
2025-11-05 00:19:57,067: log_interval: 16
2025-11-05 00:19:57,068: log_tensorboard: True
2025-11-05 00:19:57,069: log_n_figures: 1
2025-11-05 00:19:57,070: save_weights_every: 16
2025-11-05 00:19:57,071: early_stopping: True
2025-11-05 00:19:57,071: early_stopping_mode: patience
2025-11-05 00:19:57,072: patience_early_stopping: 3
2025-11-05 00:19:57,073: min_delta_early_stopping: 0.0
2025-11-05 00:19:57,074: minimum_epochs_before_early_stopping: 10
2025-11-05 00:19:57,074: early_stopping_slope_window: 7
2025-11-05 00:19:57,075: early_stopping_slope_patience: 2
2025-11-05 00:19:57,076: early_stopping_slope_min_epoch: 8
2025-11-05 00:19:57,077: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:19:57,077: early_stopping_slope_use_log: True
2025-11-05 00:19:57,078: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:19:57,079: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:19:57,080: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:19:57,081: early_stopping_slope_variance_guard: True
2025-11-05 00:19:57,082: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:19:57,083: dataset: russian_river
2025-11-05 00:19:57,084: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:19:57,086: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:19:57,086: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:19:57,087: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:19:57,088: hourly: False
2025-11-05 00:19:57,089: is_mts: False
2025-11-05 00:19:57,089: is_mts_data: False
2025-11-05 00:19:57,090: verbose: True
2025-11-05 00:19:57,091: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957
2025-11-05 00:19:57,092: run_label: BASELINE
2025-11-05 00:19:57,093: number_of_basins: 1
2025-11-05 00:19:57,094: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\train_data
2025-11-05 00:19:57,094: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\img_log
2025-11-05 00:19:57,097: ### Device cuda:0 will be used for training
2025-11-05 00:19:57,098: Loading basin data into xarray data set.
2025-11-05 00:19:57,335: Calculating target variable stds per basin
2025-11-05 00:19:57,345: Create lookup table and convert to pytorch tensor
2025-11-05 00:19:57,468: Early stopping enabled: mode=patience
2025-11-05 00:19:57,858: Epoch 1 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:19:58,079: Epoch 2 average loss: avg_loss: 1.34e-06, avg_total_loss: 1.34e-06
2025-11-05 00:19:58,352: Epoch 3 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:19:58,606: Epoch 4 average loss: avg_loss: 9.01e-07, avg_total_loss: 9.01e-07
2025-11-05 00:19:58,868: Epoch 5 average loss: avg_loss: 8.67e-07, avg_total_loss: 8.67e-07
2025-11-05 00:19:59,373: Epoch 5 average validation loss: 7.95e-07 -- Median validation metrics: avg_loss: 7.95e-07, NSE: 0.81690, MSE: 31366.96289
2025-11-05 00:19:59,598: Epoch 6 average loss: avg_loss: 6.94e-07, avg_total_loss: 6.94e-07
2025-11-05 00:19:59,824: Epoch 7 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:19:59,825: Setting learning rate to 0.005
2025-11-05 00:20:00,089: Epoch 8 average loss: avg_loss: 6.37e-07, avg_total_loss: 6.37e-07
2025-11-05 00:20:00,342: Epoch 9 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:20:00,638: Epoch 10 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:20:00,949: Epoch 10 average validation loss: 6.93e-07 -- Median validation metrics: avg_loss: 6.93e-07, NSE: 0.84137, MSE: 27175.81641
2025-11-05 00:20:01,198: Epoch 11 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:20:01,199: Setting learning rate to 0.001
2025-11-05 00:20:01,490: Epoch 12 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:20:01,756: Epoch 13 average loss: avg_loss: 5.04e-07, avg_total_loss: 5.04e-07
2025-11-05 00:20:02,056: Epoch 14 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:20:02,365: Epoch 15 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:20:02,709: Epoch 15 average validation loss: 7.06e-07 -- Median validation metrics: avg_loss: 7.06e-07, NSE: 0.83766, MSE: 27811.52344
2025-11-05 00:20:02,972: Epoch 16 average loss: avg_loss: 4.80e-07, avg_total_loss: 4.80e-07
2025-11-05 00:20:02,996: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\model_epoch016.pt
2025-11-05 00:20:03,286: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:20:03,288: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_001957\validation\model_epoch016\validation_results.p
2025-11-05 00:20:04,029: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\output.log initialized.
2025-11-05 00:20:04,030: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004
2025-11-05 00:20:04,031: ### Run configurations for testing_run
2025-11-05 00:20:04,032: experiment_name: testing_run
2025-11-05 00:20:04,033: train_basin_file: calpella
2025-11-05 00:20:04,034: validation_basin_file: calpella
2025-11-05 00:20:04,034: test_basin_file: calpella
2025-11-05 00:20:04,035: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:20:04,036: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:20:04,036: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:20:04,038: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:20:04,038: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:20:04,039: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:20:04,040: device: cuda:0
2025-11-05 00:20:04,040: physics_informed: True
2025-11-05 00:20:04,041: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:20:04,042: validate_every: 5
2025-11-05 00:20:04,042: validate_n_random_basins: 1
2025-11-05 00:20:04,043: metrics: ['NSE', 'MSE']
2025-11-05 00:20:04,044: model: cudalstm
2025-11-05 00:20:04,045: head: regression
2025-11-05 00:20:04,046: output_activation: linear
2025-11-05 00:20:04,046: hidden_size: 128
2025-11-05 00:20:04,047: initial_forget_bias: 3
2025-11-05 00:20:04,048: output_dropout: 0.4
2025-11-05 00:20:04,049: num_layers: 1
2025-11-05 00:20:04,049: dev_mode: True
2025-11-05 00:20:04,051: optimizer: Adam
2025-11-05 00:20:04,052: loss: NSE
2025-11-05 00:20:04,052: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:20:04,053: batch_size: 256
2025-11-05 00:20:04,054: epochs: 16
2025-11-05 00:20:04,055: clip_gradient_norm: 1
2025-11-05 00:20:04,056: predict_last_n: 1
2025-11-05 00:20:04,057: seq_length: 90
2025-11-05 00:20:04,057: log_interval: 16
2025-11-05 00:20:04,059: log_tensorboard: True
2025-11-05 00:20:04,060: log_n_figures: 1
2025-11-05 00:20:04,061: save_weights_every: 16
2025-11-05 00:20:04,061: early_stopping: True
2025-11-05 00:20:04,062: early_stopping_mode: patience
2025-11-05 00:20:04,063: patience_early_stopping: 3
2025-11-05 00:20:04,064: min_delta_early_stopping: 0.0
2025-11-05 00:20:04,065: minimum_epochs_before_early_stopping: 10
2025-11-05 00:20:04,065: early_stopping_slope_window: 7
2025-11-05 00:20:04,067: early_stopping_slope_patience: 2
2025-11-05 00:20:04,068: early_stopping_slope_min_epoch: 8
2025-11-05 00:20:04,068: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:20:04,069: early_stopping_slope_use_log: True
2025-11-05 00:20:04,069: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:20:04,070: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:20:04,071: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:20:04,072: early_stopping_slope_variance_guard: True
2025-11-05 00:20:04,073: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:20:04,074: dataset: russian_river
2025-11-05 00:20:04,074: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:20:04,075: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:20:04,076: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:20:04,077: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:20:04,078: hourly: False
2025-11-05 00:20:04,078: is_mts: False
2025-11-05 00:20:04,079: is_mts_data: False
2025-11-05 00:20:04,080: verbose: True
2025-11-05 00:20:04,081: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004
2025-11-05 00:20:04,082: run_label: BASELINE
2025-11-05 00:20:04,082: number_of_basins: 1
2025-11-05 00:20:04,083: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\train_data
2025-11-05 00:20:04,084: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\img_log
2025-11-05 00:20:04,086: ### Device cuda:0 will be used for training
2025-11-05 00:20:04,087: Loading basin data into xarray data set.
2025-11-05 00:20:04,340: Calculating target variable stds per basin
2025-11-05 00:20:04,354: Create lookup table and convert to pytorch tensor
2025-11-05 00:20:04,510: Early stopping enabled: mode=patience
2025-11-05 00:20:04,840: Epoch 1 average loss: avg_loss: 2.87e-06, avg_total_loss: 2.87e-06
2025-11-05 00:20:04,998: Epoch 2 average loss: avg_loss: 1.44e-06, avg_total_loss: 1.44e-06
2025-11-05 00:20:05,167: Epoch 3 average loss: avg_loss: 1.10e-06, avg_total_loss: 1.10e-06
2025-11-05 00:20:05,353: Epoch 4 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:20:05,520: Epoch 5 average loss: avg_loss: 8.89e-07, avg_total_loss: 8.89e-07
2025-11-05 00:20:06,025: Epoch 5 average validation loss: 7.54e-07 -- Median validation metrics: avg_loss: 7.54e-07, NSE: 0.80712, MSE: 33042.95703
2025-11-05 00:20:06,196: Epoch 6 average loss: avg_loss: 8.16e-07, avg_total_loss: 8.16e-07
2025-11-05 00:20:06,363: Epoch 7 average loss: avg_loss: 6.83e-07, avg_total_loss: 6.83e-07
2025-11-05 00:20:06,364: Setting learning rate to 0.005
2025-11-05 00:20:06,535: Epoch 8 average loss: avg_loss: 6.96e-07, avg_total_loss: 6.96e-07
2025-11-05 00:20:06,715: Epoch 9 average loss: avg_loss: 6.24e-07, avg_total_loss: 6.24e-07
2025-11-05 00:20:06,891: Epoch 10 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:20:07,196: Epoch 10 average validation loss: 6.22e-07 -- Median validation metrics: avg_loss: 6.22e-07, NSE: 0.84141, MSE: 27167.91016
2025-11-05 00:20:07,381: Epoch 11 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:20:07,381: Setting learning rate to 0.001
2025-11-05 00:20:07,575: Epoch 12 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:20:07,764: Epoch 13 average loss: avg_loss: 5.52e-07, avg_total_loss: 5.52e-07
2025-11-05 00:20:07,944: Epoch 14 average loss: avg_loss: 5.89e-07, avg_total_loss: 5.89e-07
2025-11-05 00:20:08,127: Epoch 15 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:20:08,496: Epoch 15 average validation loss: 6.37e-07 -- Median validation metrics: avg_loss: 6.37e-07, NSE: 0.83861, MSE: 27648.61328
2025-11-05 00:20:08,667: Epoch 16 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:20:08,689: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\model_epoch016.pt
2025-11-05 00:20:08,978: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:20:08,980: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002004\validation\model_epoch016\validation_results.p
2025-11-05 00:20:09,653: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\output.log initialized.
2025-11-05 00:20:09,654: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009
2025-11-05 00:20:09,655: ### Run configurations for testing_run
2025-11-05 00:20:09,656: experiment_name: testing_run
2025-11-05 00:20:09,657: train_basin_file: calpella
2025-11-05 00:20:09,657: validation_basin_file: calpella
2025-11-05 00:20:09,658: test_basin_file: calpella
2025-11-05 00:20:09,659: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:20:09,660: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:20:09,660: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:20:09,661: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:20:09,662: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:20:09,662: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:20:09,663: device: cuda:0
2025-11-05 00:20:09,663: physics_informed: True
2025-11-05 00:20:09,664: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:20:09,664: validate_every: 5
2025-11-05 00:20:09,665: validate_n_random_basins: 1
2025-11-05 00:20:09,665: metrics: ['NSE', 'MSE']
2025-11-05 00:20:09,666: model: cudalstm
2025-11-05 00:20:09,667: head: regression
2025-11-05 00:20:09,667: output_activation: linear
2025-11-05 00:20:09,668: hidden_size: 128
2025-11-05 00:20:09,669: initial_forget_bias: 3
2025-11-05 00:20:09,669: output_dropout: 0.4
2025-11-05 00:20:09,670: num_layers: 1
2025-11-05 00:20:09,670: dev_mode: True
2025-11-05 00:20:09,671: optimizer: Adam
2025-11-05 00:20:09,671: loss: NSE
2025-11-05 00:20:09,672: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:20:09,673: batch_size: 64
2025-11-05 00:20:09,674: epochs: 32
2025-11-05 00:20:09,674: clip_gradient_norm: 1
2025-11-05 00:20:09,675: predict_last_n: 1
2025-11-05 00:20:09,676: seq_length: 90
2025-11-05 00:20:09,676: log_interval: 16
2025-11-05 00:20:09,677: log_tensorboard: True
2025-11-05 00:20:09,678: log_n_figures: 1
2025-11-05 00:20:09,678: save_weights_every: 32
2025-11-05 00:20:09,679: early_stopping: True
2025-11-05 00:20:09,680: early_stopping_mode: patience
2025-11-05 00:20:09,681: patience_early_stopping: 3
2025-11-05 00:20:09,681: min_delta_early_stopping: 0.0
2025-11-05 00:20:09,682: minimum_epochs_before_early_stopping: 10
2025-11-05 00:20:09,683: early_stopping_slope_window: 7
2025-11-05 00:20:09,683: early_stopping_slope_patience: 2
2025-11-05 00:20:09,683: early_stopping_slope_min_epoch: 8
2025-11-05 00:20:09,684: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:20:09,685: early_stopping_slope_use_log: True
2025-11-05 00:20:09,685: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:20:09,686: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:20:09,687: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:20:09,687: early_stopping_slope_variance_guard: True
2025-11-05 00:20:09,688: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:20:09,689: dataset: russian_river
2025-11-05 00:20:09,689: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:20:09,690: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:20:09,691: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:20:09,692: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:20:09,692: hourly: False
2025-11-05 00:20:09,693: is_mts: False
2025-11-05 00:20:09,694: is_mts_data: False
2025-11-05 00:20:09,695: verbose: True
2025-11-05 00:20:09,696: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009
2025-11-05 00:20:09,697: run_label: BASELINE
2025-11-05 00:20:09,698: number_of_basins: 1
2025-11-05 00:20:09,699: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\train_data
2025-11-05 00:20:09,700: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\img_log
2025-11-05 00:20:09,702: ### Device cuda:0 will be used for training
2025-11-05 00:20:09,703: Loading basin data into xarray data set.
2025-11-05 00:20:09,938: Calculating target variable stds per basin
2025-11-05 00:20:09,951: Create lookup table and convert to pytorch tensor
2025-11-05 00:20:10,080: Early stopping enabled: mode=patience
2025-11-05 00:20:10,712: Epoch 1 average loss: avg_loss: 1.89e-06, avg_total_loss: 1.89e-06
2025-11-05 00:20:11,295: Epoch 2 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:20:11,845: Epoch 3 average loss: avg_loss: 9.24e-07, avg_total_loss: 9.24e-07
2025-11-05 00:20:12,306: Epoch 4 average loss: avg_loss: 7.94e-07, avg_total_loss: 7.94e-07
2025-11-05 00:20:12,760: Epoch 5 average loss: avg_loss: 8.55e-07, avg_total_loss: 8.55e-07
2025-11-05 00:20:13,287: Epoch 5 average validation loss: 8.00e-07 -- Median validation metrics: avg_loss: 8.00e-07, NSE: 0.81682, MSE: 31381.70312
2025-11-05 00:20:13,681: Epoch 6 average loss: avg_loss: 7.03e-07, avg_total_loss: 7.03e-07
2025-11-05 00:20:14,160: Epoch 7 average loss: avg_loss: 6.66e-07, avg_total_loss: 6.66e-07
2025-11-05 00:20:14,629: Epoch 8 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:20:15,129: Epoch 9 average loss: avg_loss: 7.11e-07, avg_total_loss: 7.11e-07
2025-11-05 00:20:15,700: Epoch 10 average loss: avg_loss: 6.15e-07, avg_total_loss: 6.15e-07
2025-11-05 00:20:16,000: Epoch 10 average validation loss: 7.51e-07 -- Median validation metrics: avg_loss: 7.51e-07, NSE: 0.82691, MSE: 29653.15234
2025-11-05 00:20:16,403: Epoch 11 average loss: avg_loss: 6.48e-07, avg_total_loss: 6.48e-07
2025-11-05 00:20:16,829: Epoch 12 average loss: avg_loss: 7.48e-07, avg_total_loss: 7.48e-07
2025-11-05 00:20:17,272: Epoch 13 average loss: avg_loss: 6.95e-07, avg_total_loss: 6.95e-07
2025-11-05 00:20:17,750: Epoch 14 average loss: avg_loss: 6.50e-07, avg_total_loss: 6.50e-07
2025-11-05 00:20:18,256: Epoch 15 average loss: avg_loss: 5.79e-07, avg_total_loss: 5.79e-07
2025-11-05 00:20:18,579: Epoch 15 average validation loss: 6.56e-07 -- Median validation metrics: avg_loss: 6.56e-07, NSE: 0.84890, MSE: 25884.48242
2025-11-05 00:20:18,579: Setting learning rate to 0.005
2025-11-05 00:20:19,052: Epoch 16 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:20:19,507: Epoch 17 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:20:19,932: Epoch 18 average loss: avg_loss: 5.15e-07, avg_total_loss: 5.15e-07
2025-11-05 00:20:20,363: Epoch 19 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:20:20,790: Epoch 20 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:20:21,149: Epoch 20 average validation loss: 8.16e-07 -- Median validation metrics: avg_loss: 8.16e-07, NSE: 0.81628, MSE: 31474.35156
2025-11-05 00:20:21,553: Epoch 21 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:20:22,134: Epoch 22 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:20:22,637: Epoch 23 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:20:22,638: Setting learning rate to 0.001
2025-11-05 00:20:23,076: Epoch 24 average loss: avg_loss: 4.39e-07, avg_total_loss: 4.39e-07
2025-11-05 00:20:23,512: Epoch 25 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:20:23,951: Epoch 25 average validation loss: 7.12e-07 -- Median validation metrics: avg_loss: 7.12e-07, NSE: 0.83641, MSE: 28024.53711
2025-11-05 00:20:24,381: Epoch 26 average loss: avg_loss: 3.59e-07, avg_total_loss: 3.59e-07
2025-11-05 00:20:24,855: Epoch 27 average loss: avg_loss: 3.64e-07, avg_total_loss: 3.64e-07
2025-11-05 00:20:25,279: Epoch 28 average loss: avg_loss: 3.94e-07, avg_total_loss: 3.94e-07
2025-11-05 00:20:25,711: Epoch 29 average loss: avg_loss: 3.68e-07, avg_total_loss: 3.68e-07
2025-11-05 00:20:26,139: Epoch 30 average loss: avg_loss: 3.71e-07, avg_total_loss: 3.71e-07
2025-11-05 00:20:26,444: Epoch 30 average validation loss: 6.86e-07 -- Median validation metrics: avg_loss: 6.86e-07, NSE: 0.84252, MSE: 26977.92578
2025-11-05 00:20:26,445: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:20:26,445: Early stopping triggered at epoch 30
2025-11-05 00:20:26,467: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\model_epoch030.pt
2025-11-05 00:20:26,757: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:20:26,759: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002009\validation\model_epoch030\validation_results.p
2025-11-05 00:20:27,443: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\output.log initialized.
2025-11-05 00:20:27,444: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027
2025-11-05 00:20:27,446: ### Run configurations for testing_run
2025-11-05 00:20:27,447: experiment_name: testing_run
2025-11-05 00:20:27,448: train_basin_file: calpella
2025-11-05 00:20:27,449: validation_basin_file: calpella
2025-11-05 00:20:27,450: test_basin_file: calpella
2025-11-05 00:20:27,451: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:20:27,452: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:20:27,452: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:20:27,453: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:20:27,454: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:20:27,454: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:20:27,455: device: cuda:0
2025-11-05 00:20:27,456: physics_informed: True
2025-11-05 00:20:27,456: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:20:27,457: validate_every: 5
2025-11-05 00:20:27,458: validate_n_random_basins: 1
2025-11-05 00:20:27,459: metrics: ['NSE', 'MSE']
2025-11-05 00:20:27,459: model: cudalstm
2025-11-05 00:20:27,459: head: regression
2025-11-05 00:20:27,460: output_activation: linear
2025-11-05 00:20:27,461: hidden_size: 128
2025-11-05 00:20:27,462: initial_forget_bias: 3
2025-11-05 00:20:27,463: output_dropout: 0.4
2025-11-05 00:20:27,463: num_layers: 1
2025-11-05 00:20:27,464: dev_mode: True
2025-11-05 00:20:27,465: optimizer: Adam
2025-11-05 00:20:27,466: loss: NSE
2025-11-05 00:20:27,467: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:20:27,468: batch_size: 128
2025-11-05 00:20:27,468: epochs: 32
2025-11-05 00:20:27,469: clip_gradient_norm: 1
2025-11-05 00:20:27,470: predict_last_n: 1
2025-11-05 00:20:27,471: seq_length: 90
2025-11-05 00:20:27,471: log_interval: 16
2025-11-05 00:20:27,472: log_tensorboard: True
2025-11-05 00:20:27,473: log_n_figures: 1
2025-11-05 00:20:27,473: save_weights_every: 32
2025-11-05 00:20:27,474: early_stopping: True
2025-11-05 00:20:27,475: early_stopping_mode: patience
2025-11-05 00:20:27,476: patience_early_stopping: 3
2025-11-05 00:20:27,477: min_delta_early_stopping: 0.0
2025-11-05 00:20:27,478: minimum_epochs_before_early_stopping: 10
2025-11-05 00:20:27,478: early_stopping_slope_window: 7
2025-11-05 00:20:27,479: early_stopping_slope_patience: 2
2025-11-05 00:20:27,480: early_stopping_slope_min_epoch: 8
2025-11-05 00:20:27,480: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:20:27,481: early_stopping_slope_use_log: True
2025-11-05 00:20:27,482: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:20:27,483: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:20:27,483: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:20:27,484: early_stopping_slope_variance_guard: True
2025-11-05 00:20:27,485: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:20:27,485: dataset: russian_river
2025-11-05 00:20:27,486: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:20:27,487: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:20:27,488: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:20:27,488: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:20:27,489: hourly: False
2025-11-05 00:20:27,490: is_mts: False
2025-11-05 00:20:27,490: is_mts_data: False
2025-11-05 00:20:27,491: verbose: True
2025-11-05 00:20:27,492: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027
2025-11-05 00:20:27,492: run_label: BASELINE
2025-11-05 00:20:27,493: number_of_basins: 1
2025-11-05 00:20:27,494: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\train_data
2025-11-05 00:20:27,494: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\img_log
2025-11-05 00:20:27,496: ### Device cuda:0 will be used for training
2025-11-05 00:20:27,497: Loading basin data into xarray data set.
2025-11-05 00:20:27,703: Calculating target variable stds per basin
2025-11-05 00:20:27,712: Create lookup table and convert to pytorch tensor
2025-11-05 00:20:27,833: Early stopping enabled: mode=patience
2025-11-05 00:20:28,255: Epoch 1 average loss: avg_loss: 2.16e-06, avg_total_loss: 2.16e-06
2025-11-05 00:20:28,531: Epoch 2 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:20:28,785: Epoch 3 average loss: avg_loss: 8.41e-07, avg_total_loss: 8.41e-07
2025-11-05 00:20:29,035: Epoch 4 average loss: avg_loss: 7.84e-07, avg_total_loss: 7.84e-07
2025-11-05 00:20:29,273: Epoch 5 average loss: avg_loss: 7.58e-07, avg_total_loss: 7.58e-07
2025-11-05 00:20:29,761: Epoch 5 average validation loss: 7.94e-07 -- Median validation metrics: avg_loss: 7.94e-07, NSE: 0.81808, MSE: 31164.91406
2025-11-05 00:20:29,995: Epoch 6 average loss: avg_loss: 6.62e-07, avg_total_loss: 6.62e-07
2025-11-05 00:20:30,226: Epoch 7 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:20:30,484: Epoch 8 average loss: avg_loss: 6.47e-07, avg_total_loss: 6.47e-07
2025-11-05 00:20:30,733: Epoch 9 average loss: avg_loss: 6.04e-07, avg_total_loss: 6.04e-07
2025-11-05 00:20:30,996: Epoch 10 average loss: avg_loss: 7.02e-07, avg_total_loss: 7.02e-07
2025-11-05 00:20:31,284: Epoch 10 average validation loss: 8.01e-07 -- Median validation metrics: avg_loss: 8.01e-07, NSE: 0.81796, MSE: 31186.08203
2025-11-05 00:20:31,530: Epoch 11 average loss: avg_loss: 6.59e-07, avg_total_loss: 6.59e-07
2025-11-05 00:20:31,810: Epoch 12 average loss: avg_loss: 5.44e-07, avg_total_loss: 5.44e-07
2025-11-05 00:20:32,082: Epoch 13 average loss: avg_loss: 6.15e-07, avg_total_loss: 6.15e-07
2025-11-05 00:20:32,339: Epoch 14 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:20:32,616: Epoch 15 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:20:32,900: Epoch 15 average validation loss: 7.36e-07 -- Median validation metrics: avg_loss: 7.36e-07, NSE: 0.83147, MSE: 28870.81055
2025-11-05 00:20:32,902: Setting learning rate to 0.005
2025-11-05 00:20:33,142: Epoch 16 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:20:33,399: Epoch 17 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:20:33,660: Epoch 18 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:20:33,920: Epoch 19 average loss: avg_loss: 5.05e-07, avg_total_loss: 5.05e-07
2025-11-05 00:20:34,198: Epoch 20 average loss: avg_loss: 4.45e-07, avg_total_loss: 4.45e-07
2025-11-05 00:20:34,494: Epoch 20 average validation loss: 7.11e-07 -- Median validation metrics: avg_loss: 7.11e-07, NSE: 0.83686, MSE: 27947.03125
2025-11-05 00:20:34,728: Epoch 21 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:20:34,997: Epoch 22 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:20:35,246: Epoch 23 average loss: avg_loss: 4.62e-07, avg_total_loss: 4.62e-07
2025-11-05 00:20:35,247: Setting learning rate to 0.001
2025-11-05 00:20:35,517: Epoch 24 average loss: avg_loss: 4.12e-07, avg_total_loss: 4.12e-07
2025-11-05 00:20:35,781: Epoch 25 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:20:36,069: Epoch 25 average validation loss: 6.91e-07 -- Median validation metrics: avg_loss: 6.91e-07, NSE: 0.84157, MSE: 27140.81445
2025-11-05 00:20:36,299: Epoch 26 average loss: avg_loss: 4.40e-07, avg_total_loss: 4.40e-07
2025-11-05 00:20:36,547: Epoch 27 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:20:36,793: Epoch 28 average loss: avg_loss: 3.82e-07, avg_total_loss: 3.82e-07
2025-11-05 00:20:37,061: Epoch 29 average loss: avg_loss: 3.94e-07, avg_total_loss: 3.94e-07
2025-11-05 00:20:37,303: Epoch 30 average loss: avg_loss: 3.88e-07, avg_total_loss: 3.88e-07
2025-11-05 00:20:37,627: Epoch 30 average validation loss: 7.18e-07 -- Median validation metrics: avg_loss: 7.18e-07, NSE: 0.83558, MSE: 28167.47852
2025-11-05 00:20:37,854: Epoch 31 average loss: avg_loss: 3.89e-07, avg_total_loss: 3.89e-07
2025-11-05 00:20:38,112: Epoch 32 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:20:38,134: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\model_epoch032.pt
2025-11-05 00:20:38,411: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:20:38,412: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002027\validation\model_epoch032\validation_results.p
2025-11-05 00:20:39,078: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\output.log initialized.
2025-11-05 00:20:39,079: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039
2025-11-05 00:20:39,079: ### Run configurations for testing_run
2025-11-05 00:20:39,081: experiment_name: testing_run
2025-11-05 00:20:39,082: train_basin_file: calpella
2025-11-05 00:20:39,082: validation_basin_file: calpella
2025-11-05 00:20:39,083: test_basin_file: calpella
2025-11-05 00:20:39,084: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:20:39,084: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:20:39,085: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:20:39,086: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:20:39,087: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:20:39,087: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:20:39,088: device: cuda:0
2025-11-05 00:20:39,088: physics_informed: True
2025-11-05 00:20:39,089: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:20:39,089: validate_every: 5
2025-11-05 00:20:39,091: validate_n_random_basins: 1
2025-11-05 00:20:39,092: metrics: ['NSE', 'MSE']
2025-11-05 00:20:39,092: model: cudalstm
2025-11-05 00:20:39,095: head: regression
2025-11-05 00:20:39,096: output_activation: linear
2025-11-05 00:20:39,097: hidden_size: 128
2025-11-05 00:20:39,098: initial_forget_bias: 3
2025-11-05 00:20:39,100: output_dropout: 0.4
2025-11-05 00:20:39,101: num_layers: 1
2025-11-05 00:20:39,102: dev_mode: True
2025-11-05 00:20:39,103: optimizer: Adam
2025-11-05 00:20:39,105: loss: NSE
2025-11-05 00:20:39,107: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:20:39,108: batch_size: 256
2025-11-05 00:20:39,109: epochs: 32
2025-11-05 00:20:39,110: clip_gradient_norm: 1
2025-11-05 00:20:39,111: predict_last_n: 1
2025-11-05 00:20:39,113: seq_length: 90
2025-11-05 00:20:39,114: log_interval: 16
2025-11-05 00:20:39,114: log_tensorboard: True
2025-11-05 00:20:39,115: log_n_figures: 1
2025-11-05 00:20:39,117: save_weights_every: 32
2025-11-05 00:20:39,118: early_stopping: True
2025-11-05 00:20:39,119: early_stopping_mode: patience
2025-11-05 00:20:39,119: patience_early_stopping: 3
2025-11-05 00:20:39,120: min_delta_early_stopping: 0.0
2025-11-05 00:20:39,122: minimum_epochs_before_early_stopping: 10
2025-11-05 00:20:39,123: early_stopping_slope_window: 7
2025-11-05 00:20:39,124: early_stopping_slope_patience: 2
2025-11-05 00:20:39,125: early_stopping_slope_min_epoch: 8
2025-11-05 00:20:39,126: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:20:39,127: early_stopping_slope_use_log: True
2025-11-05 00:20:39,128: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:20:39,128: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:20:39,129: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:20:39,130: early_stopping_slope_variance_guard: True
2025-11-05 00:20:39,131: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:20:39,132: dataset: russian_river
2025-11-05 00:20:39,133: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:20:39,134: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:20:39,135: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:20:39,136: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:20:39,137: hourly: False
2025-11-05 00:20:39,138: is_mts: False
2025-11-05 00:20:39,138: is_mts_data: False
2025-11-05 00:20:39,139: verbose: True
2025-11-05 00:20:39,140: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039
2025-11-05 00:20:39,141: run_label: BASELINE
2025-11-05 00:20:39,142: number_of_basins: 1
2025-11-05 00:20:39,142: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\train_data
2025-11-05 00:20:39,143: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\img_log
2025-11-05 00:20:39,146: ### Device cuda:0 will be used for training
2025-11-05 00:20:39,147: Loading basin data into xarray data set.
2025-11-05 00:20:39,371: Calculating target variable stds per basin
2025-11-05 00:20:39,381: Create lookup table and convert to pytorch tensor
2025-11-05 00:20:39,512: Early stopping enabled: mode=patience
2025-11-05 00:20:39,844: Epoch 1 average loss: avg_loss: 2.89e-06, avg_total_loss: 2.89e-06
2025-11-05 00:20:40,077: Epoch 2 average loss: avg_loss: 1.55e-06, avg_total_loss: 1.55e-06
2025-11-05 00:20:40,233: Epoch 3 average loss: avg_loss: 1.14e-06, avg_total_loss: 1.14e-06
2025-11-05 00:20:40,375: Epoch 4 average loss: avg_loss: 8.94e-07, avg_total_loss: 8.94e-07
2025-11-05 00:20:40,517: Epoch 5 average loss: avg_loss: 9.04e-07, avg_total_loss: 9.04e-07
2025-11-05 00:20:41,028: Epoch 5 average validation loss: 8.44e-07 -- Median validation metrics: avg_loss: 8.44e-07, NSE: 0.79536, MSE: 35057.60547
2025-11-05 00:20:41,161: Epoch 6 average loss: avg_loss: 8.04e-07, avg_total_loss: 8.04e-07
2025-11-05 00:20:41,304: Epoch 7 average loss: avg_loss: 6.94e-07, avg_total_loss: 6.94e-07
2025-11-05 00:20:41,457: Epoch 8 average loss: avg_loss: 6.88e-07, avg_total_loss: 6.88e-07
2025-11-05 00:20:41,620: Epoch 9 average loss: avg_loss: 6.19e-07, avg_total_loss: 6.19e-07
2025-11-05 00:20:41,765: Epoch 10 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:20:42,030: Epoch 10 average validation loss: 6.70e-07 -- Median validation metrics: avg_loss: 6.70e-07, NSE: 0.83029, MSE: 29073.73438
2025-11-05 00:20:42,190: Epoch 11 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:20:42,348: Epoch 12 average loss: avg_loss: 5.24e-07, avg_total_loss: 5.24e-07
2025-11-05 00:20:42,502: Epoch 13 average loss: avg_loss: 5.60e-07, avg_total_loss: 5.60e-07
2025-11-05 00:20:42,667: Epoch 14 average loss: avg_loss: 5.08e-07, avg_total_loss: 5.08e-07
2025-11-05 00:20:42,845: Epoch 15 average loss: avg_loss: 6.39e-07, avg_total_loss: 6.39e-07
2025-11-05 00:20:43,120: Epoch 15 average validation loss: 6.60e-07 -- Median validation metrics: avg_loss: 6.60e-07, NSE: 0.83263, MSE: 28673.03125
2025-11-05 00:20:43,121: Setting learning rate to 0.005
2025-11-05 00:20:43,271: Epoch 16 average loss: avg_loss: 5.06e-07, avg_total_loss: 5.06e-07
2025-11-05 00:20:43,436: Epoch 17 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:20:43,595: Epoch 18 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:20:43,754: Epoch 19 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:20:43,923: Epoch 20 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:20:44,230: Epoch 20 average validation loss: 6.18e-07 -- Median validation metrics: avg_loss: 6.18e-07, NSE: 0.84265, MSE: 26956.55469
2025-11-05 00:20:44,373: Epoch 21 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:20:44,521: Epoch 22 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:20:44,694: Epoch 23 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:20:44,694: Setting learning rate to 0.001
2025-11-05 00:20:44,851: Epoch 24 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:20:45,002: Epoch 25 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:20:45,313: Epoch 25 average validation loss: 6.30e-07 -- Median validation metrics: avg_loss: 6.30e-07, NSE: 0.83930, MSE: 27530.25586
2025-11-05 00:20:45,464: Epoch 26 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:20:45,610: Epoch 27 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:20:45,782: Epoch 28 average loss: avg_loss: 4.87e-07, avg_total_loss: 4.87e-07
2025-11-05 00:20:45,943: Epoch 29 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:20:46,097: Epoch 30 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:20:46,374: Epoch 30 average validation loss: 6.20e-07 -- Median validation metrics: avg_loss: 6.20e-07, NSE: 0.84273, MSE: 26943.05859
2025-11-05 00:20:46,542: Epoch 31 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:20:46,693: Epoch 32 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:20:46,714: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\model_epoch032.pt
2025-11-05 00:20:46,967: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:20:46,968: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002039\validation\model_epoch032\validation_results.p
2025-11-05 00:20:47,643: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\output.log initialized.
2025-11-05 00:20:47,644: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047
2025-11-05 00:20:47,645: ### Run configurations for testing_run
2025-11-05 00:20:47,647: experiment_name: testing_run
2025-11-05 00:20:47,647: train_basin_file: calpella
2025-11-05 00:20:47,647: validation_basin_file: calpella
2025-11-05 00:20:47,648: test_basin_file: calpella
2025-11-05 00:20:47,649: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:20:47,650: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:20:47,650: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:20:47,651: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:20:47,652: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:20:47,652: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:20:47,653: device: cuda:0
2025-11-05 00:20:47,654: physics_informed: True
2025-11-05 00:20:47,654: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:20:47,655: validate_every: 5
2025-11-05 00:20:47,656: validate_n_random_basins: 1
2025-11-05 00:20:47,657: metrics: ['NSE', 'MSE']
2025-11-05 00:20:47,658: model: cudalstm
2025-11-05 00:20:47,658: head: regression
2025-11-05 00:20:47,659: output_activation: linear
2025-11-05 00:20:47,659: hidden_size: 128
2025-11-05 00:20:47,661: initial_forget_bias: 3
2025-11-05 00:20:47,661: output_dropout: 0.4
2025-11-05 00:20:47,662: num_layers: 1
2025-11-05 00:20:47,662: dev_mode: True
2025-11-05 00:20:47,663: optimizer: Adam
2025-11-05 00:20:47,664: loss: NSE
2025-11-05 00:20:47,665: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:20:47,665: batch_size: 64
2025-11-05 00:20:47,666: epochs: 48
2025-11-05 00:20:47,667: clip_gradient_norm: 1
2025-11-05 00:20:47,668: predict_last_n: 1
2025-11-05 00:20:47,668: seq_length: 90
2025-11-05 00:20:47,669: log_interval: 16
2025-11-05 00:20:47,669: log_tensorboard: True
2025-11-05 00:20:47,670: log_n_figures: 1
2025-11-05 00:20:47,670: save_weights_every: 48
2025-11-05 00:20:47,671: early_stopping: True
2025-11-05 00:20:47,672: early_stopping_mode: patience
2025-11-05 00:20:47,673: patience_early_stopping: 3
2025-11-05 00:20:47,673: min_delta_early_stopping: 0.0
2025-11-05 00:20:47,674: minimum_epochs_before_early_stopping: 10
2025-11-05 00:20:47,675: early_stopping_slope_window: 7
2025-11-05 00:20:47,676: early_stopping_slope_patience: 2
2025-11-05 00:20:47,676: early_stopping_slope_min_epoch: 8
2025-11-05 00:20:47,677: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:20:47,677: early_stopping_slope_use_log: True
2025-11-05 00:20:47,678: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:20:47,679: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:20:47,680: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:20:47,680: early_stopping_slope_variance_guard: True
2025-11-05 00:20:47,681: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:20:47,682: dataset: russian_river
2025-11-05 00:20:47,684: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:20:47,684: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:20:47,685: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:20:47,685: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:20:47,686: hourly: False
2025-11-05 00:20:47,687: is_mts: False
2025-11-05 00:20:47,687: is_mts_data: False
2025-11-05 00:20:47,688: verbose: True
2025-11-05 00:20:47,689: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047
2025-11-05 00:20:47,690: run_label: BASELINE
2025-11-05 00:20:47,691: number_of_basins: 1
2025-11-05 00:20:47,692: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\train_data
2025-11-05 00:20:47,692: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\img_log
2025-11-05 00:20:47,695: ### Device cuda:0 will be used for training
2025-11-05 00:20:47,696: Loading basin data into xarray data set.
2025-11-05 00:20:47,895: Calculating target variable stds per basin
2025-11-05 00:20:47,904: Create lookup table and convert to pytorch tensor
2025-11-05 00:20:48,226: Early stopping enabled: mode=patience
2025-11-05 00:20:48,667: Epoch 1 average loss: avg_loss: 1.90e-06, avg_total_loss: 1.90e-06
2025-11-05 00:20:49,238: Epoch 2 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:20:49,740: Epoch 3 average loss: avg_loss: 9.36e-07, avg_total_loss: 9.36e-07
2025-11-05 00:20:50,166: Epoch 4 average loss: avg_loss: 7.06e-07, avg_total_loss: 7.06e-07
2025-11-05 00:20:50,546: Epoch 5 average loss: avg_loss: 6.58e-07, avg_total_loss: 6.58e-07
2025-11-05 00:20:51,107: Epoch 5 average validation loss: 7.14e-07 -- Median validation metrics: avg_loss: 7.14e-07, NSE: 0.83551, MSE: 28178.29492
2025-11-05 00:20:51,477: Epoch 6 average loss: avg_loss: 7.42e-07, avg_total_loss: 7.42e-07
2025-11-05 00:20:51,904: Epoch 7 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:20:52,323: Epoch 8 average loss: avg_loss: 6.25e-07, avg_total_loss: 6.25e-07
2025-11-05 00:20:52,757: Epoch 9 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:20:53,172: Epoch 10 average loss: avg_loss: 7.51e-07, avg_total_loss: 7.51e-07
2025-11-05 00:20:53,489: Epoch 10 average validation loss: 8.19e-07 -- Median validation metrics: avg_loss: 8.19e-07, NSE: 0.81138, MSE: 32313.19141
2025-11-05 00:20:54,026: Epoch 11 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:20:54,437: Epoch 12 average loss: avg_loss: 6.38e-07, avg_total_loss: 6.38e-07
2025-11-05 00:20:54,843: Epoch 13 average loss: avg_loss: 6.56e-07, avg_total_loss: 6.56e-07
2025-11-05 00:20:55,274: Epoch 14 average loss: avg_loss: 7.19e-07, avg_total_loss: 7.19e-07
2025-11-05 00:20:55,677: Epoch 15 average loss: avg_loss: 6.27e-07, avg_total_loss: 6.27e-07
2025-11-05 00:20:55,987: Epoch 15 average validation loss: 6.64e-07 -- Median validation metrics: avg_loss: 6.64e-07, NSE: 0.84766, MSE: 26097.95117
2025-11-05 00:20:56,521: Epoch 16 average loss: avg_loss: 6.93e-07, avg_total_loss: 6.93e-07
2025-11-05 00:20:56,926: Epoch 17 average loss: avg_loss: 7.09e-07, avg_total_loss: 7.09e-07
2025-11-05 00:20:57,371: Epoch 18 average loss: avg_loss: 5.90e-07, avg_total_loss: 5.90e-07
2025-11-05 00:20:57,777: Epoch 19 average loss: avg_loss: 6.38e-07, avg_total_loss: 6.38e-07
2025-11-05 00:20:58,177: Epoch 20 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:20:58,484: Epoch 20 average validation loss: 8.04e-07 -- Median validation metrics: avg_loss: 8.04e-07, NSE: 0.81632, MSE: 31465.82617
2025-11-05 00:20:58,906: Epoch 21 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:20:59,426: Epoch 22 average loss: avg_loss: 7.90e-07, avg_total_loss: 7.90e-07
2025-11-05 00:20:59,828: Epoch 23 average loss: avg_loss: 6.14e-07, avg_total_loss: 6.14e-07
2025-11-05 00:20:59,829: Setting learning rate to 0.005
2025-11-05 00:21:00,239: Epoch 24 average loss: avg_loss: 4.84e-07, avg_total_loss: 4.84e-07
2025-11-05 00:21:00,649: Epoch 25 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:21:00,924: Epoch 25 average validation loss: 8.37e-07 -- Median validation metrics: avg_loss: 8.37e-07, NSE: 0.80723, MSE: 33024.03906
2025-11-05 00:21:01,343: Epoch 26 average loss: avg_loss: 4.93e-07, avg_total_loss: 4.93e-07
2025-11-05 00:21:01,755: Epoch 27 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:21:02,159: Epoch 28 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:21:02,581: Epoch 29 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:21:02,970: Epoch 30 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:21:03,255: Epoch 30 average validation loss: 7.02e-07 -- Median validation metrics: avg_loss: 7.02e-07, NSE: 0.83929, MSE: 27531.06836
2025-11-05 00:21:03,256: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:21:03,257: Early stopping triggered at epoch 30
2025-11-05 00:21:03,275: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\model_epoch030.pt
2025-11-05 00:21:03,550: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:21:03,552: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002047\validation\model_epoch030\validation_results.p
2025-11-05 00:21:04,202: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\output.log initialized.
2025-11-05 00:21:04,203: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104
2025-11-05 00:21:04,205: ### Run configurations for testing_run
2025-11-05 00:21:04,206: experiment_name: testing_run
2025-11-05 00:21:04,206: train_basin_file: calpella
2025-11-05 00:21:04,208: validation_basin_file: calpella
2025-11-05 00:21:04,209: test_basin_file: calpella
2025-11-05 00:21:04,209: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:04,211: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:04,212: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:04,214: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:04,215: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:04,216: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:04,217: device: cuda:0
2025-11-05 00:21:04,218: physics_informed: True
2025-11-05 00:21:04,219: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:04,220: validate_every: 5
2025-11-05 00:21:04,221: validate_n_random_basins: 1
2025-11-05 00:21:04,222: metrics: ['NSE', 'MSE']
2025-11-05 00:21:04,222: model: cudalstm
2025-11-05 00:21:04,224: head: regression
2025-11-05 00:21:04,225: output_activation: linear
2025-11-05 00:21:04,226: hidden_size: 128
2025-11-05 00:21:04,227: initial_forget_bias: 3
2025-11-05 00:21:04,228: output_dropout: 0.4
2025-11-05 00:21:04,229: num_layers: 1
2025-11-05 00:21:04,230: dev_mode: True
2025-11-05 00:21:04,231: optimizer: Adam
2025-11-05 00:21:04,233: loss: NSE
2025-11-05 00:21:04,234: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:21:04,234: batch_size: 128
2025-11-05 00:21:04,235: epochs: 48
2025-11-05 00:21:04,236: clip_gradient_norm: 1
2025-11-05 00:21:04,237: predict_last_n: 1
2025-11-05 00:21:04,238: seq_length: 90
2025-11-05 00:21:04,238: log_interval: 16
2025-11-05 00:21:04,239: log_tensorboard: True
2025-11-05 00:21:04,240: log_n_figures: 1
2025-11-05 00:21:04,241: save_weights_every: 48
2025-11-05 00:21:04,241: early_stopping: True
2025-11-05 00:21:04,242: early_stopping_mode: patience
2025-11-05 00:21:04,242: patience_early_stopping: 3
2025-11-05 00:21:04,243: min_delta_early_stopping: 0.0
2025-11-05 00:21:04,244: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:04,245: early_stopping_slope_window: 7
2025-11-05 00:21:04,246: early_stopping_slope_patience: 2
2025-11-05 00:21:04,247: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:04,249: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:04,250: early_stopping_slope_use_log: True
2025-11-05 00:21:04,251: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:04,252: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:04,253: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:04,255: early_stopping_slope_variance_guard: True
2025-11-05 00:21:04,255: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:04,256: dataset: russian_river
2025-11-05 00:21:04,256: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:04,257: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:04,258: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:04,259: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:04,260: hourly: False
2025-11-05 00:21:04,260: is_mts: False
2025-11-05 00:21:04,261: is_mts_data: False
2025-11-05 00:21:04,262: verbose: True
2025-11-05 00:21:04,263: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104
2025-11-05 00:21:04,264: run_label: BASELINE
2025-11-05 00:21:04,265: number_of_basins: 1
2025-11-05 00:21:04,266: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\train_data
2025-11-05 00:21:04,267: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\img_log
2025-11-05 00:21:04,268: ### Device cuda:0 will be used for training
2025-11-05 00:21:04,269: Loading basin data into xarray data set.
2025-11-05 00:21:04,484: Calculating target variable stds per basin
2025-11-05 00:21:04,497: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:04,633: Early stopping enabled: mode=patience
2025-11-05 00:21:05,039: Epoch 1 average loss: avg_loss: 2.37e-06, avg_total_loss: 2.37e-06
2025-11-05 00:21:05,339: Epoch 2 average loss: avg_loss: 1.31e-06, avg_total_loss: 1.31e-06
2025-11-05 00:21:05,594: Epoch 3 average loss: avg_loss: 9.61e-07, avg_total_loss: 9.61e-07
2025-11-05 00:21:05,833: Epoch 4 average loss: avg_loss: 8.40e-07, avg_total_loss: 8.40e-07
2025-11-05 00:21:06,079: Epoch 5 average loss: avg_loss: 6.80e-07, avg_total_loss: 6.80e-07
2025-11-05 00:21:06,545: Epoch 5 average validation loss: 7.03e-07 -- Median validation metrics: avg_loss: 7.03e-07, NSE: 0.83859, MSE: 27652.16211
2025-11-05 00:21:06,769: Epoch 6 average loss: avg_loss: 7.34e-07, avg_total_loss: 7.34e-07
2025-11-05 00:21:07,033: Epoch 7 average loss: avg_loss: 6.40e-07, avg_total_loss: 6.40e-07
2025-11-05 00:21:07,261: Epoch 8 average loss: avg_loss: 5.68e-07, avg_total_loss: 5.68e-07
2025-11-05 00:21:07,519: Epoch 9 average loss: avg_loss: 5.72e-07, avg_total_loss: 5.72e-07
2025-11-05 00:21:07,746: Epoch 10 average loss: avg_loss: 6.09e-07, avg_total_loss: 6.09e-07
2025-11-05 00:21:08,037: Epoch 10 average validation loss: 8.24e-07 -- Median validation metrics: avg_loss: 8.24e-07, NSE: 0.81223, MSE: 32167.40430
2025-11-05 00:21:08,276: Epoch 11 average loss: avg_loss: 6.04e-07, avg_total_loss: 6.04e-07
2025-11-05 00:21:08,541: Epoch 12 average loss: avg_loss: 6.52e-07, avg_total_loss: 6.52e-07
2025-11-05 00:21:08,785: Epoch 13 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:21:09,044: Epoch 14 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:21:09,288: Epoch 15 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:21:09,585: Epoch 15 average validation loss: 6.88e-07 -- Median validation metrics: avg_loss: 6.88e-07, NSE: 0.84203, MSE: 27062.31641
2025-11-05 00:21:09,800: Epoch 16 average loss: avg_loss: 6.45e-07, avg_total_loss: 6.45e-07
2025-11-05 00:21:10,042: Epoch 17 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:21:10,279: Epoch 18 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:21:10,557: Epoch 19 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:21:10,797: Epoch 20 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:21:11,130: Epoch 20 average validation loss: 8.20e-07 -- Median validation metrics: avg_loss: 8.20e-07, NSE: 0.81123, MSE: 32338.41797
2025-11-05 00:21:11,356: Epoch 21 average loss: avg_loss: 5.07e-07, avg_total_loss: 5.07e-07
2025-11-05 00:21:11,608: Epoch 22 average loss: avg_loss: 4.78e-07, avg_total_loss: 4.78e-07
2025-11-05 00:21:11,850: Epoch 23 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:21:11,851: Setting learning rate to 0.005
2025-11-05 00:21:12,122: Epoch 24 average loss: avg_loss: 4.21e-07, avg_total_loss: 4.21e-07
2025-11-05 00:21:12,378: Epoch 25 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:21:12,686: Epoch 25 average validation loss: 7.02e-07 -- Median validation metrics: avg_loss: 7.02e-07, NSE: 0.83877, MSE: 27620.56836
2025-11-05 00:21:12,924: Epoch 26 average loss: avg_loss: 4.50e-07, avg_total_loss: 4.50e-07
2025-11-05 00:21:13,195: Epoch 27 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:21:13,439: Epoch 28 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:21:13,707: Epoch 29 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:21:13,951: Epoch 30 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:21:14,273: Epoch 30 average validation loss: 6.88e-07 -- Median validation metrics: avg_loss: 6.88e-07, NSE: 0.84153, MSE: 27147.36719
2025-11-05 00:21:14,514: Epoch 31 average loss: avg_loss: 4.74e-07, avg_total_loss: 4.74e-07
2025-11-05 00:21:14,776: Epoch 32 average loss: avg_loss: 4.20e-07, avg_total_loss: 4.20e-07
2025-11-05 00:21:15,028: Epoch 33 average loss: avg_loss: 3.72e-07, avg_total_loss: 3.72e-07
2025-11-05 00:21:15,298: Epoch 34 average loss: avg_loss: 4.39e-07, avg_total_loss: 4.39e-07
2025-11-05 00:21:15,550: Epoch 35 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:21:15,862: Epoch 35 average validation loss: 7.85e-07 -- Median validation metrics: avg_loss: 7.85e-07, NSE: 0.81929, MSE: 30958.46289
2025-11-05 00:21:15,863: Setting learning rate to 0.001
2025-11-05 00:21:16,097: Epoch 36 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:21:16,352: Epoch 37 average loss: avg_loss: 3.66e-07, avg_total_loss: 3.66e-07
2025-11-05 00:21:16,612: Epoch 38 average loss: avg_loss: 3.57e-07, avg_total_loss: 3.57e-07
2025-11-05 00:21:16,878: Epoch 39 average loss: avg_loss: 3.46e-07, avg_total_loss: 3.46e-07
2025-11-05 00:21:17,124: Epoch 40 average loss: avg_loss: 3.35e-07, avg_total_loss: 3.35e-07
2025-11-05 00:21:17,391: Epoch 40 average validation loss: 7.31e-07 -- Median validation metrics: avg_loss: 7.31e-07, NSE: 0.83209, MSE: 28764.31641
2025-11-05 00:21:17,633: Epoch 41 average loss: avg_loss: 3.21e-07, avg_total_loss: 3.21e-07
2025-11-05 00:21:17,872: Epoch 42 average loss: avg_loss: 3.51e-07, avg_total_loss: 3.51e-07
2025-11-05 00:21:18,141: Epoch 43 average loss: avg_loss: 2.93e-07, avg_total_loss: 2.93e-07
2025-11-05 00:21:18,373: Epoch 44 average loss: avg_loss: 3.17e-07, avg_total_loss: 3.17e-07
2025-11-05 00:21:18,644: Epoch 45 average loss: avg_loss: 2.94e-07, avg_total_loss: 2.94e-07
2025-11-05 00:21:18,928: Epoch 45 average validation loss: 7.33e-07 -- Median validation metrics: avg_loss: 7.33e-07, NSE: 0.83188, MSE: 28801.76953
2025-11-05 00:21:18,929: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:21:18,930: Early stopping triggered at epoch 45
2025-11-05 00:21:18,949: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\model_epoch045.pt
2025-11-05 00:21:19,201: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:21:19,203: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002104\validation\model_epoch045\validation_results.p
2025-11-05 00:21:19,860: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\output.log initialized.
2025-11-05 00:21:19,861: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119
2025-11-05 00:21:19,862: ### Run configurations for testing_run
2025-11-05 00:21:19,864: experiment_name: testing_run
2025-11-05 00:21:19,865: train_basin_file: calpella
2025-11-05 00:21:19,866: validation_basin_file: calpella
2025-11-05 00:21:19,867: test_basin_file: calpella
2025-11-05 00:21:19,868: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:19,869: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:19,870: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:19,871: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:19,873: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:19,874: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:19,875: device: cuda:0
2025-11-05 00:21:19,876: physics_informed: True
2025-11-05 00:21:19,877: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:19,878: validate_every: 5
2025-11-05 00:21:19,879: validate_n_random_basins: 1
2025-11-05 00:21:19,880: metrics: ['NSE', 'MSE']
2025-11-05 00:21:19,881: model: cudalstm
2025-11-05 00:21:19,881: head: regression
2025-11-05 00:21:19,882: output_activation: linear
2025-11-05 00:21:19,883: hidden_size: 128
2025-11-05 00:21:19,883: initial_forget_bias: 3
2025-11-05 00:21:19,884: output_dropout: 0.4
2025-11-05 00:21:19,885: num_layers: 1
2025-11-05 00:21:19,885: dev_mode: True
2025-11-05 00:21:19,886: optimizer: Adam
2025-11-05 00:21:19,888: loss: NSE
2025-11-05 00:21:19,889: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:21:19,890: batch_size: 256
2025-11-05 00:21:19,891: epochs: 48
2025-11-05 00:21:19,892: clip_gradient_norm: 1
2025-11-05 00:21:19,893: predict_last_n: 1
2025-11-05 00:21:19,894: seq_length: 90
2025-11-05 00:21:19,895: log_interval: 16
2025-11-05 00:21:19,896: log_tensorboard: True
2025-11-05 00:21:19,897: log_n_figures: 1
2025-11-05 00:21:19,897: save_weights_every: 48
2025-11-05 00:21:19,898: early_stopping: True
2025-11-05 00:21:19,899: early_stopping_mode: patience
2025-11-05 00:21:19,899: patience_early_stopping: 3
2025-11-05 00:21:19,900: min_delta_early_stopping: 0.0
2025-11-05 00:21:19,901: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:19,902: early_stopping_slope_window: 7
2025-11-05 00:21:19,903: early_stopping_slope_patience: 2
2025-11-05 00:21:19,903: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:19,904: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:19,905: early_stopping_slope_use_log: True
2025-11-05 00:21:19,905: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:19,906: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:19,907: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:19,907: early_stopping_slope_variance_guard: True
2025-11-05 00:21:19,908: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:19,909: dataset: russian_river
2025-11-05 00:21:19,909: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:19,910: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:19,911: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:19,912: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:19,913: hourly: False
2025-11-05 00:21:19,913: is_mts: False
2025-11-05 00:21:19,914: is_mts_data: False
2025-11-05 00:21:19,915: verbose: True
2025-11-05 00:21:19,915: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119
2025-11-05 00:21:19,916: run_label: BASELINE
2025-11-05 00:21:19,917: number_of_basins: 1
2025-11-05 00:21:19,918: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\train_data
2025-11-05 00:21:19,919: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\img_log
2025-11-05 00:21:19,920: ### Device cuda:0 will be used for training
2025-11-05 00:21:19,921: Loading basin data into xarray data set.
2025-11-05 00:21:20,128: Calculating target variable stds per basin
2025-11-05 00:21:20,137: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:20,258: Early stopping enabled: mode=patience
2025-11-05 00:21:20,599: Epoch 1 average loss: avg_loss: 2.88e-06, avg_total_loss: 2.88e-06
2025-11-05 00:21:20,761: Epoch 2 average loss: avg_loss: 1.49e-06, avg_total_loss: 1.49e-06
2025-11-05 00:21:20,918: Epoch 3 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:21:21,072: Epoch 4 average loss: avg_loss: 9.05e-07, avg_total_loss: 9.05e-07
2025-11-05 00:21:21,247: Epoch 5 average loss: avg_loss: 7.55e-07, avg_total_loss: 7.55e-07
2025-11-05 00:21:21,743: Epoch 5 average validation loss: 6.59e-07 -- Median validation metrics: avg_loss: 6.59e-07, NSE: 0.83170, MSE: 28832.60938
2025-11-05 00:21:21,887: Epoch 6 average loss: avg_loss: 7.34e-07, avg_total_loss: 7.34e-07
2025-11-05 00:21:22,032: Epoch 7 average loss: avg_loss: 7.48e-07, avg_total_loss: 7.48e-07
2025-11-05 00:21:22,199: Epoch 8 average loss: avg_loss: 6.78e-07, avg_total_loss: 6.78e-07
2025-11-05 00:21:22,352: Epoch 9 average loss: avg_loss: 6.17e-07, avg_total_loss: 6.17e-07
2025-11-05 00:21:22,503: Epoch 10 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:21:22,782: Epoch 10 average validation loss: 6.47e-07 -- Median validation metrics: avg_loss: 6.47e-07, NSE: 0.83473, MSE: 28313.24805
2025-11-05 00:21:22,937: Epoch 11 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:21:23,082: Epoch 12 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:21:23,234: Epoch 13 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:21:23,398: Epoch 14 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:21:23,548: Epoch 15 average loss: avg_loss: 5.37e-07, avg_total_loss: 5.37e-07
2025-11-05 00:21:23,996: Epoch 15 average validation loss: 6.31e-07 -- Median validation metrics: avg_loss: 6.31e-07, NSE: 0.83877, MSE: 27620.15234
2025-11-05 00:21:24,163: Epoch 16 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:21:24,346: Epoch 17 average loss: avg_loss: 4.71e-07, avg_total_loss: 4.71e-07
2025-11-05 00:21:24,506: Epoch 18 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:21:24,665: Epoch 19 average loss: avg_loss: 4.65e-07, avg_total_loss: 4.65e-07
2025-11-05 00:21:24,842: Epoch 20 average loss: avg_loss: 5.06e-07, avg_total_loss: 5.06e-07
2025-11-05 00:21:25,134: Epoch 20 average validation loss: 6.47e-07 -- Median validation metrics: avg_loss: 6.47e-07, NSE: 0.83746, MSE: 27844.55664
2025-11-05 00:21:25,279: Epoch 21 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:21:25,435: Epoch 22 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:21:25,607: Epoch 23 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:21:25,608: Setting learning rate to 0.005
2025-11-05 00:21:25,758: Epoch 24 average loss: avg_loss: 4.36e-07, avg_total_loss: 4.36e-07
2025-11-05 00:21:25,911: Epoch 25 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:21:26,227: Epoch 25 average validation loss: 6.51e-07 -- Median validation metrics: avg_loss: 6.51e-07, NSE: 0.83582, MSE: 28125.68164
2025-11-05 00:21:26,382: Epoch 26 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:21:26,535: Epoch 27 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:21:26,702: Epoch 28 average loss: avg_loss: 4.23e-07, avg_total_loss: 4.23e-07
2025-11-05 00:21:26,863: Epoch 29 average loss: avg_loss: 3.84e-07, avg_total_loss: 3.84e-07
2025-11-05 00:21:27,017: Epoch 30 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:21:27,302: Epoch 30 average validation loss: 6.31e-07 -- Median validation metrics: avg_loss: 6.31e-07, NSE: 0.84082, MSE: 27268.83984
2025-11-05 00:21:27,304: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:21:27,304: Early stopping triggered at epoch 30
2025-11-05 00:21:27,324: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\model_epoch030.pt
2025-11-05 00:21:27,609: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:21:27,610: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002119\validation\model_epoch030\validation_results.p
2025-11-05 00:21:28,270: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\output.log initialized.
2025-11-05 00:21:28,271: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128
2025-11-05 00:21:28,272: ### Run configurations for testing_run
2025-11-05 00:21:28,272: experiment_name: testing_run
2025-11-05 00:21:28,273: train_basin_file: calpella
2025-11-05 00:21:28,275: validation_basin_file: calpella
2025-11-05 00:21:28,275: test_basin_file: calpella
2025-11-05 00:21:28,276: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:28,277: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:28,278: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:28,279: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:28,279: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:28,280: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:28,281: device: cuda:0
2025-11-05 00:21:28,281: physics_informed: True
2025-11-05 00:21:28,282: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:28,282: validate_every: 5
2025-11-05 00:21:28,283: validate_n_random_basins: 1
2025-11-05 00:21:28,284: metrics: ['NSE', 'MSE']
2025-11-05 00:21:28,284: model: cudalstm
2025-11-05 00:21:28,285: head: regression
2025-11-05 00:21:28,285: output_activation: linear
2025-11-05 00:21:28,286: hidden_size: 128
2025-11-05 00:21:28,287: initial_forget_bias: 3
2025-11-05 00:21:28,287: output_dropout: 0.4
2025-11-05 00:21:28,288: num_layers: 1
2025-11-05 00:21:28,288: dev_mode: True
2025-11-05 00:21:28,289: optimizer: Adam
2025-11-05 00:21:28,290: loss: NSE
2025-11-05 00:21:28,290: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:21:28,290: batch_size: 64
2025-11-05 00:21:28,291: epochs: 16
2025-11-05 00:21:28,292: clip_gradient_norm: 1
2025-11-05 00:21:28,292: predict_last_n: 1
2025-11-05 00:21:28,293: seq_length: 120
2025-11-05 00:21:28,293: log_interval: 16
2025-11-05 00:21:28,294: log_tensorboard: True
2025-11-05 00:21:28,294: log_n_figures: 1
2025-11-05 00:21:28,295: save_weights_every: 16
2025-11-05 00:21:28,296: early_stopping: True
2025-11-05 00:21:28,296: early_stopping_mode: patience
2025-11-05 00:21:28,297: patience_early_stopping: 3
2025-11-05 00:21:28,298: min_delta_early_stopping: 0.0
2025-11-05 00:21:28,300: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:28,302: early_stopping_slope_window: 7
2025-11-05 00:21:28,302: early_stopping_slope_patience: 2
2025-11-05 00:21:28,304: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:28,305: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:28,307: early_stopping_slope_use_log: True
2025-11-05 00:21:28,307: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:28,309: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:28,310: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:28,311: early_stopping_slope_variance_guard: True
2025-11-05 00:21:28,312: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:28,313: dataset: russian_river
2025-11-05 00:21:28,314: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:28,315: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:28,316: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:28,317: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:28,318: hourly: False
2025-11-05 00:21:28,319: is_mts: False
2025-11-05 00:21:28,321: is_mts_data: False
2025-11-05 00:21:28,322: verbose: True
2025-11-05 00:21:28,322: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128
2025-11-05 00:21:28,323: run_label: BASELINE
2025-11-05 00:21:28,324: number_of_basins: 1
2025-11-05 00:21:28,325: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\train_data
2025-11-05 00:21:28,326: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\img_log
2025-11-05 00:21:28,329: ### Device cuda:0 will be used for training
2025-11-05 00:21:28,331: Loading basin data into xarray data set.
2025-11-05 00:21:28,559: Calculating target variable stds per basin
2025-11-05 00:21:28,568: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:28,697: Early stopping enabled: mode=patience
2025-11-05 00:21:29,192: Epoch 1 average loss: avg_loss: 1.89e-06, avg_total_loss: 1.89e-06
2025-11-05 00:21:29,672: Epoch 2 average loss: avg_loss: 8.78e-07, avg_total_loss: 8.78e-07
2025-11-05 00:21:30,160: Epoch 3 average loss: avg_loss: 7.79e-07, avg_total_loss: 7.79e-07
2025-11-05 00:21:30,646: Epoch 4 average loss: avg_loss: 6.12e-07, avg_total_loss: 6.12e-07
2025-11-05 00:21:31,113: Epoch 5 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:21:31,647: Epoch 5 average validation loss: 7.75e-07 -- Median validation metrics: avg_loss: 7.75e-07, NSE: 0.82146, MSE: 30585.24805
2025-11-05 00:21:32,122: Epoch 6 average loss: avg_loss: 7.17e-07, avg_total_loss: 7.17e-07
2025-11-05 00:21:32,544: Epoch 7 average loss: avg_loss: 6.42e-07, avg_total_loss: 6.42e-07
2025-11-05 00:21:32,544: Setting learning rate to 0.005
2025-11-05 00:21:32,987: Epoch 8 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:21:33,421: Epoch 9 average loss: avg_loss: 5.31e-07, avg_total_loss: 5.31e-07
2025-11-05 00:21:33,855: Epoch 10 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:21:34,174: Epoch 10 average validation loss: 6.92e-07 -- Median validation metrics: avg_loss: 6.92e-07, NSE: 0.84101, MSE: 27236.80469
2025-11-05 00:21:34,606: Epoch 11 average loss: avg_loss: 5.14e-07, avg_total_loss: 5.14e-07
2025-11-05 00:21:34,607: Setting learning rate to 0.001
2025-11-05 00:21:35,043: Epoch 12 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:21:35,476: Epoch 13 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:21:35,954: Epoch 14 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:21:36,418: Epoch 15 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:21:36,738: Epoch 15 average validation loss: 7.10e-07 -- Median validation metrics: avg_loss: 7.10e-07, NSE: 0.83702, MSE: 27920.18945
2025-11-05 00:21:37,152: Epoch 16 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:21:37,186: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\model_epoch016.pt
2025-11-05 00:21:37,494: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:21:37,495: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002128\validation\model_epoch016\validation_results.p
2025-11-05 00:21:38,148: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\output.log initialized.
2025-11-05 00:21:38,149: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138
2025-11-05 00:21:38,150: ### Run configurations for testing_run
2025-11-05 00:21:38,150: experiment_name: testing_run
2025-11-05 00:21:38,151: train_basin_file: calpella
2025-11-05 00:21:38,152: validation_basin_file: calpella
2025-11-05 00:21:38,152: test_basin_file: calpella
2025-11-05 00:21:38,153: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:38,154: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:38,154: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:38,155: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:38,155: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:38,156: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:38,157: device: cuda:0
2025-11-05 00:21:38,157: physics_informed: True
2025-11-05 00:21:38,158: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:38,158: validate_every: 5
2025-11-05 00:21:38,159: validate_n_random_basins: 1
2025-11-05 00:21:38,160: metrics: ['NSE', 'MSE']
2025-11-05 00:21:38,161: model: cudalstm
2025-11-05 00:21:38,162: head: regression
2025-11-05 00:21:38,163: output_activation: linear
2025-11-05 00:21:38,164: hidden_size: 128
2025-11-05 00:21:38,164: initial_forget_bias: 3
2025-11-05 00:21:38,166: output_dropout: 0.4
2025-11-05 00:21:38,167: num_layers: 1
2025-11-05 00:21:38,169: dev_mode: True
2025-11-05 00:21:38,170: optimizer: Adam
2025-11-05 00:21:38,171: loss: NSE
2025-11-05 00:21:38,172: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:21:38,174: batch_size: 128
2025-11-05 00:21:38,175: epochs: 16
2025-11-05 00:21:38,177: clip_gradient_norm: 1
2025-11-05 00:21:38,178: predict_last_n: 1
2025-11-05 00:21:38,179: seq_length: 120
2025-11-05 00:21:38,180: log_interval: 16
2025-11-05 00:21:38,181: log_tensorboard: True
2025-11-05 00:21:38,183: log_n_figures: 1
2025-11-05 00:21:38,184: save_weights_every: 16
2025-11-05 00:21:38,184: early_stopping: True
2025-11-05 00:21:38,185: early_stopping_mode: patience
2025-11-05 00:21:38,186: patience_early_stopping: 3
2025-11-05 00:21:38,187: min_delta_early_stopping: 0.0
2025-11-05 00:21:38,188: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:38,189: early_stopping_slope_window: 7
2025-11-05 00:21:38,190: early_stopping_slope_patience: 2
2025-11-05 00:21:38,190: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:38,191: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:38,193: early_stopping_slope_use_log: True
2025-11-05 00:21:38,194: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:38,195: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:38,196: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:38,197: early_stopping_slope_variance_guard: True
2025-11-05 00:21:38,197: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:38,199: dataset: russian_river
2025-11-05 00:21:38,199: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:38,201: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:38,201: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:38,203: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:38,203: hourly: False
2025-11-05 00:21:38,204: is_mts: False
2025-11-05 00:21:38,205: is_mts_data: False
2025-11-05 00:21:38,206: verbose: True
2025-11-05 00:21:38,206: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138
2025-11-05 00:21:38,207: run_label: BASELINE
2025-11-05 00:21:38,208: number_of_basins: 1
2025-11-05 00:21:38,209: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\train_data
2025-11-05 00:21:38,209: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\img_log
2025-11-05 00:21:38,212: ### Device cuda:0 will be used for training
2025-11-05 00:21:38,214: Loading basin data into xarray data set.
2025-11-05 00:21:38,465: Calculating target variable stds per basin
2025-11-05 00:21:38,475: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:38,605: Early stopping enabled: mode=patience
2025-11-05 00:21:38,918: Epoch 1 average loss: avg_loss: 2.07e-06, avg_total_loss: 2.07e-06
2025-11-05 00:21:39,177: Epoch 2 average loss: avg_loss: 9.94e-07, avg_total_loss: 9.94e-07
2025-11-05 00:21:39,424: Epoch 3 average loss: avg_loss: 7.46e-07, avg_total_loss: 7.46e-07
2025-11-05 00:21:39,691: Epoch 4 average loss: avg_loss: 6.89e-07, avg_total_loss: 6.89e-07
2025-11-05 00:21:39,934: Epoch 5 average loss: avg_loss: 5.93e-07, avg_total_loss: 5.93e-07
2025-11-05 00:21:40,426: Epoch 5 average validation loss: 7.77e-07 -- Median validation metrics: avg_loss: 7.77e-07, NSE: 0.82208, MSE: 30480.47656
2025-11-05 00:21:40,636: Epoch 6 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:21:40,881: Epoch 7 average loss: avg_loss: 5.97e-07, avg_total_loss: 5.97e-07
2025-11-05 00:21:40,882: Setting learning rate to 0.005
2025-11-05 00:21:41,128: Epoch 8 average loss: avg_loss: 5.79e-07, avg_total_loss: 5.79e-07
2025-11-05 00:21:41,392: Epoch 9 average loss: avg_loss: 5.00e-07, avg_total_loss: 5.00e-07
2025-11-05 00:21:41,643: Epoch 10 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:21:41,960: Epoch 10 average validation loss: 7.30e-07 -- Median validation metrics: avg_loss: 7.30e-07, NSE: 0.83216, MSE: 28753.48438
2025-11-05 00:21:42,186: Epoch 11 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:21:42,187: Setting learning rate to 0.001
2025-11-05 00:21:42,437: Epoch 12 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:21:42,679: Epoch 13 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:21:42,938: Epoch 14 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:21:43,180: Epoch 15 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:21:43,468: Epoch 15 average validation loss: 7.08e-07 -- Median validation metrics: avg_loss: 7.08e-07, NSE: 0.83732, MSE: 27869.92383
2025-11-05 00:21:43,729: Epoch 16 average loss: avg_loss: 4.14e-07, avg_total_loss: 4.14e-07
2025-11-05 00:21:43,749: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\model_epoch016.pt
2025-11-05 00:21:44,026: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:21:44,028: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002138\validation\model_epoch016\validation_results.p
2025-11-05 00:21:44,695: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\output.log initialized.
2025-11-05 00:21:44,696: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144
2025-11-05 00:21:44,697: ### Run configurations for testing_run
2025-11-05 00:21:44,697: experiment_name: testing_run
2025-11-05 00:21:44,698: train_basin_file: calpella
2025-11-05 00:21:44,700: validation_basin_file: calpella
2025-11-05 00:21:44,701: test_basin_file: calpella
2025-11-05 00:21:44,702: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:44,704: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:44,705: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:44,706: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:44,707: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:44,708: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:44,709: device: cuda:0
2025-11-05 00:21:44,710: physics_informed: True
2025-11-05 00:21:44,711: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:44,711: validate_every: 5
2025-11-05 00:21:44,713: validate_n_random_basins: 1
2025-11-05 00:21:44,713: metrics: ['NSE', 'MSE']
2025-11-05 00:21:44,714: model: cudalstm
2025-11-05 00:21:44,715: head: regression
2025-11-05 00:21:44,715: output_activation: linear
2025-11-05 00:21:44,716: hidden_size: 128
2025-11-05 00:21:44,717: initial_forget_bias: 3
2025-11-05 00:21:44,718: output_dropout: 0.4
2025-11-05 00:21:44,718: num_layers: 1
2025-11-05 00:21:44,719: dev_mode: True
2025-11-05 00:21:44,720: optimizer: Adam
2025-11-05 00:21:44,721: loss: NSE
2025-11-05 00:21:44,721: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:21:44,722: batch_size: 256
2025-11-05 00:21:44,723: epochs: 16
2025-11-05 00:21:44,724: clip_gradient_norm: 1
2025-11-05 00:21:44,724: predict_last_n: 1
2025-11-05 00:21:44,725: seq_length: 120
2025-11-05 00:21:44,726: log_interval: 16
2025-11-05 00:21:44,727: log_tensorboard: True
2025-11-05 00:21:44,727: log_n_figures: 1
2025-11-05 00:21:44,728: save_weights_every: 16
2025-11-05 00:21:44,729: early_stopping: True
2025-11-05 00:21:44,730: early_stopping_mode: patience
2025-11-05 00:21:44,731: patience_early_stopping: 3
2025-11-05 00:21:44,731: min_delta_early_stopping: 0.0
2025-11-05 00:21:44,732: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:44,732: early_stopping_slope_window: 7
2025-11-05 00:21:44,733: early_stopping_slope_patience: 2
2025-11-05 00:21:44,734: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:44,735: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:44,735: early_stopping_slope_use_log: True
2025-11-05 00:21:44,736: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:44,737: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:44,738: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:44,739: early_stopping_slope_variance_guard: True
2025-11-05 00:21:44,740: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:44,740: dataset: russian_river
2025-11-05 00:21:44,741: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:44,741: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:44,742: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:44,743: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:44,744: hourly: False
2025-11-05 00:21:44,744: is_mts: False
2025-11-05 00:21:44,745: is_mts_data: False
2025-11-05 00:21:44,745: verbose: True
2025-11-05 00:21:44,746: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144
2025-11-05 00:21:44,747: run_label: BASELINE
2025-11-05 00:21:44,748: number_of_basins: 1
2025-11-05 00:21:44,748: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\train_data
2025-11-05 00:21:44,750: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\img_log
2025-11-05 00:21:44,752: ### Device cuda:0 will be used for training
2025-11-05 00:21:44,754: Loading basin data into xarray data set.
2025-11-05 00:21:44,975: Calculating target variable stds per basin
2025-11-05 00:21:44,986: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:45,108: Early stopping enabled: mode=patience
2025-11-05 00:21:45,325: Epoch 1 average loss: avg_loss: 2.48e-06, avg_total_loss: 2.48e-06
2025-11-05 00:21:45,533: Epoch 2 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:21:45,715: Epoch 3 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:21:45,884: Epoch 4 average loss: avg_loss: 8.85e-07, avg_total_loss: 8.85e-07
2025-11-05 00:21:46,068: Epoch 5 average loss: avg_loss: 8.93e-07, avg_total_loss: 8.93e-07
2025-11-05 00:21:46,534: Epoch 5 average validation loss: 7.68e-07 -- Median validation metrics: avg_loss: 7.68e-07, NSE: 0.80442, MSE: 33505.14844
2025-11-05 00:21:46,680: Epoch 6 average loss: avg_loss: 9.61e-07, avg_total_loss: 9.61e-07
2025-11-05 00:21:46,827: Epoch 7 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:21:46,828: Setting learning rate to 0.005
2025-11-05 00:21:47,002: Epoch 8 average loss: avg_loss: 6.87e-07, avg_total_loss: 6.87e-07
2025-11-05 00:21:47,160: Epoch 9 average loss: avg_loss: 7.46e-07, avg_total_loss: 7.46e-07
2025-11-05 00:21:47,309: Epoch 10 average loss: avg_loss: 6.49e-07, avg_total_loss: 6.49e-07
2025-11-05 00:21:47,637: Epoch 10 average validation loss: 7.38e-07 -- Median validation metrics: avg_loss: 7.38e-07, NSE: 0.81378, MSE: 31901.98438
2025-11-05 00:21:47,792: Epoch 11 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:21:47,792: Setting learning rate to 0.001
2025-11-05 00:21:47,940: Epoch 12 average loss: avg_loss: 5.70e-07, avg_total_loss: 5.70e-07
2025-11-05 00:21:48,089: Epoch 13 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:21:48,415: Epoch 14 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:21:48,564: Epoch 15 average loss: avg_loss: 5.60e-07, avg_total_loss: 5.60e-07
2025-11-05 00:21:48,842: Epoch 15 average validation loss: 6.74e-07 -- Median validation metrics: avg_loss: 6.74e-07, NSE: 0.82926, MSE: 29249.27734
2025-11-05 00:21:48,983: Epoch 16 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:21:49,012: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\model_epoch016.pt
2025-11-05 00:21:49,305: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:21:49,306: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002144\validation\model_epoch016\validation_results.p
2025-11-05 00:21:49,961: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\output.log initialized.
2025-11-05 00:21:49,962: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149
2025-11-05 00:21:49,962: ### Run configurations for testing_run
2025-11-05 00:21:49,963: experiment_name: testing_run
2025-11-05 00:21:49,963: train_basin_file: calpella
2025-11-05 00:21:49,964: validation_basin_file: calpella
2025-11-05 00:21:49,964: test_basin_file: calpella
2025-11-05 00:21:49,965: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:21:49,966: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:21:49,967: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:21:49,968: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:21:49,969: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:21:49,970: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:21:49,971: device: cuda:0
2025-11-05 00:21:49,971: physics_informed: True
2025-11-05 00:21:49,972: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:21:49,973: validate_every: 5
2025-11-05 00:21:49,973: validate_n_random_basins: 1
2025-11-05 00:21:49,974: metrics: ['NSE', 'MSE']
2025-11-05 00:21:49,975: model: cudalstm
2025-11-05 00:21:49,975: head: regression
2025-11-05 00:21:49,976: output_activation: linear
2025-11-05 00:21:49,976: hidden_size: 128
2025-11-05 00:21:49,977: initial_forget_bias: 3
2025-11-05 00:21:49,978: output_dropout: 0.4
2025-11-05 00:21:49,979: num_layers: 1
2025-11-05 00:21:49,980: dev_mode: True
2025-11-05 00:21:49,981: optimizer: Adam
2025-11-05 00:21:49,983: loss: NSE
2025-11-05 00:21:49,984: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:21:49,986: batch_size: 64
2025-11-05 00:21:49,987: epochs: 32
2025-11-05 00:21:49,988: clip_gradient_norm: 1
2025-11-05 00:21:49,989: predict_last_n: 1
2025-11-05 00:21:49,990: seq_length: 120
2025-11-05 00:21:49,992: log_interval: 16
2025-11-05 00:21:49,993: log_tensorboard: True
2025-11-05 00:21:49,994: log_n_figures: 1
2025-11-05 00:21:49,995: save_weights_every: 32
2025-11-05 00:21:49,996: early_stopping: True
2025-11-05 00:21:49,998: early_stopping_mode: patience
2025-11-05 00:21:49,999: patience_early_stopping: 3
2025-11-05 00:21:50,000: min_delta_early_stopping: 0.0
2025-11-05 00:21:50,001: minimum_epochs_before_early_stopping: 10
2025-11-05 00:21:50,001: early_stopping_slope_window: 7
2025-11-05 00:21:50,002: early_stopping_slope_patience: 2
2025-11-05 00:21:50,003: early_stopping_slope_min_epoch: 8
2025-11-05 00:21:50,004: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:21:50,006: early_stopping_slope_use_log: True
2025-11-05 00:21:50,007: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:21:50,008: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:21:50,009: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:21:50,010: early_stopping_slope_variance_guard: True
2025-11-05 00:21:50,011: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:21:50,012: dataset: russian_river
2025-11-05 00:21:50,013: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:21:50,014: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:21:50,015: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:21:50,016: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:21:50,016: hourly: False
2025-11-05 00:21:50,018: is_mts: False
2025-11-05 00:21:50,019: is_mts_data: False
2025-11-05 00:21:50,020: verbose: True
2025-11-05 00:21:50,021: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149
2025-11-05 00:21:50,022: run_label: BASELINE
2025-11-05 00:21:50,022: number_of_basins: 1
2025-11-05 00:21:50,023: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\train_data
2025-11-05 00:21:50,023: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\img_log
2025-11-05 00:21:50,025: ### Device cuda:0 will be used for training
2025-11-05 00:21:50,026: Loading basin data into xarray data set.
2025-11-05 00:21:50,241: Calculating target variable stds per basin
2025-11-05 00:21:50,250: Create lookup table and convert to pytorch tensor
2025-11-05 00:21:50,400: Early stopping enabled: mode=patience
2025-11-05 00:21:50,892: Epoch 1 average loss: avg_loss: 1.57e-06, avg_total_loss: 1.57e-06
2025-11-05 00:21:51,358: Epoch 2 average loss: avg_loss: 8.43e-07, avg_total_loss: 8.43e-07
2025-11-05 00:21:51,830: Epoch 3 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:21:52,299: Epoch 4 average loss: avg_loss: 6.65e-07, avg_total_loss: 6.65e-07
2025-11-05 00:21:52,779: Epoch 5 average loss: avg_loss: 6.61e-07, avg_total_loss: 6.61e-07
2025-11-05 00:21:53,296: Epoch 5 average validation loss: 7.22e-07 -- Median validation metrics: avg_loss: 7.22e-07, NSE: 0.83450, MSE: 28351.46875
2025-11-05 00:21:53,845: Epoch 6 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:21:54,271: Epoch 7 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:21:54,722: Epoch 8 average loss: avg_loss: 5.35e-07, avg_total_loss: 5.35e-07
2025-11-05 00:21:55,097: Epoch 9 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:21:55,501: Epoch 10 average loss: avg_loss: 5.55e-07, avg_total_loss: 5.55e-07
2025-11-05 00:21:55,779: Epoch 10 average validation loss: 7.10e-07 -- Median validation metrics: avg_loss: 7.10e-07, NSE: 0.83649, MSE: 28010.66211
2025-11-05 00:21:56,198: Epoch 11 average loss: avg_loss: 5.40e-07, avg_total_loss: 5.40e-07
2025-11-05 00:21:56,666: Epoch 12 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:21:57,113: Epoch 13 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:21:57,574: Epoch 14 average loss: avg_loss: 4.77e-07, avg_total_loss: 4.77e-07
2025-11-05 00:21:58,035: Epoch 15 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:21:58,385: Epoch 15 average validation loss: 7.23e-07 -- Median validation metrics: avg_loss: 7.23e-07, NSE: 0.83480, MSE: 28301.44531
2025-11-05 00:21:58,386: Setting learning rate to 0.005
2025-11-05 00:21:58,816: Epoch 16 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:21:59,271: Epoch 17 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:21:59,740: Epoch 18 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:22:00,209: Epoch 19 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:22:00,670: Epoch 20 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:22:00,977: Epoch 20 average validation loss: 7.34e-07 -- Median validation metrics: avg_loss: 7.34e-07, NSE: 0.83126, MSE: 28907.91797
2025-11-05 00:22:01,517: Epoch 21 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:22:01,944: Epoch 22 average loss: avg_loss: 3.54e-07, avg_total_loss: 3.54e-07
2025-11-05 00:22:02,367: Epoch 23 average loss: avg_loss: 3.56e-07, avg_total_loss: 3.56e-07
2025-11-05 00:22:02,367: Setting learning rate to 0.001
2025-11-05 00:22:02,778: Epoch 24 average loss: avg_loss: 3.45e-07, avg_total_loss: 3.45e-07
2025-11-05 00:22:03,188: Epoch 25 average loss: avg_loss: 3.33e-07, avg_total_loss: 3.33e-07
2025-11-05 00:22:03,480: Epoch 25 average validation loss: 7.53e-07 -- Median validation metrics: avg_loss: 7.53e-07, NSE: 0.82698, MSE: 29641.20898
2025-11-05 00:22:03,481: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:22:03,481: Early stopping triggered at epoch 25
2025-11-05 00:22:03,499: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\model_epoch025.pt
2025-11-05 00:22:03,768: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:22:03,770: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002149\validation\model_epoch025\validation_results.p
2025-11-05 00:22:04,432: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\output.log initialized.
2025-11-05 00:22:04,433: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204
2025-11-05 00:22:04,434: ### Run configurations for testing_run
2025-11-05 00:22:04,434: experiment_name: testing_run
2025-11-05 00:22:04,435: train_basin_file: calpella
2025-11-05 00:22:04,436: validation_basin_file: calpella
2025-11-05 00:22:04,436: test_basin_file: calpella
2025-11-05 00:22:04,437: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:22:04,437: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:22:04,438: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:22:04,439: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:22:04,439: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:22:04,440: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:22:04,441: device: cuda:0
2025-11-05 00:22:04,441: physics_informed: True
2025-11-05 00:22:04,442: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:22:04,442: validate_every: 5
2025-11-05 00:22:04,443: validate_n_random_basins: 1
2025-11-05 00:22:04,444: metrics: ['NSE', 'MSE']
2025-11-05 00:22:04,444: model: cudalstm
2025-11-05 00:22:04,445: head: regression
2025-11-05 00:22:04,446: output_activation: linear
2025-11-05 00:22:04,446: hidden_size: 128
2025-11-05 00:22:04,446: initial_forget_bias: 3
2025-11-05 00:22:04,447: output_dropout: 0.4
2025-11-05 00:22:04,447: num_layers: 1
2025-11-05 00:22:04,448: dev_mode: True
2025-11-05 00:22:04,449: optimizer: Adam
2025-11-05 00:22:04,449: loss: NSE
2025-11-05 00:22:04,449: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:22:04,450: batch_size: 128
2025-11-05 00:22:04,451: epochs: 32
2025-11-05 00:22:04,452: clip_gradient_norm: 1
2025-11-05 00:22:04,452: predict_last_n: 1
2025-11-05 00:22:04,453: seq_length: 120
2025-11-05 00:22:04,453: log_interval: 16
2025-11-05 00:22:04,454: log_tensorboard: True
2025-11-05 00:22:04,455: log_n_figures: 1
2025-11-05 00:22:04,455: save_weights_every: 32
2025-11-05 00:22:04,456: early_stopping: True
2025-11-05 00:22:04,457: early_stopping_mode: patience
2025-11-05 00:22:04,457: patience_early_stopping: 3
2025-11-05 00:22:04,458: min_delta_early_stopping: 0.0
2025-11-05 00:22:04,458: minimum_epochs_before_early_stopping: 10
2025-11-05 00:22:04,459: early_stopping_slope_window: 7
2025-11-05 00:22:04,460: early_stopping_slope_patience: 2
2025-11-05 00:22:04,461: early_stopping_slope_min_epoch: 8
2025-11-05 00:22:04,462: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:22:04,462: early_stopping_slope_use_log: True
2025-11-05 00:22:04,463: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:22:04,464: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:22:04,464: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:22:04,465: early_stopping_slope_variance_guard: True
2025-11-05 00:22:04,466: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:22:04,466: dataset: russian_river
2025-11-05 00:22:04,467: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:22:04,468: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:22:04,468: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:22:04,469: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:22:04,469: hourly: False
2025-11-05 00:22:04,470: is_mts: False
2025-11-05 00:22:04,471: is_mts_data: False
2025-11-05 00:22:04,471: verbose: True
2025-11-05 00:22:04,472: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204
2025-11-05 00:22:04,472: run_label: BASELINE
2025-11-05 00:22:04,473: number_of_basins: 1
2025-11-05 00:22:04,474: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\train_data
2025-11-05 00:22:04,475: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\img_log
2025-11-05 00:22:04,476: ### Device cuda:0 will be used for training
2025-11-05 00:22:04,477: Loading basin data into xarray data set.
2025-11-05 00:22:04,724: Calculating target variable stds per basin
2025-11-05 00:22:04,734: Create lookup table and convert to pytorch tensor
2025-11-05 00:22:04,860: Early stopping enabled: mode=patience
2025-11-05 00:22:05,323: Epoch 1 average loss: avg_loss: 1.95e-06, avg_total_loss: 1.95e-06
2025-11-05 00:22:05,574: Epoch 2 average loss: avg_loss: 1.09e-06, avg_total_loss: 1.09e-06
2025-11-05 00:22:05,816: Epoch 3 average loss: avg_loss: 8.63e-07, avg_total_loss: 8.63e-07
2025-11-05 00:22:06,069: Epoch 4 average loss: avg_loss: 7.35e-07, avg_total_loss: 7.35e-07
2025-11-05 00:22:06,294: Epoch 5 average loss: avg_loss: 7.03e-07, avg_total_loss: 7.03e-07
2025-11-05 00:22:06,806: Epoch 5 average validation loss: 8.09e-07 -- Median validation metrics: avg_loss: 8.09e-07, NSE: 0.81521, MSE: 31656.79688
2025-11-05 00:22:07,019: Epoch 6 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:22:07,266: Epoch 7 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:22:07,510: Epoch 8 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:22:07,765: Epoch 9 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:22:08,009: Epoch 10 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:22:08,304: Epoch 10 average validation loss: 8.14e-07 -- Median validation metrics: avg_loss: 8.14e-07, NSE: 0.81339, MSE: 31967.91602
2025-11-05 00:22:08,560: Epoch 11 average loss: avg_loss: 5.47e-07, avg_total_loss: 5.47e-07
2025-11-05 00:22:08,802: Epoch 12 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:22:09,075: Epoch 13 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:22:09,325: Epoch 14 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:22:09,610: Epoch 15 average loss: avg_loss: 4.73e-07, avg_total_loss: 4.73e-07
2025-11-05 00:22:09,892: Epoch 15 average validation loss: 6.65e-07 -- Median validation metrics: avg_loss: 6.65e-07, NSE: 0.84691, MSE: 26226.61133
2025-11-05 00:22:09,893: Setting learning rate to 0.005
2025-11-05 00:22:10,126: Epoch 16 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:22:10,393: Epoch 17 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:22:10,649: Epoch 18 average loss: avg_loss: 4.07e-07, avg_total_loss: 4.07e-07
2025-11-05 00:22:10,906: Epoch 19 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:22:11,183: Epoch 20 average loss: avg_loss: 3.99e-07, avg_total_loss: 3.99e-07
2025-11-05 00:22:11,493: Epoch 20 average validation loss: 7.48e-07 -- Median validation metrics: avg_loss: 7.48e-07, NSE: 0.82878, MSE: 29331.29102
2025-11-05 00:22:11,733: Epoch 21 average loss: avg_loss: 3.93e-07, avg_total_loss: 3.93e-07
2025-11-05 00:22:12,005: Epoch 22 average loss: avg_loss: 4.03e-07, avg_total_loss: 4.03e-07
2025-11-05 00:22:12,260: Epoch 23 average loss: avg_loss: 3.77e-07, avg_total_loss: 3.77e-07
2025-11-05 00:22:12,261: Setting learning rate to 0.001
2025-11-05 00:22:12,539: Epoch 24 average loss: avg_loss: 3.47e-07, avg_total_loss: 3.47e-07
2025-11-05 00:22:12,798: Epoch 25 average loss: avg_loss: 3.39e-07, avg_total_loss: 3.39e-07
2025-11-05 00:22:13,100: Epoch 25 average validation loss: 7.00e-07 -- Median validation metrics: avg_loss: 7.00e-07, NSE: 0.83927, MSE: 27534.66406
2025-11-05 00:22:13,328: Epoch 26 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:22:13,591: Epoch 27 average loss: avg_loss: 3.66e-07, avg_total_loss: 3.66e-07
2025-11-05 00:22:13,835: Epoch 28 average loss: avg_loss: 3.60e-07, avg_total_loss: 3.60e-07
2025-11-05 00:22:14,100: Epoch 29 average loss: avg_loss: 3.15e-07, avg_total_loss: 3.15e-07
2025-11-05 00:22:14,356: Epoch 30 average loss: avg_loss: 3.48e-07, avg_total_loss: 3.48e-07
2025-11-05 00:22:14,666: Epoch 30 average validation loss: 7.25e-07 -- Median validation metrics: avg_loss: 7.25e-07, NSE: 0.83346, MSE: 28531.08398
2025-11-05 00:22:14,667: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:22:14,668: Early stopping triggered at epoch 30
2025-11-05 00:22:14,689: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\model_epoch030.pt
2025-11-05 00:22:14,937: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:22:14,939: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002204\validation\model_epoch030\validation_results.p
2025-11-05 00:22:15,623: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\output.log initialized.
2025-11-05 00:22:15,624: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215
2025-11-05 00:22:15,625: ### Run configurations for testing_run
2025-11-05 00:22:15,626: experiment_name: testing_run
2025-11-05 00:22:15,627: train_basin_file: calpella
2025-11-05 00:22:15,627: validation_basin_file: calpella
2025-11-05 00:22:15,628: test_basin_file: calpella
2025-11-05 00:22:15,629: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:22:15,630: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:22:15,631: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:22:15,631: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:22:15,632: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:22:15,633: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:22:15,634: device: cuda:0
2025-11-05 00:22:15,634: physics_informed: True
2025-11-05 00:22:15,635: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:22:15,636: validate_every: 5
2025-11-05 00:22:15,636: validate_n_random_basins: 1
2025-11-05 00:22:15,637: metrics: ['NSE', 'MSE']
2025-11-05 00:22:15,638: model: cudalstm
2025-11-05 00:22:15,638: head: regression
2025-11-05 00:22:15,639: output_activation: linear
2025-11-05 00:22:15,640: hidden_size: 128
2025-11-05 00:22:15,642: initial_forget_bias: 3
2025-11-05 00:22:15,642: output_dropout: 0.4
2025-11-05 00:22:15,643: num_layers: 1
2025-11-05 00:22:15,644: dev_mode: True
2025-11-05 00:22:15,645: optimizer: Adam
2025-11-05 00:22:15,646: loss: NSE
2025-11-05 00:22:15,647: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:22:15,648: batch_size: 256
2025-11-05 00:22:15,649: epochs: 32
2025-11-05 00:22:15,650: clip_gradient_norm: 1
2025-11-05 00:22:15,652: predict_last_n: 1
2025-11-05 00:22:15,654: seq_length: 120
2025-11-05 00:22:15,655: log_interval: 16
2025-11-05 00:22:15,656: log_tensorboard: True
2025-11-05 00:22:15,657: log_n_figures: 1
2025-11-05 00:22:15,658: save_weights_every: 32
2025-11-05 00:22:15,659: early_stopping: True
2025-11-05 00:22:15,660: early_stopping_mode: patience
2025-11-05 00:22:15,662: patience_early_stopping: 3
2025-11-05 00:22:15,663: min_delta_early_stopping: 0.0
2025-11-05 00:22:15,664: minimum_epochs_before_early_stopping: 10
2025-11-05 00:22:15,666: early_stopping_slope_window: 7
2025-11-05 00:22:15,667: early_stopping_slope_patience: 2
2025-11-05 00:22:15,668: early_stopping_slope_min_epoch: 8
2025-11-05 00:22:15,669: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:22:15,671: early_stopping_slope_use_log: True
2025-11-05 00:22:15,672: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:22:15,673: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:22:15,674: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:22:15,676: early_stopping_slope_variance_guard: True
2025-11-05 00:22:15,677: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:22:15,678: dataset: russian_river
2025-11-05 00:22:15,679: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:22:15,681: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:22:15,682: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:22:15,683: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:22:15,684: hourly: False
2025-11-05 00:22:15,686: is_mts: False
2025-11-05 00:22:15,687: is_mts_data: False
2025-11-05 00:22:15,688: verbose: True
2025-11-05 00:22:15,689: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215
2025-11-05 00:22:15,690: run_label: BASELINE
2025-11-05 00:22:15,691: number_of_basins: 1
2025-11-05 00:22:15,692: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\train_data
2025-11-05 00:22:15,693: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\img_log
2025-11-05 00:22:15,696: ### Device cuda:0 will be used for training
2025-11-05 00:22:15,698: Loading basin data into xarray data set.
2025-11-05 00:22:15,914: Calculating target variable stds per basin
2025-11-05 00:22:15,926: Create lookup table and convert to pytorch tensor
2025-11-05 00:22:16,060: Early stopping enabled: mode=patience
2025-11-05 00:22:16,371: Epoch 1 average loss: avg_loss: 2.37e-06, avg_total_loss: 2.37e-06
2025-11-05 00:22:16,533: Epoch 2 average loss: avg_loss: 1.30e-06, avg_total_loss: 1.30e-06
2025-11-05 00:22:16,705: Epoch 3 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:22:16,863: Epoch 4 average loss: avg_loss: 9.60e-07, avg_total_loss: 9.60e-07
2025-11-05 00:22:17,022: Epoch 5 average loss: avg_loss: 8.16e-07, avg_total_loss: 8.16e-07
2025-11-05 00:22:17,508: Epoch 5 average validation loss: 7.84e-07 -- Median validation metrics: avg_loss: 7.84e-07, NSE: 0.80097, MSE: 34096.22656
2025-11-05 00:22:17,653: Epoch 6 average loss: avg_loss: 7.36e-07, avg_total_loss: 7.36e-07
2025-11-05 00:22:17,805: Epoch 7 average loss: avg_loss: 8.01e-07, avg_total_loss: 8.01e-07
2025-11-05 00:22:17,956: Epoch 8 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:22:18,131: Epoch 9 average loss: avg_loss: 6.24e-07, avg_total_loss: 6.24e-07
2025-11-05 00:22:18,285: Epoch 10 average loss: avg_loss: 6.01e-07, avg_total_loss: 6.01e-07
2025-11-05 00:22:18,560: Epoch 10 average validation loss: 6.67e-07 -- Median validation metrics: avg_loss: 6.67e-07, NSE: 0.82942, MSE: 29222.25781
2025-11-05 00:22:18,883: Epoch 11 average loss: avg_loss: 5.68e-07, avg_total_loss: 5.68e-07
2025-11-05 00:22:19,054: Epoch 12 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:22:19,212: Epoch 13 average loss: avg_loss: 5.18e-07, avg_total_loss: 5.18e-07
2025-11-05 00:22:19,369: Epoch 14 average loss: avg_loss: 4.68e-07, avg_total_loss: 4.68e-07
2025-11-05 00:22:19,544: Epoch 15 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:22:19,810: Epoch 15 average validation loss: 6.68e-07 -- Median validation metrics: avg_loss: 6.68e-07, NSE: 0.83038, MSE: 29057.28906
2025-11-05 00:22:19,811: Setting learning rate to 0.005
2025-11-05 00:22:19,962: Epoch 16 average loss: avg_loss: 4.40e-07, avg_total_loss: 4.40e-07
2025-11-05 00:22:20,117: Epoch 17 average loss: avg_loss: 4.32e-07, avg_total_loss: 4.32e-07
2025-11-05 00:22:20,290: Epoch 18 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:22:20,450: Epoch 19 average loss: avg_loss: 3.95e-07, avg_total_loss: 3.95e-07
2025-11-05 00:22:20,614: Epoch 20 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:22:20,925: Epoch 20 average validation loss: 7.59e-07 -- Median validation metrics: avg_loss: 7.59e-07, NSE: 0.81045, MSE: 32472.83008
2025-11-05 00:22:21,086: Epoch 21 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:22:21,249: Epoch 22 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:22:21,402: Epoch 23 average loss: avg_loss: 3.70e-07, avg_total_loss: 3.70e-07
2025-11-05 00:22:21,403: Setting learning rate to 0.001
2025-11-05 00:22:21,576: Epoch 24 average loss: avg_loss: 3.65e-07, avg_total_loss: 3.65e-07
2025-11-05 00:22:21,731: Epoch 25 average loss: avg_loss: 3.25e-07, avg_total_loss: 3.25e-07
2025-11-05 00:22:21,986: Epoch 25 average validation loss: 6.62e-07 -- Median validation metrics: avg_loss: 6.62e-07, NSE: 0.83320, MSE: 28575.00000
2025-11-05 00:22:22,138: Epoch 26 average loss: avg_loss: 3.89e-07, avg_total_loss: 3.89e-07
2025-11-05 00:22:22,313: Epoch 27 average loss: avg_loss: 3.24e-07, avg_total_loss: 3.24e-07
2025-11-05 00:22:22,466: Epoch 28 average loss: avg_loss: 3.35e-07, avg_total_loss: 3.35e-07
2025-11-05 00:22:22,620: Epoch 29 average loss: avg_loss: 3.53e-07, avg_total_loss: 3.53e-07
2025-11-05 00:22:22,795: Epoch 30 average loss: avg_loss: 3.46e-07, avg_total_loss: 3.46e-07
2025-11-05 00:22:23,098: Epoch 30 average validation loss: 6.69e-07 -- Median validation metrics: avg_loss: 6.69e-07, NSE: 0.83033, MSE: 29065.99609
2025-11-05 00:22:23,243: Epoch 31 average loss: avg_loss: 3.38e-07, avg_total_loss: 3.38e-07
2025-11-05 00:22:23,395: Epoch 32 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:22:23,423: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\model_epoch032.pt
2025-11-05 00:22:23,724: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:22:23,725: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002215\validation\model_epoch032\validation_results.p
2025-11-05 00:22:24,424: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\output.log initialized.
2025-11-05 00:22:24,425: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224
2025-11-05 00:22:24,425: ### Run configurations for testing_run
2025-11-05 00:22:24,426: experiment_name: testing_run
2025-11-05 00:22:24,427: train_basin_file: calpella
2025-11-05 00:22:24,427: validation_basin_file: calpella
2025-11-05 00:22:24,428: test_basin_file: calpella
2025-11-05 00:22:24,428: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:22:24,429: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:22:24,430: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:22:24,430: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:22:24,431: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:22:24,431: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:22:24,432: device: cuda:0
2025-11-05 00:22:24,433: physics_informed: True
2025-11-05 00:22:24,433: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:22:24,434: validate_every: 5
2025-11-05 00:22:24,435: validate_n_random_basins: 1
2025-11-05 00:22:24,436: metrics: ['NSE', 'MSE']
2025-11-05 00:22:24,436: model: cudalstm
2025-11-05 00:22:24,437: head: regression
2025-11-05 00:22:24,437: output_activation: linear
2025-11-05 00:22:24,438: hidden_size: 128
2025-11-05 00:22:24,438: initial_forget_bias: 3
2025-11-05 00:22:24,439: output_dropout: 0.4
2025-11-05 00:22:24,439: num_layers: 1
2025-11-05 00:22:24,440: dev_mode: True
2025-11-05 00:22:24,440: optimizer: Adam
2025-11-05 00:22:24,441: loss: NSE
2025-11-05 00:22:24,442: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:22:24,442: batch_size: 64
2025-11-05 00:22:24,443: epochs: 48
2025-11-05 00:22:24,443: clip_gradient_norm: 1
2025-11-05 00:22:24,444: predict_last_n: 1
2025-11-05 00:22:24,445: seq_length: 120
2025-11-05 00:22:24,446: log_interval: 16
2025-11-05 00:22:24,447: log_tensorboard: True
2025-11-05 00:22:24,448: log_n_figures: 1
2025-11-05 00:22:24,448: save_weights_every: 48
2025-11-05 00:22:24,449: early_stopping: True
2025-11-05 00:22:24,450: early_stopping_mode: patience
2025-11-05 00:22:24,452: patience_early_stopping: 3
2025-11-05 00:22:24,453: min_delta_early_stopping: 0.0
2025-11-05 00:22:24,454: minimum_epochs_before_early_stopping: 10
2025-11-05 00:22:24,456: early_stopping_slope_window: 7
2025-11-05 00:22:24,457: early_stopping_slope_patience: 2
2025-11-05 00:22:24,458: early_stopping_slope_min_epoch: 8
2025-11-05 00:22:24,459: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:22:24,460: early_stopping_slope_use_log: True
2025-11-05 00:22:24,462: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:22:24,463: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:22:24,465: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:22:24,466: early_stopping_slope_variance_guard: True
2025-11-05 00:22:24,468: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:22:24,468: dataset: russian_river
2025-11-05 00:22:24,470: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:22:24,471: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:22:24,472: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:22:24,472: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:22:24,474: hourly: False
2025-11-05 00:22:24,475: is_mts: False
2025-11-05 00:22:24,476: is_mts_data: False
2025-11-05 00:22:24,477: verbose: True
2025-11-05 00:22:24,478: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224
2025-11-05 00:22:24,480: run_label: BASELINE
2025-11-05 00:22:24,481: number_of_basins: 1
2025-11-05 00:22:24,482: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\train_data
2025-11-05 00:22:24,483: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\img_log
2025-11-05 00:22:24,486: ### Device cuda:0 will be used for training
2025-11-05 00:22:24,488: Loading basin data into xarray data set.
2025-11-05 00:22:24,717: Calculating target variable stds per basin
2025-11-05 00:22:24,727: Create lookup table and convert to pytorch tensor
2025-11-05 00:22:24,850: Early stopping enabled: mode=patience
2025-11-05 00:22:25,232: Epoch 1 average loss: avg_loss: 1.73e-06, avg_total_loss: 1.73e-06
2025-11-05 00:22:25,656: Epoch 2 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:22:26,074: Epoch 3 average loss: avg_loss: 7.32e-07, avg_total_loss: 7.32e-07
2025-11-05 00:22:26,521: Epoch 4 average loss: avg_loss: 6.53e-07, avg_total_loss: 6.53e-07
2025-11-05 00:22:26,971: Epoch 5 average loss: avg_loss: 6.16e-07, avg_total_loss: 6.16e-07
2025-11-05 00:22:27,477: Epoch 5 average validation loss: 7.56e-07 -- Median validation metrics: avg_loss: 7.56e-07, NSE: 0.82621, MSE: 29772.15430
2025-11-05 00:22:27,921: Epoch 6 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:22:28,390: Epoch 7 average loss: avg_loss: 6.13e-07, avg_total_loss: 6.13e-07
2025-11-05 00:22:28,859: Epoch 8 average loss: avg_loss: 6.53e-07, avg_total_loss: 6.53e-07
2025-11-05 00:22:29,328: Epoch 9 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:22:29,787: Epoch 10 average loss: avg_loss: 5.57e-07, avg_total_loss: 5.57e-07
2025-11-05 00:22:30,095: Epoch 10 average validation loss: 7.79e-07 -- Median validation metrics: avg_loss: 7.79e-07, NSE: 0.82049, MSE: 30751.90820
2025-11-05 00:22:30,526: Epoch 11 average loss: avg_loss: 7.53e-07, avg_total_loss: 7.53e-07
2025-11-05 00:22:31,017: Epoch 12 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:22:31,472: Epoch 13 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:22:31,919: Epoch 14 average loss: avg_loss: 4.99e-07, avg_total_loss: 4.99e-07
2025-11-05 00:22:32,337: Epoch 15 average loss: avg_loss: 5.32e-07, avg_total_loss: 5.32e-07
2025-11-05 00:22:32,630: Epoch 15 average validation loss: 7.52e-07 -- Median validation metrics: avg_loss: 7.52e-07, NSE: 0.82795, MSE: 29474.42188
2025-11-05 00:22:33,035: Epoch 16 average loss: avg_loss: 5.43e-07, avg_total_loss: 5.43e-07
2025-11-05 00:22:33,471: Epoch 17 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:22:33,939: Epoch 18 average loss: avg_loss: 4.79e-07, avg_total_loss: 4.79e-07
2025-11-05 00:22:34,378: Epoch 19 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:22:34,822: Epoch 20 average loss: avg_loss: 4.78e-07, avg_total_loss: 4.78e-07
2025-11-05 00:22:35,120: Epoch 20 average validation loss: 7.87e-07 -- Median validation metrics: avg_loss: 7.87e-07, NSE: 0.81896, MSE: 31013.78906
2025-11-05 00:22:35,569: Epoch 21 average loss: avg_loss: 4.37e-07, avg_total_loss: 4.37e-07
2025-11-05 00:22:36,010: Epoch 22 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:22:36,475: Epoch 23 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:22:36,476: Setting learning rate to 0.005
2025-11-05 00:22:36,938: Epoch 24 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:22:37,396: Epoch 25 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:22:37,712: Epoch 25 average validation loss: 7.72e-07 -- Median validation metrics: avg_loss: 7.72e-07, NSE: 0.82218, MSE: 30463.16016
2025-11-05 00:22:38,181: Epoch 26 average loss: avg_loss: 3.81e-07, avg_total_loss: 3.81e-07
2025-11-05 00:22:38,606: Epoch 27 average loss: avg_loss: 3.60e-07, avg_total_loss: 3.60e-07
2025-11-05 00:22:39,035: Epoch 28 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:22:39,485: Epoch 29 average loss: avg_loss: 3.75e-07, avg_total_loss: 3.75e-07
2025-11-05 00:22:39,914: Epoch 30 average loss: avg_loss: 3.27e-07, avg_total_loss: 3.27e-07
2025-11-05 00:22:40,201: Epoch 30 average validation loss: 8.25e-07 -- Median validation metrics: avg_loss: 8.25e-07, NSE: 0.81020, MSE: 32515.19336
2025-11-05 00:22:40,202: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:22:40,203: Early stopping triggered at epoch 30
2025-11-05 00:22:40,221: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\model_epoch030.pt
2025-11-05 00:22:40,495: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:22:40,497: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002224\validation\model_epoch030\validation_results.p
2025-11-05 00:22:41,164: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\output.log initialized.
2025-11-05 00:22:41,164: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241
2025-11-05 00:22:41,165: ### Run configurations for testing_run
2025-11-05 00:22:41,166: experiment_name: testing_run
2025-11-05 00:22:41,166: train_basin_file: calpella
2025-11-05 00:22:41,167: validation_basin_file: calpella
2025-11-05 00:22:41,168: test_basin_file: calpella
2025-11-05 00:22:41,168: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:22:41,169: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:22:41,170: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:22:41,171: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:22:41,172: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:22:41,173: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:22:41,173: device: cuda:0
2025-11-05 00:22:41,174: physics_informed: True
2025-11-05 00:22:41,175: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:22:41,176: validate_every: 5
2025-11-05 00:22:41,177: validate_n_random_basins: 1
2025-11-05 00:22:41,178: metrics: ['NSE', 'MSE']
2025-11-05 00:22:41,179: model: cudalstm
2025-11-05 00:22:41,180: head: regression
2025-11-05 00:22:41,180: output_activation: linear
2025-11-05 00:22:41,181: hidden_size: 128
2025-11-05 00:22:41,181: initial_forget_bias: 3
2025-11-05 00:22:41,182: output_dropout: 0.4
2025-11-05 00:22:41,183: num_layers: 1
2025-11-05 00:22:41,183: dev_mode: True
2025-11-05 00:22:41,184: optimizer: Adam
2025-11-05 00:22:41,185: loss: NSE
2025-11-05 00:22:41,185: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:22:41,186: batch_size: 128
2025-11-05 00:22:41,187: epochs: 48
2025-11-05 00:22:41,187: clip_gradient_norm: 1
2025-11-05 00:22:41,188: predict_last_n: 1
2025-11-05 00:22:41,188: seq_length: 120
2025-11-05 00:22:41,189: log_interval: 16
2025-11-05 00:22:41,189: log_tensorboard: True
2025-11-05 00:22:41,190: log_n_figures: 1
2025-11-05 00:22:41,191: save_weights_every: 48
2025-11-05 00:22:41,191: early_stopping: True
2025-11-05 00:22:41,192: early_stopping_mode: patience
2025-11-05 00:22:41,192: patience_early_stopping: 3
2025-11-05 00:22:41,193: min_delta_early_stopping: 0.0
2025-11-05 00:22:41,194: minimum_epochs_before_early_stopping: 10
2025-11-05 00:22:41,194: early_stopping_slope_window: 7
2025-11-05 00:22:41,195: early_stopping_slope_patience: 2
2025-11-05 00:22:41,196: early_stopping_slope_min_epoch: 8
2025-11-05 00:22:41,196: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:22:41,197: early_stopping_slope_use_log: True
2025-11-05 00:22:41,197: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:22:41,198: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:22:41,199: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:22:41,199: early_stopping_slope_variance_guard: True
2025-11-05 00:22:41,200: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:22:41,201: dataset: russian_river
2025-11-05 00:22:41,201: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:22:41,202: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:22:41,203: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:22:41,203: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:22:41,204: hourly: False
2025-11-05 00:22:41,204: is_mts: False
2025-11-05 00:22:41,205: is_mts_data: False
2025-11-05 00:22:41,206: verbose: True
2025-11-05 00:22:41,207: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241
2025-11-05 00:22:41,207: run_label: BASELINE
2025-11-05 00:22:41,208: number_of_basins: 1
2025-11-05 00:22:41,208: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\train_data
2025-11-05 00:22:41,210: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\img_log
2025-11-05 00:22:41,211: ### Device cuda:0 will be used for training
2025-11-05 00:22:41,213: Loading basin data into xarray data set.
2025-11-05 00:22:41,417: Calculating target variable stds per basin
2025-11-05 00:22:41,426: Create lookup table and convert to pytorch tensor
2025-11-05 00:22:41,554: Early stopping enabled: mode=patience
2025-11-05 00:22:41,999: Epoch 1 average loss: avg_loss: 1.96e-06, avg_total_loss: 1.96e-06
2025-11-05 00:22:42,228: Epoch 2 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:22:42,498: Epoch 3 average loss: avg_loss: 8.28e-07, avg_total_loss: 8.28e-07
2025-11-05 00:22:42,740: Epoch 4 average loss: avg_loss: 7.32e-07, avg_total_loss: 7.32e-07
2025-11-05 00:22:43,006: Epoch 5 average loss: avg_loss: 6.35e-07, avg_total_loss: 6.35e-07
2025-11-05 00:22:43,502: Epoch 5 average validation loss: 7.62e-07 -- Median validation metrics: avg_loss: 7.62e-07, NSE: 0.82482, MSE: 30011.03516
2025-11-05 00:22:43,750: Epoch 6 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:22:44,014: Epoch 7 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:22:44,282: Epoch 8 average loss: avg_loss: 5.42e-07, avg_total_loss: 5.42e-07
2025-11-05 00:22:44,525: Epoch 9 average loss: avg_loss: 6.18e-07, avg_total_loss: 6.18e-07
2025-11-05 00:22:44,793: Epoch 10 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:22:45,077: Epoch 10 average validation loss: 8.52e-07 -- Median validation metrics: avg_loss: 8.52e-07, NSE: 0.80626, MSE: 33189.84375
2025-11-05 00:22:45,315: Epoch 11 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:22:45,579: Epoch 12 average loss: avg_loss: 4.89e-07, avg_total_loss: 4.89e-07
2025-11-05 00:22:45,825: Epoch 13 average loss: avg_loss: 5.23e-07, avg_total_loss: 5.23e-07
2025-11-05 00:22:46,099: Epoch 14 average loss: avg_loss: 4.53e-07, avg_total_loss: 4.53e-07
2025-11-05 00:22:46,346: Epoch 15 average loss: avg_loss: 4.81e-07, avg_total_loss: 4.81e-07
2025-11-05 00:22:46,663: Epoch 15 average validation loss: 7.55e-07 -- Median validation metrics: avg_loss: 7.55e-07, NSE: 0.82824, MSE: 29424.84375
2025-11-05 00:22:46,896: Epoch 16 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:22:47,151: Epoch 17 average loss: avg_loss: 5.37e-07, avg_total_loss: 5.37e-07
2025-11-05 00:22:47,396: Epoch 18 average loss: avg_loss: 5.08e-07, avg_total_loss: 5.08e-07
2025-11-05 00:22:47,681: Epoch 19 average loss: avg_loss: 4.48e-07, avg_total_loss: 4.48e-07
2025-11-05 00:22:47,930: Epoch 20 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:22:48,266: Epoch 20 average validation loss: 6.60e-07 -- Median validation metrics: avg_loss: 6.60e-07, NSE: 0.84873, MSE: 25914.92383
2025-11-05 00:22:48,509: Epoch 21 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:22:48,788: Epoch 22 average loss: avg_loss: 4.86e-07, avg_total_loss: 4.86e-07
2025-11-05 00:22:49,042: Epoch 23 average loss: avg_loss: 4.43e-07, avg_total_loss: 4.43e-07
2025-11-05 00:22:49,043: Setting learning rate to 0.005
2025-11-05 00:22:49,315: Epoch 24 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:22:49,566: Epoch 25 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:22:49,887: Epoch 25 average validation loss: 7.21e-07 -- Median validation metrics: avg_loss: 7.21e-07, NSE: 0.83400, MSE: 28438.05664
2025-11-05 00:22:50,124: Epoch 26 average loss: avg_loss: 3.47e-07, avg_total_loss: 3.47e-07
2025-11-05 00:22:50,389: Epoch 27 average loss: avg_loss: 3.49e-07, avg_total_loss: 3.49e-07
2025-11-05 00:22:50,637: Epoch 28 average loss: avg_loss: 3.25e-07, avg_total_loss: 3.25e-07
2025-11-05 00:22:50,906: Epoch 29 average loss: avg_loss: 3.50e-07, avg_total_loss: 3.50e-07
2025-11-05 00:22:51,151: Epoch 30 average loss: avg_loss: 3.04e-07, avg_total_loss: 3.04e-07
2025-11-05 00:22:51,487: Epoch 30 average validation loss: 7.25e-07 -- Median validation metrics: avg_loss: 7.25e-07, NSE: 0.83315, MSE: 28584.08203
2025-11-05 00:22:51,717: Epoch 31 average loss: avg_loss: 3.52e-07, avg_total_loss: 3.52e-07
2025-11-05 00:22:51,981: Epoch 32 average loss: avg_loss: 2.91e-07, avg_total_loss: 2.91e-07
2025-11-05 00:22:52,231: Epoch 33 average loss: avg_loss: 3.28e-07, avg_total_loss: 3.28e-07
2025-11-05 00:22:52,502: Epoch 34 average loss: avg_loss: 3.00e-07, avg_total_loss: 3.00e-07
2025-11-05 00:22:52,747: Epoch 35 average loss: avg_loss: 3.31e-07, avg_total_loss: 3.31e-07
2025-11-05 00:22:53,248: Epoch 35 average validation loss: 6.78e-07 -- Median validation metrics: avg_loss: 6.78e-07, NSE: 0.84423, MSE: 26686.13281
2025-11-05 00:22:53,249: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:22:53,250: Early stopping triggered at epoch 35
2025-11-05 00:22:53,272: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\model_epoch035.pt
2025-11-05 00:22:53,556: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:22:53,557: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002241\validation\model_epoch035\validation_results.p
2025-11-05 00:22:54,318: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\output.log initialized.
2025-11-05 00:22:54,319: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254
2025-11-05 00:22:54,319: ### Run configurations for testing_run
2025-11-05 00:22:54,320: experiment_name: testing_run
2025-11-05 00:22:54,321: train_basin_file: calpella
2025-11-05 00:22:54,322: validation_basin_file: calpella
2025-11-05 00:22:54,322: test_basin_file: calpella
2025-11-05 00:22:54,323: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:22:54,324: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:22:54,325: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:22:54,325: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:22:54,326: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:22:54,327: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:22:54,327: device: cuda:0
2025-11-05 00:22:54,328: physics_informed: True
2025-11-05 00:22:54,328: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:22:54,329: validate_every: 5
2025-11-05 00:22:54,330: validate_n_random_basins: 1
2025-11-05 00:22:54,331: metrics: ['NSE', 'MSE']
2025-11-05 00:22:54,331: model: cudalstm
2025-11-05 00:22:54,332: head: regression
2025-11-05 00:22:54,332: output_activation: linear
2025-11-05 00:22:54,333: hidden_size: 128
2025-11-05 00:22:54,333: initial_forget_bias: 3
2025-11-05 00:22:54,334: output_dropout: 0.4
2025-11-05 00:22:54,335: num_layers: 1
2025-11-05 00:22:54,335: dev_mode: True
2025-11-05 00:22:54,336: optimizer: Adam
2025-11-05 00:22:54,336: loss: NSE
2025-11-05 00:22:54,337: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:22:54,338: batch_size: 256
2025-11-05 00:22:54,339: epochs: 48
2025-11-05 00:22:54,340: clip_gradient_norm: 1
2025-11-05 00:22:54,341: predict_last_n: 1
2025-11-05 00:22:54,342: seq_length: 120
2025-11-05 00:22:54,342: log_interval: 16
2025-11-05 00:22:54,343: log_tensorboard: True
2025-11-05 00:22:54,344: log_n_figures: 1
2025-11-05 00:22:54,344: save_weights_every: 48
2025-11-05 00:22:54,345: early_stopping: True
2025-11-05 00:22:54,346: early_stopping_mode: patience
2025-11-05 00:22:54,346: patience_early_stopping: 3
2025-11-05 00:22:54,347: min_delta_early_stopping: 0.0
2025-11-05 00:22:54,348: minimum_epochs_before_early_stopping: 10
2025-11-05 00:22:54,349: early_stopping_slope_window: 7
2025-11-05 00:22:54,350: early_stopping_slope_patience: 2
2025-11-05 00:22:54,350: early_stopping_slope_min_epoch: 8
2025-11-05 00:22:54,352: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:22:54,352: early_stopping_slope_use_log: True
2025-11-05 00:22:54,353: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:22:54,354: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:22:54,356: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:22:54,357: early_stopping_slope_variance_guard: True
2025-11-05 00:22:54,358: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:22:54,359: dataset: russian_river
2025-11-05 00:22:54,359: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:22:54,361: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:22:54,363: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:22:54,364: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:22:54,365: hourly: False
2025-11-05 00:22:54,367: is_mts: False
2025-11-05 00:22:54,368: is_mts_data: False
2025-11-05 00:22:54,368: verbose: True
2025-11-05 00:22:54,370: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254
2025-11-05 00:22:54,371: run_label: BASELINE
2025-11-05 00:22:54,372: number_of_basins: 1
2025-11-05 00:22:54,373: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\train_data
2025-11-05 00:22:54,374: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\img_log
2025-11-05 00:22:54,377: ### Device cuda:0 will be used for training
2025-11-05 00:22:54,379: Loading basin data into xarray data set.
2025-11-05 00:22:54,634: Calculating target variable stds per basin
2025-11-05 00:22:54,644: Create lookup table and convert to pytorch tensor
2025-11-05 00:22:54,787: Early stopping enabled: mode=patience
2025-11-05 00:22:55,171: Epoch 1 average loss: avg_loss: 2.34e-06, avg_total_loss: 2.34e-06
2025-11-05 00:22:55,339: Epoch 2 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:22:55,534: Epoch 3 average loss: avg_loss: 9.61e-07, avg_total_loss: 9.61e-07
2025-11-05 00:22:55,697: Epoch 4 average loss: avg_loss: 8.87e-07, avg_total_loss: 8.87e-07
2025-11-05 00:22:55,851: Epoch 5 average loss: avg_loss: 7.37e-07, avg_total_loss: 7.37e-07
2025-11-05 00:22:56,367: Epoch 5 average validation loss: 8.77e-07 -- Median validation metrics: avg_loss: 8.77e-07, NSE: 0.77932, MSE: 37805.67188
2025-11-05 00:22:56,531: Epoch 6 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:22:56,701: Epoch 7 average loss: avg_loss: 6.62e-07, avg_total_loss: 6.62e-07
2025-11-05 00:22:56,877: Epoch 8 average loss: avg_loss: 5.21e-07, avg_total_loss: 5.21e-07
2025-11-05 00:22:57,059: Epoch 9 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:22:57,234: Epoch 10 average loss: avg_loss: 4.98e-07, avg_total_loss: 4.98e-07
2025-11-05 00:22:57,564: Epoch 10 average validation loss: 6.25e-07 -- Median validation metrics: avg_loss: 6.25e-07, NSE: 0.84029, MSE: 27360.79102
2025-11-05 00:22:57,737: Epoch 11 average loss: avg_loss: 4.58e-07, avg_total_loss: 4.58e-07
2025-11-05 00:22:57,912: Epoch 12 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:22:58,105: Epoch 13 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:22:58,297: Epoch 14 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:22:58,468: Epoch 15 average loss: avg_loss: 4.79e-07, avg_total_loss: 4.79e-07
2025-11-05 00:22:58,744: Epoch 15 average validation loss: 6.22e-07 -- Median validation metrics: avg_loss: 6.22e-07, NSE: 0.84158, MSE: 27139.60156
2025-11-05 00:22:58,921: Epoch 16 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:22:59,091: Epoch 17 average loss: avg_loss: 4.49e-07, avg_total_loss: 4.49e-07
2025-11-05 00:22:59,256: Epoch 18 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:22:59,434: Epoch 19 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:22:59,615: Epoch 20 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:22:59,907: Epoch 20 average validation loss: 6.12e-07 -- Median validation metrics: avg_loss: 6.12e-07, NSE: 0.84434, MSE: 26665.57812
2025-11-05 00:23:00,063: Epoch 21 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:23:00,240: Epoch 22 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:23:00,407: Epoch 23 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:23:00,408: Setting learning rate to 0.005
2025-11-05 00:23:00,573: Epoch 24 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:23:00,745: Epoch 25 average loss: avg_loss: 4.10e-07, avg_total_loss: 4.10e-07
2025-11-05 00:23:01,039: Epoch 25 average validation loss: 6.57e-07 -- Median validation metrics: avg_loss: 6.57e-07, NSE: 0.83561, MSE: 28161.51758
2025-11-05 00:23:01,190: Epoch 26 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:23:01,346: Epoch 27 average loss: avg_loss: 3.45e-07, avg_total_loss: 3.45e-07
2025-11-05 00:23:01,523: Epoch 28 average loss: avg_loss: 3.60e-07, avg_total_loss: 3.60e-07
2025-11-05 00:23:01,697: Epoch 29 average loss: avg_loss: 3.38e-07, avg_total_loss: 3.38e-07
2025-11-05 00:23:01,856: Epoch 30 average loss: avg_loss: 3.66e-07, avg_total_loss: 3.66e-07
2025-11-05 00:23:02,162: Epoch 30 average validation loss: 6.32e-07 -- Median validation metrics: avg_loss: 6.32e-07, NSE: 0.83973, MSE: 27455.78711
2025-11-05 00:23:02,347: Epoch 31 average loss: avg_loss: 3.59e-07, avg_total_loss: 3.59e-07
2025-11-05 00:23:02,527: Epoch 32 average loss: avg_loss: 3.35e-07, avg_total_loss: 3.35e-07
2025-11-05 00:23:02,715: Epoch 33 average loss: avg_loss: 3.48e-07, avg_total_loss: 3.48e-07
2025-11-05 00:23:02,917: Epoch 34 average loss: avg_loss: 3.41e-07, avg_total_loss: 3.41e-07
2025-11-05 00:23:03,096: Epoch 35 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:23:03,378: Epoch 35 average validation loss: 6.55e-07 -- Median validation metrics: avg_loss: 6.55e-07, NSE: 0.83492, MSE: 28280.39453
2025-11-05 00:23:03,379: ES[patience]: STOP at epoch=35 after 3 checks without improvement
2025-11-05 00:23:03,379: Early stopping triggered at epoch 35
2025-11-05 00:23:03,397: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\model_epoch035.pt
2025-11-05 00:23:03,665: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\validation\model_epoch035\validation_metrics.csv
2025-11-05 00:23:03,666: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002254\validation\model_epoch035\validation_results.p
2025-11-05 00:23:04,374: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\output.log initialized.
2025-11-05 00:23:04,375: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304
2025-11-05 00:23:04,376: ### Run configurations for testing_run
2025-11-05 00:23:04,377: experiment_name: testing_run
2025-11-05 00:23:04,379: train_basin_file: calpella
2025-11-05 00:23:04,380: validation_basin_file: calpella
2025-11-05 00:23:04,381: test_basin_file: calpella
2025-11-05 00:23:04,381: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:23:04,381: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:23:04,382: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:23:04,383: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:23:04,383: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:23:04,384: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:23:04,385: device: cuda:0
2025-11-05 00:23:04,385: physics_informed: True
2025-11-05 00:23:04,386: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:23:04,386: validate_every: 5
2025-11-05 00:23:04,387: validate_n_random_basins: 1
2025-11-05 00:23:04,387: metrics: ['NSE', 'MSE']
2025-11-05 00:23:04,388: model: cudalstm
2025-11-05 00:23:04,389: head: regression
2025-11-05 00:23:04,389: output_activation: linear
2025-11-05 00:23:04,390: hidden_size: 256
2025-11-05 00:23:04,391: initial_forget_bias: 3
2025-11-05 00:23:04,391: output_dropout: 0.4
2025-11-05 00:23:04,392: num_layers: 1
2025-11-05 00:23:04,392: dev_mode: True
2025-11-05 00:23:04,393: optimizer: Adam
2025-11-05 00:23:04,393: loss: NSE
2025-11-05 00:23:04,394: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:23:04,395: batch_size: 64
2025-11-05 00:23:04,396: epochs: 16
2025-11-05 00:23:04,396: clip_gradient_norm: 1
2025-11-05 00:23:04,397: predict_last_n: 1
2025-11-05 00:23:04,397: seq_length: 90
2025-11-05 00:23:04,398: log_interval: 16
2025-11-05 00:23:04,399: log_tensorboard: True
2025-11-05 00:23:04,400: log_n_figures: 1
2025-11-05 00:23:04,400: save_weights_every: 16
2025-11-05 00:23:04,401: early_stopping: True
2025-11-05 00:23:04,402: early_stopping_mode: patience
2025-11-05 00:23:04,403: patience_early_stopping: 3
2025-11-05 00:23:04,403: min_delta_early_stopping: 0.0
2025-11-05 00:23:04,405: minimum_epochs_before_early_stopping: 10
2025-11-05 00:23:04,405: early_stopping_slope_window: 7
2025-11-05 00:23:04,406: early_stopping_slope_patience: 2
2025-11-05 00:23:04,407: early_stopping_slope_min_epoch: 8
2025-11-05 00:23:04,408: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:23:04,409: early_stopping_slope_use_log: True
2025-11-05 00:23:04,410: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:23:04,410: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:23:04,412: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:23:04,413: early_stopping_slope_variance_guard: True
2025-11-05 00:23:04,413: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:23:04,414: dataset: russian_river
2025-11-05 00:23:04,415: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:23:04,416: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:23:04,417: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:23:04,417: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:23:04,418: hourly: False
2025-11-05 00:23:04,419: is_mts: False
2025-11-05 00:23:04,420: is_mts_data: False
2025-11-05 00:23:04,420: verbose: True
2025-11-05 00:23:04,421: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304
2025-11-05 00:23:04,422: run_label: BASELINE
2025-11-05 00:23:04,423: number_of_basins: 1
2025-11-05 00:23:04,424: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\train_data
2025-11-05 00:23:04,425: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\img_log
2025-11-05 00:23:04,427: ### Device cuda:0 will be used for training
2025-11-05 00:23:04,428: Loading basin data into xarray data set.
2025-11-05 00:23:04,667: Calculating target variable stds per basin
2025-11-05 00:23:04,678: Create lookup table and convert to pytorch tensor
2025-11-05 00:23:04,812: Early stopping enabled: mode=patience
2025-11-05 00:23:05,426: Epoch 1 average loss: avg_loss: 3.03e-06, avg_total_loss: 3.03e-06
2025-11-05 00:23:06,026: Epoch 2 average loss: avg_loss: 1.75e-06, avg_total_loss: 1.75e-06
2025-11-05 00:23:06,674: Epoch 3 average loss: avg_loss: 1.40e-06, avg_total_loss: 1.40e-06
2025-11-05 00:23:07,298: Epoch 4 average loss: avg_loss: 1.20e-06, avg_total_loss: 1.20e-06
2025-11-05 00:23:07,945: Epoch 5 average loss: avg_loss: 1.00e-06, avg_total_loss: 1.00e-06
2025-11-05 00:23:08,475: Epoch 5 average validation loss: 6.71e-07 -- Median validation metrics: avg_loss: 6.71e-07, NSE: 0.84547, MSE: 26473.22070
2025-11-05 00:23:09,074: Epoch 6 average loss: avg_loss: 9.62e-07, avg_total_loss: 9.62e-07
2025-11-05 00:23:09,735: Epoch 7 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:23:09,735: Setting learning rate to 0.005
2025-11-05 00:23:10,380: Epoch 8 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:23:11,005: Epoch 9 average loss: avg_loss: 8.66e-07, avg_total_loss: 8.66e-07
2025-11-05 00:23:11,644: Epoch 10 average loss: avg_loss: 7.78e-07, avg_total_loss: 7.78e-07
2025-11-05 00:23:11,992: Epoch 10 average validation loss: 8.80e-07 -- Median validation metrics: avg_loss: 8.80e-07, NSE: 0.79737, MSE: 34712.75391
2025-11-05 00:23:12,649: Epoch 11 average loss: avg_loss: 6.51e-07, avg_total_loss: 6.51e-07
2025-11-05 00:23:12,650: Setting learning rate to 0.001
2025-11-05 00:23:13,234: Epoch 12 average loss: avg_loss: 6.03e-07, avg_total_loss: 6.03e-07
2025-11-05 00:23:13,845: Epoch 13 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:23:14,474: Epoch 14 average loss: avg_loss: 5.77e-07, avg_total_loss: 5.77e-07
2025-11-05 00:23:15,144: Epoch 15 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:23:15,493: Epoch 15 average validation loss: 7.74e-07 -- Median validation metrics: avg_loss: 7.74e-07, NSE: 0.82185, MSE: 30519.64453
2025-11-05 00:23:16,095: Epoch 16 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:23:16,120: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\model_epoch016.pt
2025-11-05 00:23:16,483: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:23:16,485: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002304\validation\model_epoch016\validation_results.p
2025-11-05 00:23:17,116: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\output.log initialized.
2025-11-05 00:23:17,117: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317
2025-11-05 00:23:17,117: ### Run configurations for testing_run
2025-11-05 00:23:17,118: experiment_name: testing_run
2025-11-05 00:23:17,118: train_basin_file: calpella
2025-11-05 00:23:17,119: validation_basin_file: calpella
2025-11-05 00:23:17,120: test_basin_file: calpella
2025-11-05 00:23:17,120: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:23:17,121: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:23:17,121: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:23:17,122: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:23:17,122: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:23:17,123: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:23:17,123: device: cuda:0
2025-11-05 00:23:17,124: physics_informed: True
2025-11-05 00:23:17,125: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:23:17,125: validate_every: 5
2025-11-05 00:23:17,126: validate_n_random_basins: 1
2025-11-05 00:23:17,126: metrics: ['NSE', 'MSE']
2025-11-05 00:23:17,127: model: cudalstm
2025-11-05 00:23:17,127: head: regression
2025-11-05 00:23:17,128: output_activation: linear
2025-11-05 00:23:17,128: hidden_size: 256
2025-11-05 00:23:17,129: initial_forget_bias: 3
2025-11-05 00:23:17,130: output_dropout: 0.4
2025-11-05 00:23:17,130: num_layers: 1
2025-11-05 00:23:17,131: dev_mode: True
2025-11-05 00:23:17,131: optimizer: Adam
2025-11-05 00:23:17,132: loss: NSE
2025-11-05 00:23:17,133: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:23:17,133: batch_size: 128
2025-11-05 00:23:17,134: epochs: 16
2025-11-05 00:23:17,134: clip_gradient_norm: 1
2025-11-05 00:23:17,135: predict_last_n: 1
2025-11-05 00:23:17,135: seq_length: 90
2025-11-05 00:23:17,137: log_interval: 16
2025-11-05 00:23:17,137: log_tensorboard: True
2025-11-05 00:23:17,138: log_n_figures: 1
2025-11-05 00:23:17,139: save_weights_every: 16
2025-11-05 00:23:17,139: early_stopping: True
2025-11-05 00:23:17,140: early_stopping_mode: patience
2025-11-05 00:23:17,141: patience_early_stopping: 3
2025-11-05 00:23:17,141: min_delta_early_stopping: 0.0
2025-11-05 00:23:17,142: minimum_epochs_before_early_stopping: 10
2025-11-05 00:23:17,143: early_stopping_slope_window: 7
2025-11-05 00:23:17,144: early_stopping_slope_patience: 2
2025-11-05 00:23:17,144: early_stopping_slope_min_epoch: 8
2025-11-05 00:23:17,145: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:23:17,146: early_stopping_slope_use_log: True
2025-11-05 00:23:17,148: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:23:17,150: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:23:17,151: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:23:17,152: early_stopping_slope_variance_guard: True
2025-11-05 00:23:17,152: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:23:17,153: dataset: russian_river
2025-11-05 00:23:17,155: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:23:17,156: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:23:17,156: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:23:17,157: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:23:17,158: hourly: False
2025-11-05 00:23:17,159: is_mts: False
2025-11-05 00:23:17,160: is_mts_data: False
2025-11-05 00:23:17,161: verbose: True
2025-11-05 00:23:17,162: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317
2025-11-05 00:23:17,164: run_label: BASELINE
2025-11-05 00:23:17,165: number_of_basins: 1
2025-11-05 00:23:17,167: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\train_data
2025-11-05 00:23:17,167: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\img_log
2025-11-05 00:23:17,170: ### Device cuda:0 will be used for training
2025-11-05 00:23:17,171: Loading basin data into xarray data set.
2025-11-05 00:23:17,390: Calculating target variable stds per basin
2025-11-05 00:23:17,401: Create lookup table and convert to pytorch tensor
2025-11-05 00:23:17,527: Early stopping enabled: mode=patience
2025-11-05 00:23:17,857: Epoch 1 average loss: avg_loss: 2.60e-06, avg_total_loss: 2.60e-06
2025-11-05 00:23:18,167: Epoch 2 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:23:18,477: Epoch 3 average loss: avg_loss: 8.86e-07, avg_total_loss: 8.86e-07
2025-11-05 00:23:18,815: Epoch 4 average loss: avg_loss: 7.75e-07, avg_total_loss: 7.75e-07
2025-11-05 00:23:19,134: Epoch 5 average loss: avg_loss: 6.55e-07, avg_total_loss: 6.55e-07
2025-11-05 00:23:19,687: Epoch 5 average validation loss: 8.03e-07 -- Median validation metrics: avg_loss: 8.03e-07, NSE: 0.81834, MSE: 31120.25586
2025-11-05 00:23:20,009: Epoch 6 average loss: avg_loss: 6.21e-07, avg_total_loss: 6.21e-07
2025-11-05 00:23:20,345: Epoch 7 average loss: avg_loss: 6.73e-07, avg_total_loss: 6.73e-07
2025-11-05 00:23:20,345: Setting learning rate to 0.005
2025-11-05 00:23:20,652: Epoch 8 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:23:20,998: Epoch 9 average loss: avg_loss: 6.02e-07, avg_total_loss: 6.02e-07
2025-11-05 00:23:21,288: Epoch 10 average loss: avg_loss: 5.82e-07, avg_total_loss: 5.82e-07
2025-11-05 00:23:21,630: Epoch 10 average validation loss: 6.97e-07 -- Median validation metrics: avg_loss: 6.97e-07, NSE: 0.84063, MSE: 27301.31250
2025-11-05 00:23:21,929: Epoch 11 average loss: avg_loss: 5.51e-07, avg_total_loss: 5.51e-07
2025-11-05 00:23:21,930: Setting learning rate to 0.001
2025-11-05 00:23:22,243: Epoch 12 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:23:22,540: Epoch 13 average loss: avg_loss: 4.62e-07, avg_total_loss: 4.62e-07
2025-11-05 00:23:22,874: Epoch 14 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:23:23,153: Epoch 15 average loss: avg_loss: 4.45e-07, avg_total_loss: 4.45e-07
2025-11-05 00:23:23,634: Epoch 15 average validation loss: 6.69e-07 -- Median validation metrics: avg_loss: 6.69e-07, NSE: 0.84635, MSE: 26321.41602
2025-11-05 00:23:23,918: Epoch 16 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:23:23,939: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\model_epoch016.pt
2025-11-05 00:23:24,212: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:23:24,213: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002317\validation\model_epoch016\validation_results.p
2025-11-05 00:23:24,873: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\output.log initialized.
2025-11-05 00:23:24,874: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324
2025-11-05 00:23:24,874: ### Run configurations for testing_run
2025-11-05 00:23:24,875: experiment_name: testing_run
2025-11-05 00:23:24,877: train_basin_file: calpella
2025-11-05 00:23:24,877: validation_basin_file: calpella
2025-11-05 00:23:24,879: test_basin_file: calpella
2025-11-05 00:23:24,880: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:23:24,880: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:23:24,881: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:23:24,882: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:23:24,883: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:23:24,883: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:23:24,884: device: cuda:0
2025-11-05 00:23:24,885: physics_informed: True
2025-11-05 00:23:24,885: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:23:24,886: validate_every: 5
2025-11-05 00:23:24,887: validate_n_random_basins: 1
2025-11-05 00:23:24,887: metrics: ['NSE', 'MSE']
2025-11-05 00:23:24,888: model: cudalstm
2025-11-05 00:23:24,888: head: regression
2025-11-05 00:23:24,889: output_activation: linear
2025-11-05 00:23:24,889: hidden_size: 256
2025-11-05 00:23:24,890: initial_forget_bias: 3
2025-11-05 00:23:24,891: output_dropout: 0.4
2025-11-05 00:23:24,891: num_layers: 1
2025-11-05 00:23:24,892: dev_mode: True
2025-11-05 00:23:24,893: optimizer: Adam
2025-11-05 00:23:24,893: loss: NSE
2025-11-05 00:23:24,894: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:23:24,895: batch_size: 256
2025-11-05 00:23:24,896: epochs: 16
2025-11-05 00:23:24,897: clip_gradient_norm: 1
2025-11-05 00:23:24,897: predict_last_n: 1
2025-11-05 00:23:24,898: seq_length: 90
2025-11-05 00:23:24,898: log_interval: 16
2025-11-05 00:23:24,899: log_tensorboard: True
2025-11-05 00:23:24,900: log_n_figures: 1
2025-11-05 00:23:24,901: save_weights_every: 16
2025-11-05 00:23:24,901: early_stopping: True
2025-11-05 00:23:24,902: early_stopping_mode: patience
2025-11-05 00:23:24,903: patience_early_stopping: 3
2025-11-05 00:23:24,903: min_delta_early_stopping: 0.0
2025-11-05 00:23:24,904: minimum_epochs_before_early_stopping: 10
2025-11-05 00:23:24,905: early_stopping_slope_window: 7
2025-11-05 00:23:24,905: early_stopping_slope_patience: 2
2025-11-05 00:23:24,906: early_stopping_slope_min_epoch: 8
2025-11-05 00:23:24,907: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:23:24,908: early_stopping_slope_use_log: True
2025-11-05 00:23:24,908: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:23:24,909: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:23:24,910: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:23:24,910: early_stopping_slope_variance_guard: True
2025-11-05 00:23:24,911: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:23:24,912: dataset: russian_river
2025-11-05 00:23:24,913: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:23:24,914: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:23:24,914: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:23:24,915: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:23:24,915: hourly: False
2025-11-05 00:23:24,916: is_mts: False
2025-11-05 00:23:24,917: is_mts_data: False
2025-11-05 00:23:24,918: verbose: True
2025-11-05 00:23:24,918: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324
2025-11-05 00:23:24,919: run_label: BASELINE
2025-11-05 00:23:24,920: number_of_basins: 1
2025-11-05 00:23:24,921: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\train_data
2025-11-05 00:23:24,922: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\img_log
2025-11-05 00:23:24,924: ### Device cuda:0 will be used for training
2025-11-05 00:23:24,926: Loading basin data into xarray data set.
2025-11-05 00:23:25,175: Calculating target variable stds per basin
2025-11-05 00:23:25,186: Create lookup table and convert to pytorch tensor
2025-11-05 00:23:25,324: Early stopping enabled: mode=patience
2025-11-05 00:23:25,576: Epoch 1 average loss: avg_loss: 3.54e-06, avg_total_loss: 3.54e-06
2025-11-05 00:23:25,785: Epoch 2 average loss: avg_loss: 1.35e-06, avg_total_loss: 1.35e-06
2025-11-05 00:23:25,992: Epoch 3 average loss: avg_loss: 1.08e-06, avg_total_loss: 1.08e-06
2025-11-05 00:23:26,197: Epoch 4 average loss: avg_loss: 8.42e-07, avg_total_loss: 8.42e-07
2025-11-05 00:23:26,402: Epoch 5 average loss: avg_loss: 8.19e-07, avg_total_loss: 8.19e-07
2025-11-05 00:23:26,881: Epoch 5 average validation loss: 7.66e-07 -- Median validation metrics: avg_loss: 7.66e-07, NSE: 0.81244, MSE: 32131.22461
2025-11-05 00:23:27,079: Epoch 6 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:23:27,293: Epoch 7 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:23:27,294: Setting learning rate to 0.005
2025-11-05 00:23:27,493: Epoch 8 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:23:27,696: Epoch 9 average loss: avg_loss: 6.30e-07, avg_total_loss: 6.30e-07
2025-11-05 00:23:27,897: Epoch 10 average loss: avg_loss: 6.21e-07, avg_total_loss: 6.21e-07
2025-11-05 00:23:28,164: Epoch 10 average validation loss: 6.47e-07 -- Median validation metrics: avg_loss: 6.47e-07, NSE: 0.83473, MSE: 28312.05078
2025-11-05 00:23:28,342: Epoch 11 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:23:28,343: Setting learning rate to 0.001
2025-11-05 00:23:28,541: Epoch 12 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:23:28,743: Epoch 13 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:23:28,935: Epoch 14 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:23:29,118: Epoch 15 average loss: avg_loss: 5.33e-07, avg_total_loss: 5.33e-07
2025-11-05 00:23:29,430: Epoch 15 average validation loss: 6.16e-07 -- Median validation metrics: avg_loss: 6.16e-07, NSE: 0.84363, MSE: 26788.81641
2025-11-05 00:23:29,610: Epoch 16 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:23:29,630: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\model_epoch016.pt
2025-11-05 00:23:29,882: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:23:29,883: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002324\validation\model_epoch016\validation_results.p
2025-11-05 00:23:30,549: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\output.log initialized.
2025-11-05 00:23:30,550: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330
2025-11-05 00:23:30,550: ### Run configurations for testing_run
2025-11-05 00:23:30,551: experiment_name: testing_run
2025-11-05 00:23:30,552: train_basin_file: calpella
2025-11-05 00:23:30,553: validation_basin_file: calpella
2025-11-05 00:23:30,554: test_basin_file: calpella
2025-11-05 00:23:30,554: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:23:30,555: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:23:30,557: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:23:30,557: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:23:30,558: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:23:30,559: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:23:30,560: device: cuda:0
2025-11-05 00:23:30,561: physics_informed: True
2025-11-05 00:23:30,562: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:23:30,563: validate_every: 5
2025-11-05 00:23:30,564: validate_n_random_basins: 1
2025-11-05 00:23:30,564: metrics: ['NSE', 'MSE']
2025-11-05 00:23:30,565: model: cudalstm
2025-11-05 00:23:30,566: head: regression
2025-11-05 00:23:30,566: output_activation: linear
2025-11-05 00:23:30,567: hidden_size: 256
2025-11-05 00:23:30,567: initial_forget_bias: 3
2025-11-05 00:23:30,568: output_dropout: 0.4
2025-11-05 00:23:30,569: num_layers: 1
2025-11-05 00:23:30,570: dev_mode: True
2025-11-05 00:23:30,570: optimizer: Adam
2025-11-05 00:23:30,571: loss: NSE
2025-11-05 00:23:30,572: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:23:30,573: batch_size: 64
2025-11-05 00:23:30,573: epochs: 32
2025-11-05 00:23:30,574: clip_gradient_norm: 1
2025-11-05 00:23:30,575: predict_last_n: 1
2025-11-05 00:23:30,575: seq_length: 90
2025-11-05 00:23:30,576: log_interval: 16
2025-11-05 00:23:30,577: log_tensorboard: True
2025-11-05 00:23:30,578: log_n_figures: 1
2025-11-05 00:23:30,579: save_weights_every: 32
2025-11-05 00:23:30,579: early_stopping: True
2025-11-05 00:23:30,580: early_stopping_mode: patience
2025-11-05 00:23:30,580: patience_early_stopping: 3
2025-11-05 00:23:30,581: min_delta_early_stopping: 0.0
2025-11-05 00:23:30,581: minimum_epochs_before_early_stopping: 10
2025-11-05 00:23:30,582: early_stopping_slope_window: 7
2025-11-05 00:23:30,583: early_stopping_slope_patience: 2
2025-11-05 00:23:30,584: early_stopping_slope_min_epoch: 8
2025-11-05 00:23:30,584: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:23:30,585: early_stopping_slope_use_log: True
2025-11-05 00:23:30,585: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:23:30,586: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:23:30,587: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:23:30,587: early_stopping_slope_variance_guard: True
2025-11-05 00:23:30,588: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:23:30,589: dataset: russian_river
2025-11-05 00:23:30,589: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:23:30,590: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:23:30,591: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:23:30,591: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:23:30,592: hourly: False
2025-11-05 00:23:30,593: is_mts: False
2025-11-05 00:23:30,593: is_mts_data: False
2025-11-05 00:23:30,594: verbose: True
2025-11-05 00:23:30,594: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330
2025-11-05 00:23:30,595: run_label: BASELINE
2025-11-05 00:23:30,596: number_of_basins: 1
2025-11-05 00:23:30,596: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\train_data
2025-11-05 00:23:30,597: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\img_log
2025-11-05 00:23:30,598: ### Device cuda:0 will be used for training
2025-11-05 00:23:30,599: Loading basin data into xarray data set.
2025-11-05 00:23:30,846: Calculating target variable stds per basin
2025-11-05 00:23:30,855: Create lookup table and convert to pytorch tensor
2025-11-05 00:23:30,984: Early stopping enabled: mode=patience
2025-11-05 00:23:31,612: Epoch 1 average loss: avg_loss: 2.14e-06, avg_total_loss: 2.14e-06
2025-11-05 00:23:32,176: Epoch 2 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:23:32,761: Epoch 3 average loss: avg_loss: 1.19e-06, avg_total_loss: 1.19e-06
2025-11-05 00:23:33,341: Epoch 4 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:23:33,933: Epoch 5 average loss: avg_loss: 1.36e-06, avg_total_loss: 1.36e-06
2025-11-05 00:23:34,458: Epoch 5 average validation loss: 1.07e-06 -- Median validation metrics: avg_loss: 1.07e-06, NSE: 0.76204, MSE: 40765.76172
2025-11-05 00:23:35,018: Epoch 6 average loss: avg_loss: 1.05e-06, avg_total_loss: 1.05e-06
2025-11-05 00:23:35,609: Epoch 7 average loss: avg_loss: 9.04e-07, avg_total_loss: 9.04e-07
2025-11-05 00:23:36,191: Epoch 8 average loss: avg_loss: 8.02e-07, avg_total_loss: 8.02e-07
2025-11-05 00:23:36,775: Epoch 9 average loss: avg_loss: 7.91e-07, avg_total_loss: 7.91e-07
2025-11-05 00:23:37,353: Epoch 10 average loss: avg_loss: 7.73e-07, avg_total_loss: 7.73e-07
2025-11-05 00:23:37,671: Epoch 10 average validation loss: 8.61e-07 -- Median validation metrics: avg_loss: 8.61e-07, NSE: 0.80229, MSE: 33870.07812
2025-11-05 00:23:38,239: Epoch 11 average loss: avg_loss: 7.55e-07, avg_total_loss: 7.55e-07
2025-11-05 00:23:38,835: Epoch 12 average loss: avg_loss: 7.61e-07, avg_total_loss: 7.61e-07
2025-11-05 00:23:39,469: Epoch 13 average loss: avg_loss: 7.68e-07, avg_total_loss: 7.68e-07
2025-11-05 00:23:40,118: Epoch 14 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:23:40,733: Epoch 15 average loss: avg_loss: 7.01e-07, avg_total_loss: 7.01e-07
2025-11-05 00:23:41,098: Epoch 15 average validation loss: 7.92e-07 -- Median validation metrics: avg_loss: 7.92e-07, NSE: 0.81850, MSE: 31092.60938
2025-11-05 00:23:41,099: Setting learning rate to 0.005
2025-11-05 00:23:41,673: Epoch 16 average loss: avg_loss: 6.43e-07, avg_total_loss: 6.43e-07
2025-11-05 00:23:42,291: Epoch 17 average loss: avg_loss: 6.31e-07, avg_total_loss: 6.31e-07
2025-11-05 00:23:42,882: Epoch 18 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:23:43,479: Epoch 19 average loss: avg_loss: 5.99e-07, avg_total_loss: 5.99e-07
2025-11-05 00:23:44,069: Epoch 20 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:23:44,370: Epoch 20 average validation loss: 7.34e-07 -- Median validation metrics: avg_loss: 7.34e-07, NSE: 0.83088, MSE: 28972.76562
2025-11-05 00:23:44,931: Epoch 21 average loss: avg_loss: 5.62e-07, avg_total_loss: 5.62e-07
2025-11-05 00:23:45,526: Epoch 22 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:23:46,112: Epoch 23 average loss: avg_loss: 5.61e-07, avg_total_loss: 5.61e-07
2025-11-05 00:23:46,112: Setting learning rate to 0.001
2025-11-05 00:23:46,759: Epoch 24 average loss: avg_loss: 5.11e-07, avg_total_loss: 5.11e-07
2025-11-05 00:23:47,428: Epoch 25 average loss: avg_loss: 4.99e-07, avg_total_loss: 4.99e-07
2025-11-05 00:23:47,770: Epoch 25 average validation loss: 7.15e-07 -- Median validation metrics: avg_loss: 7.15e-07, NSE: 0.83603, MSE: 28090.10156
2025-11-05 00:23:48,344: Epoch 26 average loss: avg_loss: 4.73e-07, avg_total_loss: 4.73e-07
2025-11-05 00:23:48,939: Epoch 27 average loss: avg_loss: 4.52e-07, avg_total_loss: 4.52e-07
2025-11-05 00:23:49,547: Epoch 28 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:23:50,137: Epoch 29 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:23:50,739: Epoch 30 average loss: avg_loss: 4.31e-07, avg_total_loss: 4.31e-07
2025-11-05 00:23:51,092: Epoch 30 average validation loss: 6.92e-07 -- Median validation metrics: avg_loss: 6.92e-07, NSE: 0.84093, MSE: 27251.11133
2025-11-05 00:23:51,658: Epoch 31 average loss: avg_loss: 4.39e-07, avg_total_loss: 4.39e-07
2025-11-05 00:23:52,250: Epoch 32 average loss: avg_loss: 4.42e-07, avg_total_loss: 4.42e-07
2025-11-05 00:23:52,274: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\model_epoch032.pt
2025-11-05 00:23:52,582: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:23:52,583: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002330\validation\model_epoch032\validation_results.p
2025-11-05 00:23:53,262: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\output.log initialized.
2025-11-05 00:23:53,262: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353
2025-11-05 00:23:53,263: ### Run configurations for testing_run
2025-11-05 00:23:53,264: experiment_name: testing_run
2025-11-05 00:23:53,265: train_basin_file: calpella
2025-11-05 00:23:53,266: validation_basin_file: calpella
2025-11-05 00:23:53,266: test_basin_file: calpella
2025-11-05 00:23:53,267: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:23:53,268: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:23:53,269: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:23:53,269: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:23:53,270: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:23:53,271: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:23:53,271: device: cuda:0
2025-11-05 00:23:53,272: physics_informed: True
2025-11-05 00:23:53,273: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:23:53,274: validate_every: 5
2025-11-05 00:23:53,275: validate_n_random_basins: 1
2025-11-05 00:23:53,275: metrics: ['NSE', 'MSE']
2025-11-05 00:23:53,276: model: cudalstm
2025-11-05 00:23:53,277: head: regression
2025-11-05 00:23:53,277: output_activation: linear
2025-11-05 00:23:53,278: hidden_size: 256
2025-11-05 00:23:53,279: initial_forget_bias: 3
2025-11-05 00:23:53,280: output_dropout: 0.4
2025-11-05 00:23:53,280: num_layers: 1
2025-11-05 00:23:53,281: dev_mode: True
2025-11-05 00:23:53,281: optimizer: Adam
2025-11-05 00:23:53,282: loss: NSE
2025-11-05 00:23:53,283: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:23:53,284: batch_size: 128
2025-11-05 00:23:53,284: epochs: 32
2025-11-05 00:23:53,285: clip_gradient_norm: 1
2025-11-05 00:23:53,286: predict_last_n: 1
2025-11-05 00:23:53,286: seq_length: 90
2025-11-05 00:23:53,287: log_interval: 16
2025-11-05 00:23:53,288: log_tensorboard: True
2025-11-05 00:23:53,289: log_n_figures: 1
2025-11-05 00:23:53,290: save_weights_every: 32
2025-11-05 00:23:53,291: early_stopping: True
2025-11-05 00:23:53,291: early_stopping_mode: patience
2025-11-05 00:23:53,292: patience_early_stopping: 3
2025-11-05 00:23:53,292: min_delta_early_stopping: 0.0
2025-11-05 00:23:53,293: minimum_epochs_before_early_stopping: 10
2025-11-05 00:23:53,294: early_stopping_slope_window: 7
2025-11-05 00:23:53,295: early_stopping_slope_patience: 2
2025-11-05 00:23:53,295: early_stopping_slope_min_epoch: 8
2025-11-05 00:23:53,296: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:23:53,297: early_stopping_slope_use_log: True
2025-11-05 00:23:53,297: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:23:53,298: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:23:53,299: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:23:53,299: early_stopping_slope_variance_guard: True
2025-11-05 00:23:53,300: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:23:53,301: dataset: russian_river
2025-11-05 00:23:53,301: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:23:53,302: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:23:53,303: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:23:53,303: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:23:53,304: hourly: False
2025-11-05 00:23:53,305: is_mts: False
2025-11-05 00:23:53,305: is_mts_data: False
2025-11-05 00:23:53,306: verbose: True
2025-11-05 00:23:53,307: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353
2025-11-05 00:23:53,307: run_label: BASELINE
2025-11-05 00:23:53,308: number_of_basins: 1
2025-11-05 00:23:53,309: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\train_data
2025-11-05 00:23:53,309: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\img_log
2025-11-05 00:23:53,311: ### Device cuda:0 will be used for training
2025-11-05 00:23:53,312: Loading basin data into xarray data set.
2025-11-05 00:23:53,558: Calculating target variable stds per basin
2025-11-05 00:23:53,570: Create lookup table and convert to pytorch tensor
2025-11-05 00:23:53,713: Early stopping enabled: mode=patience
2025-11-05 00:23:54,156: Epoch 1 average loss: avg_loss: 2.65e-06, avg_total_loss: 2.65e-06
2025-11-05 00:23:54,483: Epoch 2 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:23:54,791: Epoch 3 average loss: avg_loss: 7.91e-07, avg_total_loss: 7.91e-07
2025-11-05 00:23:55,109: Epoch 4 average loss: avg_loss: 7.38e-07, avg_total_loss: 7.38e-07
2025-11-05 00:23:55,431: Epoch 5 average loss: avg_loss: 6.84e-07, avg_total_loss: 6.84e-07
2025-11-05 00:23:55,939: Epoch 5 average validation loss: 7.69e-07 -- Median validation metrics: avg_loss: 7.69e-07, NSE: 0.82518, MSE: 29947.94727
2025-11-05 00:23:56,218: Epoch 6 average loss: avg_loss: 6.24e-07, avg_total_loss: 6.24e-07
2025-11-05 00:23:56,527: Epoch 7 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:23:56,815: Epoch 8 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:23:57,139: Epoch 9 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:23:57,427: Epoch 10 average loss: avg_loss: 5.24e-07, avg_total_loss: 5.24e-07
2025-11-05 00:23:57,706: Epoch 10 average validation loss: 8.10e-07 -- Median validation metrics: avg_loss: 8.10e-07, NSE: 0.81451, MSE: 31776.56250
2025-11-05 00:23:58,021: Epoch 11 average loss: avg_loss: 5.57e-07, avg_total_loss: 5.57e-07
2025-11-05 00:23:58,318: Epoch 12 average loss: avg_loss: 5.85e-07, avg_total_loss: 5.85e-07
2025-11-05 00:23:58,637: Epoch 13 average loss: avg_loss: 6.22e-07, avg_total_loss: 6.22e-07
2025-11-05 00:23:58,972: Epoch 14 average loss: avg_loss: 6.27e-07, avg_total_loss: 6.27e-07
2025-11-05 00:23:59,285: Epoch 15 average loss: avg_loss: 5.13e-07, avg_total_loss: 5.13e-07
2025-11-05 00:23:59,593: Epoch 15 average validation loss: 7.11e-07 -- Median validation metrics: avg_loss: 7.11e-07, NSE: 0.83692, MSE: 27936.87500
2025-11-05 00:23:59,594: Setting learning rate to 0.005
2025-11-05 00:23:59,908: Epoch 16 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:24:00,216: Epoch 17 average loss: avg_loss: 4.11e-07, avg_total_loss: 4.11e-07
2025-11-05 00:24:00,546: Epoch 18 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:24:00,859: Epoch 19 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:24:01,172: Epoch 20 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:24:01,461: Epoch 20 average validation loss: 6.57e-07 -- Median validation metrics: avg_loss: 6.57e-07, NSE: 0.84882, MSE: 25899.74023
2025-11-05 00:24:01,765: Epoch 21 average loss: avg_loss: 4.16e-07, avg_total_loss: 4.16e-07
2025-11-05 00:24:02,059: Epoch 22 average loss: avg_loss: 4.41e-07, avg_total_loss: 4.41e-07
2025-11-05 00:24:02,378: Epoch 23 average loss: avg_loss: 4.35e-07, avg_total_loss: 4.35e-07
2025-11-05 00:24:02,379: Setting learning rate to 0.001
2025-11-05 00:24:02,659: Epoch 24 average loss: avg_loss: 4.00e-07, avg_total_loss: 4.00e-07
2025-11-05 00:24:02,985: Epoch 25 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:24:03,269: Epoch 25 average validation loss: 6.76e-07 -- Median validation metrics: avg_loss: 6.76e-07, NSE: 0.84504, MSE: 26546.86719
2025-11-05 00:24:03,570: Epoch 26 average loss: avg_loss: 4.27e-07, avg_total_loss: 4.27e-07
2025-11-05 00:24:03,865: Epoch 27 average loss: avg_loss: 3.74e-07, avg_total_loss: 3.74e-07
2025-11-05 00:24:04,182: Epoch 28 average loss: avg_loss: 3.85e-07, avg_total_loss: 3.85e-07
2025-11-05 00:24:04,473: Epoch 29 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:24:04,807: Epoch 30 average loss: avg_loss: 3.65e-07, avg_total_loss: 3.65e-07
2025-11-05 00:24:05,207: Epoch 30 average validation loss: 6.93e-07 -- Median validation metrics: avg_loss: 6.93e-07, NSE: 0.84094, MSE: 27249.37500
2025-11-05 00:24:05,497: Epoch 31 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:24:05,790: Epoch 32 average loss: avg_loss: 3.72e-07, avg_total_loss: 3.72e-07
2025-11-05 00:24:05,812: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\model_epoch032.pt
2025-11-05 00:24:06,085: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:24:06,087: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002353\validation\model_epoch032\validation_results.p
2025-11-05 00:24:06,768: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\output.log initialized.
2025-11-05 00:24:06,769: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406
2025-11-05 00:24:06,770: ### Run configurations for testing_run
2025-11-05 00:24:06,770: experiment_name: testing_run
2025-11-05 00:24:06,771: train_basin_file: calpella
2025-11-05 00:24:06,772: validation_basin_file: calpella
2025-11-05 00:24:06,772: test_basin_file: calpella
2025-11-05 00:24:06,773: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:24:06,774: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:24:06,774: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:24:06,775: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:24:06,776: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:24:06,776: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:24:06,777: device: cuda:0
2025-11-05 00:24:06,777: physics_informed: True
2025-11-05 00:24:06,778: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:24:06,778: validate_every: 5
2025-11-05 00:24:06,779: validate_n_random_basins: 1
2025-11-05 00:24:06,780: metrics: ['NSE', 'MSE']
2025-11-05 00:24:06,780: model: cudalstm
2025-11-05 00:24:06,781: head: regression
2025-11-05 00:24:06,781: output_activation: linear
2025-11-05 00:24:06,782: hidden_size: 256
2025-11-05 00:24:06,783: initial_forget_bias: 3
2025-11-05 00:24:06,783: output_dropout: 0.4
2025-11-05 00:24:06,784: num_layers: 1
2025-11-05 00:24:06,784: dev_mode: True
2025-11-05 00:24:06,785: optimizer: Adam
2025-11-05 00:24:06,786: loss: NSE
2025-11-05 00:24:06,786: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:24:06,787: batch_size: 256
2025-11-05 00:24:06,787: epochs: 32
2025-11-05 00:24:06,788: clip_gradient_norm: 1
2025-11-05 00:24:06,788: predict_last_n: 1
2025-11-05 00:24:06,789: seq_length: 90
2025-11-05 00:24:06,789: log_interval: 16
2025-11-05 00:24:06,789: log_tensorboard: True
2025-11-05 00:24:06,790: log_n_figures: 1
2025-11-05 00:24:06,791: save_weights_every: 32
2025-11-05 00:24:06,791: early_stopping: True
2025-11-05 00:24:06,792: early_stopping_mode: patience
2025-11-05 00:24:06,792: patience_early_stopping: 3
2025-11-05 00:24:06,793: min_delta_early_stopping: 0.0
2025-11-05 00:24:06,794: minimum_epochs_before_early_stopping: 10
2025-11-05 00:24:06,795: early_stopping_slope_window: 7
2025-11-05 00:24:06,796: early_stopping_slope_patience: 2
2025-11-05 00:24:06,796: early_stopping_slope_min_epoch: 8
2025-11-05 00:24:06,797: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:24:06,797: early_stopping_slope_use_log: True
2025-11-05 00:24:06,798: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:24:06,798: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:24:06,799: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:24:06,800: early_stopping_slope_variance_guard: True
2025-11-05 00:24:06,801: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:24:06,802: dataset: russian_river
2025-11-05 00:24:06,802: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:24:06,803: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:24:06,803: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:24:06,804: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:24:06,805: hourly: False
2025-11-05 00:24:06,805: is_mts: False
2025-11-05 00:24:06,806: is_mts_data: False
2025-11-05 00:24:06,807: verbose: True
2025-11-05 00:24:06,807: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406
2025-11-05 00:24:06,808: run_label: BASELINE
2025-11-05 00:24:06,809: number_of_basins: 1
2025-11-05 00:24:06,810: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\train_data
2025-11-05 00:24:06,811: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\img_log
2025-11-05 00:24:06,813: ### Device cuda:0 will be used for training
2025-11-05 00:24:06,814: Loading basin data into xarray data set.
2025-11-05 00:24:07,045: Calculating target variable stds per basin
2025-11-05 00:24:07,054: Create lookup table and convert to pytorch tensor
2025-11-05 00:24:07,184: Early stopping enabled: mode=patience
2025-11-05 00:24:07,376: Epoch 1 average loss: avg_loss: 3.51e-06, avg_total_loss: 3.51e-06
2025-11-05 00:24:07,571: Epoch 2 average loss: avg_loss: 1.40e-06, avg_total_loss: 1.40e-06
2025-11-05 00:24:07,784: Epoch 3 average loss: avg_loss: 1.03e-06, avg_total_loss: 1.03e-06
2025-11-05 00:24:07,986: Epoch 4 average loss: avg_loss: 9.01e-07, avg_total_loss: 9.01e-07
2025-11-05 00:24:08,179: Epoch 5 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:24:08,636: Epoch 5 average validation loss: 7.04e-07 -- Median validation metrics: avg_loss: 7.04e-07, NSE: 0.82018, MSE: 30806.19922
2025-11-05 00:24:08,838: Epoch 6 average loss: avg_loss: 7.02e-07, avg_total_loss: 7.02e-07
2025-11-05 00:24:09,028: Epoch 7 average loss: avg_loss: 6.30e-07, avg_total_loss: 6.30e-07
2025-11-05 00:24:09,216: Epoch 8 average loss: avg_loss: 5.99e-07, avg_total_loss: 5.99e-07
2025-11-05 00:24:09,408: Epoch 9 average loss: avg_loss: 8.14e-07, avg_total_loss: 8.14e-07
2025-11-05 00:24:09,613: Epoch 10 average loss: avg_loss: 6.59e-07, avg_total_loss: 6.59e-07
2025-11-05 00:24:09,886: Epoch 10 average validation loss: 6.87e-07 -- Median validation metrics: avg_loss: 6.87e-07, NSE: 0.82537, MSE: 29916.15039
2025-11-05 00:24:10,070: Epoch 11 average loss: avg_loss: 5.84e-07, avg_total_loss: 5.84e-07
2025-11-05 00:24:10,262: Epoch 12 average loss: avg_loss: 6.07e-07, avg_total_loss: 6.07e-07
2025-11-05 00:24:10,467: Epoch 13 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:24:10,664: Epoch 14 average loss: avg_loss: 5.49e-07, avg_total_loss: 5.49e-07
2025-11-05 00:24:10,852: Epoch 15 average loss: avg_loss: 5.46e-07, avg_total_loss: 5.46e-07
2025-11-05 00:24:11,133: Epoch 15 average validation loss: 6.91e-07 -- Median validation metrics: avg_loss: 6.91e-07, NSE: 0.82340, MSE: 30253.05859
2025-11-05 00:24:11,134: Setting learning rate to 0.005
2025-11-05 00:24:11,313: Epoch 16 average loss: avg_loss: 4.81e-07, avg_total_loss: 4.81e-07
2025-11-05 00:24:11,498: Epoch 17 average loss: avg_loss: 4.87e-07, avg_total_loss: 4.87e-07
2025-11-05 00:24:11,686: Epoch 18 average loss: avg_loss: 4.38e-07, avg_total_loss: 4.38e-07
2025-11-05 00:24:11,905: Epoch 19 average loss: avg_loss: 4.94e-07, avg_total_loss: 4.94e-07
2025-11-05 00:24:12,096: Epoch 20 average loss: avg_loss: 4.71e-07, avg_total_loss: 4.71e-07
2025-11-05 00:24:12,330: Epoch 20 average validation loss: 6.65e-07 -- Median validation metrics: avg_loss: 6.65e-07, NSE: 0.83085, MSE: 28977.36719
2025-11-05 00:24:12,522: Epoch 21 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:24:12,722: Epoch 22 average loss: avg_loss: 4.75e-07, avg_total_loss: 4.75e-07
2025-11-05 00:24:12,916: Epoch 23 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:24:12,917: Setting learning rate to 0.001
2025-11-05 00:24:13,120: Epoch 24 average loss: avg_loss: 4.35e-07, avg_total_loss: 4.35e-07
2025-11-05 00:24:13,318: Epoch 25 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:24:13,574: Epoch 25 average validation loss: 6.47e-07 -- Median validation metrics: avg_loss: 6.47e-07, NSE: 0.83602, MSE: 28091.80859
2025-11-05 00:24:13,758: Epoch 26 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:24:13,960: Epoch 27 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:24:14,176: Epoch 28 average loss: avg_loss: 4.12e-07, avg_total_loss: 4.12e-07
2025-11-05 00:24:14,373: Epoch 29 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:24:14,577: Epoch 30 average loss: avg_loss: 3.96e-07, avg_total_loss: 3.96e-07
2025-11-05 00:24:14,908: Epoch 30 average validation loss: 6.55e-07 -- Median validation metrics: avg_loss: 6.55e-07, NSE: 0.83493, MSE: 28278.81250
2025-11-05 00:24:15,101: Epoch 31 average loss: avg_loss: 3.88e-07, avg_total_loss: 3.88e-07
2025-11-05 00:24:15,301: Epoch 32 average loss: avg_loss: 4.02e-07, avg_total_loss: 4.02e-07
2025-11-05 00:24:15,323: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\model_epoch032.pt
2025-11-05 00:24:15,593: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:24:15,595: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002406\validation\model_epoch032\validation_results.p
2025-11-05 00:24:16,259: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\output.log initialized.
2025-11-05 00:24:16,260: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416
2025-11-05 00:24:16,260: ### Run configurations for testing_run
2025-11-05 00:24:16,261: experiment_name: testing_run
2025-11-05 00:24:16,262: train_basin_file: calpella
2025-11-05 00:24:16,263: validation_basin_file: calpella
2025-11-05 00:24:16,264: test_basin_file: calpella
2025-11-05 00:24:16,265: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:24:16,267: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:24:16,268: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:24:16,269: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:24:16,270: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:24:16,271: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:24:16,272: device: cuda:0
2025-11-05 00:24:16,274: physics_informed: True
2025-11-05 00:24:16,274: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:24:16,275: validate_every: 5
2025-11-05 00:24:16,276: validate_n_random_basins: 1
2025-11-05 00:24:16,277: metrics: ['NSE', 'MSE']
2025-11-05 00:24:16,278: model: cudalstm
2025-11-05 00:24:16,278: head: regression
2025-11-05 00:24:16,279: output_activation: linear
2025-11-05 00:24:16,280: hidden_size: 256
2025-11-05 00:24:16,281: initial_forget_bias: 3
2025-11-05 00:24:16,281: output_dropout: 0.4
2025-11-05 00:24:16,282: num_layers: 1
2025-11-05 00:24:16,282: dev_mode: True
2025-11-05 00:24:16,283: optimizer: Adam
2025-11-05 00:24:16,284: loss: NSE
2025-11-05 00:24:16,285: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:24:16,286: batch_size: 64
2025-11-05 00:24:16,287: epochs: 48
2025-11-05 00:24:16,287: clip_gradient_norm: 1
2025-11-05 00:24:16,288: predict_last_n: 1
2025-11-05 00:24:16,289: seq_length: 90
2025-11-05 00:24:16,290: log_interval: 16
2025-11-05 00:24:16,291: log_tensorboard: True
2025-11-05 00:24:16,291: log_n_figures: 1
2025-11-05 00:24:16,292: save_weights_every: 48
2025-11-05 00:24:16,293: early_stopping: True
2025-11-05 00:24:16,293: early_stopping_mode: patience
2025-11-05 00:24:16,294: patience_early_stopping: 3
2025-11-05 00:24:16,295: min_delta_early_stopping: 0.0
2025-11-05 00:24:16,295: minimum_epochs_before_early_stopping: 10
2025-11-05 00:24:16,296: early_stopping_slope_window: 7
2025-11-05 00:24:16,297: early_stopping_slope_patience: 2
2025-11-05 00:24:16,297: early_stopping_slope_min_epoch: 8
2025-11-05 00:24:16,298: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:24:16,299: early_stopping_slope_use_log: True
2025-11-05 00:24:16,299: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:24:16,300: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:24:16,301: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:24:16,301: early_stopping_slope_variance_guard: True
2025-11-05 00:24:16,302: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:24:16,303: dataset: russian_river
2025-11-05 00:24:16,303: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:24:16,304: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:24:16,305: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:24:16,305: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:24:16,305: hourly: False
2025-11-05 00:24:16,306: is_mts: False
2025-11-05 00:24:16,307: is_mts_data: False
2025-11-05 00:24:16,308: verbose: True
2025-11-05 00:24:16,309: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416
2025-11-05 00:24:16,310: run_label: BASELINE
2025-11-05 00:24:16,310: number_of_basins: 1
2025-11-05 00:24:16,311: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\train_data
2025-11-05 00:24:16,312: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\img_log
2025-11-05 00:24:16,315: ### Device cuda:0 will be used for training
2025-11-05 00:24:16,317: Loading basin data into xarray data set.
2025-11-05 00:24:16,551: Calculating target variable stds per basin
2025-11-05 00:24:16,562: Create lookup table and convert to pytorch tensor
2025-11-05 00:24:16,689: Early stopping enabled: mode=patience
2025-11-05 00:24:17,291: Epoch 1 average loss: avg_loss: 1.74e-06, avg_total_loss: 1.74e-06
2025-11-05 00:24:17,893: Epoch 2 average loss: avg_loss: 8.25e-07, avg_total_loss: 8.25e-07
2025-11-05 00:24:18,498: Epoch 3 average loss: avg_loss: 7.16e-07, avg_total_loss: 7.16e-07
2025-11-05 00:24:19,090: Epoch 4 average loss: avg_loss: 7.27e-07, avg_total_loss: 7.27e-07
2025-11-05 00:24:19,699: Epoch 5 average loss: avg_loss: 8.20e-07, avg_total_loss: 8.20e-07
2025-11-05 00:24:20,278: Epoch 5 average validation loss: 1.09e-06 -- Median validation metrics: avg_loss: 1.09e-06, NSE: 0.75132, MSE: 42601.69141
2025-11-05 00:24:20,883: Epoch 6 average loss: avg_loss: 1.50e-06, avg_total_loss: 1.50e-06
2025-11-05 00:24:21,530: Epoch 7 average loss: avg_loss: 8.31e-07, avg_total_loss: 8.31e-07
2025-11-05 00:24:22,157: Epoch 8 average loss: avg_loss: 6.74e-07, avg_total_loss: 6.74e-07
2025-11-05 00:24:22,788: Epoch 9 average loss: avg_loss: 7.70e-07, avg_total_loss: 7.70e-07
2025-11-05 00:24:23,527: Epoch 10 average loss: avg_loss: 6.29e-07, avg_total_loss: 6.29e-07
2025-11-05 00:24:23,907: Epoch 10 average validation loss: 7.25e-07 -- Median validation metrics: avg_loss: 7.25e-07, NSE: 0.83359, MSE: 28508.53320
2025-11-05 00:24:24,564: Epoch 11 average loss: avg_loss: 7.59e-07, avg_total_loss: 7.59e-07
2025-11-05 00:24:25,152: Epoch 12 average loss: avg_loss: 8.32e-07, avg_total_loss: 8.32e-07
2025-11-05 00:24:25,798: Epoch 13 average loss: avg_loss: 8.15e-07, avg_total_loss: 8.15e-07
2025-11-05 00:24:26,434: Epoch 14 average loss: avg_loss: 7.78e-07, avg_total_loss: 7.78e-07
2025-11-05 00:24:27,062: Epoch 15 average loss: avg_loss: 6.25e-07, avg_total_loss: 6.25e-07
2025-11-05 00:24:27,435: Epoch 15 average validation loss: 8.45e-07 -- Median validation metrics: avg_loss: 8.45e-07, NSE: 0.80756, MSE: 32967.76562
2025-11-05 00:24:28,061: Epoch 16 average loss: avg_loss: 7.47e-07, avg_total_loss: 7.47e-07
2025-11-05 00:24:28,688: Epoch 17 average loss: avg_loss: 6.79e-07, avg_total_loss: 6.79e-07
2025-11-05 00:24:29,316: Epoch 18 average loss: avg_loss: 6.95e-07, avg_total_loss: 6.95e-07
2025-11-05 00:24:29,935: Epoch 19 average loss: avg_loss: 7.58e-07, avg_total_loss: 7.58e-07
2025-11-05 00:24:30,632: Epoch 20 average loss: avg_loss: 5.81e-07, avg_total_loss: 5.81e-07
2025-11-05 00:24:30,972: Epoch 20 average validation loss: 8.54e-07 -- Median validation metrics: avg_loss: 8.54e-07, NSE: 0.80328, MSE: 33701.17578
2025-11-05 00:24:31,592: Epoch 21 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:24:32,234: Epoch 22 average loss: avg_loss: 6.18e-07, avg_total_loss: 6.18e-07
2025-11-05 00:24:32,837: Epoch 23 average loss: avg_loss: 4.97e-07, avg_total_loss: 4.97e-07
2025-11-05 00:24:32,838: Setting learning rate to 0.005
2025-11-05 00:24:33,503: Epoch 24 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:24:34,103: Epoch 25 average loss: avg_loss: 5.01e-07, avg_total_loss: 5.01e-07
2025-11-05 00:24:34,433: Epoch 25 average validation loss: 8.65e-07 -- Median validation metrics: avg_loss: 8.65e-07, NSE: 0.80378, MSE: 33614.05078
2025-11-05 00:24:34,434: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:24:34,435: Early stopping triggered at epoch 25
2025-11-05 00:24:34,455: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\model_epoch025.pt
2025-11-05 00:24:34,751: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:24:34,753: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002416\validation\model_epoch025\validation_results.p
2025-11-05 00:24:35,414: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\output.log initialized.
2025-11-05 00:24:35,415: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435
2025-11-05 00:24:35,415: ### Run configurations for testing_run
2025-11-05 00:24:35,416: experiment_name: testing_run
2025-11-05 00:24:35,417: train_basin_file: calpella
2025-11-05 00:24:35,417: validation_basin_file: calpella
2025-11-05 00:24:35,418: test_basin_file: calpella
2025-11-05 00:24:35,419: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:24:35,419: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:24:35,420: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:24:35,421: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:24:35,422: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:24:35,422: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:24:35,423: device: cuda:0
2025-11-05 00:24:35,424: physics_informed: True
2025-11-05 00:24:35,425: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:24:35,426: validate_every: 5
2025-11-05 00:24:35,427: validate_n_random_basins: 1
2025-11-05 00:24:35,428: metrics: ['NSE', 'MSE']
2025-11-05 00:24:35,429: model: cudalstm
2025-11-05 00:24:35,429: head: regression
2025-11-05 00:24:35,430: output_activation: linear
2025-11-05 00:24:35,430: hidden_size: 256
2025-11-05 00:24:35,431: initial_forget_bias: 3
2025-11-05 00:24:35,431: output_dropout: 0.4
2025-11-05 00:24:35,432: num_layers: 1
2025-11-05 00:24:35,433: dev_mode: True
2025-11-05 00:24:35,433: optimizer: Adam
2025-11-05 00:24:35,434: loss: NSE
2025-11-05 00:24:35,435: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:24:35,435: batch_size: 128
2025-11-05 00:24:35,435: epochs: 48
2025-11-05 00:24:35,436: clip_gradient_norm: 1
2025-11-05 00:24:35,437: predict_last_n: 1
2025-11-05 00:24:35,437: seq_length: 90
2025-11-05 00:24:35,438: log_interval: 16
2025-11-05 00:24:35,438: log_tensorboard: True
2025-11-05 00:24:35,439: log_n_figures: 1
2025-11-05 00:24:35,440: save_weights_every: 48
2025-11-05 00:24:35,440: early_stopping: True
2025-11-05 00:24:35,441: early_stopping_mode: patience
2025-11-05 00:24:35,441: patience_early_stopping: 3
2025-11-05 00:24:35,442: min_delta_early_stopping: 0.0
2025-11-05 00:24:35,442: minimum_epochs_before_early_stopping: 10
2025-11-05 00:24:35,443: early_stopping_slope_window: 7
2025-11-05 00:24:35,443: early_stopping_slope_patience: 2
2025-11-05 00:24:35,444: early_stopping_slope_min_epoch: 8
2025-11-05 00:24:35,455: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:24:35,456: early_stopping_slope_use_log: True
2025-11-05 00:24:35,457: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:24:35,458: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:24:35,458: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:24:35,459: early_stopping_slope_variance_guard: True
2025-11-05 00:24:35,459: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:24:35,460: dataset: russian_river
2025-11-05 00:24:35,461: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:24:35,461: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:24:35,462: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:24:35,463: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:24:35,463: hourly: False
2025-11-05 00:24:35,464: is_mts: False
2025-11-05 00:24:35,465: is_mts_data: False
2025-11-05 00:24:35,465: verbose: True
2025-11-05 00:24:35,466: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435
2025-11-05 00:24:35,467: run_label: BASELINE
2025-11-05 00:24:35,467: number_of_basins: 1
2025-11-05 00:24:35,468: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\train_data
2025-11-05 00:24:35,469: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\img_log
2025-11-05 00:24:35,471: ### Device cuda:0 will be used for training
2025-11-05 00:24:35,473: Loading basin data into xarray data set.
2025-11-05 00:24:35,707: Calculating target variable stds per basin
2025-11-05 00:24:35,719: Create lookup table and convert to pytorch tensor
2025-11-05 00:24:36,028: Early stopping enabled: mode=patience
2025-11-05 00:24:36,508: Epoch 1 average loss: avg_loss: 2.51e-06, avg_total_loss: 2.51e-06
2025-11-05 00:24:36,826: Epoch 2 average loss: avg_loss: 9.89e-07, avg_total_loss: 9.89e-07
2025-11-05 00:24:37,132: Epoch 3 average loss: avg_loss: 7.31e-07, avg_total_loss: 7.31e-07
2025-11-05 00:24:37,452: Epoch 4 average loss: avg_loss: 6.83e-07, avg_total_loss: 6.83e-07
2025-11-05 00:24:37,741: Epoch 5 average loss: avg_loss: 6.32e-07, avg_total_loss: 6.32e-07
2025-11-05 00:24:38,209: Epoch 5 average validation loss: 6.67e-07 -- Median validation metrics: avg_loss: 6.67e-07, NSE: 0.84664, MSE: 26272.58789
2025-11-05 00:24:38,505: Epoch 6 average loss: avg_loss: 5.91e-07, avg_total_loss: 5.91e-07
2025-11-05 00:24:38,804: Epoch 7 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:24:39,129: Epoch 8 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:24:39,429: Epoch 9 average loss: avg_loss: 6.48e-07, avg_total_loss: 6.48e-07
2025-11-05 00:24:39,764: Epoch 10 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:24:40,069: Epoch 10 average validation loss: 9.49e-07 -- Median validation metrics: avg_loss: 9.49e-07, NSE: 0.78377, MSE: 37042.54688
2025-11-05 00:24:40,362: Epoch 11 average loss: avg_loss: 7.84e-07, avg_total_loss: 7.84e-07
2025-11-05 00:24:40,657: Epoch 12 average loss: avg_loss: 5.65e-07, avg_total_loss: 5.65e-07
2025-11-05 00:24:40,965: Epoch 13 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:24:41,270: Epoch 14 average loss: avg_loss: 6.14e-07, avg_total_loss: 6.14e-07
2025-11-05 00:24:41,579: Epoch 15 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:24:41,872: Epoch 15 average validation loss: 6.91e-07 -- Median validation metrics: avg_loss: 6.91e-07, NSE: 0.84105, MSE: 27229.86914
2025-11-05 00:24:42,131: Epoch 16 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:24:42,430: Epoch 17 average loss: avg_loss: 5.66e-07, avg_total_loss: 5.66e-07
2025-11-05 00:24:42,717: Epoch 18 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:24:43,049: Epoch 19 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:24:43,343: Epoch 20 average loss: avg_loss: 5.26e-07, avg_total_loss: 5.26e-07
2025-11-05 00:24:43,689: Epoch 20 average validation loss: 7.19e-07 -- Median validation metrics: avg_loss: 7.19e-07, NSE: 0.83632, MSE: 28040.32422
2025-11-05 00:24:43,962: Epoch 21 average loss: avg_loss: 4.97e-07, avg_total_loss: 4.97e-07
2025-11-05 00:24:44,280: Epoch 22 average loss: avg_loss: 4.60e-07, avg_total_loss: 4.60e-07
2025-11-05 00:24:44,587: Epoch 23 average loss: avg_loss: 5.26e-07, avg_total_loss: 5.26e-07
2025-11-05 00:24:44,588: Setting learning rate to 0.005
2025-11-05 00:24:44,927: Epoch 24 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:24:45,215: Epoch 25 average loss: avg_loss: 4.36e-07, avg_total_loss: 4.36e-07
2025-11-05 00:24:45,516: Epoch 25 average validation loss: 7.04e-07 -- Median validation metrics: avg_loss: 7.04e-07, NSE: 0.83792, MSE: 27766.98242
2025-11-05 00:24:45,778: Epoch 26 average loss: avg_loss: 4.05e-07, avg_total_loss: 4.05e-07
2025-11-05 00:24:46,077: Epoch 27 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:24:46,380: Epoch 28 average loss: avg_loss: 4.00e-07, avg_total_loss: 4.00e-07
2025-11-05 00:24:46,711: Epoch 29 average loss: avg_loss: 3.80e-07, avg_total_loss: 3.80e-07
2025-11-05 00:24:47,057: Epoch 30 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:24:47,363: Epoch 30 average validation loss: 7.42e-07 -- Median validation metrics: avg_loss: 7.42e-07, NSE: 0.82944, MSE: 29218.99023
2025-11-05 00:24:47,364: ES[patience]: STOP at epoch=30 after 3 checks without improvement
2025-11-05 00:24:47,365: Early stopping triggered at epoch 30
2025-11-05 00:24:47,385: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\model_epoch030.pt
2025-11-05 00:24:47,649: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\validation\model_epoch030\validation_metrics.csv
2025-11-05 00:24:47,650: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002435\validation\model_epoch030\validation_results.p
2025-11-05 00:24:48,296: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\output.log initialized.
2025-11-05 00:24:48,297: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448
2025-11-05 00:24:48,298: ### Run configurations for testing_run
2025-11-05 00:24:48,298: experiment_name: testing_run
2025-11-05 00:24:48,299: train_basin_file: calpella
2025-11-05 00:24:48,299: validation_basin_file: calpella
2025-11-05 00:24:48,300: test_basin_file: calpella
2025-11-05 00:24:48,300: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:24:48,301: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:24:48,301: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:24:48,302: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:24:48,303: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:24:48,304: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:24:48,305: device: cuda:0
2025-11-05 00:24:48,305: physics_informed: True
2025-11-05 00:24:48,306: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:24:48,306: validate_every: 5
2025-11-05 00:24:48,307: validate_n_random_basins: 1
2025-11-05 00:24:48,308: metrics: ['NSE', 'MSE']
2025-11-05 00:24:48,308: model: cudalstm
2025-11-05 00:24:48,309: head: regression
2025-11-05 00:24:48,310: output_activation: linear
2025-11-05 00:24:48,310: hidden_size: 256
2025-11-05 00:24:48,311: initial_forget_bias: 3
2025-11-05 00:24:48,312: output_dropout: 0.4
2025-11-05 00:24:48,313: num_layers: 1
2025-11-05 00:24:48,313: dev_mode: True
2025-11-05 00:24:48,314: optimizer: Adam
2025-11-05 00:24:48,314: loss: NSE
2025-11-05 00:24:48,315: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:24:48,315: batch_size: 256
2025-11-05 00:24:48,316: epochs: 48
2025-11-05 00:24:48,317: clip_gradient_norm: 1
2025-11-05 00:24:48,318: predict_last_n: 1
2025-11-05 00:24:48,318: seq_length: 90
2025-11-05 00:24:48,319: log_interval: 16
2025-11-05 00:24:48,320: log_tensorboard: True
2025-11-05 00:24:48,320: log_n_figures: 1
2025-11-05 00:24:48,321: save_weights_every: 48
2025-11-05 00:24:48,322: early_stopping: True
2025-11-05 00:24:48,323: early_stopping_mode: patience
2025-11-05 00:24:48,323: patience_early_stopping: 3
2025-11-05 00:24:48,324: min_delta_early_stopping: 0.0
2025-11-05 00:24:48,324: minimum_epochs_before_early_stopping: 10
2025-11-05 00:24:48,325: early_stopping_slope_window: 7
2025-11-05 00:24:48,326: early_stopping_slope_patience: 2
2025-11-05 00:24:48,327: early_stopping_slope_min_epoch: 8
2025-11-05 00:24:48,328: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:24:48,329: early_stopping_slope_use_log: True
2025-11-05 00:24:48,330: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:24:48,331: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:24:48,331: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:24:48,332: early_stopping_slope_variance_guard: True
2025-11-05 00:24:48,333: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:24:48,334: dataset: russian_river
2025-11-05 00:24:48,334: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:24:48,335: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:24:48,335: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:24:48,336: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:24:48,337: hourly: False
2025-11-05 00:24:48,337: is_mts: False
2025-11-05 00:24:48,338: is_mts_data: False
2025-11-05 00:24:48,339: verbose: True
2025-11-05 00:24:48,340: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448
2025-11-05 00:24:48,341: run_label: BASELINE
2025-11-05 00:24:48,341: number_of_basins: 1
2025-11-05 00:24:48,342: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\train_data
2025-11-05 00:24:48,343: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\img_log
2025-11-05 00:24:48,345: ### Device cuda:0 will be used for training
2025-11-05 00:24:48,346: Loading basin data into xarray data set.
2025-11-05 00:24:48,583: Calculating target variable stds per basin
2025-11-05 00:24:48,591: Create lookup table and convert to pytorch tensor
2025-11-05 00:24:48,722: Early stopping enabled: mode=patience
2025-11-05 00:24:48,974: Epoch 1 average loss: avg_loss: 4.02e-06, avg_total_loss: 4.02e-06
2025-11-05 00:24:49,203: Epoch 2 average loss: avg_loss: 1.69e-06, avg_total_loss: 1.69e-06
2025-11-05 00:24:49,418: Epoch 3 average loss: avg_loss: 1.58e-06, avg_total_loss: 1.58e-06
2025-11-05 00:24:49,620: Epoch 4 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:24:49,819: Epoch 5 average loss: avg_loss: 9.45e-07, avg_total_loss: 9.45e-07
2025-11-05 00:24:50,312: Epoch 5 average validation loss: 6.79e-07 -- Median validation metrics: avg_loss: 6.79e-07, NSE: 0.82644, MSE: 29732.29297
2025-11-05 00:24:50,498: Epoch 6 average loss: avg_loss: 8.25e-07, avg_total_loss: 8.25e-07
2025-11-05 00:24:50,688: Epoch 7 average loss: avg_loss: 7.64e-07, avg_total_loss: 7.64e-07
2025-11-05 00:24:50,887: Epoch 8 average loss: avg_loss: 9.72e-07, avg_total_loss: 9.72e-07
2025-11-05 00:24:51,110: Epoch 9 average loss: avg_loss: 8.10e-07, avg_total_loss: 8.10e-07
2025-11-05 00:24:51,308: Epoch 10 average loss: avg_loss: 8.92e-07, avg_total_loss: 8.92e-07
2025-11-05 00:24:51,569: Epoch 10 average validation loss: 7.39e-07 -- Median validation metrics: avg_loss: 7.39e-07, NSE: 0.81565, MSE: 31581.68750
2025-11-05 00:24:51,771: Epoch 11 average loss: avg_loss: 6.96e-07, avg_total_loss: 6.96e-07
2025-11-05 00:24:51,972: Epoch 12 average loss: avg_loss: 5.97e-07, avg_total_loss: 5.97e-07
2025-11-05 00:24:52,165: Epoch 13 average loss: avg_loss: 5.58e-07, avg_total_loss: 5.58e-07
2025-11-05 00:24:52,378: Epoch 14 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:24:52,575: Epoch 15 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:24:52,843: Epoch 15 average validation loss: 6.28e-07 -- Median validation metrics: avg_loss: 6.28e-07, NSE: 0.83979, MSE: 27446.10547
2025-11-05 00:24:53,029: Epoch 16 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:24:53,239: Epoch 17 average loss: avg_loss: 6.08e-07, avg_total_loss: 6.08e-07
2025-11-05 00:24:53,459: Epoch 18 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:24:53,656: Epoch 19 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:24:53,860: Epoch 20 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:24:54,124: Epoch 20 average validation loss: 6.49e-07 -- Median validation metrics: avg_loss: 6.49e-07, NSE: 0.83525, MSE: 28224.46289
2025-11-05 00:24:54,306: Epoch 21 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:24:54,494: Epoch 22 average loss: avg_loss: 5.10e-07, avg_total_loss: 5.10e-07
2025-11-05 00:24:54,698: Epoch 23 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:24:54,700: Setting learning rate to 0.005
2025-11-05 00:24:54,906: Epoch 24 average loss: avg_loss: 4.61e-07, avg_total_loss: 4.61e-07
2025-11-05 00:24:55,110: Epoch 25 average loss: avg_loss: 4.45e-07, avg_total_loss: 4.45e-07
2025-11-05 00:24:55,402: Epoch 25 average validation loss: 6.26e-07 -- Median validation metrics: avg_loss: 6.26e-07, NSE: 0.84075, MSE: 27280.85742
2025-11-05 00:24:55,609: Epoch 26 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:24:55,810: Epoch 27 average loss: avg_loss: 4.26e-07, avg_total_loss: 4.26e-07
2025-11-05 00:24:56,011: Epoch 28 average loss: avg_loss: 3.98e-07, avg_total_loss: 3.98e-07
2025-11-05 00:24:56,221: Epoch 29 average loss: avg_loss: 4.35e-07, avg_total_loss: 4.35e-07
2025-11-05 00:24:56,409: Epoch 30 average loss: avg_loss: 4.24e-07, avg_total_loss: 4.24e-07
2025-11-05 00:24:56,680: Epoch 30 average validation loss: 5.79e-07 -- Median validation metrics: avg_loss: 5.79e-07, NSE: 0.85277, MSE: 25222.47852
2025-11-05 00:24:56,885: Epoch 31 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:24:57,081: Epoch 32 average loss: avg_loss: 3.99e-07, avg_total_loss: 3.99e-07
2025-11-05 00:24:57,266: Epoch 33 average loss: avg_loss: 3.70e-07, avg_total_loss: 3.70e-07
2025-11-05 00:24:57,475: Epoch 34 average loss: avg_loss: 4.20e-07, avg_total_loss: 4.20e-07
2025-11-05 00:24:57,656: Epoch 35 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:24:57,890: Epoch 35 average validation loss: 5.88e-07 -- Median validation metrics: avg_loss: 5.88e-07, NSE: 0.85110, MSE: 25508.47852
2025-11-05 00:24:57,891: Setting learning rate to 0.001
2025-11-05 00:24:58,072: Epoch 36 average loss: avg_loss: 3.58e-07, avg_total_loss: 3.58e-07
2025-11-05 00:24:58,279: Epoch 37 average loss: avg_loss: 3.61e-07, avg_total_loss: 3.61e-07
2025-11-05 00:24:58,465: Epoch 38 average loss: avg_loss: 3.72e-07, avg_total_loss: 3.72e-07
2025-11-05 00:24:58,654: Epoch 39 average loss: avg_loss: 4.04e-07, avg_total_loss: 4.04e-07
2025-11-05 00:24:58,853: Epoch 40 average loss: avg_loss: 3.70e-07, avg_total_loss: 3.70e-07
2025-11-05 00:24:59,131: Epoch 40 average validation loss: 6.04e-07 -- Median validation metrics: avg_loss: 6.04e-07, NSE: 0.84709, MSE: 26195.10156
2025-11-05 00:24:59,317: Epoch 41 average loss: avg_loss: 3.64e-07, avg_total_loss: 3.64e-07
2025-11-05 00:24:59,502: Epoch 42 average loss: avg_loss: 3.53e-07, avg_total_loss: 3.53e-07
2025-11-05 00:24:59,720: Epoch 43 average loss: avg_loss: 3.51e-07, avg_total_loss: 3.51e-07
2025-11-05 00:24:59,909: Epoch 44 average loss: avg_loss: 3.28e-07, avg_total_loss: 3.28e-07
2025-11-05 00:25:00,096: Epoch 45 average loss: avg_loss: 3.49e-07, avg_total_loss: 3.49e-07
2025-11-05 00:25:00,376: Epoch 45 average validation loss: 5.98e-07 -- Median validation metrics: avg_loss: 5.98e-07, NSE: 0.84850, MSE: 25954.20898
2025-11-05 00:25:00,378: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:25:00,379: Early stopping triggered at epoch 45
2025-11-05 00:25:00,399: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\model_epoch045.pt
2025-11-05 00:25:00,774: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:25:00,776: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002448\validation\model_epoch045\validation_results.p
2025-11-05 00:25:01,473: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\output.log initialized.
2025-11-05 00:25:01,474: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501
2025-11-05 00:25:01,475: ### Run configurations for testing_run
2025-11-05 00:25:01,476: experiment_name: testing_run
2025-11-05 00:25:01,476: train_basin_file: calpella
2025-11-05 00:25:01,477: validation_basin_file: calpella
2025-11-05 00:25:01,478: test_basin_file: calpella
2025-11-05 00:25:01,478: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:01,479: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:01,480: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:01,480: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:01,481: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:01,482: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:01,482: device: cuda:0
2025-11-05 00:25:01,483: physics_informed: True
2025-11-05 00:25:01,484: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:01,484: validate_every: 5
2025-11-05 00:25:01,485: validate_n_random_basins: 1
2025-11-05 00:25:01,485: metrics: ['NSE', 'MSE']
2025-11-05 00:25:01,486: model: cudalstm
2025-11-05 00:25:01,486: head: regression
2025-11-05 00:25:01,487: output_activation: linear
2025-11-05 00:25:01,488: hidden_size: 256
2025-11-05 00:25:01,488: initial_forget_bias: 3
2025-11-05 00:25:01,489: output_dropout: 0.4
2025-11-05 00:25:01,489: num_layers: 1
2025-11-05 00:25:01,490: dev_mode: True
2025-11-05 00:25:01,491: optimizer: Adam
2025-11-05 00:25:01,491: loss: NSE
2025-11-05 00:25:01,492: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:25:01,493: batch_size: 64
2025-11-05 00:25:01,494: epochs: 16
2025-11-05 00:25:01,495: clip_gradient_norm: 1
2025-11-05 00:25:01,496: predict_last_n: 1
2025-11-05 00:25:01,497: seq_length: 120
2025-11-05 00:25:01,498: log_interval: 16
2025-11-05 00:25:01,499: log_tensorboard: True
2025-11-05 00:25:01,500: log_n_figures: 1
2025-11-05 00:25:01,502: save_weights_every: 16
2025-11-05 00:25:01,503: early_stopping: True
2025-11-05 00:25:01,504: early_stopping_mode: patience
2025-11-05 00:25:01,505: patience_early_stopping: 3
2025-11-05 00:25:01,507: min_delta_early_stopping: 0.0
2025-11-05 00:25:01,508: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:01,509: early_stopping_slope_window: 7
2025-11-05 00:25:01,511: early_stopping_slope_patience: 2
2025-11-05 00:25:01,512: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:01,513: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:01,514: early_stopping_slope_use_log: True
2025-11-05 00:25:01,515: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:01,517: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:01,518: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:01,519: early_stopping_slope_variance_guard: True
2025-11-05 00:25:01,520: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:01,521: dataset: russian_river
2025-11-05 00:25:01,522: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:01,523: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:01,525: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:01,526: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:01,527: hourly: False
2025-11-05 00:25:01,529: is_mts: False
2025-11-05 00:25:01,530: is_mts_data: False
2025-11-05 00:25:01,531: verbose: True
2025-11-05 00:25:01,532: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501
2025-11-05 00:25:01,533: run_label: BASELINE
2025-11-05 00:25:01,534: number_of_basins: 1
2025-11-05 00:25:01,535: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\train_data
2025-11-05 00:25:01,536: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\img_log
2025-11-05 00:25:01,539: ### Device cuda:0 will be used for training
2025-11-05 00:25:01,540: Loading basin data into xarray data set.
2025-11-05 00:25:01,770: Calculating target variable stds per basin
2025-11-05 00:25:01,780: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:01,898: Early stopping enabled: mode=patience
2025-11-05 00:25:02,581: Epoch 1 average loss: avg_loss: 2.23e-06, avg_total_loss: 2.23e-06
2025-11-05 00:25:03,233: Epoch 2 average loss: avg_loss: 8.08e-07, avg_total_loss: 8.08e-07
2025-11-05 00:25:03,873: Epoch 3 average loss: avg_loss: 6.74e-07, avg_total_loss: 6.74e-07
2025-11-05 00:25:04,540: Epoch 4 average loss: avg_loss: 7.67e-07, avg_total_loss: 7.67e-07
2025-11-05 00:25:05,200: Epoch 5 average loss: avg_loss: 6.04e-07, avg_total_loss: 6.04e-07
2025-11-05 00:25:05,729: Epoch 5 average validation loss: 7.68e-07 -- Median validation metrics: avg_loss: 7.68e-07, NSE: 0.82320, MSE: 30287.37500
2025-11-05 00:25:06,341: Epoch 6 average loss: avg_loss: 5.97e-07, avg_total_loss: 5.97e-07
2025-11-05 00:25:06,972: Epoch 7 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:25:06,973: Setting learning rate to 0.005
2025-11-05 00:25:07,627: Epoch 8 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:25:08,278: Epoch 9 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:25:08,886: Epoch 10 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:25:09,245: Epoch 10 average validation loss: 7.96e-07 -- Median validation metrics: avg_loss: 7.96e-07, NSE: 0.81646, MSE: 31442.68945
2025-11-05 00:25:09,856: Epoch 11 average loss: avg_loss: 5.00e-07, avg_total_loss: 5.00e-07
2025-11-05 00:25:09,857: Setting learning rate to 0.001
2025-11-05 00:25:10,476: Epoch 12 average loss: avg_loss: 4.55e-07, avg_total_loss: 4.55e-07
2025-11-05 00:25:11,129: Epoch 13 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:25:11,779: Epoch 14 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:25:12,391: Epoch 15 average loss: avg_loss: 3.97e-07, avg_total_loss: 3.97e-07
2025-11-05 00:25:12,696: Epoch 15 average validation loss: 7.43e-07 -- Median validation metrics: avg_loss: 7.43e-07, NSE: 0.82884, MSE: 29321.59961
2025-11-05 00:25:13,290: Epoch 16 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:25:13,313: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\model_epoch016.pt
2025-11-05 00:25:13,627: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:25:13,628: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002501\validation\model_epoch016\validation_results.p
2025-11-05 00:25:14,341: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\output.log initialized.
2025-11-05 00:25:14,342: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514
2025-11-05 00:25:14,343: ### Run configurations for testing_run
2025-11-05 00:25:14,343: experiment_name: testing_run
2025-11-05 00:25:14,344: train_basin_file: calpella
2025-11-05 00:25:14,345: validation_basin_file: calpella
2025-11-05 00:25:14,346: test_basin_file: calpella
2025-11-05 00:25:14,347: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:14,347: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:14,348: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:14,350: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:14,350: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:14,351: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:14,352: device: cuda:0
2025-11-05 00:25:14,352: physics_informed: True
2025-11-05 00:25:14,353: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:14,354: validate_every: 5
2025-11-05 00:25:14,355: validate_n_random_basins: 1
2025-11-05 00:25:14,355: metrics: ['NSE', 'MSE']
2025-11-05 00:25:14,356: model: cudalstm
2025-11-05 00:25:14,358: head: regression
2025-11-05 00:25:14,358: output_activation: linear
2025-11-05 00:25:14,359: hidden_size: 256
2025-11-05 00:25:14,360: initial_forget_bias: 3
2025-11-05 00:25:14,361: output_dropout: 0.4
2025-11-05 00:25:14,363: num_layers: 1
2025-11-05 00:25:14,363: dev_mode: True
2025-11-05 00:25:14,365: optimizer: Adam
2025-11-05 00:25:14,366: loss: NSE
2025-11-05 00:25:14,367: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:25:14,367: batch_size: 128
2025-11-05 00:25:14,368: epochs: 16
2025-11-05 00:25:14,369: clip_gradient_norm: 1
2025-11-05 00:25:14,371: predict_last_n: 1
2025-11-05 00:25:14,371: seq_length: 120
2025-11-05 00:25:14,372: log_interval: 16
2025-11-05 00:25:14,374: log_tensorboard: True
2025-11-05 00:25:14,375: log_n_figures: 1
2025-11-05 00:25:14,377: save_weights_every: 16
2025-11-05 00:25:14,378: early_stopping: True
2025-11-05 00:25:14,379: early_stopping_mode: patience
2025-11-05 00:25:14,380: patience_early_stopping: 3
2025-11-05 00:25:14,381: min_delta_early_stopping: 0.0
2025-11-05 00:25:14,383: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:14,384: early_stopping_slope_window: 7
2025-11-05 00:25:14,386: early_stopping_slope_patience: 2
2025-11-05 00:25:14,387: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:14,389: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:14,390: early_stopping_slope_use_log: True
2025-11-05 00:25:14,391: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:14,392: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:14,394: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:14,395: early_stopping_slope_variance_guard: True
2025-11-05 00:25:14,397: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:14,398: dataset: russian_river
2025-11-05 00:25:14,399: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:14,400: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:14,402: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:14,403: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:14,404: hourly: False
2025-11-05 00:25:14,405: is_mts: False
2025-11-05 00:25:14,406: is_mts_data: False
2025-11-05 00:25:14,407: verbose: True
2025-11-05 00:25:14,408: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514
2025-11-05 00:25:14,409: run_label: BASELINE
2025-11-05 00:25:14,410: number_of_basins: 1
2025-11-05 00:25:14,411: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\train_data
2025-11-05 00:25:14,412: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\img_log
2025-11-05 00:25:14,416: ### Device cuda:0 will be used for training
2025-11-05 00:25:14,418: Loading basin data into xarray data set.
2025-11-05 00:25:14,666: Calculating target variable stds per basin
2025-11-05 00:25:14,678: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:14,816: Early stopping enabled: mode=patience
2025-11-05 00:25:15,171: Epoch 1 average loss: avg_loss: 2.48e-06, avg_total_loss: 2.48e-06
2025-11-05 00:25:15,519: Epoch 2 average loss: avg_loss: 9.12e-07, avg_total_loss: 9.12e-07
2025-11-05 00:25:15,848: Epoch 3 average loss: avg_loss: 7.88e-07, avg_total_loss: 7.88e-07
2025-11-05 00:25:16,194: Epoch 4 average loss: avg_loss: 6.24e-07, avg_total_loss: 6.24e-07
2025-11-05 00:25:16,529: Epoch 5 average loss: avg_loss: 5.50e-07, avg_total_loss: 5.50e-07
2025-11-05 00:25:17,048: Epoch 5 average validation loss: 7.08e-07 -- Median validation metrics: avg_loss: 7.08e-07, NSE: 0.83798, MSE: 27755.62891
2025-11-05 00:25:17,354: Epoch 6 average loss: avg_loss: 5.43e-07, avg_total_loss: 5.43e-07
2025-11-05 00:25:17,702: Epoch 7 average loss: avg_loss: 5.56e-07, avg_total_loss: 5.56e-07
2025-11-05 00:25:17,702: Setting learning rate to 0.005
2025-11-05 00:25:18,015: Epoch 8 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:25:18,365: Epoch 9 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:25:18,687: Epoch 10 average loss: avg_loss: 5.34e-07, avg_total_loss: 5.34e-07
2025-11-05 00:25:19,003: Epoch 10 average validation loss: 7.28e-07 -- Median validation metrics: avg_loss: 7.28e-07, NSE: 0.83372, MSE: 28485.25977
2025-11-05 00:25:19,320: Epoch 11 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:25:19,321: Setting learning rate to 0.001
2025-11-05 00:25:19,672: Epoch 12 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:25:19,973: Epoch 13 average loss: avg_loss: 4.17e-07, avg_total_loss: 4.17e-07
2025-11-05 00:25:20,322: Epoch 14 average loss: avg_loss: 4.23e-07, avg_total_loss: 4.23e-07
2025-11-05 00:25:20,619: Epoch 15 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:25:20,956: Epoch 15 average validation loss: 6.83e-07 -- Median validation metrics: avg_loss: 6.83e-07, NSE: 0.84309, MSE: 26879.93945
2025-11-05 00:25:21,266: Epoch 16 average loss: avg_loss: 4.34e-07, avg_total_loss: 4.34e-07
2025-11-05 00:25:21,287: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\model_epoch016.pt
2025-11-05 00:25:21,576: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:25:21,577: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002514\validation\model_epoch016\validation_results.p
2025-11-05 00:25:22,243: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\output.log initialized.
2025-11-05 00:25:22,244: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522
2025-11-05 00:25:22,246: ### Run configurations for testing_run
2025-11-05 00:25:22,246: experiment_name: testing_run
2025-11-05 00:25:22,248: train_basin_file: calpella
2025-11-05 00:25:22,249: validation_basin_file: calpella
2025-11-05 00:25:22,249: test_basin_file: calpella
2025-11-05 00:25:22,251: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:22,251: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:22,252: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:22,252: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:22,253: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:22,254: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:22,255: device: cuda:0
2025-11-05 00:25:22,255: physics_informed: True
2025-11-05 00:25:22,256: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:22,257: validate_every: 5
2025-11-05 00:25:22,257: validate_n_random_basins: 1
2025-11-05 00:25:22,258: metrics: ['NSE', 'MSE']
2025-11-05 00:25:22,259: model: cudalstm
2025-11-05 00:25:22,260: head: regression
2025-11-05 00:25:22,261: output_activation: linear
2025-11-05 00:25:22,262: hidden_size: 256
2025-11-05 00:25:22,263: initial_forget_bias: 3
2025-11-05 00:25:22,263: output_dropout: 0.4
2025-11-05 00:25:22,264: num_layers: 1
2025-11-05 00:25:22,265: dev_mode: True
2025-11-05 00:25:22,266: optimizer: Adam
2025-11-05 00:25:22,266: loss: NSE
2025-11-05 00:25:22,267: learning_rate: {0: 0.01, 8: 0.005, 12: 0.001}
2025-11-05 00:25:22,268: batch_size: 256
2025-11-05 00:25:22,269: epochs: 16
2025-11-05 00:25:22,269: clip_gradient_norm: 1
2025-11-05 00:25:22,271: predict_last_n: 1
2025-11-05 00:25:22,271: seq_length: 120
2025-11-05 00:25:22,272: log_interval: 16
2025-11-05 00:25:22,272: log_tensorboard: True
2025-11-05 00:25:22,273: log_n_figures: 1
2025-11-05 00:25:22,274: save_weights_every: 16
2025-11-05 00:25:22,275: early_stopping: True
2025-11-05 00:25:22,276: early_stopping_mode: patience
2025-11-05 00:25:22,277: patience_early_stopping: 3
2025-11-05 00:25:22,279: min_delta_early_stopping: 0.0
2025-11-05 00:25:22,280: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:22,281: early_stopping_slope_window: 7
2025-11-05 00:25:22,282: early_stopping_slope_patience: 2
2025-11-05 00:25:22,283: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:22,285: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:22,285: early_stopping_slope_use_log: True
2025-11-05 00:25:22,286: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:22,287: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:22,288: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:22,289: early_stopping_slope_variance_guard: True
2025-11-05 00:25:22,290: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:22,290: dataset: russian_river
2025-11-05 00:25:22,291: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:22,292: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:22,293: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:22,293: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:22,294: hourly: False
2025-11-05 00:25:22,294: is_mts: False
2025-11-05 00:25:22,295: is_mts_data: False
2025-11-05 00:25:22,296: verbose: True
2025-11-05 00:25:22,297: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522
2025-11-05 00:25:22,297: run_label: BASELINE
2025-11-05 00:25:22,298: number_of_basins: 1
2025-11-05 00:25:22,299: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\train_data
2025-11-05 00:25:22,300: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\img_log
2025-11-05 00:25:22,301: ### Device cuda:0 will be used for training
2025-11-05 00:25:22,302: Loading basin data into xarray data set.
2025-11-05 00:25:22,527: Calculating target variable stds per basin
2025-11-05 00:25:22,538: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:22,666: Early stopping enabled: mode=patience
2025-11-05 00:25:22,865: Epoch 1 average loss: avg_loss: 3.23e-06, avg_total_loss: 3.23e-06
2025-11-05 00:25:23,065: Epoch 2 average loss: avg_loss: 1.59e-06, avg_total_loss: 1.59e-06
2025-11-05 00:25:23,276: Epoch 3 average loss: avg_loss: 1.20e-06, avg_total_loss: 1.20e-06
2025-11-05 00:25:23,498: Epoch 4 average loss: avg_loss: 1.01e-06, avg_total_loss: 1.01e-06
2025-11-05 00:25:23,716: Epoch 5 average loss: avg_loss: 8.03e-07, avg_total_loss: 8.03e-07
2025-11-05 00:25:24,250: Epoch 5 average validation loss: 8.75e-07 -- Median validation metrics: avg_loss: 8.75e-07, NSE: 0.77711, MSE: 38183.29297
2025-11-05 00:25:24,453: Epoch 6 average loss: avg_loss: 7.52e-07, avg_total_loss: 7.52e-07
2025-11-05 00:25:24,653: Epoch 7 average loss: avg_loss: 6.63e-07, avg_total_loss: 6.63e-07
2025-11-05 00:25:24,654: Setting learning rate to 0.005
2025-11-05 00:25:24,877: Epoch 8 average loss: avg_loss: 6.34e-07, avg_total_loss: 6.34e-07
2025-11-05 00:25:25,100: Epoch 9 average loss: avg_loss: 6.71e-07, avg_total_loss: 6.71e-07
2025-11-05 00:25:25,308: Epoch 10 average loss: avg_loss: 5.54e-07, avg_total_loss: 5.54e-07
2025-11-05 00:25:25,581: Epoch 10 average validation loss: 7.15e-07 -- Median validation metrics: avg_loss: 7.15e-07, NSE: 0.81814, MSE: 31155.08594
2025-11-05 00:25:25,793: Epoch 11 average loss: avg_loss: 5.25e-07, avg_total_loss: 5.25e-07
2025-11-05 00:25:25,794: Setting learning rate to 0.001
2025-11-05 00:25:26,024: Epoch 12 average loss: avg_loss: 5.83e-07, avg_total_loss: 5.83e-07
2025-11-05 00:25:26,236: Epoch 13 average loss: avg_loss: 4.73e-07, avg_total_loss: 4.73e-07
2025-11-05 00:25:26,445: Epoch 14 average loss: avg_loss: 4.57e-07, avg_total_loss: 4.57e-07
2025-11-05 00:25:26,681: Epoch 15 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:25:26,969: Epoch 15 average validation loss: 6.97e-07 -- Median validation metrics: avg_loss: 6.97e-07, NSE: 0.82325, MSE: 30280.18359
2025-11-05 00:25:27,176: Epoch 16 average loss: avg_loss: 5.38e-07, avg_total_loss: 5.38e-07
2025-11-05 00:25:27,197: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\model_epoch016.pt
2025-11-05 00:25:27,467: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\validation\model_epoch016\validation_metrics.csv
2025-11-05 00:25:27,469: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002522\validation\model_epoch016\validation_results.p
2025-11-05 00:25:28,149: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\output.log initialized.
2025-11-05 00:25:28,150: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528
2025-11-05 00:25:28,152: ### Run configurations for testing_run
2025-11-05 00:25:28,153: experiment_name: testing_run
2025-11-05 00:25:28,154: train_basin_file: calpella
2025-11-05 00:25:28,156: validation_basin_file: calpella
2025-11-05 00:25:28,157: test_basin_file: calpella
2025-11-05 00:25:28,158: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:28,159: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:28,161: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:28,162: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:28,164: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:28,165: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:28,166: device: cuda:0
2025-11-05 00:25:28,167: physics_informed: True
2025-11-05 00:25:28,169: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:28,170: validate_every: 5
2025-11-05 00:25:28,170: validate_n_random_basins: 1
2025-11-05 00:25:28,171: metrics: ['NSE', 'MSE']
2025-11-05 00:25:28,172: model: cudalstm
2025-11-05 00:25:28,173: head: regression
2025-11-05 00:25:28,174: output_activation: linear
2025-11-05 00:25:28,175: hidden_size: 256
2025-11-05 00:25:28,176: initial_forget_bias: 3
2025-11-05 00:25:28,177: output_dropout: 0.4
2025-11-05 00:25:28,178: num_layers: 1
2025-11-05 00:25:28,178: dev_mode: True
2025-11-05 00:25:28,179: optimizer: Adam
2025-11-05 00:25:28,180: loss: NSE
2025-11-05 00:25:28,181: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:25:28,181: batch_size: 64
2025-11-05 00:25:28,182: epochs: 32
2025-11-05 00:25:28,183: clip_gradient_norm: 1
2025-11-05 00:25:28,184: predict_last_n: 1
2025-11-05 00:25:28,185: seq_length: 120
2025-11-05 00:25:28,186: log_interval: 16
2025-11-05 00:25:28,187: log_tensorboard: True
2025-11-05 00:25:28,188: log_n_figures: 1
2025-11-05 00:25:28,189: save_weights_every: 32
2025-11-05 00:25:28,190: early_stopping: True
2025-11-05 00:25:28,191: early_stopping_mode: patience
2025-11-05 00:25:28,192: patience_early_stopping: 3
2025-11-05 00:25:28,193: min_delta_early_stopping: 0.0
2025-11-05 00:25:28,195: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:28,196: early_stopping_slope_window: 7
2025-11-05 00:25:28,197: early_stopping_slope_patience: 2
2025-11-05 00:25:28,198: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:28,199: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:28,199: early_stopping_slope_use_log: True
2025-11-05 00:25:28,200: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:28,201: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:28,202: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:28,202: early_stopping_slope_variance_guard: True
2025-11-05 00:25:28,203: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:28,204: dataset: russian_river
2025-11-05 00:25:28,204: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:28,205: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:28,206: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:28,207: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:28,207: hourly: False
2025-11-05 00:25:28,208: is_mts: False
2025-11-05 00:25:28,209: is_mts_data: False
2025-11-05 00:25:28,210: verbose: True
2025-11-05 00:25:28,210: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528
2025-11-05 00:25:28,211: run_label: BASELINE
2025-11-05 00:25:28,212: number_of_basins: 1
2025-11-05 00:25:28,213: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\train_data
2025-11-05 00:25:28,213: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\img_log
2025-11-05 00:25:28,215: ### Device cuda:0 will be used for training
2025-11-05 00:25:28,216: Loading basin data into xarray data set.
2025-11-05 00:25:28,443: Calculating target variable stds per basin
2025-11-05 00:25:28,455: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:28,580: Early stopping enabled: mode=patience
2025-11-05 00:25:29,224: Epoch 1 average loss: avg_loss: 1.86e-06, avg_total_loss: 1.86e-06
2025-11-05 00:25:29,866: Epoch 2 average loss: avg_loss: 9.28e-07, avg_total_loss: 9.28e-07
2025-11-05 00:25:30,498: Epoch 3 average loss: avg_loss: 7.92e-07, avg_total_loss: 7.92e-07
2025-11-05 00:25:31,123: Epoch 4 average loss: avg_loss: 6.57e-07, avg_total_loss: 6.57e-07
2025-11-05 00:25:31,759: Epoch 5 average loss: avg_loss: 5.88e-07, avg_total_loss: 5.88e-07
2025-11-05 00:25:32,290: Epoch 5 average validation loss: 8.15e-07 -- Median validation metrics: avg_loss: 8.15e-07, NSE: 0.81426, MSE: 31819.88672
2025-11-05 00:25:32,910: Epoch 6 average loss: avg_loss: 6.77e-07, avg_total_loss: 6.77e-07
2025-11-05 00:25:33,549: Epoch 7 average loss: avg_loss: 7.13e-07, avg_total_loss: 7.13e-07
2025-11-05 00:25:34,191: Epoch 8 average loss: avg_loss: 7.40e-07, avg_total_loss: 7.40e-07
2025-11-05 00:25:34,819: Epoch 9 average loss: avg_loss: 6.88e-07, avg_total_loss: 6.88e-07
2025-11-05 00:25:35,434: Epoch 10 average loss: avg_loss: 5.45e-07, avg_total_loss: 5.45e-07
2025-11-05 00:25:35,805: Epoch 10 average validation loss: 7.05e-07 -- Median validation metrics: avg_loss: 7.05e-07, NSE: 0.83746, MSE: 27845.84766
2025-11-05 00:25:36,440: Epoch 11 average loss: avg_loss: 5.92e-07, avg_total_loss: 5.92e-07
2025-11-05 00:25:37,090: Epoch 12 average loss: avg_loss: 5.76e-07, avg_total_loss: 5.76e-07
2025-11-05 00:25:37,738: Epoch 13 average loss: avg_loss: 5.64e-07, avg_total_loss: 5.64e-07
2025-11-05 00:25:38,362: Epoch 14 average loss: avg_loss: 6.11e-07, avg_total_loss: 6.11e-07
2025-11-05 00:25:38,993: Epoch 15 average loss: avg_loss: 5.74e-07, avg_total_loss: 5.74e-07
2025-11-05 00:25:39,444: Epoch 15 average validation loss: 7.93e-07 -- Median validation metrics: avg_loss: 7.93e-07, NSE: 0.81984, MSE: 30863.25391
2025-11-05 00:25:39,444: Setting learning rate to 0.005
2025-11-05 00:25:40,023: Epoch 16 average loss: avg_loss: 4.44e-07, avg_total_loss: 4.44e-07
2025-11-05 00:25:40,634: Epoch 17 average loss: avg_loss: 4.66e-07, avg_total_loss: 4.66e-07
2025-11-05 00:25:41,256: Epoch 18 average loss: avg_loss: 5.73e-07, avg_total_loss: 5.73e-07
2025-11-05 00:25:41,877: Epoch 19 average loss: avg_loss: 5.67e-07, avg_total_loss: 5.67e-07
2025-11-05 00:25:42,493: Epoch 20 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:25:42,850: Epoch 20 average validation loss: 7.42e-07 -- Median validation metrics: avg_loss: 7.42e-07, NSE: 0.82945, MSE: 29216.92578
2025-11-05 00:25:43,497: Epoch 21 average loss: avg_loss: 3.73e-07, avg_total_loss: 3.73e-07
2025-11-05 00:25:44,210: Epoch 22 average loss: avg_loss: 3.68e-07, avg_total_loss: 3.68e-07
2025-11-05 00:25:44,914: Epoch 23 average loss: avg_loss: 3.67e-07, avg_total_loss: 3.67e-07
2025-11-05 00:25:44,915: Setting learning rate to 0.001
2025-11-05 00:25:45,534: Epoch 24 average loss: avg_loss: 3.52e-07, avg_total_loss: 3.52e-07
2025-11-05 00:25:46,138: Epoch 25 average loss: avg_loss: 3.13e-07, avg_total_loss: 3.13e-07
2025-11-05 00:25:46,480: Epoch 25 average validation loss: 7.34e-07 -- Median validation metrics: avg_loss: 7.34e-07, NSE: 0.83154, MSE: 28859.49414
2025-11-05 00:25:46,481: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:25:46,482: Early stopping triggered at epoch 25
2025-11-05 00:25:46,506: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\model_epoch025.pt
2025-11-05 00:25:46,867: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:25:46,868: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002528\validation\model_epoch025\validation_results.p
2025-11-05 00:25:47,629: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\output.log initialized.
2025-11-05 00:25:47,630: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547
2025-11-05 00:25:47,630: ### Run configurations for testing_run
2025-11-05 00:25:47,631: experiment_name: testing_run
2025-11-05 00:25:47,632: train_basin_file: calpella
2025-11-05 00:25:47,632: validation_basin_file: calpella
2025-11-05 00:25:47,634: test_basin_file: calpella
2025-11-05 00:25:47,635: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:47,635: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:47,636: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:47,637: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:47,638: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:47,638: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:47,639: device: cuda:0
2025-11-05 00:25:47,640: physics_informed: True
2025-11-05 00:25:47,641: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:47,641: validate_every: 5
2025-11-05 00:25:47,642: validate_n_random_basins: 1
2025-11-05 00:25:47,643: metrics: ['NSE', 'MSE']
2025-11-05 00:25:47,643: model: cudalstm
2025-11-05 00:25:47,644: head: regression
2025-11-05 00:25:47,644: output_activation: linear
2025-11-05 00:25:47,645: hidden_size: 256
2025-11-05 00:25:47,646: initial_forget_bias: 3
2025-11-05 00:25:47,647: output_dropout: 0.4
2025-11-05 00:25:47,648: num_layers: 1
2025-11-05 00:25:47,648: dev_mode: True
2025-11-05 00:25:47,649: optimizer: Adam
2025-11-05 00:25:47,650: loss: NSE
2025-11-05 00:25:47,650: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:25:47,651: batch_size: 128
2025-11-05 00:25:47,652: epochs: 32
2025-11-05 00:25:47,654: clip_gradient_norm: 1
2025-11-05 00:25:47,654: predict_last_n: 1
2025-11-05 00:25:47,656: seq_length: 120
2025-11-05 00:25:47,657: log_interval: 16
2025-11-05 00:25:47,658: log_tensorboard: True
2025-11-05 00:25:47,659: log_n_figures: 1
2025-11-05 00:25:47,660: save_weights_every: 32
2025-11-05 00:25:47,660: early_stopping: True
2025-11-05 00:25:47,662: early_stopping_mode: patience
2025-11-05 00:25:47,663: patience_early_stopping: 3
2025-11-05 00:25:47,664: min_delta_early_stopping: 0.0
2025-11-05 00:25:47,665: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:47,666: early_stopping_slope_window: 7
2025-11-05 00:25:47,667: early_stopping_slope_patience: 2
2025-11-05 00:25:47,668: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:47,669: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:47,669: early_stopping_slope_use_log: True
2025-11-05 00:25:47,670: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:47,671: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:47,672: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:47,672: early_stopping_slope_variance_guard: True
2025-11-05 00:25:47,673: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:47,674: dataset: russian_river
2025-11-05 00:25:47,676: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:47,676: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:47,678: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:47,679: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:47,680: hourly: False
2025-11-05 00:25:47,682: is_mts: False
2025-11-05 00:25:47,683: is_mts_data: False
2025-11-05 00:25:47,684: verbose: True
2025-11-05 00:25:47,686: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547
2025-11-05 00:25:47,687: run_label: BASELINE
2025-11-05 00:25:47,688: number_of_basins: 1
2025-11-05 00:25:47,690: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\train_data
2025-11-05 00:25:47,691: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\img_log
2025-11-05 00:25:47,695: ### Device cuda:0 will be used for training
2025-11-05 00:25:47,697: Loading basin data into xarray data set.
2025-11-05 00:25:47,988: Calculating target variable stds per basin
2025-11-05 00:25:48,000: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:48,140: Early stopping enabled: mode=patience
2025-11-05 00:25:48,689: Epoch 1 average loss: avg_loss: 2.36e-06, avg_total_loss: 2.36e-06
2025-11-05 00:25:49,032: Epoch 2 average loss: avg_loss: 1.92e-06, avg_total_loss: 1.92e-06
2025-11-05 00:25:49,374: Epoch 3 average loss: avg_loss: 1.06e-06, avg_total_loss: 1.06e-06
2025-11-05 00:25:49,698: Epoch 4 average loss: avg_loss: 9.05e-07, avg_total_loss: 9.05e-07
2025-11-05 00:25:50,053: Epoch 5 average loss: avg_loss: 8.66e-07, avg_total_loss: 8.66e-07
2025-11-05 00:25:50,564: Epoch 5 average validation loss: 8.85e-07 -- Median validation metrics: avg_loss: 8.85e-07, NSE: 0.79622, MSE: 34910.41797
2025-11-05 00:25:50,873: Epoch 6 average loss: avg_loss: 7.22e-07, avg_total_loss: 7.22e-07
2025-11-05 00:25:51,182: Epoch 7 average loss: avg_loss: 5.96e-07, avg_total_loss: 5.96e-07
2025-11-05 00:25:51,538: Epoch 8 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:25:51,882: Epoch 9 average loss: avg_loss: 6.20e-07, avg_total_loss: 6.20e-07
2025-11-05 00:25:52,212: Epoch 10 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:25:52,509: Epoch 10 average validation loss: 6.93e-07 -- Median validation metrics: avg_loss: 6.93e-07, NSE: 0.84085, MSE: 27264.57422
2025-11-05 00:25:52,853: Epoch 11 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:25:53,184: Epoch 12 average loss: avg_loss: 4.78e-07, avg_total_loss: 4.78e-07
2025-11-05 00:25:53,527: Epoch 13 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:25:53,870: Epoch 14 average loss: avg_loss: 5.19e-07, avg_total_loss: 5.19e-07
2025-11-05 00:25:54,191: Epoch 15 average loss: avg_loss: 4.51e-07, avg_total_loss: 4.51e-07
2025-11-05 00:25:54,491: Epoch 15 average validation loss: 8.36e-07 -- Median validation metrics: avg_loss: 8.36e-07, NSE: 0.80747, MSE: 32983.23438
2025-11-05 00:25:54,492: Setting learning rate to 0.005
2025-11-05 00:25:54,860: Epoch 16 average loss: avg_loss: 4.25e-07, avg_total_loss: 4.25e-07
2025-11-05 00:25:55,189: Epoch 17 average loss: avg_loss: 3.81e-07, avg_total_loss: 3.81e-07
2025-11-05 00:25:55,523: Epoch 18 average loss: avg_loss: 3.62e-07, avg_total_loss: 3.62e-07
2025-11-05 00:25:55,846: Epoch 19 average loss: avg_loss: 3.80e-07, avg_total_loss: 3.80e-07
2025-11-05 00:25:56,179: Epoch 20 average loss: avg_loss: 3.24e-07, avg_total_loss: 3.24e-07
2025-11-05 00:25:56,505: Epoch 20 average validation loss: 7.78e-07 -- Median validation metrics: avg_loss: 7.78e-07, NSE: 0.82120, MSE: 30630.52539
2025-11-05 00:25:56,863: Epoch 21 average loss: avg_loss: 3.24e-07, avg_total_loss: 3.24e-07
2025-11-05 00:25:57,185: Epoch 22 average loss: avg_loss: 3.46e-07, avg_total_loss: 3.46e-07
2025-11-05 00:25:57,523: Epoch 23 average loss: avg_loss: 3.10e-07, avg_total_loss: 3.10e-07
2025-11-05 00:25:57,524: Setting learning rate to 0.001
2025-11-05 00:25:57,865: Epoch 24 average loss: avg_loss: 2.92e-07, avg_total_loss: 2.92e-07
2025-11-05 00:25:58,211: Epoch 25 average loss: avg_loss: 2.83e-07, avg_total_loss: 2.83e-07
2025-11-05 00:25:58,496: Epoch 25 average validation loss: 7.35e-07 -- Median validation metrics: avg_loss: 7.35e-07, NSE: 0.83127, MSE: 28905.57031
2025-11-05 00:25:58,497: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:25:58,498: Early stopping triggered at epoch 25
2025-11-05 00:25:58,517: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\model_epoch025.pt
2025-11-05 00:25:58,783: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:25:58,784: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002547\validation\model_epoch025\validation_results.p
2025-11-05 00:25:59,475: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\output.log initialized.
2025-11-05 00:25:59,476: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559
2025-11-05 00:25:59,477: ### Run configurations for testing_run
2025-11-05 00:25:59,478: experiment_name: testing_run
2025-11-05 00:25:59,480: train_basin_file: calpella
2025-11-05 00:25:59,481: validation_basin_file: calpella
2025-11-05 00:25:59,482: test_basin_file: calpella
2025-11-05 00:25:59,484: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:25:59,484: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:25:59,485: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:25:59,486: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:25:59,487: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:25:59,488: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:25:59,489: device: cuda:0
2025-11-05 00:25:59,490: physics_informed: True
2025-11-05 00:25:59,491: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:25:59,491: validate_every: 5
2025-11-05 00:25:59,492: validate_n_random_basins: 1
2025-11-05 00:25:59,493: metrics: ['NSE', 'MSE']
2025-11-05 00:25:59,494: model: cudalstm
2025-11-05 00:25:59,494: head: regression
2025-11-05 00:25:59,495: output_activation: linear
2025-11-05 00:25:59,496: hidden_size: 256
2025-11-05 00:25:59,496: initial_forget_bias: 3
2025-11-05 00:25:59,497: output_dropout: 0.4
2025-11-05 00:25:59,497: num_layers: 1
2025-11-05 00:25:59,498: dev_mode: True
2025-11-05 00:25:59,499: optimizer: Adam
2025-11-05 00:25:59,499: loss: NSE
2025-11-05 00:25:59,500: learning_rate: {0: 0.01, 16: 0.005, 24: 0.001}
2025-11-05 00:25:59,501: batch_size: 256
2025-11-05 00:25:59,501: epochs: 32
2025-11-05 00:25:59,502: clip_gradient_norm: 1
2025-11-05 00:25:59,503: predict_last_n: 1
2025-11-05 00:25:59,504: seq_length: 120
2025-11-05 00:25:59,504: log_interval: 16
2025-11-05 00:25:59,505: log_tensorboard: True
2025-11-05 00:25:59,505: log_n_figures: 1
2025-11-05 00:25:59,506: save_weights_every: 32
2025-11-05 00:25:59,507: early_stopping: True
2025-11-05 00:25:59,507: early_stopping_mode: patience
2025-11-05 00:25:59,508: patience_early_stopping: 3
2025-11-05 00:25:59,509: min_delta_early_stopping: 0.0
2025-11-05 00:25:59,510: minimum_epochs_before_early_stopping: 10
2025-11-05 00:25:59,510: early_stopping_slope_window: 7
2025-11-05 00:25:59,511: early_stopping_slope_patience: 2
2025-11-05 00:25:59,512: early_stopping_slope_min_epoch: 8
2025-11-05 00:25:59,513: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:25:59,513: early_stopping_slope_use_log: True
2025-11-05 00:25:59,514: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:25:59,514: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:25:59,515: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:25:59,516: early_stopping_slope_variance_guard: True
2025-11-05 00:25:59,517: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:25:59,517: dataset: russian_river
2025-11-05 00:25:59,518: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:25:59,519: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:25:59,520: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:25:59,520: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:25:59,521: hourly: False
2025-11-05 00:25:59,521: is_mts: False
2025-11-05 00:25:59,522: is_mts_data: False
2025-11-05 00:25:59,523: verbose: True
2025-11-05 00:25:59,523: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559
2025-11-05 00:25:59,524: run_label: BASELINE
2025-11-05 00:25:59,524: number_of_basins: 1
2025-11-05 00:25:59,525: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\train_data
2025-11-05 00:25:59,526: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\img_log
2025-11-05 00:25:59,527: ### Device cuda:0 will be used for training
2025-11-05 00:25:59,528: Loading basin data into xarray data set.
2025-11-05 00:25:59,778: Calculating target variable stds per basin
2025-11-05 00:25:59,789: Create lookup table and convert to pytorch tensor
2025-11-05 00:25:59,913: Early stopping enabled: mode=patience
2025-11-05 00:26:00,207: Epoch 1 average loss: avg_loss: 3.19e-06, avg_total_loss: 3.19e-06
2025-11-05 00:26:00,443: Epoch 2 average loss: avg_loss: 1.24e-06, avg_total_loss: 1.24e-06
2025-11-05 00:26:00,692: Epoch 3 average loss: avg_loss: 8.59e-07, avg_total_loss: 8.59e-07
2025-11-05 00:26:00,923: Epoch 4 average loss: avg_loss: 7.55e-07, avg_total_loss: 7.55e-07
2025-11-05 00:26:01,140: Epoch 5 average loss: avg_loss: 6.60e-07, avg_total_loss: 6.60e-07
2025-11-05 00:26:01,634: Epoch 5 average validation loss: 6.51e-07 -- Median validation metrics: avg_loss: 6.51e-07, NSE: 0.83367, MSE: 28494.71875
2025-11-05 00:26:01,863: Epoch 6 average loss: avg_loss: 6.00e-07, avg_total_loss: 6.00e-07
2025-11-05 00:26:02,091: Epoch 7 average loss: avg_loss: 6.39e-07, avg_total_loss: 6.39e-07
2025-11-05 00:26:02,318: Epoch 8 average loss: avg_loss: 1.25e-06, avg_total_loss: 1.25e-06
2025-11-05 00:26:02,553: Epoch 9 average loss: avg_loss: 1.11e-06, avg_total_loss: 1.11e-06
2025-11-05 00:26:02,770: Epoch 10 average loss: avg_loss: 9.43e-07, avg_total_loss: 9.43e-07
2025-11-05 00:26:03,055: Epoch 10 average validation loss: 6.95e-07 -- Median validation metrics: avg_loss: 6.95e-07, NSE: 0.82366, MSE: 30208.77930
2025-11-05 00:26:03,261: Epoch 11 average loss: avg_loss: 8.17e-07, avg_total_loss: 8.17e-07
2025-11-05 00:26:03,494: Epoch 12 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:26:03,722: Epoch 13 average loss: avg_loss: 6.98e-07, avg_total_loss: 6.98e-07
2025-11-05 00:26:03,956: Epoch 14 average loss: avg_loss: 7.03e-07, avg_total_loss: 7.03e-07
2025-11-05 00:26:04,203: Epoch 15 average loss: avg_loss: 6.81e-07, avg_total_loss: 6.81e-07
2025-11-05 00:26:04,486: Epoch 15 average validation loss: 7.50e-07 -- Median validation metrics: avg_loss: 7.50e-07, NSE: 0.81662, MSE: 31415.56250
2025-11-05 00:26:04,487: Setting learning rate to 0.005
2025-11-05 00:26:04,703: Epoch 16 average loss: avg_loss: 6.03e-07, avg_total_loss: 6.03e-07
2025-11-05 00:26:04,918: Epoch 17 average loss: avg_loss: 5.55e-07, avg_total_loss: 5.55e-07
2025-11-05 00:26:05,151: Epoch 18 average loss: avg_loss: 5.37e-07, avg_total_loss: 5.37e-07
2025-11-05 00:26:05,373: Epoch 19 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:26:05,590: Epoch 20 average loss: avg_loss: 5.80e-07, avg_total_loss: 5.80e-07
2025-11-05 00:26:05,906: Epoch 20 average validation loss: 6.21e-07 -- Median validation metrics: avg_loss: 6.21e-07, NSE: 0.84306, MSE: 26885.31641
2025-11-05 00:26:06,121: Epoch 21 average loss: avg_loss: 4.95e-07, avg_total_loss: 4.95e-07
2025-11-05 00:26:06,331: Epoch 22 average loss: avg_loss: 4.82e-07, avg_total_loss: 4.82e-07
2025-11-05 00:26:06,554: Epoch 23 average loss: avg_loss: 4.46e-07, avg_total_loss: 4.46e-07
2025-11-05 00:26:06,555: Setting learning rate to 0.001
2025-11-05 00:26:06,798: Epoch 24 average loss: avg_loss: 4.67e-07, avg_total_loss: 4.67e-07
2025-11-05 00:26:07,013: Epoch 25 average loss: avg_loss: 4.43e-07, avg_total_loss: 4.43e-07
2025-11-05 00:26:07,319: Epoch 25 average validation loss: 6.32e-07 -- Median validation metrics: avg_loss: 6.32e-07, NSE: 0.84013, MSE: 27387.77734
2025-11-05 00:26:07,555: Epoch 26 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:26:07,771: Epoch 27 average loss: avg_loss: 4.59e-07, avg_total_loss: 4.59e-07
2025-11-05 00:26:07,992: Epoch 28 average loss: avg_loss: 4.96e-07, avg_total_loss: 4.96e-07
2025-11-05 00:26:08,225: Epoch 29 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:26:08,432: Epoch 30 average loss: avg_loss: 4.22e-07, avg_total_loss: 4.22e-07
2025-11-05 00:26:08,700: Epoch 30 average validation loss: 6.27e-07 -- Median validation metrics: avg_loss: 6.27e-07, NSE: 0.84145, MSE: 27161.19922
2025-11-05 00:26:08,900: Epoch 31 average loss: avg_loss: 4.42e-07, avg_total_loss: 4.42e-07
2025-11-05 00:26:09,132: Epoch 32 average loss: avg_loss: 4.29e-07, avg_total_loss: 4.29e-07
2025-11-05 00:26:09,157: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\model_epoch032.pt
2025-11-05 00:26:09,449: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\validation\model_epoch032\validation_metrics.csv
2025-11-05 00:26:09,451: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002559\validation\model_epoch032\validation_results.p
2025-11-05 00:26:10,330: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\output.log initialized.
2025-11-05 00:26:10,331: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610
2025-11-05 00:26:10,331: ### Run configurations for testing_run
2025-11-05 00:26:10,332: experiment_name: testing_run
2025-11-05 00:26:10,333: train_basin_file: calpella
2025-11-05 00:26:10,334: validation_basin_file: calpella
2025-11-05 00:26:10,335: test_basin_file: calpella
2025-11-05 00:26:10,335: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:26:10,336: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:26:10,337: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:26:10,338: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:26:10,339: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:26:10,340: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:26:10,341: device: cuda:0
2025-11-05 00:26:10,341: physics_informed: True
2025-11-05 00:26:10,342: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:26:10,343: validate_every: 5
2025-11-05 00:26:10,343: validate_n_random_basins: 1
2025-11-05 00:26:10,344: metrics: ['NSE', 'MSE']
2025-11-05 00:26:10,345: model: cudalstm
2025-11-05 00:26:10,346: head: regression
2025-11-05 00:26:10,346: output_activation: linear
2025-11-05 00:26:10,347: hidden_size: 256
2025-11-05 00:26:10,347: initial_forget_bias: 3
2025-11-05 00:26:10,348: output_dropout: 0.4
2025-11-05 00:26:10,349: num_layers: 1
2025-11-05 00:26:10,350: dev_mode: True
2025-11-05 00:26:10,350: optimizer: Adam
2025-11-05 00:26:10,352: loss: NSE
2025-11-05 00:26:10,353: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:26:10,354: batch_size: 64
2025-11-05 00:26:10,355: epochs: 48
2025-11-05 00:26:10,355: clip_gradient_norm: 1
2025-11-05 00:26:10,355: predict_last_n: 1
2025-11-05 00:26:10,356: seq_length: 120
2025-11-05 00:26:10,356: log_interval: 16
2025-11-05 00:26:10,357: log_tensorboard: True
2025-11-05 00:26:10,358: log_n_figures: 1
2025-11-05 00:26:10,360: save_weights_every: 48
2025-11-05 00:26:10,362: early_stopping: True
2025-11-05 00:26:10,363: early_stopping_mode: patience
2025-11-05 00:26:10,364: patience_early_stopping: 3
2025-11-05 00:26:10,366: min_delta_early_stopping: 0.0
2025-11-05 00:26:10,367: minimum_epochs_before_early_stopping: 10
2025-11-05 00:26:10,369: early_stopping_slope_window: 7
2025-11-05 00:26:10,369: early_stopping_slope_patience: 2
2025-11-05 00:26:10,370: early_stopping_slope_min_epoch: 8
2025-11-05 00:26:10,372: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:26:10,373: early_stopping_slope_use_log: True
2025-11-05 00:26:10,374: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:26:10,375: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:26:10,377: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:26:10,378: early_stopping_slope_variance_guard: True
2025-11-05 00:26:10,379: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:26:10,381: dataset: russian_river
2025-11-05 00:26:10,382: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:26:10,383: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:26:10,384: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:26:10,385: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:26:10,386: hourly: False
2025-11-05 00:26:10,388: is_mts: False
2025-11-05 00:26:10,390: is_mts_data: False
2025-11-05 00:26:10,391: verbose: True
2025-11-05 00:26:10,391: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610
2025-11-05 00:26:10,393: run_label: BASELINE
2025-11-05 00:26:10,394: number_of_basins: 1
2025-11-05 00:26:10,395: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\train_data
2025-11-05 00:26:10,396: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\img_log
2025-11-05 00:26:10,399: ### Device cuda:0 will be used for training
2025-11-05 00:26:10,401: Loading basin data into xarray data set.
2025-11-05 00:26:10,653: Calculating target variable stds per basin
2025-11-05 00:26:10,664: Create lookup table and convert to pytorch tensor
2025-11-05 00:26:10,793: Early stopping enabled: mode=patience
2025-11-05 00:26:11,501: Epoch 1 average loss: avg_loss: 1.62e-06, avg_total_loss: 1.62e-06
2025-11-05 00:26:12,205: Epoch 2 average loss: avg_loss: 8.36e-07, avg_total_loss: 8.36e-07
2025-11-05 00:26:12,897: Epoch 3 average loss: avg_loss: 8.42e-07, avg_total_loss: 8.42e-07
2025-11-05 00:26:13,609: Epoch 4 average loss: avg_loss: 7.75e-07, avg_total_loss: 7.75e-07
2025-11-05 00:26:14,278: Epoch 5 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:26:14,859: Epoch 5 average validation loss: 7.38e-07 -- Median validation metrics: avg_loss: 7.38e-07, NSE: 0.83055, MSE: 29028.73633
2025-11-05 00:26:15,524: Epoch 6 average loss: avg_loss: 5.27e-07, avg_total_loss: 5.27e-07
2025-11-05 00:26:16,208: Epoch 7 average loss: avg_loss: 6.88e-07, avg_total_loss: 6.88e-07
2025-11-05 00:26:16,862: Epoch 8 average loss: avg_loss: 8.36e-07, avg_total_loss: 8.36e-07
2025-11-05 00:26:17,556: Epoch 9 average loss: avg_loss: 6.69e-07, avg_total_loss: 6.69e-07
2025-11-05 00:26:18,231: Epoch 10 average loss: avg_loss: 6.72e-07, avg_total_loss: 6.72e-07
2025-11-05 00:26:18,590: Epoch 10 average validation loss: 7.17e-07 -- Median validation metrics: avg_loss: 7.17e-07, NSE: 0.83652, MSE: 28006.29688
2025-11-05 00:26:19,245: Epoch 11 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:26:19,910: Epoch 12 average loss: avg_loss: 5.69e-07, avg_total_loss: 5.69e-07
2025-11-05 00:26:20,591: Epoch 13 average loss: avg_loss: 5.87e-07, avg_total_loss: 5.87e-07
2025-11-05 00:26:21,268: Epoch 14 average loss: avg_loss: 5.02e-07, avg_total_loss: 5.02e-07
2025-11-05 00:26:21,937: Epoch 15 average loss: avg_loss: 5.00e-07, avg_total_loss: 5.00e-07
2025-11-05 00:26:22,283: Epoch 15 average validation loss: 9.76e-07 -- Median validation metrics: avg_loss: 9.76e-07, NSE: 0.77812, MSE: 38010.08203
2025-11-05 00:26:22,967: Epoch 16 average loss: avg_loss: 6.14e-07, avg_total_loss: 6.14e-07
2025-11-05 00:26:23,613: Epoch 17 average loss: avg_loss: 4.90e-07, avg_total_loss: 4.90e-07
2025-11-05 00:26:24,332: Epoch 18 average loss: avg_loss: 5.28e-07, avg_total_loss: 5.28e-07
2025-11-05 00:26:25,044: Epoch 19 average loss: avg_loss: 4.88e-07, avg_total_loss: 4.88e-07
2025-11-05 00:26:25,698: Epoch 20 average loss: avg_loss: 4.71e-07, avg_total_loss: 4.71e-07
2025-11-05 00:26:26,062: Epoch 20 average validation loss: 8.00e-07 -- Median validation metrics: avg_loss: 8.00e-07, NSE: 0.81569, MSE: 31575.22461
2025-11-05 00:26:26,687: Epoch 21 average loss: avg_loss: 5.55e-07, avg_total_loss: 5.55e-07
2025-11-05 00:26:27,367: Epoch 22 average loss: avg_loss: 5.48e-07, avg_total_loss: 5.48e-07
2025-11-05 00:26:28,009: Epoch 23 average loss: avg_loss: 5.46e-07, avg_total_loss: 5.46e-07
2025-11-05 00:26:28,009: Setting learning rate to 0.005
2025-11-05 00:26:28,628: Epoch 24 average loss: avg_loss: 4.28e-07, avg_total_loss: 4.28e-07
2025-11-05 00:26:29,268: Epoch 25 average loss: avg_loss: 3.91e-07, avg_total_loss: 3.91e-07
2025-11-05 00:26:29,609: Epoch 25 average validation loss: 7.97e-07 -- Median validation metrics: avg_loss: 7.97e-07, NSE: 0.81726, MSE: 31305.65430
2025-11-05 00:26:29,610: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:26:29,611: Early stopping triggered at epoch 25
2025-11-05 00:26:29,639: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\model_epoch025.pt
2025-11-05 00:26:29,936: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:26:29,937: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002610\validation\model_epoch025\validation_results.p
2025-11-05 00:26:30,623: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\output.log initialized.
2025-11-05 00:26:30,624: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630
2025-11-05 00:26:30,625: ### Run configurations for testing_run
2025-11-05 00:26:30,625: experiment_name: testing_run
2025-11-05 00:26:30,626: train_basin_file: calpella
2025-11-05 00:26:30,626: validation_basin_file: calpella
2025-11-05 00:26:30,627: test_basin_file: calpella
2025-11-05 00:26:30,628: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:26:30,628: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:26:30,629: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:26:30,630: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:26:30,631: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:26:30,631: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:26:30,632: device: cuda:0
2025-11-05 00:26:30,633: physics_informed: True
2025-11-05 00:26:30,633: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:26:30,634: validate_every: 5
2025-11-05 00:26:30,634: validate_n_random_basins: 1
2025-11-05 00:26:30,635: metrics: ['NSE', 'MSE']
2025-11-05 00:26:30,636: model: cudalstm
2025-11-05 00:26:30,637: head: regression
2025-11-05 00:26:30,637: output_activation: linear
2025-11-05 00:26:30,638: hidden_size: 256
2025-11-05 00:26:30,638: initial_forget_bias: 3
2025-11-05 00:26:30,639: output_dropout: 0.4
2025-11-05 00:26:30,639: num_layers: 1
2025-11-05 00:26:30,640: dev_mode: True
2025-11-05 00:26:30,641: optimizer: Adam
2025-11-05 00:26:30,642: loss: NSE
2025-11-05 00:26:30,642: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:26:30,643: batch_size: 128
2025-11-05 00:26:30,643: epochs: 48
2025-11-05 00:26:30,644: clip_gradient_norm: 1
2025-11-05 00:26:30,645: predict_last_n: 1
2025-11-05 00:26:30,645: seq_length: 120
2025-11-05 00:26:30,646: log_interval: 16
2025-11-05 00:26:30,647: log_tensorboard: True
2025-11-05 00:26:30,647: log_n_figures: 1
2025-11-05 00:26:30,648: save_weights_every: 48
2025-11-05 00:26:30,649: early_stopping: True
2025-11-05 00:26:30,650: early_stopping_mode: patience
2025-11-05 00:26:30,650: patience_early_stopping: 3
2025-11-05 00:26:30,651: min_delta_early_stopping: 0.0
2025-11-05 00:26:30,652: minimum_epochs_before_early_stopping: 10
2025-11-05 00:26:30,652: early_stopping_slope_window: 7
2025-11-05 00:26:30,653: early_stopping_slope_patience: 2
2025-11-05 00:26:30,654: early_stopping_slope_min_epoch: 8
2025-11-05 00:26:30,654: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:26:30,655: early_stopping_slope_use_log: True
2025-11-05 00:26:30,656: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:26:30,657: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:26:30,658: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:26:30,659: early_stopping_slope_variance_guard: True
2025-11-05 00:26:30,660: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:26:30,661: dataset: russian_river
2025-11-05 00:26:30,662: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:26:30,663: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:26:30,664: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:26:30,665: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:26:30,666: hourly: False
2025-11-05 00:26:30,667: is_mts: False
2025-11-05 00:26:30,668: is_mts_data: False
2025-11-05 00:26:30,669: verbose: True
2025-11-05 00:26:30,669: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630
2025-11-05 00:26:30,670: run_label: BASELINE
2025-11-05 00:26:30,671: number_of_basins: 1
2025-11-05 00:26:30,671: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\train_data
2025-11-05 00:26:30,672: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\img_log
2025-11-05 00:26:30,674: ### Device cuda:0 will be used for training
2025-11-05 00:26:30,675: Loading basin data into xarray data set.
2025-11-05 00:26:30,897: Calculating target variable stds per basin
2025-11-05 00:26:30,906: Create lookup table and convert to pytorch tensor
2025-11-05 00:26:31,043: Early stopping enabled: mode=patience
2025-11-05 00:26:31,534: Epoch 1 average loss: avg_loss: 2.55e-06, avg_total_loss: 2.55e-06
2025-11-05 00:26:31,880: Epoch 2 average loss: avg_loss: 1.18e-06, avg_total_loss: 1.18e-06
2025-11-05 00:26:32,246: Epoch 3 average loss: avg_loss: 8.39e-07, avg_total_loss: 8.39e-07
2025-11-05 00:26:32,609: Epoch 4 average loss: avg_loss: 6.95e-07, avg_total_loss: 6.95e-07
2025-11-05 00:26:32,965: Epoch 5 average loss: avg_loss: 6.04e-07, avg_total_loss: 6.04e-07
2025-11-05 00:26:33,466: Epoch 5 average validation loss: 7.08e-07 -- Median validation metrics: avg_loss: 7.08e-07, NSE: 0.83766, MSE: 27810.81641
2025-11-05 00:26:33,825: Epoch 6 average loss: avg_loss: 5.86e-07, avg_total_loss: 5.86e-07
2025-11-05 00:26:34,150: Epoch 7 average loss: avg_loss: 4.92e-07, avg_total_loss: 4.92e-07
2025-11-05 00:26:34,524: Epoch 8 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:26:34,881: Epoch 9 average loss: avg_loss: 5.94e-07, avg_total_loss: 5.94e-07
2025-11-05 00:26:35,269: Epoch 10 average loss: avg_loss: 5.78e-07, avg_total_loss: 5.78e-07
2025-11-05 00:26:35,572: Epoch 10 average validation loss: 7.49e-07 -- Median validation metrics: avg_loss: 7.49e-07, NSE: 0.82913, MSE: 29271.39844
2025-11-05 00:26:35,885: Epoch 11 average loss: avg_loss: 5.90e-07, avg_total_loss: 5.90e-07
2025-11-05 00:26:36,245: Epoch 12 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:26:36,615: Epoch 13 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:26:36,972: Epoch 14 average loss: avg_loss: 5.75e-07, avg_total_loss: 5.75e-07
2025-11-05 00:26:37,349: Epoch 15 average loss: avg_loss: 5.26e-07, avg_total_loss: 5.26e-07
2025-11-05 00:26:37,630: Epoch 15 average validation loss: 7.61e-07 -- Median validation metrics: avg_loss: 7.61e-07, NSE: 0.82462, MSE: 30044.35156
2025-11-05 00:26:37,967: Epoch 16 average loss: avg_loss: 5.36e-07, avg_total_loss: 5.36e-07
2025-11-05 00:26:38,334: Epoch 17 average loss: avg_loss: 4.69e-07, avg_total_loss: 4.69e-07
2025-11-05 00:26:38,687: Epoch 18 average loss: avg_loss: 4.77e-07, avg_total_loss: 4.77e-07
2025-11-05 00:26:39,042: Epoch 19 average loss: avg_loss: 5.03e-07, avg_total_loss: 5.03e-07
2025-11-05 00:26:39,402: Epoch 20 average loss: avg_loss: 5.23e-07, avg_total_loss: 5.23e-07
2025-11-05 00:26:39,696: Epoch 20 average validation loss: 8.81e-07 -- Median validation metrics: avg_loss: 8.81e-07, NSE: 0.80077, MSE: 34130.71875
2025-11-05 00:26:40,002: Epoch 21 average loss: avg_loss: 4.87e-07, avg_total_loss: 4.87e-07
2025-11-05 00:26:40,348: Epoch 22 average loss: avg_loss: 4.09e-07, avg_total_loss: 4.09e-07
2025-11-05 00:26:40,700: Epoch 23 average loss: avg_loss: 4.63e-07, avg_total_loss: 4.63e-07
2025-11-05 00:26:40,701: Setting learning rate to 0.005
2025-11-05 00:26:41,083: Epoch 24 average loss: avg_loss: 4.30e-07, avg_total_loss: 4.30e-07
2025-11-05 00:26:41,447: Epoch 25 average loss: avg_loss: 4.13e-07, avg_total_loss: 4.13e-07
2025-11-05 00:26:41,763: Epoch 25 average validation loss: 7.68e-07 -- Median validation metrics: avg_loss: 7.68e-07, NSE: 0.82416, MSE: 30122.85938
2025-11-05 00:26:41,764: ES[patience]: STOP at epoch=25 after 3 checks without improvement
2025-11-05 00:26:41,765: Early stopping triggered at epoch 25
2025-11-05 00:26:41,790: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\model_epoch025.pt
2025-11-05 00:26:42,079: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\validation\model_epoch025\validation_metrics.csv
2025-11-05 00:26:42,080: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002630\validation\model_epoch025\validation_results.p
2025-11-05 00:26:42,750: Logging to C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\output.log initialized.
2025-11-05 00:26:42,751: ### Folder structure created at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642
2025-11-05 00:26:42,752: ### Run configurations for testing_run
2025-11-05 00:26:42,753: experiment_name: testing_run
2025-11-05 00:26:42,754: train_basin_file: calpella
2025-11-05 00:26:42,755: validation_basin_file: calpella
2025-11-05 00:26:42,757: test_basin_file: calpella
2025-11-05 00:26:42,758: train_start_date: 1994-10-01 00:00:00
2025-11-05 00:26:42,759: train_end_date: 2002-09-30 00:00:00
2025-11-05 00:26:42,761: validation_start_date: 2002-10-01 00:00:00
2025-11-05 00:26:42,763: validation_end_date: 2005-09-30 00:00:00
2025-11-05 00:26:42,764: test_start_date: 2005-10-01 00:00:00
2025-11-05 00:26:42,765: test_end_date: 2009-09-29 00:00:00
2025-11-05 00:26:42,767: device: cuda:0
2025-11-05 00:26:42,769: physics_informed: True
2025-11-05 00:26:42,770: physics_data_file: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data\Calpella_daily_shift.csv
2025-11-05 00:26:42,772: validate_every: 5
2025-11-05 00:26:42,773: validate_n_random_basins: 1
2025-11-05 00:26:42,774: metrics: ['NSE', 'MSE']
2025-11-05 00:26:42,776: model: cudalstm
2025-11-05 00:26:42,777: head: regression
2025-11-05 00:26:42,778: output_activation: linear
2025-11-05 00:26:42,779: hidden_size: 256
2025-11-05 00:26:42,780: initial_forget_bias: 3
2025-11-05 00:26:42,782: output_dropout: 0.4
2025-11-05 00:26:42,783: num_layers: 1
2025-11-05 00:26:42,784: dev_mode: True
2025-11-05 00:26:42,785: optimizer: Adam
2025-11-05 00:26:42,786: loss: NSE
2025-11-05 00:26:42,787: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-05 00:26:42,789: batch_size: 256
2025-11-05 00:26:42,790: epochs: 48
2025-11-05 00:26:42,792: clip_gradient_norm: 1
2025-11-05 00:26:42,793: predict_last_n: 1
2025-11-05 00:26:42,794: seq_length: 120
2025-11-05 00:26:42,794: log_interval: 16
2025-11-05 00:26:42,796: log_tensorboard: True
2025-11-05 00:26:42,796: log_n_figures: 1
2025-11-05 00:26:42,797: save_weights_every: 48
2025-11-05 00:26:42,798: early_stopping: True
2025-11-05 00:26:42,798: early_stopping_mode: patience
2025-11-05 00:26:42,800: patience_early_stopping: 3
2025-11-05 00:26:42,800: min_delta_early_stopping: 0.0
2025-11-05 00:26:42,801: minimum_epochs_before_early_stopping: 10
2025-11-05 00:26:42,803: early_stopping_slope_window: 7
2025-11-05 00:26:42,804: early_stopping_slope_patience: 2
2025-11-05 00:26:42,805: early_stopping_slope_min_epoch: 8
2025-11-05 00:26:42,806: early_stopping_slope_ema_alpha: 0.4
2025-11-05 00:26:42,807: early_stopping_slope_use_log: True
2025-11-05 00:26:42,809: early_stopping_slope_log_eps: 1e-12
2025-11-05 00:26:42,810: early_stopping_slope_eps_slope: 0.001
2025-11-05 00:26:42,811: early_stopping_slope_min_window_gain: 0.01
2025-11-05 00:26:42,812: early_stopping_slope_variance_guard: True
2025-11-05 00:26:42,812: early_stopping_slope_variance_cv_max: 0.01
2025-11-05 00:26:42,814: dataset: russian_river
2025-11-05 00:26:42,814: data_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\russian_river_data
2025-11-05 00:26:42,816: dynamic_inputs: ['EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'POTTER VALLEY CA FLOW USGS_ADJUSTED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'Capella Gage FLOW', 'EF Russian 20 ET-POTENTIAL', 'EF Russian 20 FLOW', 'EF Russian 20 FLOW-BASE', 'EF Russian 20 INFILTRATION', 'EF Russian 20 PERC-SOIL', 'EF Russian 20 SATURATION FRACTION']
2025-11-05 00:26:42,816: target_variables: ['NR CALPELLA FLOW COE CPL']
2025-11-05 00:26:42,817: clip_targets_to_zero: [['NR CALPELLA FLOW COE CPL']]
2025-11-05 00:26:42,818: hourly: False
2025-11-05 00:26:42,819: is_mts: False
2025-11-05 00:26:42,819: is_mts_data: False
2025-11-05 00:26:42,820: verbose: True
2025-11-05 00:26:42,821: run_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642
2025-11-05 00:26:42,822: run_label: BASELINE
2025-11-05 00:26:42,823: number_of_basins: 1
2025-11-05 00:26:42,823: train_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\train_data
2025-11-05 00:26:42,824: img_log_dir: C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\img_log
2025-11-05 00:26:42,827: ### Device cuda:0 will be used for training
2025-11-05 00:26:42,828: Loading basin data into xarray data set.
2025-11-05 00:26:43,068: Calculating target variable stds per basin
2025-11-05 00:26:43,081: Create lookup table and convert to pytorch tensor
2025-11-05 00:26:43,219: Early stopping enabled: mode=patience
2025-11-05 00:26:43,548: Epoch 1 average loss: avg_loss: 3.56e-06, avg_total_loss: 3.56e-06
2025-11-05 00:26:43,817: Epoch 2 average loss: avg_loss: 1.49e-06, avg_total_loss: 1.49e-06
2025-11-05 00:26:44,068: Epoch 3 average loss: avg_loss: 1.15e-06, avg_total_loss: 1.15e-06
2025-11-05 00:26:44,292: Epoch 4 average loss: avg_loss: 1.02e-06, avg_total_loss: 1.02e-06
2025-11-05 00:26:44,532: Epoch 5 average loss: avg_loss: 8.82e-07, avg_total_loss: 8.82e-07
2025-11-05 00:26:45,030: Epoch 5 average validation loss: 7.96e-07 -- Median validation metrics: avg_loss: 7.96e-07, NSE: 0.79780, MSE: 34638.88672
2025-11-05 00:26:45,240: Epoch 6 average loss: avg_loss: 7.76e-07, avg_total_loss: 7.76e-07
2025-11-05 00:26:45,460: Epoch 7 average loss: avg_loss: 7.35e-07, avg_total_loss: 7.35e-07
2025-11-05 00:26:45,696: Epoch 8 average loss: avg_loss: 6.99e-07, avg_total_loss: 6.99e-07
2025-11-05 00:26:45,926: Epoch 9 average loss: avg_loss: 6.64e-07, avg_total_loss: 6.64e-07
2025-11-05 00:26:46,156: Epoch 10 average loss: avg_loss: 5.99e-07, avg_total_loss: 5.99e-07
2025-11-05 00:26:46,485: Epoch 10 average validation loss: 7.67e-07 -- Median validation metrics: avg_loss: 7.67e-07, NSE: 0.80407, MSE: 33564.42969
2025-11-05 00:26:46,711: Epoch 11 average loss: avg_loss: 6.05e-07, avg_total_loss: 6.05e-07
2025-11-05 00:26:46,931: Epoch 12 average loss: avg_loss: 5.79e-07, avg_total_loss: 5.79e-07
2025-11-05 00:26:47,180: Epoch 13 average loss: avg_loss: 5.84e-07, avg_total_loss: 5.84e-07
2025-11-05 00:26:47,417: Epoch 14 average loss: avg_loss: 5.39e-07, avg_total_loss: 5.39e-07
2025-11-05 00:26:47,644: Epoch 15 average loss: avg_loss: 5.23e-07, avg_total_loss: 5.23e-07
2025-11-05 00:26:47,973: Epoch 15 average validation loss: 8.22e-07 -- Median validation metrics: avg_loss: 8.22e-07, NSE: 0.79120, MSE: 35769.50000
2025-11-05 00:26:48,223: Epoch 16 average loss: avg_loss: 5.41e-07, avg_total_loss: 5.41e-07
2025-11-05 00:26:48,451: Epoch 17 average loss: avg_loss: 4.91e-07, avg_total_loss: 4.91e-07
2025-11-05 00:26:48,685: Epoch 18 average loss: avg_loss: 4.85e-07, avg_total_loss: 4.85e-07
2025-11-05 00:26:48,947: Epoch 19 average loss: avg_loss: 4.83e-07, avg_total_loss: 4.83e-07
2025-11-05 00:26:49,181: Epoch 20 average loss: avg_loss: 4.08e-07, avg_total_loss: 4.08e-07
2025-11-05 00:26:49,475: Epoch 20 average validation loss: 7.59e-07 -- Median validation metrics: avg_loss: 7.59e-07, NSE: 0.81008, MSE: 32535.11523
2025-11-05 00:26:49,705: Epoch 21 average loss: avg_loss: 4.54e-07, avg_total_loss: 4.54e-07
2025-11-05 00:26:49,956: Epoch 22 average loss: avg_loss: 4.48e-07, avg_total_loss: 4.48e-07
2025-11-05 00:26:50,192: Epoch 23 average loss: avg_loss: 4.76e-07, avg_total_loss: 4.76e-07
2025-11-05 00:26:50,193: Setting learning rate to 0.005
2025-11-05 00:26:50,452: Epoch 24 average loss: avg_loss: 5.20e-07, avg_total_loss: 5.20e-07
2025-11-05 00:26:50,695: Epoch 25 average loss: avg_loss: 4.06e-07, avg_total_loss: 4.06e-07
2025-11-05 00:26:51,201: Epoch 25 average validation loss: 6.65e-07 -- Median validation metrics: avg_loss: 6.65e-07, NSE: 0.83110, MSE: 28933.84180
2025-11-05 00:26:51,415: Epoch 26 average loss: avg_loss: 4.70e-07, avg_total_loss: 4.70e-07
2025-11-05 00:26:51,660: Epoch 27 average loss: avg_loss: 4.15e-07, avg_total_loss: 4.15e-07
2025-11-05 00:26:51,891: Epoch 28 average loss: avg_loss: 4.01e-07, avg_total_loss: 4.01e-07
2025-11-05 00:26:52,113: Epoch 29 average loss: avg_loss: 3.85e-07, avg_total_loss: 3.85e-07
2025-11-05 00:26:52,362: Epoch 30 average loss: avg_loss: 3.76e-07, avg_total_loss: 3.76e-07
2025-11-05 00:26:52,670: Epoch 30 average validation loss: 6.48e-07 -- Median validation metrics: avg_loss: 6.48e-07, NSE: 0.83563, MSE: 28158.31836
2025-11-05 00:26:52,877: Epoch 31 average loss: avg_loss: 3.44e-07, avg_total_loss: 3.44e-07
2025-11-05 00:26:53,101: Epoch 32 average loss: avg_loss: 3.28e-07, avg_total_loss: 3.28e-07
2025-11-05 00:26:53,337: Epoch 33 average loss: avg_loss: 3.16e-07, avg_total_loss: 3.16e-07
2025-11-05 00:26:53,564: Epoch 34 average loss: avg_loss: 2.98e-07, avg_total_loss: 2.98e-07
2025-11-05 00:26:53,811: Epoch 35 average loss: avg_loss: 2.81e-07, avg_total_loss: 2.81e-07
2025-11-05 00:26:54,203: Epoch 35 average validation loss: 7.10e-07 -- Median validation metrics: avg_loss: 7.10e-07, NSE: 0.81962, MSE: 30901.84570
2025-11-05 00:26:54,204: Setting learning rate to 0.001
2025-11-05 00:26:54,437: Epoch 36 average loss: avg_loss: 2.82e-07, avg_total_loss: 2.82e-07
2025-11-05 00:26:54,669: Epoch 37 average loss: avg_loss: 2.71e-07, avg_total_loss: 2.71e-07
2025-11-05 00:26:54,919: Epoch 38 average loss: avg_loss: 2.71e-07, avg_total_loss: 2.71e-07
2025-11-05 00:26:55,160: Epoch 39 average loss: avg_loss: 2.44e-07, avg_total_loss: 2.44e-07
2025-11-05 00:26:55,398: Epoch 40 average loss: avg_loss: 2.64e-07, avg_total_loss: 2.64e-07
2025-11-05 00:26:55,754: Epoch 40 average validation loss: 7.12e-07 -- Median validation metrics: avg_loss: 7.12e-07, NSE: 0.81943, MSE: 30934.49414
2025-11-05 00:26:55,964: Epoch 41 average loss: avg_loss: 2.32e-07, avg_total_loss: 2.32e-07
2025-11-05 00:26:56,166: Epoch 42 average loss: avg_loss: 2.46e-07, avg_total_loss: 2.46e-07
2025-11-05 00:26:56,393: Epoch 43 average loss: avg_loss: 2.66e-07, avg_total_loss: 2.66e-07
2025-11-05 00:26:56,631: Epoch 44 average loss: avg_loss: 2.52e-07, avg_total_loss: 2.52e-07
2025-11-05 00:26:56,843: Epoch 45 average loss: avg_loss: 2.85e-07, avg_total_loss: 2.85e-07
2025-11-05 00:26:57,156: Epoch 45 average validation loss: 7.09e-07 -- Median validation metrics: avg_loss: 7.09e-07, NSE: 0.81979, MSE: 30871.46289
2025-11-05 00:26:57,158: ES[patience]: STOP at epoch=45 after 3 checks without improvement
2025-11-05 00:26:57,158: Early stopping triggered at epoch 45
2025-11-05 00:26:57,180: Using the model weights from C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\model_epoch045.pt
2025-11-05 00:26:57,502: Stored metrics at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\validation\model_epoch045\validation_metrics.csv
2025-11-05 00:26:57,503: Stored results at C:\Users\arthu\OneDrive\Documents\GitHub\UCB-USACE-RR-PROJECT\outputs\calpella\daily_shared\runs\BASELINE\testing_run_0511_002642\validation\model_epoch045\validation_results.p
