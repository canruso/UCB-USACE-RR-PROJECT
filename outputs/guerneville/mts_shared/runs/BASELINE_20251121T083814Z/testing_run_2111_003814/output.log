2025-11-21 00:38:14,463: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083814Z/testing_run_2111_003814/output.log initialized.
2025-11-21 00:38:14,463: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083814Z/testing_run_2111_003814
2025-11-21 00:38:14,464: ### Run configurations for testing_run
2025-11-21 00:38:14,464: experiment_name: testing_run
2025-11-21 00:38:14,464: train_basin_file: guerneville
2025-11-21 00:38:14,464: validation_basin_file: guerneville
2025-11-21 00:38:14,464: test_basin_file: guerneville
2025-11-21 00:38:14,465: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:38:14,465: train_end_date: 2002-09-30 00:00:00
2025-11-21 00:38:14,465: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:38:14,465: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:38:14,466: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:38:14,466: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:38:14,466: device: cpu
2025-11-21 00:38:14,466: physics_informed: False
2025-11-21 00:38:14,466: physics_data_file: None
2025-11-21 00:38:14,467: validate_every: 5
2025-11-21 00:38:14,467: validate_n_random_basins: 1
2025-11-21 00:38:14,467: save_validation_results: True
2025-11-21 00:38:14,467: metrics: ['NSE', 'MSE']
2025-11-21 00:38:14,467: model: mtslstm
2025-11-21 00:38:14,468: shared_mtslstm: False
2025-11-21 00:38:14,468: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:38:14,468: use_frequencies: ['1H', '1D']
2025-11-21 00:38:14,468: head: regression
2025-11-21 00:38:14,468: output_activation: linear
2025-11-21 00:38:14,469: hidden_size: 256
2025-11-21 00:38:14,469: initial_forget_bias: 3
2025-11-21 00:38:14,469: output_dropout: 0.4
2025-11-21 00:38:14,469: optimizer: Adam
2025-11-21 00:38:14,469: loss: NSE
2025-11-21 00:38:14,470: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:38:14,470: batch_size: 64
2025-11-21 00:38:14,470: epochs: 48
2025-11-21 00:38:14,470: clip_gradient_norm: 1
2025-11-21 00:38:14,470: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:38:14,471: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:38:14,471: log_interval: 16
2025-11-21 00:38:14,471: log_tensorboard: True
2025-11-21 00:38:14,471: log_n_figures: 1
2025-11-21 00:38:14,471: save_weights_every: 48
2025-11-21 00:38:14,471: dataset: russian_river
2025-11-21 00:38:14,472: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:38:14,472: dev_mode: True
2025-11-21 00:38:14,472: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:38:14,472: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:38:14,472: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:38:14,472: num_layers: 1
2025-11-21 00:38:14,473: hourly: True
2025-11-21 00:38:14,473: is_mts: True
2025-11-21 00:38:14,473: is_mts_data: False
2025-11-21 00:38:14,473: verbose: True
2025-11-21 00:38:14,473: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083814Z/testing_run_2111_003814
2025-11-21 00:38:14,474: run_label: BASELINE
2025-11-21 00:38:14,474: run_stamp: 20251121T083814Z
2025-11-21 00:38:14,474: number_of_basins: 1
2025-11-21 00:38:14,474: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083814Z/testing_run_2111_003814/train_data
2025-11-21 00:38:14,474: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083814Z/testing_run_2111_003814/img_log
2025-11-21 00:38:14,479: ### Device cpu will be used for training
2025-11-21 00:38:14,480: Loading basin data into xarray data set.
2025-11-21 00:38:15,731: Calculating target variable stds per basin
2025-11-21 00:38:15,760: Create lookup table and convert to pytorch tensor
2025-11-21 00:38:16,713: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:38:26,076: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:38:34,338: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:38:42,629: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:39:58,139: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083958Z/testing_run_2111_003958/output.log initialized.
2025-11-21 00:39:58,140: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083958Z/testing_run_2111_003958
2025-11-21 00:39:58,140: ### Run configurations for testing_run
2025-11-21 00:39:58,140: experiment_name: testing_run
2025-11-21 00:39:58,141: train_basin_file: guerneville
2025-11-21 00:39:58,141: validation_basin_file: guerneville
2025-11-21 00:39:58,141: test_basin_file: guerneville
2025-11-21 00:39:58,141: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:39:58,142: train_end_date: 2002-09-30 00:00:00
2025-11-21 00:39:58,142: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:39:58,142: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:39:58,142: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:39:58,142: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:39:58,143: device: cpu
2025-11-21 00:39:58,143: physics_informed: False
2025-11-21 00:39:58,143: physics_data_file: None
2025-11-21 00:39:58,143: validate_every: 5
2025-11-21 00:39:58,143: validate_n_random_basins: 1
2025-11-21 00:39:58,144: save_validation_results: True
2025-11-21 00:39:58,144: metrics: ['NSE', 'MSE']
2025-11-21 00:39:58,144: model: mtslstm
2025-11-21 00:39:58,144: shared_mtslstm: False
2025-11-21 00:39:58,144: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:39:58,145: use_frequencies: ['1H', '1D']
2025-11-21 00:39:58,145: head: regression
2025-11-21 00:39:58,145: output_activation: linear
2025-11-21 00:39:58,145: hidden_size: 256
2025-11-21 00:39:58,145: initial_forget_bias: 3
2025-11-21 00:39:58,145: output_dropout: 0.4
2025-11-21 00:39:58,146: optimizer: Adam
2025-11-21 00:39:58,146: loss: NSE
2025-11-21 00:39:58,146: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:39:58,146: batch_size: 64
2025-11-21 00:39:58,146: epochs: 48
2025-11-21 00:39:58,147: clip_gradient_norm: 1
2025-11-21 00:39:58,147: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:39:58,147: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:39:58,147: log_interval: 16
2025-11-21 00:39:58,147: log_tensorboard: True
2025-11-21 00:39:58,148: log_n_figures: 1
2025-11-21 00:39:58,148: save_weights_every: 48
2025-11-21 00:39:58,148: dataset: russian_river
2025-11-21 00:39:58,148: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:39:58,148: dev_mode: True
2025-11-21 00:39:58,149: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:39:58,149: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:39:58,149: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:39:58,149: num_layers: 1
2025-11-21 00:39:58,150: hourly: True
2025-11-21 00:39:58,150: is_mts: True
2025-11-21 00:39:58,150: is_mts_data: False
2025-11-21 00:39:58,150: verbose: True
2025-11-21 00:39:58,151: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083958Z/testing_run_2111_003958
2025-11-21 00:39:58,151: run_label: BASELINE
2025-11-21 00:39:58,151: run_stamp: 20251121T083958Z
2025-11-21 00:39:58,151: number_of_basins: 1
2025-11-21 00:39:58,151: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083958Z/testing_run_2111_003958/train_data
2025-11-21 00:39:58,151: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T083958Z/testing_run_2111_003958/img_log
2025-11-21 00:39:58,157: ### Device cpu will be used for training
2025-11-21 00:39:58,158: Loading basin data into xarray data set.
2025-11-21 00:39:59,375: Calculating target variable stds per basin
2025-11-21 00:39:59,408: Create lookup table and convert to pytorch tensor
2025-11-21 00:39:59,499: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:40:08,761: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:49:41,085: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/output.log initialized.
2025-11-21 00:49:41,085: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941
2025-11-21 00:49:41,086: ### Run configurations for testing_run
2025-11-21 00:49:41,086: experiment_name: testing_run
2025-11-21 00:49:41,086: train_basin_file: guerneville
2025-11-21 00:49:41,086: validation_basin_file: guerneville
2025-11-21 00:49:41,086: test_basin_file: guerneville
2025-11-21 00:49:41,087: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:49:41,087: train_end_date: 2002-09-30 00:00:00
2025-11-21 00:49:41,087: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:49:41,087: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:49:41,087: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:49:41,088: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:49:41,088: device: cpu
2025-11-21 00:49:41,088: physics_informed: False
2025-11-21 00:49:41,088: physics_data_file: None
2025-11-21 00:49:41,088: validate_every: 5
2025-11-21 00:49:41,089: validate_n_random_basins: 1
2025-11-21 00:49:41,089: save_validation_results: True
2025-11-21 00:49:41,089: metrics: ['NSE', 'MSE']
2025-11-21 00:49:41,089: model: mtslstm
2025-11-21 00:49:41,089: shared_mtslstm: False
2025-11-21 00:49:41,090: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:49:41,090: use_frequencies: ['1H', '1D']
2025-11-21 00:49:41,090: head: regression
2025-11-21 00:49:41,090: output_activation: linear
2025-11-21 00:49:41,090: hidden_size: 256
2025-11-21 00:49:41,091: initial_forget_bias: 3
2025-11-21 00:49:41,091: output_dropout: 0.4
2025-11-21 00:49:41,091: optimizer: Adam
2025-11-21 00:49:41,091: loss: NSE
2025-11-21 00:49:41,091: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:49:41,092: batch_size: 64
2025-11-21 00:49:41,092: epochs: 3
2025-11-21 00:49:41,092: clip_gradient_norm: 1
2025-11-21 00:49:41,092: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:49:41,092: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:49:41,092: log_interval: 16
2025-11-21 00:49:41,093: log_tensorboard: True
2025-11-21 00:49:41,093: log_n_figures: 1
2025-11-21 00:49:41,093: save_weights_every: 3
2025-11-21 00:49:41,093: dataset: russian_river
2025-11-21 00:49:41,093: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:49:41,094: dev_mode: True
2025-11-21 00:49:41,094: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:49:41,094: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:49:41,094: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:49:41,094: num_layers: 1
2025-11-21 00:49:41,095: hourly: True
2025-11-21 00:49:41,095: is_mts: True
2025-11-21 00:49:41,095: is_mts_data: False
2025-11-21 00:49:41,095: verbose: True
2025-11-21 00:49:41,095: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941
2025-11-21 00:49:41,095: run_label: BASELINE
2025-11-21 00:49:41,096: run_stamp: 20251121T084941Z
2025-11-21 00:49:41,096: number_of_basins: 1
2025-11-21 00:49:41,096: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/train_data
2025-11-21 00:49:41,096: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/img_log
2025-11-21 00:49:41,099: ### Device cpu will be used for training
2025-11-21 00:49:41,099: Loading basin data into xarray data set.
2025-11-21 00:49:42,337: Calculating target variable stds per basin
2025-11-21 00:49:42,362: Create lookup table and convert to pytorch tensor
2025-11-21 00:49:42,482: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:49:50,898: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:49:59,087: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:50:07,332: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:50:07,367: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:50:07,376: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/model_epoch003.pt
2025-11-21 00:50:10,170: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/validation/model_epoch003/validation_metrics.csv
2025-11-21 00:50:10,171: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_004941/validation/model_epoch003/validation_results.p
2025-11-21 00:50:10,598: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/output.log initialized.
2025-11-21 00:50:10,599: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010
2025-11-21 00:50:10,599: ### Run configurations for testing_run
2025-11-21 00:50:10,599: experiment_name: testing_run
2025-11-21 00:50:10,599: train_basin_file: guerneville
2025-11-21 00:50:10,600: validation_basin_file: guerneville
2025-11-21 00:50:10,600: test_basin_file: guerneville
2025-11-21 00:50:10,600: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:50:10,600: train_end_date: 2002-09-30 00:00:00
2025-11-21 00:50:10,601: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:50:10,601: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:50:10,601: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:50:10,601: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:50:10,601: device: cpu
2025-11-21 00:50:10,602: physics_informed: True
2025-11-21 00:50:10,602: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 00:50:10,602: validate_every: 5
2025-11-21 00:50:10,602: validate_n_random_basins: 1
2025-11-21 00:50:10,602: save_validation_results: True
2025-11-21 00:50:10,602: metrics: ['NSE', 'MSE']
2025-11-21 00:50:10,603: model: mtslstm
2025-11-21 00:50:10,603: shared_mtslstm: False
2025-11-21 00:50:10,603: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:50:10,603: use_frequencies: ['1H', '1D']
2025-11-21 00:50:10,603: head: regression
2025-11-21 00:50:10,604: output_activation: linear
2025-11-21 00:50:10,604: hidden_size: 128
2025-11-21 00:50:10,604: initial_forget_bias: 3
2025-11-21 00:50:10,604: output_dropout: 0.4
2025-11-21 00:50:10,604: optimizer: Adam
2025-11-21 00:50:10,604: loss: NSE
2025-11-21 00:50:10,605: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:50:10,605: batch_size: 64
2025-11-21 00:50:10,605: epochs: 3
2025-11-21 00:50:10,605: clip_gradient_norm: 1
2025-11-21 00:50:10,605: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:50:10,606: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:50:10,606: log_interval: 16
2025-11-21 00:50:10,606: log_tensorboard: True
2025-11-21 00:50:10,606: log_n_figures: 1
2025-11-21 00:50:10,606: save_weights_every: 3
2025-11-21 00:50:10,606: dataset: russian_river
2025-11-21 00:50:10,607: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:50:10,607: dev_mode: True
2025-11-21 00:50:10,607: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 00:50:10,607: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:50:10,607: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:50:10,608: num_layers: 1
2025-11-21 00:50:10,608: hourly: True
2025-11-21 00:50:10,608: is_mts: True
2025-11-21 00:50:10,608: is_mts_data: False
2025-11-21 00:50:10,608: verbose: True
2025-11-21 00:50:10,609: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010
2025-11-21 00:50:10,609: run_label: BASELINE
2025-11-21 00:50:10,609: run_stamp: 20251121T084941Z
2025-11-21 00:50:10,609: number_of_basins: 1
2025-11-21 00:50:10,609: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/train_data
2025-11-21 00:50:10,609: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/img_log
2025-11-21 00:50:10,611: ### Device cpu will be used for training
2025-11-21 00:50:10,612: Loading basin data into xarray data set.
2025-11-21 00:50:15,191: Calculating target variable stds per basin
2025-11-21 00:50:15,244: Create lookup table and convert to pytorch tensor
2025-11-21 00:50:15,452: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:50:20,268: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:50:24,973: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:50:29,640: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:50:29,657: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:50:29,671: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/model_epoch003.pt
2025-11-21 00:50:34,404: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/validation/model_epoch003/validation_metrics.csv
2025-11-21 00:50:34,405: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005010/validation/model_epoch003/validation_results.p
2025-11-21 00:50:41,799: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/output.log initialized.
2025-11-21 00:50:41,800: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041
2025-11-21 00:50:41,801: ### Run configurations for testing_run
2025-11-21 00:50:41,802: experiment_name: testing_run
2025-11-21 00:50:41,802: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:50:41,803: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:50:41,803: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:50:41,804: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:50:41,805: train_end_date: 2005-09-30 00:00:00
2025-11-21 00:50:41,805: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:50:41,806: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:50:41,806: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:50:41,807: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:50:41,808: device: cpu
2025-11-21 00:50:41,808: physics_informed: False
2025-11-21 00:50:41,809: physics_data_file: None
2025-11-21 00:50:41,809: validate_every: 5
2025-11-21 00:50:41,809: validate_n_random_basins: 1
2025-11-21 00:50:41,809: save_validation_results: True
2025-11-21 00:50:41,810: metrics: ['NSE', 'MSE']
2025-11-21 00:50:41,810: model: mtslstm
2025-11-21 00:50:41,810: shared_mtslstm: False
2025-11-21 00:50:41,810: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:50:41,811: use_frequencies: ['1H', '1D']
2025-11-21 00:50:41,811: head: regression
2025-11-21 00:50:41,811: output_activation: linear
2025-11-21 00:50:41,812: hidden_size: 256
2025-11-21 00:50:41,812: initial_forget_bias: 3
2025-11-21 00:50:41,812: output_dropout: 0.4
2025-11-21 00:50:41,812: optimizer: Adam
2025-11-21 00:50:41,813: loss: NSE
2025-11-21 00:50:41,813: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:50:41,813: batch_size: 64
2025-11-21 00:50:41,813: epochs: 3
2025-11-21 00:50:41,813: clip_gradient_norm: 1
2025-11-21 00:50:41,814: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:50:41,814: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:50:41,814: log_interval: 16
2025-11-21 00:50:41,815: log_tensorboard: True
2025-11-21 00:50:41,815: log_n_figures: 1
2025-11-21 00:50:41,815: save_weights_every: 3
2025-11-21 00:50:41,816: dataset: russian_river
2025-11-21 00:50:41,816: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:50:41,817: dev_mode: True
2025-11-21 00:50:41,817: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:50:41,818: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:50:41,818: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:50:41,818: num_layers: 1
2025-11-21 00:50:41,819: hourly: True
2025-11-21 00:50:41,819: is_mts: True
2025-11-21 00:50:41,819: is_mts_data: False
2025-11-21 00:50:41,819: verbose: True
2025-11-21 00:50:41,820: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041
2025-11-21 00:50:41,820: run_label: BASELINE
2025-11-21 00:50:41,820: run_stamp: 20251121T084941Z
2025-11-21 00:50:41,821: number_of_basins: 1
2025-11-21 00:50:41,821: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/train_data
2025-11-21 00:50:41,821: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/img_log
2025-11-21 00:50:41,823: ### Device cpu will be used for training
2025-11-21 00:50:41,824: Loading basin data into xarray data set.
2025-11-21 00:50:43,096: Calculating target variable stds per basin
2025-11-21 00:50:43,123: Create lookup table and convert to pytorch tensor
2025-11-21 00:50:43,244: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:50:55,469: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:51:07,172: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:51:19,063: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:51:19,094: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/testing_run_2111_005119/output.log initialized.
2025-11-21 00:51:19,095: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/testing_run_2111_005119
2025-11-21 00:51:19,095: ### Run configurations for testing_run
2025-11-21 00:51:19,095: experiment_name: testing_run
2025-11-21 00:51:19,095: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:51:19,096: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:51:19,096: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:51:19,096: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:51:19,096: train_end_date: 2005-09-30 00:00:00
2025-11-21 00:51:19,097: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:51:19,097: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:51:19,097: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:51:19,097: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:51:19,097: device: cpu
2025-11-21 00:51:19,097: physics_informed: False
2025-11-21 00:51:19,098: physics_data_file: None
2025-11-21 00:51:19,098: validate_every: 5
2025-11-21 00:51:19,098: validate_n_random_basins: 1
2025-11-21 00:51:19,098: save_validation_results: True
2025-11-21 00:51:19,098: metrics: ['NSE', 'MSE']
2025-11-21 00:51:19,099: model: mtslstm
2025-11-21 00:51:19,099: shared_mtslstm: False
2025-11-21 00:51:19,099: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:51:19,099: use_frequencies: ['1H', '1D']
2025-11-21 00:51:19,099: head: regression
2025-11-21 00:51:19,099: output_activation: linear
2025-11-21 00:51:19,100: hidden_size: 256
2025-11-21 00:51:19,100: initial_forget_bias: 3
2025-11-21 00:51:19,100: output_dropout: 0.4
2025-11-21 00:51:19,100: optimizer: Adam
2025-11-21 00:51:19,100: loss: NSE
2025-11-21 00:51:19,100: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:51:19,101: batch_size: 64
2025-11-21 00:51:19,101: epochs: 3
2025-11-21 00:51:19,101: clip_gradient_norm: 1
2025-11-21 00:51:19,101: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:51:19,101: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:51:19,101: log_interval: 16
2025-11-21 00:51:19,102: log_tensorboard: True
2025-11-21 00:51:19,102: log_n_figures: 1
2025-11-21 00:51:19,102: save_weights_every: 3
2025-11-21 00:51:19,102: dataset: russian_river
2025-11-21 00:51:19,102: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:51:19,103: dev_mode: True
2025-11-21 00:51:19,103: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:51:19,103: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:51:19,103: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:51:19,103: num_layers: 1
2025-11-21 00:51:19,103: hourly: True
2025-11-21 00:51:19,104: is_mts: True
2025-11-21 00:51:19,104: is_mts_data: False
2025-11-21 00:51:19,104: verbose: True
2025-11-21 00:51:19,104: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/testing_run_2111_005119
2025-11-21 00:51:19,104: run_label: BASELINE
2025-11-21 00:51:19,104: run_stamp: 20251121T084941Z
2025-11-21 00:51:19,105: number_of_basins: 1
2025-11-21 00:51:19,105: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/testing_run_2111_005119/train_data
2025-11-21 00:51:19,105: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084941Z/testing_run_2111_005041/testing_run_2111_005119/img_log
2025-11-21 00:51:19,105: seed: 26989
2025-11-21 00:51:19,105: commit_hash: 994040c
2025-11-21 00:51:19,106: package_version: 1.11.0
2025-11-21 00:51:19,107: ### Device cpu will be used for training
2025-11-21 00:51:19,108: Loading basin data into xarray data set.
2025-11-21 00:51:20,356: Calculating target variable stds per basin
2025-11-21 00:51:20,381: Create lookup table and convert to pytorch tensor
2025-11-21 00:51:20,494: No specific hidden size for frequencies are specified. Same hidden size is used for all.
