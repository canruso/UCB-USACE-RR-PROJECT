2025-11-14 12:40:24,887: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124024/output.log initialized.
2025-11-14 12:40:24,888: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124024
2025-11-14 12:40:24,889: ### Run configurations for testing_run
2025-11-14 12:40:24,889: experiment_name: testing_run
2025-11-14 12:40:24,890: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:24,890: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:24,890: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:24,891: train_ranges: ['01/10/1994-30/09/2002']
2025-11-14 12:40:24,891: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-14 12:40:24,891: test_ranges: ['01/10/2005-30/09/2009']
2025-11-14 12:40:24,892: device: cpu
2025-11-14 12:40:24,892: physics_informed: False
2025-11-14 12:40:24,892: physics_data_file: None
2025-11-14 12:40:24,892: validate_every: 5
2025-11-14 12:40:24,892: validate_n_random_basins: 1
2025-11-14 12:40:24,893: save_validation_results: True
2025-11-14 12:40:24,893: metrics: ['NSE', 'MSE']
2025-11-14 12:40:24,893: model: mtslstm
2025-11-14 12:40:24,893: shared_mtslstm: False
2025-11-14 12:40:24,894: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-14 12:40:24,894: use_frequencies: ['1H', '1D']
2025-11-14 12:40:24,894: head: regression
2025-11-14 12:40:24,894: output_activation: linear
2025-11-14 12:40:24,895: hidden_size: 256
2025-11-14 12:40:24,895: initial_forget_bias: 3
2025-11-14 12:40:24,895: output_dropout: 0.4
2025-11-14 12:40:24,895: optimizer: Adam
2025-11-14 12:40:24,896: loss: NSE
2025-11-14 12:40:24,896: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-14 12:40:24,896: batch_size: 64
2025-11-14 12:40:24,896: epochs: 48
2025-11-14 12:40:24,897: clip_gradient_norm: 1
2025-11-14 12:40:24,897: predict_last_n: {'1D': 1, '1H': 24}
2025-11-14 12:40:24,897: seq_length: {'1D': 90, '1H': 168}
2025-11-14 12:40:24,897: log_interval: 16
2025-11-14 12:40:24,897: log_tensorboard: True
2025-11-14 12:40:24,898: log_n_figures: 1
2025-11-14 12:40:24,898: save_weights_every: 48
2025-11-14 12:40:24,898: dataset: synthetic_russian_river
2025-11-14 12:40:24,898: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-14 12:40:24,899: dev_mode: True
2025-11-14 12:40:24,900: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-14 12:40:24,901: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-14 12:40:24,901: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-14 12:40:24,901: train_start_date: 01/01/1900
2025-11-14 12:40:24,902: train_end_date: 1901-01-01 00:00:00
2025-11-14 12:40:24,902: validation_start_date: 01/01/1900
2025-11-14 12:40:24,903: validation_end_date: 01/01/1901
2025-11-14 12:40:24,904: test_start_date: 01/01/1900
2025-11-14 12:40:24,905: test_end_date: 01/01/1901
2025-11-14 12:40:24,905: num_layers: 1
2025-11-14 12:40:24,905: hourly: True
2025-11-14 12:40:24,905: is_mts: True
2025-11-14 12:40:24,905: is_mts_data: False
2025-11-14 12:40:24,906: verbose: True
2025-11-14 12:40:24,906: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124024
2025-11-14 12:40:24,906: run_label: BASELINE
2025-11-14 12:40:24,906: run_stamp: 20251114T203955Z
2025-11-14 12:40:24,907: number_of_basins: 1
2025-11-14 12:40:24,907: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124024/train_data
2025-11-14 12:40:24,907: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124024/img_log
2025-11-14 12:40:24,913: ### Device cpu will be used for training
2025-11-14 12:40:24,916: Loading basin data into xarray data set.
2025-11-14 12:40:26,155: Calculating target variable stds per basin
2025-11-14 12:40:26,193: Create lookup table and convert to pytorch tensor
2025-11-14 12:40:27,218: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-14 12:40:37,056: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-14 12:40:45,406: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-14 12:40:50,790: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124050/output.log initialized.
2025-11-14 12:40:50,790: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124050
2025-11-14 12:40:50,791: ### Run configurations for testing_run
2025-11-14 12:40:50,791: experiment_name: testing_run
2025-11-14 12:40:50,791: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:50,792: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:50,792: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-14 12:40:50,792: train_ranges: ['01/10/1994-30/09/2002']
2025-11-14 12:40:50,793: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-14 12:40:50,793: test_ranges: ['01/10/2005-30/09/2009']
2025-11-14 12:40:50,793: device: cpu
2025-11-14 12:40:50,794: physics_informed: False
2025-11-14 12:40:50,794: physics_data_file: None
2025-11-14 12:40:50,795: validate_every: 5
2025-11-14 12:40:50,797: validate_n_random_basins: 1
2025-11-14 12:40:50,798: save_validation_results: True
2025-11-14 12:40:50,798: metrics: ['NSE', 'MSE']
2025-11-14 12:40:50,799: model: mtslstm
2025-11-14 12:40:50,799: shared_mtslstm: False
2025-11-14 12:40:50,800: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-14 12:40:50,800: use_frequencies: ['1H', '1D']
2025-11-14 12:40:50,800: head: regression
2025-11-14 12:40:50,800: output_activation: linear
2025-11-14 12:40:50,801: hidden_size: 256
2025-11-14 12:40:50,801: initial_forget_bias: 3
2025-11-14 12:40:50,801: output_dropout: 0.4
2025-11-14 12:40:50,801: optimizer: Adam
2025-11-14 12:40:50,802: loss: NSE
2025-11-14 12:40:50,802: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-14 12:40:50,802: batch_size: 64
2025-11-14 12:40:50,802: epochs: 48
2025-11-14 12:40:50,802: clip_gradient_norm: 1
2025-11-14 12:40:50,803: predict_last_n: {'1D': 1, '1H': 24}
2025-11-14 12:40:50,804: seq_length: {'1D': 90, '1H': 168}
2025-11-14 12:40:50,805: log_interval: 16
2025-11-14 12:40:50,806: log_tensorboard: True
2025-11-14 12:40:50,807: log_n_figures: 1
2025-11-14 12:40:50,807: save_weights_every: 48
2025-11-14 12:40:50,808: dataset: synthetic_russian_river
2025-11-14 12:40:50,808: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-14 12:40:50,809: dev_mode: True
2025-11-14 12:40:50,809: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-14 12:40:50,809: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-14 12:40:50,810: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-14 12:40:50,810: train_start_date: 01/01/1900
2025-11-14 12:40:50,810: train_end_date: 1901-01-01 00:00:00
2025-11-14 12:40:50,811: validation_start_date: 01/01/1900
2025-11-14 12:40:50,811: validation_end_date: 01/01/1901
2025-11-14 12:40:50,812: test_start_date: 01/01/1900
2025-11-14 12:40:50,812: test_end_date: 01/01/1901
2025-11-14 12:40:50,812: num_layers: 1
2025-11-14 12:40:50,812: hourly: True
2025-11-14 12:40:50,812: is_mts: True
2025-11-14 12:40:50,813: is_mts_data: False
2025-11-14 12:40:50,813: verbose: True
2025-11-14 12:40:50,813: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124050
2025-11-14 12:40:50,813: run_label: BASELINE
2025-11-14 12:40:50,814: run_stamp: 20251114T203955Z
2025-11-14 12:40:50,814: number_of_basins: 1
2025-11-14 12:40:50,814: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124050/train_data
2025-11-14 12:40:50,814: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251114T203955Z/testing_run_1411_124050/img_log
2025-11-14 12:40:50,819: ### Device cpu will be used for training
2025-11-14 12:40:50,822: Loading basin data into xarray data set.
2025-11-14 12:40:52,024: Calculating target variable stds per basin
2025-11-14 12:40:52,047: Create lookup table and convert to pytorch tensor
2025-11-14 12:40:52,136: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-14 12:41:00,520: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
