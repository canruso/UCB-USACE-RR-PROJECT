2025-11-21 01:20:01,561: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/output.log initialized.
2025-11-21 01:20:01,561: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001
2025-11-21 01:20:01,561: ### Run configurations for testing_run
2025-11-21 01:20:01,561: experiment_name: testing_run
2025-11-21 01:20:01,562: train_basin_file: guerneville
2025-11-21 01:20:01,562: validation_basin_file: guerneville
2025-11-21 01:20:01,562: test_basin_file: guerneville
2025-11-21 01:20:01,562: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:20:01,562: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:20:01,563: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:20:01,563: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:20:01,563: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:20:01,563: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:20:01,563: device: cpu
2025-11-21 01:20:01,564: physics_informed: False
2025-11-21 01:20:01,564: physics_data_file: None
2025-11-21 01:20:01,564: validate_every: 5
2025-11-21 01:20:01,564: validate_n_random_basins: 1
2025-11-21 01:20:01,564: save_validation_results: True
2025-11-21 01:20:01,565: metrics: ['NSE', 'MSE']
2025-11-21 01:20:01,565: model: mtslstm
2025-11-21 01:20:01,565: shared_mtslstm: False
2025-11-21 01:20:01,565: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:20:01,565: use_frequencies: ['1H', '1D']
2025-11-21 01:20:01,566: head: regression
2025-11-21 01:20:01,566: output_activation: linear
2025-11-21 01:20:01,566: hidden_size: 256
2025-11-21 01:20:01,566: initial_forget_bias: 3
2025-11-21 01:20:01,566: output_dropout: 0.4
2025-11-21 01:20:01,566: optimizer: Adam
2025-11-21 01:20:01,567: loss: NSE
2025-11-21 01:20:01,567: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:20:01,567: batch_size: 64
2025-11-21 01:20:01,567: epochs: 2
2025-11-21 01:20:01,567: clip_gradient_norm: 1
2025-11-21 01:20:01,568: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:20:01,568: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:20:01,568: log_interval: 16
2025-11-21 01:20:01,568: log_tensorboard: True
2025-11-21 01:20:01,568: log_n_figures: 1
2025-11-21 01:20:01,568: save_weights_every: 2
2025-11-21 01:20:01,569: dataset: russian_river
2025-11-21 01:20:01,569: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:20:01,569: dev_mode: True
2025-11-21 01:20:01,569: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:20:01,569: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:20:01,569: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:20:01,570: num_layers: 1
2025-11-21 01:20:01,570: hourly: True
2025-11-21 01:20:01,570: is_mts: True
2025-11-21 01:20:01,570: is_mts_data: False
2025-11-21 01:20:01,570: verbose: True
2025-11-21 01:20:01,570: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001
2025-11-21 01:20:01,571: run_label: BASELINE
2025-11-21 01:20:01,571: run_stamp: 20251121T092001Z
2025-11-21 01:20:01,571: number_of_basins: 1
2025-11-21 01:20:01,571: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/train_data
2025-11-21 01:20:01,571: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/img_log
2025-11-21 01:20:01,576: ### Device cpu will be used for training
2025-11-21 01:20:01,577: Loading basin data into xarray data set.
2025-11-21 01:20:02,780: Calculating target variable stds per basin
2025-11-21 01:20:02,808: Create lookup table and convert to pytorch tensor
2025-11-21 01:20:03,963: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:20:12,832: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:20:21,809: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:20:21,844: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:20:21,854: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/model_epoch002.pt
2025-11-21 01:20:24,593: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:20:24,594: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012001/validation/model_epoch002/validation_results.p
2025-11-21 01:20:25,006: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/output.log initialized.
2025-11-21 01:20:25,007: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025
2025-11-21 01:20:25,007: ### Run configurations for testing_run
2025-11-21 01:20:25,007: experiment_name: testing_run
2025-11-21 01:20:25,007: train_basin_file: guerneville
2025-11-21 01:20:25,008: validation_basin_file: guerneville
2025-11-21 01:20:25,008: test_basin_file: guerneville
2025-11-21 01:20:25,008: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:20:25,008: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:20:25,008: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:20:25,009: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:20:25,009: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:20:25,009: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:20:25,009: device: cpu
2025-11-21 01:20:25,009: physics_informed: True
2025-11-21 01:20:25,009: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:20:25,010: validate_every: 5
2025-11-21 01:20:25,010: validate_n_random_basins: 1
2025-11-21 01:20:25,010: save_validation_results: True
2025-11-21 01:20:25,010: metrics: ['NSE', 'MSE']
2025-11-21 01:20:25,010: model: mtslstm
2025-11-21 01:20:25,011: shared_mtslstm: False
2025-11-21 01:20:25,011: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:20:25,011: use_frequencies: ['1H', '1D']
2025-11-21 01:20:25,011: head: regression
2025-11-21 01:20:25,011: output_activation: linear
2025-11-21 01:20:25,012: hidden_size: 128
2025-11-21 01:20:25,012: initial_forget_bias: 3
2025-11-21 01:20:25,012: output_dropout: 0.4
2025-11-21 01:20:25,012: optimizer: Adam
2025-11-21 01:20:25,012: loss: NSE
2025-11-21 01:20:25,012: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:20:25,013: batch_size: 64
2025-11-21 01:20:25,013: epochs: 2
2025-11-21 01:20:25,013: clip_gradient_norm: 1
2025-11-21 01:20:25,013: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:20:25,013: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:20:25,014: log_interval: 16
2025-11-21 01:20:25,014: log_tensorboard: True
2025-11-21 01:20:25,014: log_n_figures: 1
2025-11-21 01:20:25,014: save_weights_every: 2
2025-11-21 01:20:25,014: dataset: russian_river
2025-11-21 01:20:25,014: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:20:25,015: dev_mode: True
2025-11-21 01:20:25,015: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:20:25,015: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:20:25,015: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:20:25,015: num_layers: 1
2025-11-21 01:20:25,016: hourly: True
2025-11-21 01:20:25,016: is_mts: True
2025-11-21 01:20:25,016: is_mts_data: False
2025-11-21 01:20:25,016: verbose: True
2025-11-21 01:20:25,016: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025
2025-11-21 01:20:25,016: run_label: BASELINE
2025-11-21 01:20:25,017: run_stamp: 20251121T092001Z
2025-11-21 01:20:25,017: number_of_basins: 1
2025-11-21 01:20:25,017: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/train_data
2025-11-21 01:20:25,017: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/img_log
2025-11-21 01:20:25,021: ### Device cpu will be used for training
2025-11-21 01:20:25,021: Loading basin data into xarray data set.
2025-11-21 01:20:29,291: Calculating target variable stds per basin
2025-11-21 01:20:29,350: Create lookup table and convert to pytorch tensor
2025-11-21 01:20:29,556: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:20:34,170: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:20:39,211: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:20:39,226: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:20:39,242: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/model_epoch002.pt
2025-11-21 01:20:44,280: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:20:44,281: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012025/validation/model_epoch002/validation_results.p
2025-11-21 01:20:51,560: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/output.log initialized.
2025-11-21 01:20:51,560: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051
2025-11-21 01:20:51,560: ### Run configurations for testing_run
2025-11-21 01:20:51,561: experiment_name: testing_run
2025-11-21 01:20:51,561: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:20:51,561: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:20:51,561: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:20:51,561: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:20:51,562: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:20:51,562: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:20:51,562: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:20:51,562: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:20:51,563: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:20:51,563: device: cpu
2025-11-21 01:20:51,563: physics_informed: False
2025-11-21 01:20:51,563: physics_data_file: None
2025-11-21 01:20:51,563: validate_every: 5
2025-11-21 01:20:51,563: validate_n_random_basins: 1
2025-11-21 01:20:51,564: save_validation_results: True
2025-11-21 01:20:51,564: metrics: ['NSE', 'MSE']
2025-11-21 01:20:51,564: model: mtslstm
2025-11-21 01:20:51,564: shared_mtslstm: False
2025-11-21 01:20:51,564: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:20:51,565: use_frequencies: ['1H', '1D']
2025-11-21 01:20:51,565: head: regression
2025-11-21 01:20:51,565: output_activation: linear
2025-11-21 01:20:51,565: hidden_size: 256
2025-11-21 01:20:51,565: initial_forget_bias: 3
2025-11-21 01:20:51,566: output_dropout: 0.4
2025-11-21 01:20:51,566: optimizer: Adam
2025-11-21 01:20:51,566: loss: NSE
2025-11-21 01:20:51,566: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:20:51,566: batch_size: 64
2025-11-21 01:20:51,566: epochs: 2
2025-11-21 01:20:51,567: clip_gradient_norm: 1
2025-11-21 01:20:51,567: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:20:51,567: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:20:51,567: log_interval: 16
2025-11-21 01:20:51,567: log_tensorboard: True
2025-11-21 01:20:51,568: log_n_figures: 1
2025-11-21 01:20:51,568: save_weights_every: 2
2025-11-21 01:20:51,568: dataset: russian_river
2025-11-21 01:20:51,568: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:20:51,568: dev_mode: True
2025-11-21 01:20:51,568: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:20:51,569: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:20:51,569: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:20:51,569: num_layers: 1
2025-11-21 01:20:51,569: hourly: True
2025-11-21 01:20:51,569: is_mts: True
2025-11-21 01:20:51,570: is_mts_data: False
2025-11-21 01:20:51,570: verbose: True
2025-11-21 01:20:51,570: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051
2025-11-21 01:20:51,570: run_label: BASELINE
2025-11-21 01:20:51,570: run_stamp: 20251121T092001Z
2025-11-21 01:20:51,570: number_of_basins: 1
2025-11-21 01:20:51,571: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/train_data
2025-11-21 01:20:51,571: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/img_log
2025-11-21 01:20:51,573: ### Device cpu will be used for training
2025-11-21 01:20:51,573: Loading basin data into xarray data set.
2025-11-21 01:20:52,801: Calculating target variable stds per basin
2025-11-21 01:20:52,827: Create lookup table and convert to pytorch tensor
2025-11-21 01:20:52,942: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:21:05,332: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:21:17,785: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:21:17,807: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/testing_run_2111_012117/output.log initialized.
2025-11-21 01:21:17,808: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/testing_run_2111_012117
2025-11-21 01:21:17,808: ### Run configurations for testing_run
2025-11-21 01:21:17,808: experiment_name: testing_run
2025-11-21 01:21:17,809: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:21:17,809: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:21:17,809: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:21:17,809: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:21:17,809: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:21:17,810: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:21:17,810: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:21:17,810: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:21:17,810: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:21:17,810: device: cpu
2025-11-21 01:21:17,811: physics_informed: False
2025-11-21 01:21:17,811: physics_data_file: None
2025-11-21 01:21:17,811: validate_every: 5
2025-11-21 01:21:17,811: validate_n_random_basins: 1
2025-11-21 01:21:17,811: save_validation_results: True
2025-11-21 01:21:17,812: metrics: ['NSE', 'MSE']
2025-11-21 01:21:17,812: model: mtslstm
2025-11-21 01:21:17,812: shared_mtslstm: False
2025-11-21 01:21:17,812: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:21:17,812: use_frequencies: ['1H', '1D']
2025-11-21 01:21:17,812: head: regression
2025-11-21 01:21:17,813: output_activation: linear
2025-11-21 01:21:17,813: hidden_size: 256
2025-11-21 01:21:17,813: initial_forget_bias: 3
2025-11-21 01:21:17,813: output_dropout: 0.4
2025-11-21 01:21:17,813: optimizer: Adam
2025-11-21 01:21:17,814: loss: NSE
2025-11-21 01:21:17,814: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:21:17,814: batch_size: 64
2025-11-21 01:21:17,814: epochs: 2
2025-11-21 01:21:17,815: clip_gradient_norm: 1
2025-11-21 01:21:17,815: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:21:17,815: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:21:17,815: log_interval: 16
2025-11-21 01:21:17,815: log_tensorboard: True
2025-11-21 01:21:17,816: log_n_figures: 1
2025-11-21 01:21:17,816: save_weights_every: 2
2025-11-21 01:21:17,816: dataset: russian_river
2025-11-21 01:21:17,816: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:21:17,816: dev_mode: True
2025-11-21 01:21:17,816: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:21:17,817: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:21:17,817: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:21:17,817: num_layers: 1
2025-11-21 01:21:17,817: hourly: True
2025-11-21 01:21:17,817: is_mts: True
2025-11-21 01:21:17,818: is_mts_data: False
2025-11-21 01:21:17,818: verbose: True
2025-11-21 01:21:17,818: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/testing_run_2111_012117
2025-11-21 01:21:17,818: run_label: BASELINE
2025-11-21 01:21:17,818: run_stamp: 20251121T092001Z
2025-11-21 01:21:17,819: number_of_basins: 1
2025-11-21 01:21:17,819: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/testing_run_2111_012117/train_data
2025-11-21 01:21:17,819: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T092001Z/testing_run_2111_012051/testing_run_2111_012117/img_log
2025-11-21 01:21:17,819: seed: 473435
2025-11-21 01:21:17,819: commit_hash: 994040c
2025-11-21 01:21:17,820: package_version: 1.11.0
2025-11-21 01:21:17,822: ### Device cpu will be used for training
2025-11-21 01:21:17,822: Loading basin data into xarray data set.
2025-11-21 01:21:19,078: Calculating target variable stds per basin
2025-11-21 01:21:19,102: Create lookup table and convert to pytorch tensor
2025-11-21 01:21:19,214: No specific hidden size for frequencies are specified. Same hidden size is used for all.
