2025-11-20 23:53:31,182: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T075331Z/testing_run_2011_235331/output.log initialized.
2025-11-20 23:53:31,183: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T075331Z/testing_run_2011_235331
2025-11-20 23:53:31,183: ### Run configurations for testing_run
2025-11-20 23:53:31,183: experiment_name: testing_run
2025-11-20 23:53:31,183: train_basin_file: guerneville
2025-11-20 23:53:31,183: validation_basin_file: guerneville
2025-11-20 23:53:31,184: test_basin_file: guerneville
2025-11-20 23:53:31,184: train_ranges: ['01/10/1994-30/09/2002']
2025-11-20 23:53:31,184: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-20 23:53:31,184: test_ranges: ['01/10/2005-30/09/2009']
2025-11-20 23:53:31,184: device: cpu
2025-11-20 23:53:31,185: physics_informed: False
2025-11-20 23:53:31,185: physics_data_file: None
2025-11-20 23:53:31,185: validate_every: 5
2025-11-20 23:53:31,185: validate_n_random_basins: 1
2025-11-20 23:53:31,185: save_validation_results: True
2025-11-20 23:53:31,185: metrics: ['NSE', 'MSE']
2025-11-20 23:53:31,186: model: mtslstm
2025-11-20 23:53:31,186: shared_mtslstm: False
2025-11-20 23:53:31,186: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-20 23:53:31,186: use_frequencies: ['1H', '1D']
2025-11-20 23:53:31,186: head: regression
2025-11-20 23:53:31,187: output_activation: linear
2025-11-20 23:53:31,187: hidden_size: 256
2025-11-20 23:53:31,187: initial_forget_bias: 3
2025-11-20 23:53:31,187: output_dropout: 0.4
2025-11-20 23:53:31,187: optimizer: Adam
2025-11-20 23:53:31,187: loss: NSE
2025-11-20 23:53:31,188: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-20 23:53:31,188: batch_size: 64
2025-11-20 23:53:31,188: epochs: 48
2025-11-20 23:53:31,188: clip_gradient_norm: 1
2025-11-20 23:53:31,188: predict_last_n: {'1D': 1, '1H': 24}
2025-11-20 23:53:31,189: seq_length: {'1D': 90, '1H': 168}
2025-11-20 23:53:31,189: log_interval: 16
2025-11-20 23:53:31,189: log_tensorboard: True
2025-11-20 23:53:31,189: log_n_figures: 1
2025-11-20 23:53:31,189: save_weights_every: 48
2025-11-20 23:53:31,190: dataset: synthetic_russian_river
2025-11-20 23:53:31,190: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-20 23:53:31,190: dev_mode: True
2025-11-20 23:53:31,190: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-20 23:53:31,191: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-20 23:53:31,191: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-20 23:53:31,191: train_start_date: 01/01/1900
2025-11-20 23:53:31,192: train_end_date: 01/01/1901
2025-11-20 23:53:31,192: validation_start_date: 01/01/1900
2025-11-20 23:53:31,192: validation_end_date: 01/01/1901
2025-11-20 23:53:31,192: test_start_date: 01/01/1900
2025-11-20 23:53:31,193: test_end_date: 01/01/1901
2025-11-20 23:53:31,193: num_layers: 1
2025-11-20 23:53:31,193: hourly: True
2025-11-20 23:53:31,193: is_mts: True
2025-11-20 23:53:31,193: is_mts_data: False
2025-11-20 23:53:31,193: verbose: True
2025-11-20 23:53:31,194: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T075331Z/testing_run_2011_235331
2025-11-20 23:53:31,194: run_label: BASELINE
2025-11-20 23:53:31,194: run_stamp: 20251121T075331Z
2025-11-20 23:53:31,194: number_of_basins: 1
2025-11-20 23:53:31,194: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T075331Z/testing_run_2011_235331/train_data
2025-11-20 23:53:31,195: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T075331Z/testing_run_2011_235331/img_log
2025-11-20 23:53:31,200: ### Device cpu will be used for training
2025-11-20 23:53:31,202: Loading basin data into xarray data set.
2025-11-20 23:53:32,480: Calculating target variable stds per basin
2025-11-20 23:53:32,511: Create lookup table and convert to pytorch tensor
2025-11-20 23:53:33,795: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-20 23:53:44,720: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-20 23:53:54,093: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-20 23:54:03,595: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-20 23:54:13,236: Epoch 4 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:16:50,783: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081650Z/testing_run_2111_001650/output.log initialized.
2025-11-21 00:16:50,785: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081650Z/testing_run_2111_001650
2025-11-21 00:16:50,786: ### Run configurations for testing_run
2025-11-21 00:16:50,786: experiment_name: testing_run
2025-11-21 00:16:50,786: train_basin_file: guerneville
2025-11-21 00:16:50,786: validation_basin_file: guerneville
2025-11-21 00:16:50,787: test_basin_file: guerneville
2025-11-21 00:16:50,787: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:16:50,787: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:16:50,787: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:16:50,787: device: cpu
2025-11-21 00:16:50,787: physics_informed: False
2025-11-21 00:16:50,788: physics_data_file: None
2025-11-21 00:16:50,788: validate_every: 5
2025-11-21 00:16:50,788: validate_n_random_basins: 1
2025-11-21 00:16:50,788: save_validation_results: True
2025-11-21 00:16:50,789: metrics: ['NSE', 'MSE']
2025-11-21 00:16:50,789: model: mtslstm
2025-11-21 00:16:50,789: shared_mtslstm: False
2025-11-21 00:16:50,789: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:16:50,789: use_frequencies: ['1H', '1D']
2025-11-21 00:16:50,790: head: regression
2025-11-21 00:16:50,790: output_activation: linear
2025-11-21 00:16:50,790: hidden_size: 256
2025-11-21 00:16:50,790: initial_forget_bias: 3
2025-11-21 00:16:50,790: output_dropout: 0.4
2025-11-21 00:16:50,791: optimizer: Adam
2025-11-21 00:16:50,791: loss: NSE
2025-11-21 00:16:50,791: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:16:50,791: batch_size: 64
2025-11-21 00:16:50,791: epochs: 48
2025-11-21 00:16:50,791: clip_gradient_norm: 1
2025-11-21 00:16:50,791: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:16:50,792: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:16:50,792: log_interval: 16
2025-11-21 00:16:50,792: log_tensorboard: True
2025-11-21 00:16:50,792: log_n_figures: 1
2025-11-21 00:16:50,792: save_weights_every: 48
2025-11-21 00:16:50,793: dataset: synthetic_russian_river
2025-11-21 00:16:50,793: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:16:50,793: dev_mode: True
2025-11-21 00:16:50,794: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:16:50,794: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:16:50,794: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:16:50,794: train_start_date: 01/01/1900
2025-11-21 00:16:50,794: train_end_date: 01/01/1901
2025-11-21 00:16:50,795: validation_start_date: 01/01/1900
2025-11-21 00:16:50,795: validation_end_date: 01/01/1901
2025-11-21 00:16:50,795: test_start_date: 01/01/1900
2025-11-21 00:16:50,795: test_end_date: 01/01/1901
2025-11-21 00:16:50,796: num_layers: 1
2025-11-21 00:16:50,796: hourly: True
2025-11-21 00:16:50,796: is_mts: True
2025-11-21 00:16:50,796: is_mts_data: False
2025-11-21 00:16:50,797: verbose: True
2025-11-21 00:16:50,797: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081650Z/testing_run_2111_001650
2025-11-21 00:16:50,797: run_label: BASELINE
2025-11-21 00:16:50,797: run_stamp: 20251121T081650Z
2025-11-21 00:16:50,797: number_of_basins: 1
2025-11-21 00:16:50,797: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081650Z/testing_run_2111_001650/train_data
2025-11-21 00:16:50,798: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081650Z/testing_run_2111_001650/img_log
2025-11-21 00:16:50,820: ### Device cpu will be used for training
2025-11-21 00:16:50,829: Loading basin data into xarray data set.
2025-11-21 00:16:52,206: Calculating target variable stds per basin
2025-11-21 00:16:52,257: Create lookup table and convert to pytorch tensor
2025-11-21 00:16:52,416: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:17:02,704: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:17:59,221: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759/output.log initialized.
2025-11-21 00:17:59,222: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759
2025-11-21 00:17:59,222: ### Run configurations for testing_run
2025-11-21 00:17:59,222: experiment_name: testing_run
2025-11-21 00:17:59,222: train_basin_file: guerneville
2025-11-21 00:17:59,223: validation_basin_file: guerneville
2025-11-21 00:17:59,223: test_basin_file: guerneville
2025-11-21 00:17:59,223: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:17:59,223: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:17:59,224: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:17:59,224: device: cpu
2025-11-21 00:17:59,224: physics_informed: False
2025-11-21 00:17:59,224: physics_data_file: None
2025-11-21 00:17:59,224: validate_every: 5
2025-11-21 00:17:59,225: validate_n_random_basins: 1
2025-11-21 00:17:59,225: save_validation_results: True
2025-11-21 00:17:59,225: metrics: ['NSE', 'MSE']
2025-11-21 00:17:59,225: model: mtslstm
2025-11-21 00:17:59,225: shared_mtslstm: False
2025-11-21 00:17:59,226: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:17:59,226: use_frequencies: ['1H', '1D']
2025-11-21 00:17:59,226: head: regression
2025-11-21 00:17:59,226: output_activation: linear
2025-11-21 00:17:59,227: hidden_size: 256
2025-11-21 00:17:59,227: initial_forget_bias: 3
2025-11-21 00:17:59,227: output_dropout: 0.4
2025-11-21 00:17:59,227: optimizer: Adam
2025-11-21 00:17:59,227: loss: NSE
2025-11-21 00:17:59,227: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:17:59,228: batch_size: 64
2025-11-21 00:17:59,228: epochs: 48
2025-11-21 00:17:59,228: clip_gradient_norm: 1
2025-11-21 00:17:59,228: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:17:59,228: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:17:59,229: log_interval: 16
2025-11-21 00:17:59,229: log_tensorboard: True
2025-11-21 00:17:59,229: log_n_figures: 1
2025-11-21 00:17:59,230: save_weights_every: 48
2025-11-21 00:17:59,230: dataset: synthetic_russian_river
2025-11-21 00:17:59,230: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:17:59,230: dev_mode: True
2025-11-21 00:17:59,230: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:17:59,231: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:17:59,231: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:17:59,231: train_start_date: 01/01/1900
2025-11-21 00:17:59,231: train_end_date: 01/01/1901
2025-11-21 00:17:59,231: validation_start_date: 01/01/1900
2025-11-21 00:17:59,231: validation_end_date: 01/01/1901
2025-11-21 00:17:59,232: test_start_date: 01/01/1900
2025-11-21 00:17:59,232: test_end_date: 01/01/1901
2025-11-21 00:17:59,232: num_layers: 1
2025-11-21 00:17:59,232: hourly: True
2025-11-21 00:17:59,232: is_mts: True
2025-11-21 00:17:59,233: is_mts_data: False
2025-11-21 00:17:59,233: verbose: True
2025-11-21 00:17:59,233: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759
2025-11-21 00:17:59,233: run_label: BASELINE
2025-11-21 00:17:59,233: run_stamp: 20251121T081759Z
2025-11-21 00:17:59,234: number_of_basins: 1
2025-11-21 00:17:59,234: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759/train_data
2025-11-21 00:17:59,234: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759/img_log
2025-11-21 00:17:59,237: ### Device cpu will be used for training
2025-11-21 00:17:59,240: Loading basin data into xarray data set.
2025-11-21 00:18:00,494: Calculating target variable stds per basin
2025-11-21 00:18:00,518: Create lookup table and convert to pytorch tensor
2025-11-21 00:18:00,614: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:18:10,168: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:18:20,323: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:18:30,211: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:18:39,702: Epoch 4 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:18:49,803: Epoch 5 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:18:53,238: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759/validation/model_epoch005/validation_metrics.csv
2025-11-21 00:18:53,239: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T081759Z/testing_run_2111_001759/validation/model_epoch005/validation_results.p
2025-11-21 00:18:53,240: Epoch 5 average validation loss: 0.00000 -- Median validation metrics: avg_loss: 0.00000, NSE_1H: 0.77360, MSE_1H: 5891179.50000, NSE_1D: 0.66047, MSE_1D: 8414729.00000
