2025-11-21 00:43:00,419: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084300Z/testing_run_2111_004300/output.log initialized.
2025-11-21 00:43:00,419: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084300Z/testing_run_2111_004300
2025-11-21 00:43:00,419: ### Run configurations for testing_run
2025-11-21 00:43:00,419: experiment_name: testing_run
2025-11-21 00:43:00,420: train_basin_file: guerneville
2025-11-21 00:43:00,420: validation_basin_file: guerneville
2025-11-21 00:43:00,420: test_basin_file: guerneville
2025-11-21 00:43:00,420: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:43:00,420: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:43:00,421: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:43:00,421: device: cpu
2025-11-21 00:43:00,421: physics_informed: False
2025-11-21 00:43:00,421: physics_data_file: None
2025-11-21 00:43:00,421: validate_every: 5
2025-11-21 00:43:00,421: validate_n_random_basins: 1
2025-11-21 00:43:00,422: save_validation_results: True
2025-11-21 00:43:00,422: metrics: ['NSE', 'MSE']
2025-11-21 00:43:00,422: model: mtslstm
2025-11-21 00:43:00,422: shared_mtslstm: False
2025-11-21 00:43:00,422: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:43:00,422: use_frequencies: ['1H', '1D']
2025-11-21 00:43:00,423: head: regression
2025-11-21 00:43:00,423: output_activation: linear
2025-11-21 00:43:00,423: hidden_size: 256
2025-11-21 00:43:00,423: initial_forget_bias: 3
2025-11-21 00:43:00,423: output_dropout: 0.4
2025-11-21 00:43:00,424: optimizer: Adam
2025-11-21 00:43:00,424: loss: NSE
2025-11-21 00:43:00,424: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:43:00,424: batch_size: 64
2025-11-21 00:43:00,424: epochs: 48
2025-11-21 00:43:00,425: clip_gradient_norm: 1
2025-11-21 00:43:00,425: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:43:00,425: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:43:00,425: log_interval: 16
2025-11-21 00:43:00,425: log_tensorboard: True
2025-11-21 00:43:00,426: log_n_figures: 1
2025-11-21 00:43:00,426: save_weights_every: 48
2025-11-21 00:43:00,426: dataset: synthetic_russian_river
2025-11-21 00:43:00,426: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:43:00,426: dev_mode: True
2025-11-21 00:43:00,426: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:43:00,427: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:43:00,427: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:43:00,427: train_start_date: 01/01/1900
2025-11-21 00:43:00,427: train_end_date: 01/01/1901
2025-11-21 00:43:00,427: validation_start_date: 01/01/1900
2025-11-21 00:43:00,428: validation_end_date: 01/01/1901
2025-11-21 00:43:00,428: test_start_date: 01/01/1900
2025-11-21 00:43:00,428: test_end_date: 01/01/1901
2025-11-21 00:43:00,428: num_layers: 1
2025-11-21 00:43:00,431: hourly: True
2025-11-21 00:43:00,433: is_mts: True
2025-11-21 00:43:00,434: is_mts_data: False
2025-11-21 00:43:00,437: verbose: True
2025-11-21 00:43:00,448: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084300Z/testing_run_2111_004300
2025-11-21 00:43:00,451: run_label: BASELINE
2025-11-21 00:43:00,452: run_stamp: 20251121T084300Z
2025-11-21 00:43:00,455: number_of_basins: 1
2025-11-21 00:43:00,455: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084300Z/testing_run_2111_004300/train_data
2025-11-21 00:43:00,456: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084300Z/testing_run_2111_004300/img_log
2025-11-21 00:43:00,462: ### Device cpu will be used for training
2025-11-21 00:43:00,466: Loading basin data into xarray data set.
2025-11-21 00:43:01,735: Calculating target variable stds per basin
2025-11-21 00:43:01,762: Create lookup table and convert to pytorch tensor
2025-11-21 00:43:02,589: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:46:35,144: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/output.log initialized.
2025-11-21 00:46:35,145: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635
2025-11-21 00:46:35,145: ### Run configurations for testing_run
2025-11-21 00:46:35,145: experiment_name: testing_run
2025-11-21 00:46:35,145: train_basin_file: guerneville
2025-11-21 00:46:35,145: validation_basin_file: guerneville
2025-11-21 00:46:35,146: test_basin_file: guerneville
2025-11-21 00:46:35,146: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:46:35,146: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:46:35,146: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:46:35,146: device: cpu
2025-11-21 00:46:35,147: physics_informed: False
2025-11-21 00:46:35,147: physics_data_file: None
2025-11-21 00:46:35,147: validate_every: 5
2025-11-21 00:46:35,147: validate_n_random_basins: 1
2025-11-21 00:46:35,148: save_validation_results: True
2025-11-21 00:46:35,148: metrics: ['NSE', 'MSE']
2025-11-21 00:46:35,148: model: mtslstm
2025-11-21 00:46:35,148: shared_mtslstm: False
2025-11-21 00:46:35,148: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:46:35,149: use_frequencies: ['1H', '1D']
2025-11-21 00:46:35,149: head: regression
2025-11-21 00:46:35,149: output_activation: linear
2025-11-21 00:46:35,149: hidden_size: 256
2025-11-21 00:46:35,150: initial_forget_bias: 3
2025-11-21 00:46:35,150: output_dropout: 0.4
2025-11-21 00:46:35,150: optimizer: Adam
2025-11-21 00:46:35,150: loss: NSE
2025-11-21 00:46:35,150: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:46:35,151: batch_size: 64
2025-11-21 00:46:35,151: epochs: 3
2025-11-21 00:46:35,151: clip_gradient_norm: 1
2025-11-21 00:46:35,151: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:46:35,151: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:46:35,151: log_interval: 16
2025-11-21 00:46:35,152: log_tensorboard: True
2025-11-21 00:46:35,152: log_n_figures: 1
2025-11-21 00:46:35,152: save_weights_every: 3
2025-11-21 00:46:35,152: dataset: synthetic_russian_river
2025-11-21 00:46:35,152: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:46:35,152: dev_mode: True
2025-11-21 00:46:35,153: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:46:35,153: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:46:35,153: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:46:35,153: train_start_date: 01/01/1900
2025-11-21 00:46:35,153: train_end_date: 01/01/1901
2025-11-21 00:46:35,154: validation_start_date: 01/01/1900
2025-11-21 00:46:35,154: validation_end_date: 01/01/1901
2025-11-21 00:46:35,154: test_start_date: 01/01/1900
2025-11-21 00:46:35,154: test_end_date: 01/01/1901
2025-11-21 00:46:35,154: num_layers: 1
2025-11-21 00:46:35,154: hourly: True
2025-11-21 00:46:35,155: is_mts: True
2025-11-21 00:46:35,155: is_mts_data: False
2025-11-21 00:46:35,155: verbose: True
2025-11-21 00:46:35,155: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635
2025-11-21 00:46:35,155: run_label: BASELINE
2025-11-21 00:46:35,155: run_stamp: 20251121T084635Z
2025-11-21 00:46:35,156: number_of_basins: 1
2025-11-21 00:46:35,156: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/train_data
2025-11-21 00:46:35,156: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/img_log
2025-11-21 00:46:35,167: ### Device cpu will be used for training
2025-11-21 00:46:35,175: Loading basin data into xarray data set.
2025-11-21 00:46:36,391: Calculating target variable stds per basin
2025-11-21 00:46:36,423: Create lookup table and convert to pytorch tensor
2025-11-21 00:46:36,527: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:46:46,139: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:46:54,842: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:02,882: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:02,921: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:47:02,931: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/model_epoch003.pt
2025-11-21 00:47:05,972: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/validation/model_epoch003/validation_metrics.csv
2025-11-21 00:47:05,973: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004635/validation/model_epoch003/validation_results.p
2025-11-21 00:47:06,485: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/output.log initialized.
2025-11-21 00:47:06,486: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706
2025-11-21 00:47:06,486: ### Run configurations for testing_run
2025-11-21 00:47:06,487: experiment_name: testing_run
2025-11-21 00:47:06,487: train_basin_file: guerneville
2025-11-21 00:47:06,488: validation_basin_file: guerneville
2025-11-21 00:47:06,488: test_basin_file: guerneville
2025-11-21 00:47:06,489: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:47:06,490: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:47:06,490: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:47:06,491: device: cpu
2025-11-21 00:47:06,491: physics_informed: True
2025-11-21 00:47:06,492: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 00:47:06,492: validate_every: 5
2025-11-21 00:47:06,492: validate_n_random_basins: 1
2025-11-21 00:47:06,493: save_validation_results: True
2025-11-21 00:47:06,493: metrics: ['NSE', 'MSE']
2025-11-21 00:47:06,494: model: mtslstm
2025-11-21 00:47:06,494: shared_mtslstm: False
2025-11-21 00:47:06,494: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:47:06,495: use_frequencies: ['1H', '1D']
2025-11-21 00:47:06,495: head: regression
2025-11-21 00:47:06,495: output_activation: linear
2025-11-21 00:47:06,496: hidden_size: 128
2025-11-21 00:47:06,497: initial_forget_bias: 3
2025-11-21 00:47:06,498: output_dropout: 0.4
2025-11-21 00:47:06,498: optimizer: Adam
2025-11-21 00:47:06,499: loss: NSE
2025-11-21 00:47:06,499: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:47:06,501: batch_size: 64
2025-11-21 00:47:06,501: epochs: 3
2025-11-21 00:47:06,502: clip_gradient_norm: 1
2025-11-21 00:47:06,502: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:47:06,503: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:47:06,503: log_interval: 16
2025-11-21 00:47:06,504: log_tensorboard: True
2025-11-21 00:47:06,504: log_n_figures: 1
2025-11-21 00:47:06,504: save_weights_every: 3
2025-11-21 00:47:06,505: dataset: synthetic_russian_river
2025-11-21 00:47:06,505: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:47:06,505: dev_mode: True
2025-11-21 00:47:06,506: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 00:47:06,506: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:47:06,506: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:47:06,507: train_start_date: 01/01/1900
2025-11-21 00:47:06,507: train_end_date: 01/01/1901
2025-11-21 00:47:06,507: validation_start_date: 01/01/1900
2025-11-21 00:47:06,508: validation_end_date: 01/01/1901
2025-11-21 00:47:06,508: test_start_date: 01/01/1900
2025-11-21 00:47:06,508: test_end_date: 01/01/1901
2025-11-21 00:47:06,508: num_layers: 1
2025-11-21 00:47:06,508: hourly: True
2025-11-21 00:47:06,508: is_mts: True
2025-11-21 00:47:06,509: is_mts_data: False
2025-11-21 00:47:06,509: verbose: True
2025-11-21 00:47:06,509: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706
2025-11-21 00:47:06,509: run_label: BASELINE
2025-11-21 00:47:06,509: run_stamp: 20251121T084635Z
2025-11-21 00:47:06,510: number_of_basins: 1
2025-11-21 00:47:06,510: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/train_data
2025-11-21 00:47:06,510: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/img_log
2025-11-21 00:47:06,512: ### Device cpu will be used for training
2025-11-21 00:47:06,515: Loading basin data into xarray data set.
2025-11-21 00:47:11,262: Calculating target variable stds per basin
2025-11-21 00:47:11,319: Create lookup table and convert to pytorch tensor
2025-11-21 00:47:11,533: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:47:16,282: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:20,815: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:25,405: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:25,420: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:47:25,435: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/model_epoch003.pt
2025-11-21 00:47:30,241: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/validation/model_epoch003/validation_metrics.csv
2025-11-21 00:47:30,242: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004706/validation/model_epoch003/validation_results.p
2025-11-21 00:47:37,508: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/output.log initialized.
2025-11-21 00:47:37,508: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737
2025-11-21 00:47:37,509: ### Run configurations for testing_run
2025-11-21 00:47:37,509: experiment_name: testing_run
2025-11-21 00:47:37,509: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:47:37,509: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:47:37,509: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:47:37,510: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:47:37,510: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:47:37,510: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:47:37,510: device: cpu
2025-11-21 00:47:37,510: physics_informed: False
2025-11-21 00:47:37,511: physics_data_file: None
2025-11-21 00:47:37,511: validate_every: 5
2025-11-21 00:47:37,511: validate_n_random_basins: 1
2025-11-21 00:47:37,511: save_validation_results: True
2025-11-21 00:47:37,511: metrics: ['NSE', 'MSE']
2025-11-21 00:47:37,511: model: mtslstm
2025-11-21 00:47:37,512: shared_mtslstm: False
2025-11-21 00:47:37,512: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:47:37,512: use_frequencies: ['1H', '1D']
2025-11-21 00:47:37,512: head: regression
2025-11-21 00:47:37,512: output_activation: linear
2025-11-21 00:47:37,513: hidden_size: 256
2025-11-21 00:47:37,513: initial_forget_bias: 3
2025-11-21 00:47:37,513: output_dropout: 0.4
2025-11-21 00:47:37,513: optimizer: Adam
2025-11-21 00:47:37,513: loss: NSE
2025-11-21 00:47:37,514: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:47:37,514: batch_size: 64
2025-11-21 00:47:37,514: epochs: 3
2025-11-21 00:47:37,514: clip_gradient_norm: 1
2025-11-21 00:47:37,514: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:47:37,515: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:47:37,515: log_interval: 16
2025-11-21 00:47:37,515: log_tensorboard: True
2025-11-21 00:47:37,515: log_n_figures: 1
2025-11-21 00:47:37,515: save_weights_every: 3
2025-11-21 00:47:37,516: dataset: synthetic_russian_river
2025-11-21 00:47:37,516: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:47:37,516: dev_mode: True
2025-11-21 00:47:37,516: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:47:37,516: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:47:37,516: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:47:37,517: train_start_date: 01/01/1900
2025-11-21 00:47:37,517: train_end_date: 1901-01-01 00:00:00
2025-11-21 00:47:37,517: validation_start_date: 01/01/1900
2025-11-21 00:47:37,517: validation_end_date: 01/01/1901
2025-11-21 00:47:37,517: test_start_date: 01/01/1900
2025-11-21 00:47:37,518: test_end_date: 01/01/1901
2025-11-21 00:47:37,518: num_layers: 1
2025-11-21 00:47:37,518: hourly: True
2025-11-21 00:47:37,518: is_mts: True
2025-11-21 00:47:37,518: is_mts_data: False
2025-11-21 00:47:37,518: verbose: True
2025-11-21 00:47:37,519: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737
2025-11-21 00:47:37,519: run_label: BASELINE
2025-11-21 00:47:37,519: run_stamp: 20251121T084635Z
2025-11-21 00:47:37,519: number_of_basins: 1
2025-11-21 00:47:37,519: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/train_data
2025-11-21 00:47:37,519: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/img_log
2025-11-21 00:47:37,521: ### Device cpu will be used for training
2025-11-21 00:47:37,523: Loading basin data into xarray data set.
2025-11-21 00:47:38,724: Calculating target variable stds per basin
2025-11-21 00:47:38,745: Create lookup table and convert to pytorch tensor
2025-11-21 00:47:38,833: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 00:47:47,390: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:47:55,453: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:48:03,489: Epoch 3 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 00:48:03,522: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/testing_run_2111_004803/output.log initialized.
2025-11-21 00:48:03,523: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/testing_run_2111_004803
2025-11-21 00:48:03,523: ### Run configurations for testing_run
2025-11-21 00:48:03,523: experiment_name: testing_run
2025-11-21 00:48:03,523: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:48:03,524: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:48:03,524: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 00:48:03,524: train_ranges: ['01/10/1994-30/09/2002']
2025-11-21 00:48:03,524: validation_ranges: ['01/10/2002-30/09/2005']
2025-11-21 00:48:03,524: test_ranges: ['01/10/2005-30/09/2009']
2025-11-21 00:48:03,525: device: cpu
2025-11-21 00:48:03,525: physics_informed: False
2025-11-21 00:48:03,525: physics_data_file: None
2025-11-21 00:48:03,525: validate_every: 5
2025-11-21 00:48:03,525: validate_n_random_basins: 1
2025-11-21 00:48:03,525: save_validation_results: True
2025-11-21 00:48:03,526: metrics: ['NSE', 'MSE']
2025-11-21 00:48:03,526: model: mtslstm
2025-11-21 00:48:03,526: shared_mtslstm: False
2025-11-21 00:48:03,526: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 00:48:03,526: use_frequencies: ['1H', '1D']
2025-11-21 00:48:03,526: head: regression
2025-11-21 00:48:03,527: output_activation: linear
2025-11-21 00:48:03,527: hidden_size: 256
2025-11-21 00:48:03,527: initial_forget_bias: 3
2025-11-21 00:48:03,527: output_dropout: 0.4
2025-11-21 00:48:03,527: optimizer: Adam
2025-11-21 00:48:03,528: loss: NSE
2025-11-21 00:48:03,528: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 00:48:03,528: batch_size: 64
2025-11-21 00:48:03,528: epochs: 3
2025-11-21 00:48:03,528: clip_gradient_norm: 1
2025-11-21 00:48:03,529: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 00:48:03,529: seq_length: {'1D': 90, '1H': 168}
2025-11-21 00:48:03,529: log_interval: 16
2025-11-21 00:48:03,529: log_tensorboard: True
2025-11-21 00:48:03,529: log_n_figures: 1
2025-11-21 00:48:03,530: save_weights_every: 3
2025-11-21 00:48:03,530: dataset: synthetic_russian_river
2025-11-21 00:48:03,530: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 00:48:03,530: dev_mode: True
2025-11-21 00:48:03,530: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 00:48:03,531: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 00:48:03,531: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 00:48:03,531: train_start_date: 1994-10-01 00:00:00
2025-11-21 00:48:03,531: train_end_date: 2002-09-30 00:00:00
2025-11-21 00:48:03,531: validation_start_date: 2002-10-01 00:00:00
2025-11-21 00:48:03,532: validation_end_date: 2005-09-30 00:00:00
2025-11-21 00:48:03,532: test_start_date: 2005-10-01 00:00:00
2025-11-21 00:48:03,532: test_end_date: 2009-09-30 00:00:00
2025-11-21 00:48:03,532: num_layers: 1
2025-11-21 00:48:03,532: hourly: True
2025-11-21 00:48:03,533: is_mts: True
2025-11-21 00:48:03,533: is_mts_data: False
2025-11-21 00:48:03,533: verbose: True
2025-11-21 00:48:03,533: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/testing_run_2111_004803
2025-11-21 00:48:03,533: run_label: BASELINE
2025-11-21 00:48:03,533: run_stamp: 20251121T084635Z
2025-11-21 00:48:03,534: number_of_basins: 1
2025-11-21 00:48:03,534: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/testing_run_2111_004803/train_data
2025-11-21 00:48:03,534: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T084635Z/testing_run_2111_004737/testing_run_2111_004803/img_log
2025-11-21 00:48:03,534: seed: 443698
2025-11-21 00:48:03,534: commit_hash: 994040c
2025-11-21 00:48:03,535: package_version: 1.11.0
2025-11-21 00:48:03,536: ### Device cpu will be used for training
2025-11-21 00:48:03,538: Loading basin data into xarray data set.
2025-11-21 00:48:04,734: Calculating target variable stds per basin
2025-11-21 00:48:04,755: Create lookup table and convert to pytorch tensor
2025-11-21 00:48:04,839: No specific hidden size for frequencies are specified. Same hidden size is used for all.
