2025-11-21 01:11:37,122: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091137Z/testing_run_2111_011137/output.log initialized.
2025-11-21 01:11:37,122: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091137Z/testing_run_2111_011137
2025-11-21 01:11:37,122: ### Run configurations for testing_run
2025-11-21 01:11:37,122: experiment_name: testing_run
2025-11-21 01:11:37,123: train_basin_file: guerneville
2025-11-21 01:11:37,123: validation_basin_file: guerneville
2025-11-21 01:11:37,123: test_basin_file: guerneville
2025-11-21 01:11:37,123: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:11:37,123: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:11:37,124: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:11:37,124: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:11:37,124: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:11:37,124: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:11:37,124: device: cpu
2025-11-21 01:11:37,125: physics_informed: False
2025-11-21 01:11:37,125: physics_data_file: None
2025-11-21 01:11:37,125: validate_every: 5
2025-11-21 01:11:37,125: validate_n_random_basins: 1
2025-11-21 01:11:37,125: save_validation_results: True
2025-11-21 01:11:37,125: metrics: ['NSE', 'MSE']
2025-11-21 01:11:37,126: model: mtslstm
2025-11-21 01:11:37,126: shared_mtslstm: False
2025-11-21 01:11:37,126: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:11:37,126: use_frequencies: ['1H', '1D']
2025-11-21 01:11:37,126: head: regression
2025-11-21 01:11:37,127: output_activation: linear
2025-11-21 01:11:37,127: hidden_size: 256
2025-11-21 01:11:37,127: initial_forget_bias: 3
2025-11-21 01:11:37,127: output_dropout: 0.4
2025-11-21 01:11:37,127: optimizer: Adam
2025-11-21 01:11:37,128: loss: NSE
2025-11-21 01:11:37,128: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:11:37,128: batch_size: 64
2025-11-21 01:11:37,128: epochs: 2
2025-11-21 01:11:37,128: clip_gradient_norm: 1
2025-11-21 01:11:37,128: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:11:37,129: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:11:37,129: log_interval: 16
2025-11-21 01:11:37,130: log_tensorboard: True
2025-11-21 01:11:37,130: log_n_figures: 1
2025-11-21 01:11:37,130: save_weights_every: 2
2025-11-21 01:11:37,131: dataset: russian_river
2025-11-21 01:11:37,131: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:11:37,131: dev_mode: False
2025-11-21 01:11:37,132: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:11:37,132: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:11:37,133: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:11:37,133: num_layers: 1
2025-11-21 01:11:37,133: hourly: True
2025-11-21 01:11:37,134: is_mts: True
2025-11-21 01:11:37,134: is_mts_data: False
2025-11-21 01:11:37,134: verbose: True
2025-11-21 01:11:37,135: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091137Z/testing_run_2111_011137
2025-11-21 01:11:37,136: run_label: BASELINE
2025-11-21 01:11:37,137: run_stamp: 20251121T091137Z
2025-11-21 01:11:37,138: number_of_basins: 1
2025-11-21 01:11:37,138: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091137Z/testing_run_2111_011137/train_data
2025-11-21 01:11:37,139: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091137Z/testing_run_2111_011137/img_log
2025-11-21 01:11:37,147: ### Device cpu will be used for training
2025-11-21 01:11:37,147: Loading basin data into xarray data set.
2025-11-21 01:11:38,368: Calculating target variable stds per basin
2025-11-21 01:11:38,389: Create lookup table and convert to pytorch tensor
2025-11-21 01:11:39,335: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:11:48,822: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:11:57,113: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:14:13,979: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/output.log initialized.
2025-11-21 01:14:13,979: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413
2025-11-21 01:14:13,979: ### Run configurations for testing_run
2025-11-21 01:14:13,980: experiment_name: testing_run
2025-11-21 01:14:13,980: train_basin_file: guerneville
2025-11-21 01:14:13,980: validation_basin_file: guerneville
2025-11-21 01:14:13,980: test_basin_file: guerneville
2025-11-21 01:14:13,980: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:14:13,981: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:14:13,981: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:14:13,981: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:14:13,981: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:14:13,982: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:14:13,983: device: cpu
2025-11-21 01:14:13,983: physics_informed: False
2025-11-21 01:14:13,983: physics_data_file: None
2025-11-21 01:14:13,984: validate_every: 5
2025-11-21 01:14:13,984: validate_n_random_basins: 1
2025-11-21 01:14:13,984: save_validation_results: True
2025-11-21 01:14:13,984: metrics: ['NSE', 'MSE']
2025-11-21 01:14:13,984: model: mtslstm
2025-11-21 01:14:13,985: shared_mtslstm: False
2025-11-21 01:14:13,985: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:14:13,985: use_frequencies: ['1H', '1D']
2025-11-21 01:14:13,985: head: regression
2025-11-21 01:14:13,986: output_activation: linear
2025-11-21 01:14:13,986: hidden_size: 256
2025-11-21 01:14:13,986: initial_forget_bias: 3
2025-11-21 01:14:13,986: output_dropout: 0.4
2025-11-21 01:14:13,986: optimizer: Adam
2025-11-21 01:14:13,986: loss: NSE
2025-11-21 01:14:13,987: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:14:13,987: batch_size: 64
2025-11-21 01:14:13,987: epochs: 2
2025-11-21 01:14:13,987: clip_gradient_norm: 1
2025-11-21 01:14:13,987: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:14:13,988: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:14:13,988: log_interval: 16
2025-11-21 01:14:13,988: log_tensorboard: True
2025-11-21 01:14:13,988: log_n_figures: 1
2025-11-21 01:14:13,988: save_weights_every: 2
2025-11-21 01:14:13,988: dataset: russian_river
2025-11-21 01:14:13,989: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:14:13,989: dev_mode: True
2025-11-21 01:14:13,989: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:14:13,989: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:14:13,989: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:14:13,990: num_layers: 1
2025-11-21 01:14:13,990: hourly: True
2025-11-21 01:14:13,990: is_mts: True
2025-11-21 01:14:13,990: is_mts_data: False
2025-11-21 01:14:13,990: verbose: True
2025-11-21 01:14:13,990: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413
2025-11-21 01:14:13,991: run_label: BASELINE
2025-11-21 01:14:13,991: run_stamp: 20251121T091413Z
2025-11-21 01:14:13,991: number_of_basins: 1
2025-11-21 01:14:13,991: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/train_data
2025-11-21 01:14:13,991: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/img_log
2025-11-21 01:14:13,995: ### Device cpu will be used for training
2025-11-21 01:14:13,996: Loading basin data into xarray data set.
2025-11-21 01:14:15,143: Calculating target variable stds per basin
2025-11-21 01:14:15,168: Create lookup table and convert to pytorch tensor
2025-11-21 01:14:15,281: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:14:23,869: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:14:32,348: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:14:32,374: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:14:32,383: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/model_epoch002.pt
2025-11-21 01:14:35,094: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:14:35,095: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011413/validation/model_epoch002/validation_results.p
2025-11-21 01:14:35,663: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/output.log initialized.
2025-11-21 01:14:35,663: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435
2025-11-21 01:14:35,664: ### Run configurations for testing_run
2025-11-21 01:14:35,664: experiment_name: testing_run
2025-11-21 01:14:35,664: train_basin_file: guerneville
2025-11-21 01:14:35,664: validation_basin_file: guerneville
2025-11-21 01:14:35,664: test_basin_file: guerneville
2025-11-21 01:14:35,665: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:14:35,665: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:14:35,665: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:14:35,665: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:14:35,666: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:14:35,666: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:14:35,666: device: cpu
2025-11-21 01:14:35,666: physics_informed: True
2025-11-21 01:14:35,667: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:14:35,667: validate_every: 5
2025-11-21 01:14:35,667: validate_n_random_basins: 1
2025-11-21 01:14:35,667: save_validation_results: True
2025-11-21 01:14:35,667: metrics: ['NSE', 'MSE']
2025-11-21 01:14:35,668: model: mtslstm
2025-11-21 01:14:35,668: shared_mtslstm: False
2025-11-21 01:14:35,668: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:14:35,668: use_frequencies: ['1H', '1D']
2025-11-21 01:14:35,669: head: regression
2025-11-21 01:14:35,669: output_activation: linear
2025-11-21 01:14:35,669: hidden_size: 128
2025-11-21 01:14:35,669: initial_forget_bias: 3
2025-11-21 01:14:35,669: output_dropout: 0.4
2025-11-21 01:14:35,670: optimizer: Adam
2025-11-21 01:14:35,670: loss: NSE
2025-11-21 01:14:35,670: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:14:35,670: batch_size: 64
2025-11-21 01:14:35,670: epochs: 2
2025-11-21 01:14:35,671: clip_gradient_norm: 1
2025-11-21 01:14:35,671: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:14:35,671: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:14:35,671: log_interval: 16
2025-11-21 01:14:35,671: log_tensorboard: True
2025-11-21 01:14:35,671: log_n_figures: 1
2025-11-21 01:14:35,672: save_weights_every: 2
2025-11-21 01:14:35,672: dataset: russian_river
2025-11-21 01:14:35,672: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:14:35,672: dev_mode: True
2025-11-21 01:14:35,673: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:14:35,673: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:14:35,673: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:14:35,673: num_layers: 1
2025-11-21 01:14:35,673: hourly: True
2025-11-21 01:14:35,674: is_mts: True
2025-11-21 01:14:35,674: is_mts_data: False
2025-11-21 01:14:35,674: verbose: True
2025-11-21 01:14:35,674: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435
2025-11-21 01:14:35,674: run_label: BASELINE
2025-11-21 01:14:35,674: run_stamp: 20251121T091413Z
2025-11-21 01:14:35,675: number_of_basins: 1
2025-11-21 01:14:35,675: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/train_data
2025-11-21 01:14:35,675: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/img_log
2025-11-21 01:14:35,677: ### Device cpu will be used for training
2025-11-21 01:14:35,677: Loading basin data into xarray data set.
2025-11-21 01:14:40,191: Calculating target variable stds per basin
2025-11-21 01:14:40,247: Create lookup table and convert to pytorch tensor
2025-11-21 01:14:40,454: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:14:45,439: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:14:50,570: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:14:50,584: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:14:50,599: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/model_epoch002.pt
2025-11-21 01:14:55,377: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:14:55,378: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011435/validation/model_epoch002/validation_results.p
2025-11-21 01:15:02,535: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/output.log initialized.
2025-11-21 01:15:02,536: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502
2025-11-21 01:15:02,536: ### Run configurations for testing_run
2025-11-21 01:15:02,537: experiment_name: testing_run
2025-11-21 01:15:02,537: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:02,538: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:02,538: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:02,539: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:15:02,539: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:15:02,540: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:15:02,540: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:15:02,541: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:15:02,541: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:15:02,541: device: cpu
2025-11-21 01:15:02,541: physics_informed: False
2025-11-21 01:15:02,542: physics_data_file: None
2025-11-21 01:15:02,542: validate_every: 5
2025-11-21 01:15:02,542: validate_n_random_basins: 1
2025-11-21 01:15:02,542: save_validation_results: True
2025-11-21 01:15:02,542: metrics: ['NSE', 'MSE']
2025-11-21 01:15:02,543: model: mtslstm
2025-11-21 01:15:02,543: shared_mtslstm: False
2025-11-21 01:15:02,543: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:15:02,543: use_frequencies: ['1H', '1D']
2025-11-21 01:15:02,543: head: regression
2025-11-21 01:15:02,543: output_activation: linear
2025-11-21 01:15:02,544: hidden_size: 256
2025-11-21 01:15:02,544: initial_forget_bias: 3
2025-11-21 01:15:02,544: output_dropout: 0.4
2025-11-21 01:15:02,544: optimizer: Adam
2025-11-21 01:15:02,544: loss: NSE
2025-11-21 01:15:02,545: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:15:02,545: batch_size: 64
2025-11-21 01:15:02,545: epochs: 2
2025-11-21 01:15:02,545: clip_gradient_norm: 1
2025-11-21 01:15:02,545: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:15:02,545: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:15:02,546: log_interval: 16
2025-11-21 01:15:02,546: log_tensorboard: True
2025-11-21 01:15:02,546: log_n_figures: 1
2025-11-21 01:15:02,546: save_weights_every: 2
2025-11-21 01:15:02,546: dataset: russian_river
2025-11-21 01:15:02,547: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:15:02,547: dev_mode: True
2025-11-21 01:15:02,547: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:15:02,547: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:15:02,547: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:15:02,548: num_layers: 1
2025-11-21 01:15:02,548: hourly: True
2025-11-21 01:15:02,548: is_mts: True
2025-11-21 01:15:02,548: is_mts_data: False
2025-11-21 01:15:02,548: verbose: True
2025-11-21 01:15:02,549: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502
2025-11-21 01:15:02,549: run_label: BASELINE
2025-11-21 01:15:02,549: run_stamp: 20251121T091413Z
2025-11-21 01:15:02,549: number_of_basins: 1
2025-11-21 01:15:02,549: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/train_data
2025-11-21 01:15:02,550: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/img_log
2025-11-21 01:15:02,552: ### Device cpu will be used for training
2025-11-21 01:15:02,552: Loading basin data into xarray data set.
2025-11-21 01:15:03,778: Calculating target variable stds per basin
2025-11-21 01:15:03,802: Create lookup table and convert to pytorch tensor
2025-11-21 01:15:03,910: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:15:16,298: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:15:29,454: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:15:29,478: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/testing_run_2111_011529/output.log initialized.
2025-11-21 01:15:29,478: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/testing_run_2111_011529
2025-11-21 01:15:29,479: ### Run configurations for testing_run
2025-11-21 01:15:29,479: experiment_name: testing_run
2025-11-21 01:15:29,479: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:29,479: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:29,479: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:15:29,480: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:15:29,480: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:15:29,480: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:15:29,480: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:15:29,480: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:15:29,481: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:15:29,481: device: cpu
2025-11-21 01:15:29,481: physics_informed: False
2025-11-21 01:15:29,481: physics_data_file: None
2025-11-21 01:15:29,481: validate_every: 5
2025-11-21 01:15:29,482: validate_n_random_basins: 1
2025-11-21 01:15:29,482: save_validation_results: True
2025-11-21 01:15:29,482: metrics: ['NSE', 'MSE']
2025-11-21 01:15:29,482: model: mtslstm
2025-11-21 01:15:29,482: shared_mtslstm: False
2025-11-21 01:15:29,483: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:15:29,483: use_frequencies: ['1H', '1D']
2025-11-21 01:15:29,483: head: regression
2025-11-21 01:15:29,483: output_activation: linear
2025-11-21 01:15:29,483: hidden_size: 256
2025-11-21 01:15:29,484: initial_forget_bias: 3
2025-11-21 01:15:29,484: output_dropout: 0.4
2025-11-21 01:15:29,484: optimizer: Adam
2025-11-21 01:15:29,484: loss: NSE
2025-11-21 01:15:29,484: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:15:29,484: batch_size: 64
2025-11-21 01:15:29,485: epochs: 2
2025-11-21 01:15:29,485: clip_gradient_norm: 1
2025-11-21 01:15:29,485: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:15:29,485: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:15:29,485: log_interval: 16
2025-11-21 01:15:29,486: log_tensorboard: True
2025-11-21 01:15:29,486: log_n_figures: 1
2025-11-21 01:15:29,486: save_weights_every: 2
2025-11-21 01:15:29,486: dataset: russian_river
2025-11-21 01:15:29,486: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:15:29,486: dev_mode: True
2025-11-21 01:15:29,487: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:15:29,487: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:15:29,487: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:15:29,487: num_layers: 1
2025-11-21 01:15:29,487: hourly: True
2025-11-21 01:15:29,488: is_mts: True
2025-11-21 01:15:29,488: is_mts_data: False
2025-11-21 01:15:29,488: verbose: True
2025-11-21 01:15:29,488: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/testing_run_2111_011529
2025-11-21 01:15:29,488: run_label: BASELINE
2025-11-21 01:15:29,488: run_stamp: 20251121T091413Z
2025-11-21 01:15:29,489: number_of_basins: 1
2025-11-21 01:15:29,489: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/testing_run_2111_011529/train_data
2025-11-21 01:15:29,489: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091413Z/testing_run_2111_011502/testing_run_2111_011529/img_log
2025-11-21 01:15:29,489: seed: 393085
2025-11-21 01:15:29,489: commit_hash: 994040c
2025-11-21 01:15:29,489: package_version: 1.11.0
2025-11-21 01:15:29,492: ### Device cpu will be used for training
2025-11-21 01:15:29,492: Loading basin data into xarray data set.
2025-11-21 01:15:30,801: Calculating target variable stds per basin
2025-11-21 01:15:30,826: Create lookup table and convert to pytorch tensor
2025-11-21 01:15:30,940: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:15:43,193: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
