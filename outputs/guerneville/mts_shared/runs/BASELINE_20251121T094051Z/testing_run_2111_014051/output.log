2025-11-21 01:40:51,688: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/output.log initialized.
2025-11-21 01:40:51,689: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051
2025-11-21 01:40:51,689: ### Run configurations for testing_run
2025-11-21 01:40:51,690: experiment_name: testing_run
2025-11-21 01:40:51,690: train_basin_file: guerneville
2025-11-21 01:40:51,691: validation_basin_file: guerneville
2025-11-21 01:40:51,691: test_basin_file: guerneville
2025-11-21 01:40:51,692: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:40:51,692: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:40:51,693: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:40:51,693: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:40:51,694: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:40:51,694: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:40:51,695: device: cpu
2025-11-21 01:40:51,695: physics_informed: False
2025-11-21 01:40:51,696: physics_data_file: None
2025-11-21 01:40:51,696: validate_every: 5
2025-11-21 01:40:51,697: validate_n_random_basins: 1
2025-11-21 01:40:51,697: save_validation_results: True
2025-11-21 01:40:51,698: metrics: ['NSE', 'MSE']
2025-11-21 01:40:51,698: model: mtslstm
2025-11-21 01:40:51,699: shared_mtslstm: False
2025-11-21 01:40:51,699: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:40:51,699: use_frequencies: ['1H', '1D']
2025-11-21 01:40:51,700: head: regression
2025-11-21 01:40:51,700: output_activation: linear
2025-11-21 01:40:51,701: hidden_size: 256
2025-11-21 01:40:51,701: initial_forget_bias: 3
2025-11-21 01:40:51,702: output_dropout: 0.4
2025-11-21 01:40:51,702: optimizer: Adam
2025-11-21 01:40:51,703: loss: NSE
2025-11-21 01:40:51,703: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:40:51,704: batch_size: 64
2025-11-21 01:40:51,705: epochs: 2
2025-11-21 01:40:51,705: clip_gradient_norm: 1
2025-11-21 01:40:51,706: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:40:51,706: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:40:51,707: log_interval: 16
2025-11-21 01:40:51,707: log_tensorboard: True
2025-11-21 01:40:51,708: log_n_figures: 1
2025-11-21 01:40:51,708: save_weights_every: 2
2025-11-21 01:40:51,709: dataset: russian_river
2025-11-21 01:40:51,709: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:40:51,710: dev_mode: True
2025-11-21 01:40:51,710: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:40:51,711: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:40:51,711: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:40:51,712: num_layers: 1
2025-11-21 01:40:51,712: hourly: True
2025-11-21 01:40:51,713: is_mts: True
2025-11-21 01:40:51,713: is_mts_data: False
2025-11-21 01:40:51,714: verbose: True
2025-11-21 01:40:51,714: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051
2025-11-21 01:40:51,715: run_label: BASELINE
2025-11-21 01:40:51,716: run_stamp: 20251121T094051Z
2025-11-21 01:40:51,716: number_of_basins: 1
2025-11-21 01:40:51,717: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/train_data
2025-11-21 01:40:51,717: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/img_log
2025-11-21 01:40:51,726: ### Device cpu will be used for training
2025-11-21 01:40:51,727: Loading basin data into xarray data set.
2025-11-21 01:40:52,906: Calculating target variable stds per basin
2025-11-21 01:40:52,927: Create lookup table and convert to pytorch tensor
2025-11-21 01:40:53,788: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:41:02,505: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:41:10,500: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:41:10,539: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:41:10,548: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/model_epoch002.pt
2025-11-21 01:41:13,198: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:41:13,199: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014051/validation/model_epoch002/validation_results.p
2025-11-21 01:41:13,601: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/output.log initialized.
2025-11-21 01:41:13,601: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113
2025-11-21 01:41:13,601: ### Run configurations for testing_run
2025-11-21 01:41:13,601: experiment_name: testing_run
2025-11-21 01:41:13,602: train_basin_file: guerneville
2025-11-21 01:41:13,602: validation_basin_file: guerneville
2025-11-21 01:41:13,602: test_basin_file: guerneville
2025-11-21 01:41:13,602: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:41:13,602: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:41:13,603: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:41:13,603: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:41:13,603: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:41:13,603: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:41:13,603: device: cpu
2025-11-21 01:41:13,603: physics_informed: True
2025-11-21 01:41:13,604: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:41:13,604: validate_every: 5
2025-11-21 01:41:13,604: validate_n_random_basins: 1
2025-11-21 01:41:13,604: save_validation_results: True
2025-11-21 01:41:13,604: metrics: ['NSE', 'MSE']
2025-11-21 01:41:13,605: model: mtslstm
2025-11-21 01:41:13,605: shared_mtslstm: False
2025-11-21 01:41:13,605: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:41:13,605: use_frequencies: ['1H', '1D']
2025-11-21 01:41:13,605: head: regression
2025-11-21 01:41:13,605: output_activation: linear
2025-11-21 01:41:13,606: hidden_size: 128
2025-11-21 01:41:13,607: initial_forget_bias: 3
2025-11-21 01:41:13,622: output_dropout: 0.4
2025-11-21 01:41:13,623: optimizer: Adam
2025-11-21 01:41:13,623: loss: NSE
2025-11-21 01:41:13,623: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:41:13,624: batch_size: 64
2025-11-21 01:41:13,624: epochs: 2
2025-11-21 01:41:13,624: clip_gradient_norm: 1
2025-11-21 01:41:13,624: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:41:13,625: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:41:13,625: log_interval: 16
2025-11-21 01:41:13,625: log_tensorboard: True
2025-11-21 01:41:13,625: log_n_figures: 1
2025-11-21 01:41:13,625: save_weights_every: 2
2025-11-21 01:41:13,626: dataset: russian_river
2025-11-21 01:41:13,626: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:41:13,626: dev_mode: True
2025-11-21 01:41:13,626: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:41:13,626: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:41:13,626: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:41:13,627: num_layers: 1
2025-11-21 01:41:13,627: hourly: True
2025-11-21 01:41:13,627: is_mts: True
2025-11-21 01:41:13,627: is_mts_data: False
2025-11-21 01:41:13,628: verbose: True
2025-11-21 01:41:13,628: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113
2025-11-21 01:41:13,628: run_label: BASELINE
2025-11-21 01:41:13,628: run_stamp: 20251121T094051Z
2025-11-21 01:41:13,629: number_of_basins: 1
2025-11-21 01:41:13,630: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/train_data
2025-11-21 01:41:13,632: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/img_log
2025-11-21 01:41:13,636: ### Device cpu will be used for training
2025-11-21 01:41:13,636: Loading basin data into xarray data set.
2025-11-21 01:41:17,953: Calculating target variable stds per basin
2025-11-21 01:41:18,010: Create lookup table and convert to pytorch tensor
2025-11-21 01:41:18,229: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:41:22,787: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:41:27,304: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:41:27,315: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:41:27,329: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/model_epoch002.pt
2025-11-21 01:41:32,124: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:41:32,124: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014113/validation/model_epoch002/validation_results.p
2025-11-21 01:41:39,017: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/output.log initialized.
2025-11-21 01:41:39,018: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139
2025-11-21 01:41:39,019: ### Run configurations for testing_run
2025-11-21 01:41:39,019: experiment_name: testing_run
2025-11-21 01:41:39,020: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:41:39,020: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:41:39,021: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:41:39,022: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:41:39,022: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:41:39,023: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:41:39,023: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:41:39,024: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:41:39,024: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:41:39,025: device: cpu
2025-11-21 01:41:39,025: physics_informed: False
2025-11-21 01:41:39,026: physics_data_file: None
2025-11-21 01:41:39,026: validate_every: 5
2025-11-21 01:41:39,026: validate_n_random_basins: 1
2025-11-21 01:41:39,027: save_validation_results: True
2025-11-21 01:41:39,027: metrics: ['NSE', 'MSE']
2025-11-21 01:41:39,027: model: mtslstm
2025-11-21 01:41:39,028: shared_mtslstm: False
2025-11-21 01:41:39,028: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:41:39,029: use_frequencies: ['1H', '1D']
2025-11-21 01:41:39,029: head: regression
2025-11-21 01:41:39,029: output_activation: linear
2025-11-21 01:41:39,029: hidden_size: 256
2025-11-21 01:41:39,030: initial_forget_bias: 3
2025-11-21 01:41:39,030: output_dropout: 0.4
2025-11-21 01:41:39,030: optimizer: Adam
2025-11-21 01:41:39,030: loss: NSE
2025-11-21 01:41:39,030: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:41:39,031: batch_size: 64
2025-11-21 01:41:39,031: epochs: 2
2025-11-21 01:41:39,031: clip_gradient_norm: 1
2025-11-21 01:41:39,031: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:41:39,031: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:41:39,031: log_interval: 16
2025-11-21 01:41:39,032: log_tensorboard: True
2025-11-21 01:41:39,032: log_n_figures: 1
2025-11-21 01:41:39,032: save_weights_every: 2
2025-11-21 01:41:39,032: dataset: russian_river
2025-11-21 01:41:39,032: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:41:39,032: dev_mode: True
2025-11-21 01:41:39,033: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:41:39,033: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:41:39,033: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:41:39,033: num_layers: 1
2025-11-21 01:41:39,033: hourly: True
2025-11-21 01:41:39,033: is_mts: True
2025-11-21 01:41:39,034: is_mts_data: False
2025-11-21 01:41:39,034: verbose: True
2025-11-21 01:41:39,034: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139
2025-11-21 01:41:39,034: run_label: BASELINE
2025-11-21 01:41:39,035: run_stamp: 20251121T094051Z
2025-11-21 01:41:39,035: number_of_basins: 1
2025-11-21 01:41:39,035: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/train_data
2025-11-21 01:41:39,035: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/img_log
2025-11-21 01:41:39,039: ### Device cpu will be used for training
2025-11-21 01:41:39,040: Loading basin data into xarray data set.
2025-11-21 01:41:40,252: Calculating target variable stds per basin
2025-11-21 01:41:40,280: Create lookup table and convert to pytorch tensor
2025-11-21 01:41:40,392: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:41:53,221: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:04,643: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:04,668: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/output.log initialized.
2025-11-21 01:42:04,669: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204
2025-11-21 01:42:04,669: ### Run configurations for testing_run
2025-11-21 01:42:04,669: experiment_name: testing_run
2025-11-21 01:42:04,670: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:04,670: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:04,670: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:04,670: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:42:04,671: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:04,671: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:42:04,671: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:04,671: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:42:04,671: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:42:04,671: device: cpu
2025-11-21 01:42:04,672: physics_informed: False
2025-11-21 01:42:04,672: physics_data_file: None
2025-11-21 01:42:04,672: validate_every: 5
2025-11-21 01:42:04,672: validate_n_random_basins: 1
2025-11-21 01:42:04,672: save_validation_results: True
2025-11-21 01:42:04,673: metrics: ['NSE', 'MSE']
2025-11-21 01:42:04,673: model: mtslstm
2025-11-21 01:42:04,673: shared_mtslstm: False
2025-11-21 01:42:04,673: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:42:04,673: use_frequencies: ['1H', '1D']
2025-11-21 01:42:04,674: head: regression
2025-11-21 01:42:04,674: output_activation: linear
2025-11-21 01:42:04,674: hidden_size: 256
2025-11-21 01:42:04,674: initial_forget_bias: 3
2025-11-21 01:42:04,674: output_dropout: 0.4
2025-11-21 01:42:04,674: optimizer: Adam
2025-11-21 01:42:04,675: loss: NSE
2025-11-21 01:42:04,675: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:42:04,675: batch_size: 64
2025-11-21 01:42:04,675: epochs: 2
2025-11-21 01:42:04,675: clip_gradient_norm: 1
2025-11-21 01:42:04,676: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:42:04,676: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:42:04,676: log_interval: 16
2025-11-21 01:42:04,676: log_tensorboard: True
2025-11-21 01:42:04,676: log_n_figures: 1
2025-11-21 01:42:04,676: save_weights_every: 2
2025-11-21 01:42:04,677: dataset: russian_river
2025-11-21 01:42:04,677: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:42:04,677: dev_mode: True
2025-11-21 01:42:04,677: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:42:04,677: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:42:04,678: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:42:04,678: num_layers: 1
2025-11-21 01:42:04,678: hourly: True
2025-11-21 01:42:04,678: is_mts: True
2025-11-21 01:42:04,678: is_mts_data: False
2025-11-21 01:42:04,679: verbose: True
2025-11-21 01:42:04,679: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204
2025-11-21 01:42:04,679: run_label: BASELINE
2025-11-21 01:42:04,679: run_stamp: 20251121T094051Z
2025-11-21 01:42:04,679: number_of_basins: 1
2025-11-21 01:42:04,679: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/train_data
2025-11-21 01:42:04,680: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/img_log
2025-11-21 01:42:04,680: seed: 302599
2025-11-21 01:42:04,680: commit_hash: 994040c
2025-11-21 01:42:04,680: package_version: 1.11.0
2025-11-21 01:42:04,682: ### Device cpu will be used for training
2025-11-21 01:42:04,683: Loading basin data into xarray data set.
2025-11-21 01:42:05,919: Calculating target variable stds per basin
2025-11-21 01:42:05,945: Create lookup table and convert to pytorch tensor
2025-11-21 01:42:06,057: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:42:17,346: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:29,469: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:29,497: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/output.log initialized.
2025-11-21 01:42:29,498: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229
2025-11-21 01:42:29,498: ### Run configurations for testing_run
2025-11-21 01:42:29,498: experiment_name: testing_run
2025-11-21 01:42:29,498: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:29,499: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:29,499: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:29,499: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:42:29,499: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:29,500: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:42:29,500: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:29,500: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:42:29,500: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:42:29,501: device: cpu
2025-11-21 01:42:29,501: physics_informed: False
2025-11-21 01:42:29,501: physics_data_file: None
2025-11-21 01:42:29,501: validate_every: 5
2025-11-21 01:42:29,501: validate_n_random_basins: 1
2025-11-21 01:42:29,502: save_validation_results: True
2025-11-21 01:42:29,502: metrics: ['NSE', 'MSE']
2025-11-21 01:42:29,502: model: mtslstm
2025-11-21 01:42:29,502: shared_mtslstm: False
2025-11-21 01:42:29,502: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:42:29,503: use_frequencies: ['1H', '1D']
2025-11-21 01:42:29,503: head: regression
2025-11-21 01:42:29,503: output_activation: linear
2025-11-21 01:42:29,503: hidden_size: 256
2025-11-21 01:42:29,503: initial_forget_bias: 3
2025-11-21 01:42:29,503: output_dropout: 0.4
2025-11-21 01:42:29,504: optimizer: Adam
2025-11-21 01:42:29,504: loss: NSE
2025-11-21 01:42:29,504: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:42:29,504: batch_size: 64
2025-11-21 01:42:29,504: epochs: 2
2025-11-21 01:42:29,504: clip_gradient_norm: 1
2025-11-21 01:42:29,505: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:42:29,505: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:42:29,505: log_interval: 16
2025-11-21 01:42:29,505: log_tensorboard: True
2025-11-21 01:42:29,505: log_n_figures: 1
2025-11-21 01:42:29,506: save_weights_every: 2
2025-11-21 01:42:29,506: dataset: russian_river
2025-11-21 01:42:29,506: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:42:29,506: dev_mode: True
2025-11-21 01:42:29,506: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:42:29,506: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:42:29,507: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:42:29,507: num_layers: 1
2025-11-21 01:42:29,507: hourly: True
2025-11-21 01:42:29,507: is_mts: True
2025-11-21 01:42:29,507: is_mts_data: False
2025-11-21 01:42:29,508: verbose: True
2025-11-21 01:42:29,508: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229
2025-11-21 01:42:29,508: run_label: BASELINE
2025-11-21 01:42:29,508: run_stamp: 20251121T094051Z
2025-11-21 01:42:29,508: number_of_basins: 1
2025-11-21 01:42:29,508: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/train_data
2025-11-21 01:42:29,509: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/img_log
2025-11-21 01:42:29,509: seed: 302599
2025-11-21 01:42:29,509: commit_hash: 994040c
2025-11-21 01:42:29,509: package_version: 1.11.0
2025-11-21 01:42:29,511: ### Device cpu will be used for training
2025-11-21 01:42:29,512: Loading basin data into xarray data set.
2025-11-21 01:42:30,833: Calculating target variable stds per basin
2025-11-21 01:42:30,861: Create lookup table and convert to pytorch tensor
2025-11-21 01:42:30,984: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:42:43,698: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:55,757: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:42:55,790: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/testing_run_2111_014255/output.log initialized.
2025-11-21 01:42:55,790: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/testing_run_2111_014255
2025-11-21 01:42:55,790: ### Run configurations for testing_run
2025-11-21 01:42:55,791: experiment_name: testing_run
2025-11-21 01:42:55,791: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:55,791: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:55,791: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:42:55,792: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:42:55,792: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:55,792: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:42:55,792: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:42:55,792: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:42:55,793: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:42:55,793: device: cpu
2025-11-21 01:42:55,793: physics_informed: False
2025-11-21 01:42:55,793: physics_data_file: None
2025-11-21 01:42:55,793: validate_every: 5
2025-11-21 01:42:55,794: validate_n_random_basins: 1
2025-11-21 01:42:55,794: save_validation_results: True
2025-11-21 01:42:55,794: metrics: ['NSE', 'MSE']
2025-11-21 01:42:55,794: model: mtslstm
2025-11-21 01:42:55,794: shared_mtslstm: False
2025-11-21 01:42:55,794: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:42:55,795: use_frequencies: ['1H', '1D']
2025-11-21 01:42:55,795: head: regression
2025-11-21 01:42:55,795: output_activation: linear
2025-11-21 01:42:55,795: hidden_size: 256
2025-11-21 01:42:55,796: initial_forget_bias: 3
2025-11-21 01:42:55,796: output_dropout: 0.4
2025-11-21 01:42:55,796: optimizer: Adam
2025-11-21 01:42:55,796: loss: NSE
2025-11-21 01:42:55,796: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:42:55,797: batch_size: 64
2025-11-21 01:42:55,797: epochs: 2
2025-11-21 01:42:55,797: clip_gradient_norm: 1
2025-11-21 01:42:55,797: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:42:55,797: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:42:55,798: log_interval: 16
2025-11-21 01:42:55,798: log_tensorboard: True
2025-11-21 01:42:55,798: log_n_figures: 1
2025-11-21 01:42:55,798: save_weights_every: 2
2025-11-21 01:42:55,798: dataset: russian_river
2025-11-21 01:42:55,799: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:42:55,799: dev_mode: True
2025-11-21 01:42:55,799: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:42:55,799: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:42:55,799: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:42:55,800: num_layers: 1
2025-11-21 01:42:55,800: hourly: True
2025-11-21 01:42:55,800: is_mts: True
2025-11-21 01:42:55,800: is_mts_data: False
2025-11-21 01:42:55,800: verbose: True
2025-11-21 01:42:55,800: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/testing_run_2111_014255
2025-11-21 01:42:55,801: run_label: BASELINE
2025-11-21 01:42:55,801: run_stamp: 20251121T094051Z
2025-11-21 01:42:55,801: number_of_basins: 1
2025-11-21 01:42:55,801: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/testing_run_2111_014255/train_data
2025-11-21 01:42:55,801: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014139/testing_run_2111_014204/testing_run_2111_014229/testing_run_2111_014255/img_log
2025-11-21 01:42:55,801: seed: 302599
2025-11-21 01:42:55,802: commit_hash: 994040c
2025-11-21 01:42:55,802: package_version: 1.11.0
2025-11-21 01:42:55,804: ### Device cpu will be used for training
2025-11-21 01:42:55,805: Loading basin data into xarray data set.
2025-11-21 01:42:57,090: Calculating target variable stds per basin
2025-11-21 01:42:57,118: Create lookup table and convert to pytorch tensor
2025-11-21 01:42:57,242: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:45:57,548: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/output.log initialized.
2025-11-21 01:45:57,549: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557
2025-11-21 01:45:57,550: ### Run configurations for testing_run
2025-11-21 01:45:57,550: experiment_name: testing_run
2025-11-21 01:45:57,550: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:45:57,550: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:45:57,551: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:45:57,551: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:45:57,551: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:45:57,551: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:45:57,552: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:45:57,552: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:45:57,552: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:45:57,552: device: cpu
2025-11-21 01:45:57,552: physics_informed: False
2025-11-21 01:45:57,553: physics_data_file: None
2025-11-21 01:45:57,553: validate_every: 5
2025-11-21 01:45:57,553: validate_n_random_basins: 1
2025-11-21 01:45:57,553: save_validation_results: True
2025-11-21 01:45:57,553: metrics: ['NSE', 'MSE']
2025-11-21 01:45:57,554: model: mtslstm
2025-11-21 01:45:57,554: shared_mtslstm: False
2025-11-21 01:45:57,554: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:45:57,554: use_frequencies: ['1H', '1D']
2025-11-21 01:45:57,554: head: regression
2025-11-21 01:45:57,555: output_activation: linear
2025-11-21 01:45:57,555: hidden_size: 256
2025-11-21 01:45:57,555: initial_forget_bias: 3
2025-11-21 01:45:57,555: output_dropout: 0.4
2025-11-21 01:45:57,555: optimizer: Adam
2025-11-21 01:45:57,556: loss: NSE
2025-11-21 01:45:57,556: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:45:57,556: batch_size: 64
2025-11-21 01:45:57,557: epochs: 2
2025-11-21 01:45:57,557: clip_gradient_norm: 1
2025-11-21 01:45:57,557: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:45:57,558: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:45:57,558: log_interval: 16
2025-11-21 01:45:57,558: log_tensorboard: True
2025-11-21 01:45:57,558: log_n_figures: 1
2025-11-21 01:45:57,558: save_weights_every: 2
2025-11-21 01:45:57,559: dataset: russian_river
2025-11-21 01:45:57,559: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:45:57,559: dev_mode: True
2025-11-21 01:45:57,559: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:45:57,559: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:45:57,560: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:45:57,560: num_layers: 1
2025-11-21 01:45:57,560: hourly: True
2025-11-21 01:45:57,560: is_mts: True
2025-11-21 01:45:57,561: is_mts_data: False
2025-11-21 01:45:57,561: verbose: True
2025-11-21 01:45:57,561: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557
2025-11-21 01:45:57,561: run_label: BASELINE
2025-11-21 01:45:57,561: run_stamp: 20251121T094051Z
2025-11-21 01:45:57,562: number_of_basins: 1
2025-11-21 01:45:57,562: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/train_data
2025-11-21 01:45:57,562: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/img_log
2025-11-21 01:45:57,578: ### Device cpu will be used for training
2025-11-21 01:45:57,578: Loading basin data into xarray data set.
2025-11-21 01:45:58,971: Calculating target variable stds per basin
2025-11-21 01:45:59,021: Create lookup table and convert to pytorch tensor
2025-11-21 01:45:59,156: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:46:13,523: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:46:25,881: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:46:25,912: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/testing_run_2111_014625/output.log initialized.
2025-11-21 01:46:25,913: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/testing_run_2111_014625
2025-11-21 01:46:25,913: ### Run configurations for testing_run
2025-11-21 01:46:25,913: experiment_name: testing_run
2025-11-21 01:46:25,913: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:46:25,914: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:46:25,914: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:46:25,916: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:46:25,916: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:46:25,916: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:46:25,917: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:46:25,917: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:46:25,917: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:46:25,917: device: cpu
2025-11-21 01:46:25,917: physics_informed: False
2025-11-21 01:46:25,917: physics_data_file: None
2025-11-21 01:46:25,918: validate_every: 5
2025-11-21 01:46:25,918: validate_n_random_basins: 1
2025-11-21 01:46:25,918: save_validation_results: True
2025-11-21 01:46:25,918: metrics: ['NSE', 'MSE']
2025-11-21 01:46:25,918: model: mtslstm
2025-11-21 01:46:25,918: shared_mtslstm: False
2025-11-21 01:46:25,919: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:46:25,919: use_frequencies: ['1H', '1D']
2025-11-21 01:46:25,919: head: regression
2025-11-21 01:46:25,919: output_activation: linear
2025-11-21 01:46:25,919: hidden_size: 256
2025-11-21 01:46:25,920: initial_forget_bias: 3
2025-11-21 01:46:25,920: output_dropout: 0.4
2025-11-21 01:46:25,920: optimizer: Adam
2025-11-21 01:46:25,920: loss: NSE
2025-11-21 01:46:25,920: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:46:25,921: batch_size: 64
2025-11-21 01:46:25,921: epochs: 2
2025-11-21 01:46:25,921: clip_gradient_norm: 1
2025-11-21 01:46:25,921: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:46:25,921: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:46:25,922: log_interval: 16
2025-11-21 01:46:25,922: log_tensorboard: True
2025-11-21 01:46:25,922: log_n_figures: 1
2025-11-21 01:46:25,922: save_weights_every: 2
2025-11-21 01:46:25,922: dataset: russian_river
2025-11-21 01:46:25,922: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:46:25,923: dev_mode: True
2025-11-21 01:46:25,923: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:46:25,923: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:46:25,923: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:46:25,923: num_layers: 1
2025-11-21 01:46:25,924: hourly: True
2025-11-21 01:46:25,924: is_mts: True
2025-11-21 01:46:25,924: is_mts_data: False
2025-11-21 01:46:25,924: verbose: True
2025-11-21 01:46:25,924: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/testing_run_2111_014625
2025-11-21 01:46:25,924: run_label: BASELINE
2025-11-21 01:46:25,925: run_stamp: 20251121T094051Z
2025-11-21 01:46:25,925: number_of_basins: 1
2025-11-21 01:46:25,925: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/testing_run_2111_014625/train_data
2025-11-21 01:46:25,925: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T094051Z/testing_run_2111_014557/testing_run_2111_014625/img_log
2025-11-21 01:46:25,926: seed: 160896
2025-11-21 01:46:25,926: commit_hash: 994040c
2025-11-21 01:46:25,926: package_version: 1.11.0
2025-11-21 01:46:25,932: ### Device cpu will be used for training
2025-11-21 01:46:25,933: Loading basin data into xarray data set.
2025-11-21 01:46:27,212: Calculating target variable stds per basin
2025-11-21 01:46:27,239: Create lookup table and convert to pytorch tensor
2025-11-21 01:46:27,355: No specific hidden size for frequencies are specified. Same hidden size is used for all.
