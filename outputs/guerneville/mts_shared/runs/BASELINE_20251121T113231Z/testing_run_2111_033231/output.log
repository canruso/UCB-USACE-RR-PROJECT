2025-11-21 03:32:31,105: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/output.log initialized.
2025-11-21 03:32:31,105: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231
2025-11-21 03:32:31,105: ### Run configurations for testing_run
2025-11-21 03:32:31,105: experiment_name: testing_run
2025-11-21 03:32:31,105: train_basin_file: guerneville
2025-11-21 03:32:31,106: validation_basin_file: guerneville
2025-11-21 03:32:31,106: test_basin_file: guerneville
2025-11-21 03:32:31,106: train_ranges: ['01/10/1994-30/09/1995', '01/10/1995-30/09/1996', '01/10/1996-30/09/1997', '01/10/1997-30/09/1998', '01/10/1998-30/09/1999', '01/10/1999-30/09/2000', '01/10/2000-30/09/2001', '01/10/2001-30/09/2002']
2025-11-21 03:32:31,106: validation_ranges: ['01/10/2002-30/09/2003', '01/10/2004-30/09/2005']
2025-11-21 03:32:31,106: test_ranges: ['01/10/2005-30/09/2006', '01/10/2006-30/09/2007', '01/10/2007-30/09/2008', '01/10/2008-30/09/2009']
2025-11-21 03:32:31,107: device: cpu
2025-11-21 03:32:31,107: physics_informed: False
2025-11-21 03:32:31,107: physics_data_file: None
2025-11-21 03:32:31,107: validate_every: 5
2025-11-21 03:32:31,107: validate_n_random_basins: 1
2025-11-21 03:32:31,107: save_validation_results: True
2025-11-21 03:32:31,108: metrics: ['NSE', 'MSE']
2025-11-21 03:32:31,108: model: mtslstm
2025-11-21 03:32:31,108: shared_mtslstm: False
2025-11-21 03:32:31,108: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 03:32:31,108: use_frequencies: ['1H', '1D']
2025-11-21 03:32:31,109: head: regression
2025-11-21 03:32:31,109: output_activation: linear
2025-11-21 03:32:31,109: hidden_size: 256
2025-11-21 03:32:31,109: initial_forget_bias: 3
2025-11-21 03:32:31,109: output_dropout: 0.4
2025-11-21 03:32:31,109: optimizer: Adam
2025-11-21 03:32:31,110: loss: NSE
2025-11-21 03:32:31,110: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 03:32:31,110: batch_size: 64
2025-11-21 03:32:31,110: epochs: 2
2025-11-21 03:32:31,110: clip_gradient_norm: 1
2025-11-21 03:32:31,111: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 03:32:31,111: seq_length: {'1D': 90, '1H': 168}
2025-11-21 03:32:31,111: log_interval: 16
2025-11-21 03:32:31,111: log_tensorboard: True
2025-11-21 03:32:31,111: log_n_figures: 1
2025-11-21 03:32:31,111: save_weights_every: 2
2025-11-21 03:32:31,112: dataset: synthetic_russian_river
2025-11-21 03:32:31,112: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 03:32:31,112: dev_mode: True
2025-11-21 03:32:31,112: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 03:32:31,112: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 03:32:31,113: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 03:32:31,113: train_start_date: 01/01/1900
2025-11-21 03:32:31,113: train_end_date: 01/01/1901
2025-11-21 03:32:31,113: validation_start_date: 01/01/1900
2025-11-21 03:32:31,114: validation_end_date: 01/01/1901
2025-11-21 03:32:31,114: test_start_date: 01/01/1900
2025-11-21 03:32:31,114: test_end_date: 01/01/1901
2025-11-21 03:32:31,114: num_layers: 1
2025-11-21 03:32:31,114: hourly: True
2025-11-21 03:32:31,115: is_mts: True
2025-11-21 03:32:31,115: is_mts_data: False
2025-11-21 03:32:31,115: verbose: True
2025-11-21 03:32:31,115: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231
2025-11-21 03:32:31,115: run_label: BASELINE
2025-11-21 03:32:31,116: run_stamp: 20251121T113231Z
2025-11-21 03:32:31,116: number_of_basins: 1
2025-11-21 03:32:31,116: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/train_data
2025-11-21 03:32:31,116: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/img_log
2025-11-21 03:32:31,120: ### Device cpu will be used for training
2025-11-21 03:32:31,124: Loading basin data into xarray data set.
2025-11-21 03:32:32,403: Calculating target variable stds per basin
2025-11-21 03:32:32,428: Create lookup table and convert to pytorch tensor
2025-11-21 03:32:33,206: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 03:32:42,104: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 03:32:50,824: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 03:32:50,873: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 03:32:50,882: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/model_epoch002.pt
2025-11-21 03:32:53,616: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/validation/model_epoch002/validation_metrics.csv
2025-11-21 03:32:53,618: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033231/validation/model_epoch002/validation_results.p
2025-11-21 03:32:54,028: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/output.log initialized.
2025-11-21 03:32:54,028: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254
2025-11-21 03:32:54,028: ### Run configurations for testing_run
2025-11-21 03:32:54,029: experiment_name: testing_run
2025-11-21 03:32:54,029: train_basin_file: guerneville
2025-11-21 03:32:54,029: validation_basin_file: guerneville
2025-11-21 03:32:54,030: test_basin_file: guerneville
2025-11-21 03:32:54,031: train_ranges: ['01/10/1994-30/09/1995', '01/10/1995-30/09/1996', '01/10/1996-30/09/1997', '01/10/1997-30/09/1998', '01/10/1998-30/09/1999', '01/10/1999-30/09/2000', '01/10/2000-30/09/2001', '01/10/2001-30/09/2002']
2025-11-21 03:32:54,031: validation_ranges: ['01/10/2002-30/09/2003', '01/10/2004-30/09/2005']
2025-11-21 03:32:54,031: test_ranges: ['01/10/2005-30/09/2006', '01/10/2006-30/09/2007', '01/10/2007-30/09/2008', '01/10/2008-30/09/2009']
2025-11-21 03:32:54,031: device: cpu
2025-11-21 03:32:54,031: physics_informed: True
2025-11-21 03:32:54,032: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 03:32:54,032: validate_every: 5
2025-11-21 03:32:54,033: validate_n_random_basins: 1
2025-11-21 03:32:54,033: save_validation_results: True
2025-11-21 03:32:54,033: metrics: ['NSE', 'MSE']
2025-11-21 03:32:54,033: model: mtslstm
2025-11-21 03:32:54,036: shared_mtslstm: False
2025-11-21 03:32:54,042: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 03:32:54,047: use_frequencies: ['1H', '1D']
2025-11-21 03:32:54,052: head: regression
2025-11-21 03:32:54,058: output_activation: linear
2025-11-21 03:32:54,064: hidden_size: 128
2025-11-21 03:32:54,080: initial_forget_bias: 3
2025-11-21 03:32:54,080: output_dropout: 0.4
2025-11-21 03:32:54,081: optimizer: Adam
2025-11-21 03:32:54,081: loss: NSE
2025-11-21 03:32:54,081: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 03:32:54,082: batch_size: 64
2025-11-21 03:32:54,082: epochs: 2
2025-11-21 03:32:54,082: clip_gradient_norm: 1
2025-11-21 03:32:54,082: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 03:32:54,083: seq_length: {'1D': 90, '1H': 168}
2025-11-21 03:32:54,083: log_interval: 16
2025-11-21 03:32:54,083: log_tensorboard: True
2025-11-21 03:32:54,083: log_n_figures: 1
2025-11-21 03:32:54,084: save_weights_every: 2
2025-11-21 03:32:54,084: dataset: synthetic_russian_river
2025-11-21 03:32:54,084: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 03:32:54,084: dev_mode: True
2025-11-21 03:32:54,084: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 03:32:54,085: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 03:32:54,085: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 03:32:54,085: train_start_date: 01/01/1900
2025-11-21 03:32:54,086: train_end_date: 01/01/1901
2025-11-21 03:32:54,086: validation_start_date: 01/01/1900
2025-11-21 03:32:54,086: validation_end_date: 01/01/1901
2025-11-21 03:32:54,086: test_start_date: 01/01/1900
2025-11-21 03:32:54,086: test_end_date: 01/01/1901
2025-11-21 03:32:54,087: num_layers: 1
2025-11-21 03:32:54,087: hourly: True
2025-11-21 03:32:54,087: is_mts: True
2025-11-21 03:32:54,087: is_mts_data: False
2025-11-21 03:32:54,087: verbose: True
2025-11-21 03:32:54,088: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254
2025-11-21 03:32:54,088: run_label: BASELINE
2025-11-21 03:32:54,091: run_stamp: 20251121T113231Z
2025-11-21 03:32:54,095: number_of_basins: 1
2025-11-21 03:32:54,096: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/train_data
2025-11-21 03:32:54,096: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/img_log
2025-11-21 03:32:54,101: ### Device cpu will be used for training
2025-11-21 03:32:54,104: Loading basin data into xarray data set.
2025-11-21 03:32:58,391: Calculating target variable stds per basin
2025-11-21 03:32:58,446: Create lookup table and convert to pytorch tensor
2025-11-21 03:32:58,660: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 03:33:03,392: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 03:33:07,965: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 03:33:07,979: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 03:33:07,992: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/model_epoch002.pt
2025-11-21 03:33:12,927: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/validation/model_epoch002/validation_metrics.csv
2025-11-21 03:33:12,928: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033254/validation/model_epoch002/validation_results.p
2025-11-21 03:33:20,178: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033320/output.log initialized.
2025-11-21 03:33:20,183: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033320
2025-11-21 03:33:20,195: ### Run configurations for testing_run
2025-11-21 03:33:20,195: experiment_name: testing_run
2025-11-21 03:33:20,196: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 03:33:20,196: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 03:33:20,203: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 03:33:20,206: train_ranges: ['01/10/1994-30/09/1995', '01/10/1995-30/09/1996', '01/10/1996-30/09/1997', '01/10/1997-30/09/1998', '01/10/1998-30/09/1999', '01/10/1999-30/09/2000', '01/10/2000-30/09/2001', '01/10/2001-30/09/2002']
2025-11-21 03:33:20,206: validation_ranges: ['01/10/2002-30/09/2003', '01/10/2004-30/09/2005']
2025-11-21 03:33:20,207: test_ranges: ['01/10/2005-30/09/2006', '01/10/2006-30/09/2007', '01/10/2007-30/09/2008', '01/10/2008-30/09/2009']
2025-11-21 03:33:20,207: device: cpu
2025-11-21 03:33:20,207: physics_informed: False
2025-11-21 03:33:20,208: physics_data_file: None
2025-11-21 03:33:20,208: validate_every: 5
2025-11-21 03:33:20,208: validate_n_random_basins: 1
2025-11-21 03:33:20,208: save_validation_results: True
2025-11-21 03:33:20,208: metrics: ['NSE', 'MSE']
2025-11-21 03:33:20,209: model: mtslstm
2025-11-21 03:33:20,209: shared_mtslstm: False
2025-11-21 03:33:20,209: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 03:33:20,209: use_frequencies: ['1H', '1D']
2025-11-21 03:33:20,209: head: regression
2025-11-21 03:33:20,210: output_activation: linear
2025-11-21 03:33:20,210: hidden_size: 256
2025-11-21 03:33:20,210: initial_forget_bias: 3
2025-11-21 03:33:20,211: output_dropout: 0.4
2025-11-21 03:33:20,211: optimizer: Adam
2025-11-21 03:33:20,211: loss: NSE
2025-11-21 03:33:20,211: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 03:33:20,211: batch_size: 64
2025-11-21 03:33:20,212: epochs: 2
2025-11-21 03:33:20,212: clip_gradient_norm: 1
2025-11-21 03:33:20,212: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 03:33:20,212: seq_length: {'1D': 90, '1H': 168}
2025-11-21 03:33:20,212: log_interval: 16
2025-11-21 03:33:20,212: log_tensorboard: True
2025-11-21 03:33:20,212: log_n_figures: 1
2025-11-21 03:33:20,213: save_weights_every: 2
2025-11-21 03:33:20,213: dataset: synthetic_russian_river
2025-11-21 03:33:20,214: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 03:33:20,215: dev_mode: True
2025-11-21 03:33:20,216: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 03:33:20,217: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 03:33:20,217: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 03:33:20,218: train_start_date: 01/01/1900
2025-11-21 03:33:20,221: train_end_date: 1901-01-01 00:00:00
2025-11-21 03:33:20,221: validation_start_date: 01/01/1900
2025-11-21 03:33:20,221: validation_end_date: 01/01/1901
2025-11-21 03:33:20,221: test_start_date: 01/01/1900
2025-11-21 03:33:20,221: test_end_date: 01/01/1901
2025-11-21 03:33:20,222: num_layers: 1
2025-11-21 03:33:20,222: hourly: True
2025-11-21 03:33:20,222: is_mts: True
2025-11-21 03:33:20,222: is_mts_data: False
2025-11-21 03:33:20,222: verbose: True
2025-11-21 03:33:20,223: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033320
2025-11-21 03:33:20,223: run_label: BASELINE
2025-11-21 03:33:20,223: run_stamp: 20251121T113231Z
2025-11-21 03:33:20,223: number_of_basins: 1
2025-11-21 03:33:20,223: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033320/train_data
2025-11-21 03:33:20,224: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T113231Z/testing_run_2111_033320/img_log
2025-11-21 03:33:20,226: ### Device cpu will be used for training
2025-11-21 03:33:20,229: Loading basin data into xarray data set.
2025-11-21 03:33:21,417: Calculating target variable stds per basin
2025-11-21 03:33:21,437: Create lookup table and convert to pytorch tensor
2025-11-21 03:33:21,524: No specific hidden size for frequencies are specified. Same hidden size is used for all.
