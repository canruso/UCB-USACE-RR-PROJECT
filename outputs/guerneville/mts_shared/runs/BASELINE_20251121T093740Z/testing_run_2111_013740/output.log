2025-11-21 01:37:40,909: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/output.log initialized.
2025-11-21 01:37:40,909: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740
2025-11-21 01:37:40,909: ### Run configurations for testing_run
2025-11-21 01:37:40,909: experiment_name: testing_run
2025-11-21 01:37:40,909: train_basin_file: guerneville
2025-11-21 01:37:40,910: validation_basin_file: guerneville
2025-11-21 01:37:40,910: test_basin_file: guerneville
2025-11-21 01:37:40,910: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:37:40,910: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:37:40,910: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:37:40,911: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:37:40,911: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:37:40,911: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:37:40,911: device: cpu
2025-11-21 01:37:40,911: physics_informed: False
2025-11-21 01:37:40,911: physics_data_file: None
2025-11-21 01:37:40,912: validate_every: 5
2025-11-21 01:37:40,912: validate_n_random_basins: 1
2025-11-21 01:37:40,912: save_validation_results: True
2025-11-21 01:37:40,912: metrics: ['NSE', 'MSE']
2025-11-21 01:37:40,912: model: mtslstm
2025-11-21 01:37:40,913: shared_mtslstm: False
2025-11-21 01:37:40,913: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:37:40,913: use_frequencies: ['1H', '1D']
2025-11-21 01:37:40,913: head: regression
2025-11-21 01:37:40,913: output_activation: linear
2025-11-21 01:37:40,914: hidden_size: 256
2025-11-21 01:37:40,914: initial_forget_bias: 3
2025-11-21 01:37:40,914: output_dropout: 0.4
2025-11-21 01:37:40,914: optimizer: Adam
2025-11-21 01:37:40,914: loss: NSE
2025-11-21 01:37:40,915: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:37:40,915: batch_size: 64
2025-11-21 01:37:40,915: epochs: 2
2025-11-21 01:37:40,915: clip_gradient_norm: 1
2025-11-21 01:37:40,915: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:37:40,915: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:37:40,916: log_interval: 16
2025-11-21 01:37:40,916: log_tensorboard: True
2025-11-21 01:37:40,916: log_n_figures: 1
2025-11-21 01:37:40,916: save_weights_every: 2
2025-11-21 01:37:40,916: dataset: russian_river
2025-11-21 01:37:40,917: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:37:40,917: dev_mode: True
2025-11-21 01:37:40,917: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:37:40,917: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:37:40,917: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:37:40,917: num_layers: 1
2025-11-21 01:37:40,918: hourly: True
2025-11-21 01:37:40,918: is_mts: True
2025-11-21 01:37:40,918: is_mts_data: False
2025-11-21 01:37:40,918: verbose: True
2025-11-21 01:37:40,918: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740
2025-11-21 01:37:40,918: run_label: BASELINE
2025-11-21 01:37:40,919: run_stamp: 20251121T093740Z
2025-11-21 01:37:40,919: number_of_basins: 1
2025-11-21 01:37:40,919: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/train_data
2025-11-21 01:37:40,919: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/img_log
2025-11-21 01:37:40,923: ### Device cpu will be used for training
2025-11-21 01:37:40,923: Loading basin data into xarray data set.
2025-11-21 01:37:42,214: Calculating target variable stds per basin
2025-11-21 01:37:42,237: Create lookup table and convert to pytorch tensor
2025-11-21 01:37:43,022: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:37:51,870: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:00,343: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:00,377: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:38:00,386: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/model_epoch002.pt
2025-11-21 01:38:03,218: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:38:03,219: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013740/validation/model_epoch002/validation_results.p
2025-11-21 01:38:03,620: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/output.log initialized.
2025-11-21 01:38:03,621: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803
2025-11-21 01:38:03,621: ### Run configurations for testing_run
2025-11-21 01:38:03,621: experiment_name: testing_run
2025-11-21 01:38:03,621: train_basin_file: guerneville
2025-11-21 01:38:03,622: validation_basin_file: guerneville
2025-11-21 01:38:03,622: test_basin_file: guerneville
2025-11-21 01:38:03,622: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:38:03,622: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:38:03,622: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:38:03,623: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:38:03,623: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:38:03,623: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:38:03,623: device: cpu
2025-11-21 01:38:03,623: physics_informed: True
2025-11-21 01:38:03,624: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:38:03,624: validate_every: 5
2025-11-21 01:38:03,624: validate_n_random_basins: 1
2025-11-21 01:38:03,624: save_validation_results: True
2025-11-21 01:38:03,624: metrics: ['NSE', 'MSE']
2025-11-21 01:38:03,624: model: mtslstm
2025-11-21 01:38:03,625: shared_mtslstm: False
2025-11-21 01:38:03,625: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:38:03,625: use_frequencies: ['1H', '1D']
2025-11-21 01:38:03,625: head: regression
2025-11-21 01:38:03,625: output_activation: linear
2025-11-21 01:38:03,626: hidden_size: 128
2025-11-21 01:38:03,626: initial_forget_bias: 3
2025-11-21 01:38:03,626: output_dropout: 0.4
2025-11-21 01:38:03,626: optimizer: Adam
2025-11-21 01:38:03,626: loss: NSE
2025-11-21 01:38:03,627: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:38:03,627: batch_size: 64
2025-11-21 01:38:03,627: epochs: 2
2025-11-21 01:38:03,627: clip_gradient_norm: 1
2025-11-21 01:38:03,627: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:38:03,628: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:38:03,628: log_interval: 16
2025-11-21 01:38:03,628: log_tensorboard: True
2025-11-21 01:38:03,628: log_n_figures: 1
2025-11-21 01:38:03,628: save_weights_every: 2
2025-11-21 01:38:03,629: dataset: russian_river
2025-11-21 01:38:03,629: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:38:03,629: dev_mode: True
2025-11-21 01:38:03,629: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:38:03,629: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:38:03,630: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:38:03,630: num_layers: 1
2025-11-21 01:38:03,630: hourly: True
2025-11-21 01:38:03,630: is_mts: True
2025-11-21 01:38:03,630: is_mts_data: False
2025-11-21 01:38:03,630: verbose: True
2025-11-21 01:38:03,631: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803
2025-11-21 01:38:03,631: run_label: BASELINE
2025-11-21 01:38:03,631: run_stamp: 20251121T093740Z
2025-11-21 01:38:03,631: number_of_basins: 1
2025-11-21 01:38:03,631: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/train_data
2025-11-21 01:38:03,631: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/img_log
2025-11-21 01:38:03,635: ### Device cpu will be used for training
2025-11-21 01:38:03,635: Loading basin data into xarray data set.
2025-11-21 01:38:07,958: Calculating target variable stds per basin
2025-11-21 01:38:08,012: Create lookup table and convert to pytorch tensor
2025-11-21 01:38:08,213: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:38:12,900: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:17,738: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:17,752: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:38:17,766: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/model_epoch002.pt
2025-11-21 01:38:22,663: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:38:22,664: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013803/validation/model_epoch002/validation_results.p
2025-11-21 01:38:29,835: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/output.log initialized.
2025-11-21 01:38:29,835: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829
2025-11-21 01:38:29,836: ### Run configurations for testing_run
2025-11-21 01:38:29,836: experiment_name: testing_run
2025-11-21 01:38:29,836: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:29,836: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:29,837: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:29,837: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:38:29,837: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:38:29,837: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:38:29,838: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:38:29,841: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:38:29,844: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:38:29,867: device: cpu
2025-11-21 01:38:29,867: physics_informed: False
2025-11-21 01:38:29,868: physics_data_file: None
2025-11-21 01:38:29,868: validate_every: 5
2025-11-21 01:38:29,868: validate_n_random_basins: 1
2025-11-21 01:38:29,868: save_validation_results: True
2025-11-21 01:38:29,869: metrics: ['NSE', 'MSE']
2025-11-21 01:38:29,869: model: mtslstm
2025-11-21 01:38:29,869: shared_mtslstm: False
2025-11-21 01:38:29,869: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:38:29,870: use_frequencies: ['1H', '1D']
2025-11-21 01:38:29,870: head: regression
2025-11-21 01:38:29,870: output_activation: linear
2025-11-21 01:38:29,870: hidden_size: 256
2025-11-21 01:38:29,870: initial_forget_bias: 3
2025-11-21 01:38:29,871: output_dropout: 0.4
2025-11-21 01:38:29,872: optimizer: Adam
2025-11-21 01:38:29,872: loss: NSE
2025-11-21 01:38:29,872: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:38:29,872: batch_size: 64
2025-11-21 01:38:29,872: epochs: 2
2025-11-21 01:38:29,873: clip_gradient_norm: 1
2025-11-21 01:38:29,873: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:38:29,874: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:38:29,874: log_interval: 16
2025-11-21 01:38:29,874: log_tensorboard: True
2025-11-21 01:38:29,874: log_n_figures: 1
2025-11-21 01:38:29,875: save_weights_every: 2
2025-11-21 01:38:29,875: dataset: russian_river
2025-11-21 01:38:29,876: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:38:29,876: dev_mode: True
2025-11-21 01:38:29,878: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:38:29,882: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:38:29,884: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:38:29,885: num_layers: 1
2025-11-21 01:38:29,885: hourly: True
2025-11-21 01:38:29,886: is_mts: True
2025-11-21 01:38:29,886: is_mts_data: False
2025-11-21 01:38:29,887: verbose: True
2025-11-21 01:38:29,887: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829
2025-11-21 01:38:29,887: run_label: BASELINE
2025-11-21 01:38:29,887: run_stamp: 20251121T093740Z
2025-11-21 01:38:29,888: number_of_basins: 1
2025-11-21 01:38:29,888: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/train_data
2025-11-21 01:38:29,888: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/img_log
2025-11-21 01:38:29,894: ### Device cpu will be used for training
2025-11-21 01:38:29,894: Loading basin data into xarray data set.
2025-11-21 01:38:31,124: Calculating target variable stds per basin
2025-11-21 01:38:31,153: Create lookup table and convert to pytorch tensor
2025-11-21 01:38:31,267: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:38:44,562: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:56,674: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:38:56,697: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/output.log initialized.
2025-11-21 01:38:56,698: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856
2025-11-21 01:38:56,698: ### Run configurations for testing_run
2025-11-21 01:38:56,698: experiment_name: testing_run
2025-11-21 01:38:56,699: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:56,699: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:56,699: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:38:56,699: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:38:56,700: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:38:56,700: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:38:56,700: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:38:56,700: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:38:56,700: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:38:56,701: device: cpu
2025-11-21 01:38:56,701: physics_informed: False
2025-11-21 01:38:56,701: physics_data_file: None
2025-11-21 01:38:56,701: validate_every: 5
2025-11-21 01:38:56,701: validate_n_random_basins: 1
2025-11-21 01:38:56,702: save_validation_results: True
2025-11-21 01:38:56,702: metrics: ['NSE', 'MSE']
2025-11-21 01:38:56,702: model: mtslstm
2025-11-21 01:38:56,702: shared_mtslstm: False
2025-11-21 01:38:56,702: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:38:56,703: use_frequencies: ['1H', '1D']
2025-11-21 01:38:56,703: head: regression
2025-11-21 01:38:56,703: output_activation: linear
2025-11-21 01:38:56,703: hidden_size: 256
2025-11-21 01:38:56,704: initial_forget_bias: 3
2025-11-21 01:38:56,704: output_dropout: 0.4
2025-11-21 01:38:56,704: optimizer: Adam
2025-11-21 01:38:56,704: loss: NSE
2025-11-21 01:38:56,704: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:38:56,704: batch_size: 64
2025-11-21 01:38:56,705: epochs: 2
2025-11-21 01:38:56,705: clip_gradient_norm: 1
2025-11-21 01:38:56,705: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:38:56,705: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:38:56,705: log_interval: 16
2025-11-21 01:38:56,706: log_tensorboard: True
2025-11-21 01:38:56,706: log_n_figures: 1
2025-11-21 01:38:56,706: save_weights_every: 2
2025-11-21 01:38:56,706: dataset: russian_river
2025-11-21 01:38:56,706: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:38:56,707: dev_mode: True
2025-11-21 01:38:56,707: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:38:56,707: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:38:56,707: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:38:56,707: num_layers: 1
2025-11-21 01:38:56,707: hourly: True
2025-11-21 01:38:56,708: is_mts: True
2025-11-21 01:38:56,708: is_mts_data: False
2025-11-21 01:38:56,708: verbose: True
2025-11-21 01:38:56,708: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856
2025-11-21 01:38:56,708: run_label: BASELINE
2025-11-21 01:38:56,708: run_stamp: 20251121T093740Z
2025-11-21 01:38:56,709: number_of_basins: 1
2025-11-21 01:38:56,709: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/train_data
2025-11-21 01:38:56,709: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/img_log
2025-11-21 01:38:56,709: seed: 513613
2025-11-21 01:38:56,709: commit_hash: 994040c
2025-11-21 01:38:56,710: package_version: 1.11.0
2025-11-21 01:38:56,713: ### Device cpu will be used for training
2025-11-21 01:38:56,714: Loading basin data into xarray data set.
2025-11-21 01:38:57,940: Calculating target variable stds per basin
2025-11-21 01:38:57,966: Create lookup table and convert to pytorch tensor
2025-11-21 01:38:58,083: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:39:09,553: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:39:23,630: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:39:23,659: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/output.log initialized.
2025-11-21 01:39:23,659: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923
2025-11-21 01:39:23,660: ### Run configurations for testing_run
2025-11-21 01:39:23,660: experiment_name: testing_run
2025-11-21 01:39:23,660: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:23,660: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:23,661: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:23,661: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:39:23,661: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:39:23,661: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:39:23,661: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:39:23,662: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:39:23,662: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:39:23,662: device: cpu
2025-11-21 01:39:23,662: physics_informed: False
2025-11-21 01:39:23,663: physics_data_file: None
2025-11-21 01:39:23,663: validate_every: 5
2025-11-21 01:39:23,663: validate_n_random_basins: 1
2025-11-21 01:39:23,663: save_validation_results: True
2025-11-21 01:39:23,663: metrics: ['NSE', 'MSE']
2025-11-21 01:39:23,664: model: mtslstm
2025-11-21 01:39:23,664: shared_mtslstm: False
2025-11-21 01:39:23,664: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:39:23,664: use_frequencies: ['1H', '1D']
2025-11-21 01:39:23,664: head: regression
2025-11-21 01:39:23,664: output_activation: linear
2025-11-21 01:39:23,665: hidden_size: 256
2025-11-21 01:39:23,665: initial_forget_bias: 3
2025-11-21 01:39:23,665: output_dropout: 0.4
2025-11-21 01:39:23,665: optimizer: Adam
2025-11-21 01:39:23,665: loss: NSE
2025-11-21 01:39:23,666: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:39:23,666: batch_size: 64
2025-11-21 01:39:23,666: epochs: 2
2025-11-21 01:39:23,666: clip_gradient_norm: 1
2025-11-21 01:39:23,666: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:39:23,666: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:39:23,667: log_interval: 16
2025-11-21 01:39:23,667: log_tensorboard: True
2025-11-21 01:39:23,667: log_n_figures: 1
2025-11-21 01:39:23,667: save_weights_every: 2
2025-11-21 01:39:23,667: dataset: russian_river
2025-11-21 01:39:23,668: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:39:23,668: dev_mode: True
2025-11-21 01:39:23,668: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:39:23,669: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:39:23,669: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:39:23,669: num_layers: 1
2025-11-21 01:39:23,669: hourly: True
2025-11-21 01:39:23,669: is_mts: True
2025-11-21 01:39:23,670: is_mts_data: False
2025-11-21 01:39:23,670: verbose: True
2025-11-21 01:39:23,670: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923
2025-11-21 01:39:23,670: run_label: BASELINE
2025-11-21 01:39:23,670: run_stamp: 20251121T093740Z
2025-11-21 01:39:23,671: number_of_basins: 1
2025-11-21 01:39:23,671: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/train_data
2025-11-21 01:39:23,671: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/img_log
2025-11-21 01:39:23,671: seed: 513613
2025-11-21 01:39:23,671: commit_hash: 994040c
2025-11-21 01:39:23,672: package_version: 1.11.0
2025-11-21 01:39:23,674: ### Device cpu will be used for training
2025-11-21 01:39:23,674: Loading basin data into xarray data set.
2025-11-21 01:39:25,165: Calculating target variable stds per basin
2025-11-21 01:39:25,196: Create lookup table and convert to pytorch tensor
2025-11-21 01:39:25,329: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:39:38,497: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:39:50,243: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:39:50,263: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/testing_run_2111_013950/output.log initialized.
2025-11-21 01:39:50,264: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/testing_run_2111_013950
2025-11-21 01:39:50,264: ### Run configurations for testing_run
2025-11-21 01:39:50,264: experiment_name: testing_run
2025-11-21 01:39:50,264: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:50,264: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:50,265: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:39:50,265: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:39:50,265: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:39:50,265: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:39:50,266: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:39:50,266: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:39:50,266: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:39:50,267: device: cpu
2025-11-21 01:39:50,267: physics_informed: False
2025-11-21 01:39:50,267: physics_data_file: None
2025-11-21 01:39:50,267: validate_every: 5
2025-11-21 01:39:50,268: validate_n_random_basins: 1
2025-11-21 01:39:50,268: save_validation_results: True
2025-11-21 01:39:50,268: metrics: ['NSE', 'MSE']
2025-11-21 01:39:50,268: model: mtslstm
2025-11-21 01:39:50,268: shared_mtslstm: False
2025-11-21 01:39:50,269: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:39:50,269: use_frequencies: ['1H', '1D']
2025-11-21 01:39:50,270: head: regression
2025-11-21 01:39:50,270: output_activation: linear
2025-11-21 01:39:50,270: hidden_size: 256
2025-11-21 01:39:50,270: initial_forget_bias: 3
2025-11-21 01:39:50,270: output_dropout: 0.4
2025-11-21 01:39:50,270: optimizer: Adam
2025-11-21 01:39:50,271: loss: NSE
2025-11-21 01:39:50,271: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:39:50,271: batch_size: 64
2025-11-21 01:39:50,271: epochs: 2
2025-11-21 01:39:50,271: clip_gradient_norm: 1
2025-11-21 01:39:50,272: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:39:50,272: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:39:50,272: log_interval: 16
2025-11-21 01:39:50,272: log_tensorboard: True
2025-11-21 01:39:50,272: log_n_figures: 1
2025-11-21 01:39:50,272: save_weights_every: 2
2025-11-21 01:39:50,273: dataset: russian_river
2025-11-21 01:39:50,273: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:39:50,273: dev_mode: True
2025-11-21 01:39:50,273: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:39:50,273: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:39:50,274: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:39:50,274: num_layers: 1
2025-11-21 01:39:50,274: hourly: True
2025-11-21 01:39:50,274: is_mts: True
2025-11-21 01:39:50,274: is_mts_data: False
2025-11-21 01:39:50,274: verbose: True
2025-11-21 01:39:50,275: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/testing_run_2111_013950
2025-11-21 01:39:50,275: run_label: BASELINE
2025-11-21 01:39:50,275: run_stamp: 20251121T093740Z
2025-11-21 01:39:50,275: number_of_basins: 1
2025-11-21 01:39:50,275: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/testing_run_2111_013950/train_data
2025-11-21 01:39:50,275: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093740Z/testing_run_2111_013829/testing_run_2111_013856/testing_run_2111_013923/testing_run_2111_013950/img_log
2025-11-21 01:39:50,276: seed: 513613
2025-11-21 01:39:50,276: commit_hash: 994040c
2025-11-21 01:39:50,276: package_version: 1.11.0
2025-11-21 01:39:50,278: ### Device cpu will be used for training
2025-11-21 01:39:50,279: Loading basin data into xarray data set.
2025-11-21 01:39:51,560: Calculating target variable stds per basin
2025-11-21 01:39:51,594: Create lookup table and convert to pytorch tensor
2025-11-21 01:39:51,714: No specific hidden size for frequencies are specified. Same hidden size is used for all.
