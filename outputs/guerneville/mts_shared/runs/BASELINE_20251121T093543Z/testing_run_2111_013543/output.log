2025-11-21 01:35:43,857: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/output.log initialized.
2025-11-21 01:35:43,857: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543
2025-11-21 01:35:43,858: ### Run configurations for testing_run
2025-11-21 01:35:43,858: experiment_name: testing_run
2025-11-21 01:35:43,858: train_basin_file: guerneville
2025-11-21 01:35:43,858: validation_basin_file: guerneville
2025-11-21 01:35:43,859: test_basin_file: guerneville
2025-11-21 01:35:43,859: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:35:43,859: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:35:43,859: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:35:43,860: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:35:43,860: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:35:43,860: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:35:43,860: device: cpu
2025-11-21 01:35:43,860: physics_informed: False
2025-11-21 01:35:43,861: physics_data_file: None
2025-11-21 01:35:43,861: validate_every: 5
2025-11-21 01:35:43,861: validate_n_random_basins: 1
2025-11-21 01:35:43,861: save_validation_results: True
2025-11-21 01:35:43,862: metrics: ['NSE', 'MSE']
2025-11-21 01:35:43,862: model: mtslstm
2025-11-21 01:35:43,863: shared_mtslstm: False
2025-11-21 01:35:43,864: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:35:43,864: use_frequencies: ['1H', '1D']
2025-11-21 01:35:43,865: head: regression
2025-11-21 01:35:43,865: output_activation: linear
2025-11-21 01:35:43,866: hidden_size: 256
2025-11-21 01:35:43,867: initial_forget_bias: 3
2025-11-21 01:35:43,867: output_dropout: 0.4
2025-11-21 01:35:43,868: optimizer: Adam
2025-11-21 01:35:43,868: loss: NSE
2025-11-21 01:35:43,869: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:35:43,869: batch_size: 64
2025-11-21 01:35:43,870: epochs: 2
2025-11-21 01:35:43,870: clip_gradient_norm: 1
2025-11-21 01:35:43,870: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:35:43,870: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:35:43,871: log_interval: 16
2025-11-21 01:35:43,871: log_tensorboard: True
2025-11-21 01:35:43,871: log_n_figures: 1
2025-11-21 01:35:43,871: save_weights_every: 2
2025-11-21 01:35:43,871: dataset: russian_river
2025-11-21 01:35:43,871: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:35:43,872: dev_mode: True
2025-11-21 01:35:43,872: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:35:43,872: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:35:43,872: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:35:43,872: num_layers: 1
2025-11-21 01:35:43,873: hourly: True
2025-11-21 01:35:43,873: is_mts: True
2025-11-21 01:35:43,873: is_mts_data: False
2025-11-21 01:35:43,873: verbose: True
2025-11-21 01:35:43,874: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543
2025-11-21 01:35:43,874: run_label: BASELINE
2025-11-21 01:35:43,874: run_stamp: 20251121T093543Z
2025-11-21 01:35:43,874: number_of_basins: 1
2025-11-21 01:35:43,874: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/train_data
2025-11-21 01:35:43,874: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/img_log
2025-11-21 01:35:43,884: ### Device cpu will be used for training
2025-11-21 01:35:43,885: Loading basin data into xarray data set.
2025-11-21 01:35:45,330: Calculating target variable stds per basin
2025-11-21 01:35:45,361: Create lookup table and convert to pytorch tensor
2025-11-21 01:35:46,329: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:35:55,773: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:36:04,203: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:36:04,240: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:36:04,248: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/model_epoch002.pt
2025-11-21 01:36:07,378: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:36:07,380: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013543/validation/model_epoch002/validation_results.p
2025-11-21 01:36:08,000: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/output.log initialized.
2025-11-21 01:36:08,000: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607
2025-11-21 01:36:08,000: ### Run configurations for testing_run
2025-11-21 01:36:08,000: experiment_name: testing_run
2025-11-21 01:36:08,000: train_basin_file: guerneville
2025-11-21 01:36:08,001: validation_basin_file: guerneville
2025-11-21 01:36:08,001: test_basin_file: guerneville
2025-11-21 01:36:08,001: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:36:08,001: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:36:08,001: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:36:08,002: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:36:08,002: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:36:08,002: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:36:08,002: device: cpu
2025-11-21 01:36:08,002: physics_informed: True
2025-11-21 01:36:08,003: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:36:08,003: validate_every: 5
2025-11-21 01:36:08,003: validate_n_random_basins: 1
2025-11-21 01:36:08,003: save_validation_results: True
2025-11-21 01:36:08,003: metrics: ['NSE', 'MSE']
2025-11-21 01:36:08,003: model: mtslstm
2025-11-21 01:36:08,004: shared_mtslstm: False
2025-11-21 01:36:08,004: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:36:08,004: use_frequencies: ['1H', '1D']
2025-11-21 01:36:08,004: head: regression
2025-11-21 01:36:08,004: output_activation: linear
2025-11-21 01:36:08,005: hidden_size: 128
2025-11-21 01:36:08,005: initial_forget_bias: 3
2025-11-21 01:36:08,005: output_dropout: 0.4
2025-11-21 01:36:08,005: optimizer: Adam
2025-11-21 01:36:08,006: loss: NSE
2025-11-21 01:36:08,006: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:36:08,007: batch_size: 64
2025-11-21 01:36:08,007: epochs: 2
2025-11-21 01:36:08,007: clip_gradient_norm: 1
2025-11-21 01:36:08,008: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:36:08,009: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:36:08,009: log_interval: 16
2025-11-21 01:36:08,010: log_tensorboard: True
2025-11-21 01:36:08,010: log_n_figures: 1
2025-11-21 01:36:08,010: save_weights_every: 2
2025-11-21 01:36:08,010: dataset: russian_river
2025-11-21 01:36:08,010: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:36:08,011: dev_mode: True
2025-11-21 01:36:08,011: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:36:08,011: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:36:08,011: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:36:08,011: num_layers: 1
2025-11-21 01:36:08,012: hourly: True
2025-11-21 01:36:08,012: is_mts: True
2025-11-21 01:36:08,012: is_mts_data: False
2025-11-21 01:36:08,012: verbose: True
2025-11-21 01:36:08,013: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607
2025-11-21 01:36:08,013: run_label: BASELINE
2025-11-21 01:36:08,013: run_stamp: 20251121T093543Z
2025-11-21 01:36:08,013: number_of_basins: 1
2025-11-21 01:36:08,013: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/train_data
2025-11-21 01:36:08,014: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/img_log
2025-11-21 01:36:08,018: ### Device cpu will be used for training
2025-11-21 01:36:08,018: Loading basin data into xarray data set.
2025-11-21 01:36:12,281: Calculating target variable stds per basin
2025-11-21 01:36:12,345: Create lookup table and convert to pytorch tensor
2025-11-21 01:36:12,567: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:36:17,464: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:36:22,016: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:36:22,032: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:36:22,047: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/model_epoch002.pt
2025-11-21 01:36:27,366: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:36:27,368: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013607/validation/model_epoch002/validation_results.p
2025-11-21 01:36:34,674: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/output.log initialized.
2025-11-21 01:36:34,675: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634
2025-11-21 01:36:34,675: ### Run configurations for testing_run
2025-11-21 01:36:34,675: experiment_name: testing_run
2025-11-21 01:36:34,675: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:36:34,675: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:36:34,676: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:36:34,676: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:36:34,676: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:36:34,676: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:36:34,676: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:36:34,677: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:36:34,677: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:36:34,677: device: cpu
2025-11-21 01:36:34,677: physics_informed: False
2025-11-21 01:36:34,677: physics_data_file: None
2025-11-21 01:36:34,677: validate_every: 5
2025-11-21 01:36:34,678: validate_n_random_basins: 1
2025-11-21 01:36:34,678: save_validation_results: True
2025-11-21 01:36:34,678: metrics: ['NSE', 'MSE']
2025-11-21 01:36:34,678: model: mtslstm
2025-11-21 01:36:34,678: shared_mtslstm: False
2025-11-21 01:36:34,678: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:36:34,679: use_frequencies: ['1H', '1D']
2025-11-21 01:36:34,679: head: regression
2025-11-21 01:36:34,679: output_activation: linear
2025-11-21 01:36:34,679: hidden_size: 256
2025-11-21 01:36:34,679: initial_forget_bias: 3
2025-11-21 01:36:34,679: output_dropout: 0.4
2025-11-21 01:36:34,680: optimizer: Adam
2025-11-21 01:36:34,680: loss: NSE
2025-11-21 01:36:34,680: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:36:34,680: batch_size: 64
2025-11-21 01:36:34,680: epochs: 2
2025-11-21 01:36:34,681: clip_gradient_norm: 1
2025-11-21 01:36:34,681: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:36:34,681: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:36:34,681: log_interval: 16
2025-11-21 01:36:34,681: log_tensorboard: True
2025-11-21 01:36:34,681: log_n_figures: 1
2025-11-21 01:36:34,682: save_weights_every: 2
2025-11-21 01:36:34,682: dataset: russian_river
2025-11-21 01:36:34,682: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:36:34,682: dev_mode: True
2025-11-21 01:36:34,682: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:36:34,683: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:36:34,683: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:36:34,683: num_layers: 1
2025-11-21 01:36:34,683: hourly: True
2025-11-21 01:36:34,683: is_mts: True
2025-11-21 01:36:34,683: is_mts_data: False
2025-11-21 01:36:34,684: verbose: True
2025-11-21 01:36:34,684: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634
2025-11-21 01:36:34,684: run_label: BASELINE
2025-11-21 01:36:34,684: run_stamp: 20251121T093543Z
2025-11-21 01:36:34,684: number_of_basins: 1
2025-11-21 01:36:34,685: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/train_data
2025-11-21 01:36:34,685: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/img_log
2025-11-21 01:36:34,687: ### Device cpu will be used for training
2025-11-21 01:36:34,688: Loading basin data into xarray data set.
2025-11-21 01:36:35,962: Calculating target variable stds per basin
2025-11-21 01:36:35,989: Create lookup table and convert to pytorch tensor
2025-11-21 01:36:36,110: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:36:49,337: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:37:02,129: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:37:02,151: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/testing_run_2111_013702/output.log initialized.
2025-11-21 01:37:02,151: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/testing_run_2111_013702
2025-11-21 01:37:02,152: ### Run configurations for testing_run
2025-11-21 01:37:02,152: experiment_name: testing_run
2025-11-21 01:37:02,152: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:37:02,152: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:37:02,152: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:37:02,153: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:37:02,153: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:37:02,153: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:37:02,153: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:37:02,153: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:37:02,154: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:37:02,154: device: cpu
2025-11-21 01:37:02,154: physics_informed: False
2025-11-21 01:37:02,154: physics_data_file: None
2025-11-21 01:37:02,154: validate_every: 5
2025-11-21 01:37:02,154: validate_n_random_basins: 1
2025-11-21 01:37:02,155: save_validation_results: True
2025-11-21 01:37:02,155: metrics: ['NSE', 'MSE']
2025-11-21 01:37:02,155: model: mtslstm
2025-11-21 01:37:02,155: shared_mtslstm: False
2025-11-21 01:37:02,155: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:37:02,156: use_frequencies: ['1H', '1D']
2025-11-21 01:37:02,156: head: regression
2025-11-21 01:37:02,156: output_activation: linear
2025-11-21 01:37:02,156: hidden_size: 256
2025-11-21 01:37:02,156: initial_forget_bias: 3
2025-11-21 01:37:02,156: output_dropout: 0.4
2025-11-21 01:37:02,157: optimizer: Adam
2025-11-21 01:37:02,157: loss: NSE
2025-11-21 01:37:02,157: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:37:02,157: batch_size: 64
2025-11-21 01:37:02,157: epochs: 2
2025-11-21 01:37:02,158: clip_gradient_norm: 1
2025-11-21 01:37:02,158: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:37:02,158: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:37:02,158: log_interval: 16
2025-11-21 01:37:02,158: log_tensorboard: True
2025-11-21 01:37:02,159: log_n_figures: 1
2025-11-21 01:37:02,159: save_weights_every: 2
2025-11-21 01:37:02,159: dataset: russian_river
2025-11-21 01:37:02,159: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:37:02,159: dev_mode: True
2025-11-21 01:37:02,159: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:37:02,160: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:37:02,160: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:37:02,160: num_layers: 1
2025-11-21 01:37:02,160: hourly: True
2025-11-21 01:37:02,160: is_mts: True
2025-11-21 01:37:02,161: is_mts_data: False
2025-11-21 01:37:02,161: verbose: True
2025-11-21 01:37:02,161: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/testing_run_2111_013702
2025-11-21 01:37:02,161: run_label: BASELINE
2025-11-21 01:37:02,161: run_stamp: 20251121T093543Z
2025-11-21 01:37:02,161: number_of_basins: 1
2025-11-21 01:37:02,162: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/testing_run_2111_013702/train_data
2025-11-21 01:37:02,162: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T093543Z/testing_run_2111_013634/testing_run_2111_013702/img_log
2025-11-21 01:37:02,162: seed: 160832
2025-11-21 01:37:02,162: commit_hash: 994040c
2025-11-21 01:37:02,162: package_version: 1.11.0
2025-11-21 01:37:02,164: ### Device cpu will be used for training
2025-11-21 01:37:02,165: Loading basin data into xarray data set.
2025-11-21 01:37:03,523: Calculating target variable stds per basin
2025-11-21 01:37:03,553: Create lookup table and convert to pytorch tensor
2025-11-21 01:37:03,678: No specific hidden size for frequencies are specified. Same hidden size is used for all.
