2025-11-21 01:07:42,727: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/output.log initialized.
2025-11-21 01:07:42,728: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742
2025-11-21 01:07:42,728: ### Run configurations for testing_run
2025-11-21 01:07:42,728: experiment_name: testing_run
2025-11-21 01:07:42,728: train_basin_file: guerneville
2025-11-21 01:07:42,728: validation_basin_file: guerneville
2025-11-21 01:07:42,729: test_basin_file: guerneville
2025-11-21 01:07:42,729: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:07:42,729: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:07:42,729: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:07:42,729: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:07:42,729: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:07:42,730: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:07:42,730: device: cpu
2025-11-21 01:07:42,730: physics_informed: False
2025-11-21 01:07:42,730: physics_data_file: None
2025-11-21 01:07:42,730: validate_every: 5
2025-11-21 01:07:42,731: validate_n_random_basins: 1
2025-11-21 01:07:42,731: save_validation_results: True
2025-11-21 01:07:42,731: metrics: ['NSE', 'MSE']
2025-11-21 01:07:42,731: model: mtslstm
2025-11-21 01:07:42,731: shared_mtslstm: False
2025-11-21 01:07:42,732: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:07:42,732: use_frequencies: ['1H', '1D']
2025-11-21 01:07:42,732: head: regression
2025-11-21 01:07:42,732: output_activation: linear
2025-11-21 01:07:42,732: hidden_size: 256
2025-11-21 01:07:42,732: initial_forget_bias: 3
2025-11-21 01:07:42,733: output_dropout: 0.4
2025-11-21 01:07:42,733: optimizer: Adam
2025-11-21 01:07:42,733: loss: NSE
2025-11-21 01:07:42,733: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:07:42,733: batch_size: 64
2025-11-21 01:07:42,733: epochs: 2
2025-11-21 01:07:42,734: clip_gradient_norm: 1
2025-11-21 01:07:42,734: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:07:42,734: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:07:42,734: log_interval: 16
2025-11-21 01:07:42,734: log_tensorboard: True
2025-11-21 01:07:42,735: log_n_figures: 1
2025-11-21 01:07:42,735: save_weights_every: 2
2025-11-21 01:07:42,735: dataset: russian_river
2025-11-21 01:07:42,735: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:07:42,735: dev_mode: True
2025-11-21 01:07:42,736: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:07:42,736: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:07:42,736: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:07:42,737: num_layers: 1
2025-11-21 01:07:42,737: hourly: True
2025-11-21 01:07:42,737: is_mts: True
2025-11-21 01:07:42,737: is_mts_data: False
2025-11-21 01:07:42,737: verbose: True
2025-11-21 01:07:42,738: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742
2025-11-21 01:07:42,738: run_label: BASELINE
2025-11-21 01:07:42,738: run_stamp: 20251121T090742Z
2025-11-21 01:07:42,738: number_of_basins: 1
2025-11-21 01:07:42,738: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/train_data
2025-11-21 01:07:42,739: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/img_log
2025-11-21 01:07:42,744: ### Device cpu will be used for training
2025-11-21 01:07:42,744: Loading basin data into xarray data set.
2025-11-21 01:07:43,936: Calculating target variable stds per basin
2025-11-21 01:07:43,968: Create lookup table and convert to pytorch tensor
2025-11-21 01:07:44,902: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:07:53,744: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:02,868: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:02,907: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:08:02,916: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/model_epoch002.pt
2025-11-21 01:08:05,676: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:08:05,677: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010742/validation/model_epoch002/validation_results.p
2025-11-21 01:08:06,071: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/output.log initialized.
2025-11-21 01:08:06,072: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806
2025-11-21 01:08:06,072: ### Run configurations for testing_run
2025-11-21 01:08:06,072: experiment_name: testing_run
2025-11-21 01:08:06,072: train_basin_file: guerneville
2025-11-21 01:08:06,073: validation_basin_file: guerneville
2025-11-21 01:08:06,073: test_basin_file: guerneville
2025-11-21 01:08:06,073: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:08:06,073: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:08:06,073: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:08:06,074: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:08:06,074: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:08:06,074: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:08:06,074: device: cpu
2025-11-21 01:08:06,074: physics_informed: True
2025-11-21 01:08:06,075: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:08:06,075: validate_every: 5
2025-11-21 01:08:06,075: validate_n_random_basins: 1
2025-11-21 01:08:06,075: save_validation_results: True
2025-11-21 01:08:06,075: metrics: ['NSE', 'MSE']
2025-11-21 01:08:06,076: model: mtslstm
2025-11-21 01:08:06,076: shared_mtslstm: False
2025-11-21 01:08:06,076: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:08:06,076: use_frequencies: ['1H', '1D']
2025-11-21 01:08:06,076: head: regression
2025-11-21 01:08:06,076: output_activation: linear
2025-11-21 01:08:06,077: hidden_size: 128
2025-11-21 01:08:06,077: initial_forget_bias: 3
2025-11-21 01:08:06,077: output_dropout: 0.4
2025-11-21 01:08:06,077: optimizer: Adam
2025-11-21 01:08:06,077: loss: NSE
2025-11-21 01:08:06,077: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:08:06,078: batch_size: 64
2025-11-21 01:08:06,078: epochs: 2
2025-11-21 01:08:06,078: clip_gradient_norm: 1
2025-11-21 01:08:06,078: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:08:06,078: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:08:06,079: log_interval: 16
2025-11-21 01:08:06,079: log_tensorboard: True
2025-11-21 01:08:06,079: log_n_figures: 1
2025-11-21 01:08:06,079: save_weights_every: 2
2025-11-21 01:08:06,079: dataset: russian_river
2025-11-21 01:08:06,079: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:08:06,080: dev_mode: True
2025-11-21 01:08:06,080: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:08:06,080: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:08:06,080: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:08:06,080: num_layers: 1
2025-11-21 01:08:06,080: hourly: True
2025-11-21 01:08:06,081: is_mts: True
2025-11-21 01:08:06,081: is_mts_data: False
2025-11-21 01:08:06,081: verbose: True
2025-11-21 01:08:06,081: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806
2025-11-21 01:08:06,081: run_label: BASELINE
2025-11-21 01:08:06,081: run_stamp: 20251121T090742Z
2025-11-21 01:08:06,082: number_of_basins: 1
2025-11-21 01:08:06,082: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/train_data
2025-11-21 01:08:06,082: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/img_log
2025-11-21 01:08:06,086: ### Device cpu will be used for training
2025-11-21 01:08:06,086: Loading basin data into xarray data set.
2025-11-21 01:08:10,385: Calculating target variable stds per basin
2025-11-21 01:08:10,441: Create lookup table and convert to pytorch tensor
2025-11-21 01:08:10,649: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:08:15,443: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:20,025: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:20,038: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:08:20,052: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/model_epoch002.pt
2025-11-21 01:08:24,758: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:08:24,762: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010806/validation/model_epoch002/validation_results.p
2025-11-21 01:08:31,785: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/output.log initialized.
2025-11-21 01:08:31,785: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831
2025-11-21 01:08:31,785: ### Run configurations for testing_run
2025-11-21 01:08:31,786: experiment_name: testing_run
2025-11-21 01:08:31,786: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:31,786: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:31,786: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:31,786: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:08:31,787: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:08:31,787: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:08:31,787: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:08:31,787: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:08:31,787: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:08:31,787: device: cpu
2025-11-21 01:08:31,788: physics_informed: False
2025-11-21 01:08:31,788: physics_data_file: None
2025-11-21 01:08:31,788: validate_every: 5
2025-11-21 01:08:31,788: validate_n_random_basins: 1
2025-11-21 01:08:31,788: save_validation_results: True
2025-11-21 01:08:31,788: metrics: ['NSE', 'MSE']
2025-11-21 01:08:31,789: model: mtslstm
2025-11-21 01:08:31,789: shared_mtslstm: False
2025-11-21 01:08:31,789: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:08:31,789: use_frequencies: ['1H', '1D']
2025-11-21 01:08:31,789: head: regression
2025-11-21 01:08:31,789: output_activation: linear
2025-11-21 01:08:31,790: hidden_size: 256
2025-11-21 01:08:31,790: initial_forget_bias: 3
2025-11-21 01:08:31,790: output_dropout: 0.4
2025-11-21 01:08:31,790: optimizer: Adam
2025-11-21 01:08:31,790: loss: NSE
2025-11-21 01:08:31,791: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:08:31,791: batch_size: 64
2025-11-21 01:08:31,791: epochs: 2
2025-11-21 01:08:31,791: clip_gradient_norm: 1
2025-11-21 01:08:31,791: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:08:31,791: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:08:31,792: log_interval: 16
2025-11-21 01:08:31,792: log_tensorboard: True
2025-11-21 01:08:31,792: log_n_figures: 1
2025-11-21 01:08:31,792: save_weights_every: 2
2025-11-21 01:08:31,792: dataset: russian_river
2025-11-21 01:08:31,792: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:08:31,793: dev_mode: True
2025-11-21 01:08:31,793: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:08:31,793: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:08:31,793: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:08:31,793: num_layers: 1
2025-11-21 01:08:31,794: hourly: True
2025-11-21 01:08:31,794: is_mts: True
2025-11-21 01:08:31,794: is_mts_data: False
2025-11-21 01:08:31,794: verbose: True
2025-11-21 01:08:31,794: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831
2025-11-21 01:08:31,794: run_label: BASELINE
2025-11-21 01:08:31,795: run_stamp: 20251121T090742Z
2025-11-21 01:08:31,795: number_of_basins: 1
2025-11-21 01:08:31,795: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/train_data
2025-11-21 01:08:31,795: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/img_log
2025-11-21 01:08:31,797: ### Device cpu will be used for training
2025-11-21 01:08:31,798: Loading basin data into xarray data set.
2025-11-21 01:08:32,986: Calculating target variable stds per basin
2025-11-21 01:08:33,011: Create lookup table and convert to pytorch tensor
2025-11-21 01:08:33,119: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:08:44,938: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:59,234: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:08:59,376: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/output.log initialized.
2025-11-21 01:08:59,378: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859
2025-11-21 01:08:59,378: ### Run configurations for testing_run
2025-11-21 01:08:59,378: experiment_name: testing_run
2025-11-21 01:08:59,378: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:59,378: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:59,379: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:08:59,380: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:08:59,380: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:08:59,380: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:08:59,381: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:08:59,381: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:08:59,381: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:08:59,382: device: cpu
2025-11-21 01:08:59,382: physics_informed: False
2025-11-21 01:08:59,382: physics_data_file: None
2025-11-21 01:08:59,382: validate_every: 5
2025-11-21 01:08:59,382: validate_n_random_basins: 1
2025-11-21 01:08:59,382: save_validation_results: True
2025-11-21 01:08:59,383: metrics: ['NSE', 'MSE']
2025-11-21 01:08:59,383: model: mtslstm
2025-11-21 01:08:59,383: shared_mtslstm: False
2025-11-21 01:08:59,383: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:08:59,383: use_frequencies: ['1H', '1D']
2025-11-21 01:08:59,384: head: regression
2025-11-21 01:08:59,384: output_activation: linear
2025-11-21 01:08:59,384: hidden_size: 256
2025-11-21 01:08:59,384: initial_forget_bias: 3
2025-11-21 01:08:59,384: output_dropout: 0.4
2025-11-21 01:08:59,384: optimizer: Adam
2025-11-21 01:08:59,385: loss: NSE
2025-11-21 01:08:59,385: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:08:59,385: batch_size: 64
2025-11-21 01:08:59,385: epochs: 2
2025-11-21 01:08:59,385: clip_gradient_norm: 1
2025-11-21 01:08:59,385: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:08:59,386: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:08:59,386: log_interval: 16
2025-11-21 01:08:59,386: log_tensorboard: True
2025-11-21 01:08:59,386: log_n_figures: 1
2025-11-21 01:08:59,386: save_weights_every: 2
2025-11-21 01:08:59,387: dataset: russian_river
2025-11-21 01:08:59,387: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:08:59,387: dev_mode: True
2025-11-21 01:08:59,388: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:08:59,389: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:08:59,389: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:08:59,389: num_layers: 1
2025-11-21 01:08:59,389: hourly: True
2025-11-21 01:08:59,390: is_mts: True
2025-11-21 01:08:59,390: is_mts_data: False
2025-11-21 01:08:59,390: verbose: True
2025-11-21 01:08:59,390: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859
2025-11-21 01:08:59,391: run_label: BASELINE
2025-11-21 01:08:59,391: run_stamp: 20251121T090742Z
2025-11-21 01:08:59,391: number_of_basins: 1
2025-11-21 01:08:59,391: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/train_data
2025-11-21 01:08:59,391: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/img_log
2025-11-21 01:08:59,392: seed: 212974
2025-11-21 01:08:59,392: commit_hash: 994040c
2025-11-21 01:08:59,392: package_version: 1.11.0
2025-11-21 01:08:59,406: ### Device cpu will be used for training
2025-11-21 01:08:59,408: Loading basin data into xarray data set.
2025-11-21 01:09:00,748: Calculating target variable stds per basin
2025-11-21 01:09:00,775: Create lookup table and convert to pytorch tensor
2025-11-21 01:09:00,894: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:09:13,882: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:09:26,220: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:09:26,242: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/output.log initialized.
2025-11-21 01:09:26,242: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926
2025-11-21 01:09:26,242: ### Run configurations for testing_run
2025-11-21 01:09:26,243: experiment_name: testing_run
2025-11-21 01:09:26,243: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:26,243: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:26,243: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:26,243: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:09:26,244: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:09:26,244: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:09:26,245: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:09:26,245: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:09:26,245: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:09:26,245: device: cpu
2025-11-21 01:09:26,245: physics_informed: False
2025-11-21 01:09:26,246: physics_data_file: None
2025-11-21 01:09:26,246: validate_every: 5
2025-11-21 01:09:26,246: validate_n_random_basins: 1
2025-11-21 01:09:26,246: save_validation_results: True
2025-11-21 01:09:26,246: metrics: ['NSE', 'MSE']
2025-11-21 01:09:26,246: model: mtslstm
2025-11-21 01:09:26,247: shared_mtslstm: False
2025-11-21 01:09:26,247: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:09:26,247: use_frequencies: ['1H', '1D']
2025-11-21 01:09:26,247: head: regression
2025-11-21 01:09:26,247: output_activation: linear
2025-11-21 01:09:26,248: hidden_size: 256
2025-11-21 01:09:26,248: initial_forget_bias: 3
2025-11-21 01:09:26,248: output_dropout: 0.4
2025-11-21 01:09:26,248: optimizer: Adam
2025-11-21 01:09:26,248: loss: NSE
2025-11-21 01:09:26,249: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:09:26,249: batch_size: 64
2025-11-21 01:09:26,249: epochs: 2
2025-11-21 01:09:26,249: clip_gradient_norm: 1
2025-11-21 01:09:26,249: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:09:26,249: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:09:26,250: log_interval: 16
2025-11-21 01:09:26,250: log_tensorboard: True
2025-11-21 01:09:26,250: log_n_figures: 1
2025-11-21 01:09:26,250: save_weights_every: 2
2025-11-21 01:09:26,250: dataset: russian_river
2025-11-21 01:09:26,250: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:09:26,251: dev_mode: True
2025-11-21 01:09:26,251: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:09:26,251: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:09:26,251: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:09:26,251: num_layers: 1
2025-11-21 01:09:26,252: hourly: True
2025-11-21 01:09:26,252: is_mts: True
2025-11-21 01:09:26,252: is_mts_data: False
2025-11-21 01:09:26,252: verbose: True
2025-11-21 01:09:26,252: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926
2025-11-21 01:09:26,252: run_label: BASELINE
2025-11-21 01:09:26,253: run_stamp: 20251121T090742Z
2025-11-21 01:09:26,253: number_of_basins: 1
2025-11-21 01:09:26,253: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/train_data
2025-11-21 01:09:26,253: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/img_log
2025-11-21 01:09:26,254: seed: 212974
2025-11-21 01:09:26,254: commit_hash: 994040c
2025-11-21 01:09:26,254: package_version: 1.11.0
2025-11-21 01:09:26,256: ### Device cpu will be used for training
2025-11-21 01:09:26,256: Loading basin data into xarray data set.
2025-11-21 01:09:27,527: Calculating target variable stds per basin
2025-11-21 01:09:27,557: Create lookup table and convert to pytorch tensor
2025-11-21 01:09:27,692: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:09:40,083: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:09:52,033: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:09:52,056: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/output.log initialized.
2025-11-21 01:09:52,056: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952
2025-11-21 01:09:52,056: ### Run configurations for testing_run
2025-11-21 01:09:52,056: experiment_name: testing_run
2025-11-21 01:09:52,057: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:52,057: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:52,057: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:09:52,058: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:09:52,058: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:09:52,058: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:09:52,058: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:09:52,058: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:09:52,059: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:09:52,059: device: cpu
2025-11-21 01:09:52,059: physics_informed: False
2025-11-21 01:09:52,059: physics_data_file: None
2025-11-21 01:09:52,059: validate_every: 5
2025-11-21 01:09:52,060: validate_n_random_basins: 1
2025-11-21 01:09:52,060: save_validation_results: True
2025-11-21 01:09:52,060: metrics: ['NSE', 'MSE']
2025-11-21 01:09:52,060: model: mtslstm
2025-11-21 01:09:52,060: shared_mtslstm: False
2025-11-21 01:09:52,061: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:09:52,061: use_frequencies: ['1H', '1D']
2025-11-21 01:09:52,061: head: regression
2025-11-21 01:09:52,061: output_activation: linear
2025-11-21 01:09:52,061: hidden_size: 256
2025-11-21 01:09:52,061: initial_forget_bias: 3
2025-11-21 01:09:52,062: output_dropout: 0.4
2025-11-21 01:09:52,062: optimizer: Adam
2025-11-21 01:09:52,062: loss: NSE
2025-11-21 01:09:52,062: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:09:52,063: batch_size: 64
2025-11-21 01:09:52,063: epochs: 2
2025-11-21 01:09:52,063: clip_gradient_norm: 1
2025-11-21 01:09:52,063: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:09:52,063: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:09:52,063: log_interval: 16
2025-11-21 01:09:52,064: log_tensorboard: True
2025-11-21 01:09:52,064: log_n_figures: 1
2025-11-21 01:09:52,064: save_weights_every: 2
2025-11-21 01:09:52,064: dataset: russian_river
2025-11-21 01:09:52,064: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:09:52,064: dev_mode: True
2025-11-21 01:09:52,065: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:09:52,065: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:09:52,065: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:09:52,065: num_layers: 1
2025-11-21 01:09:52,065: hourly: True
2025-11-21 01:09:52,066: is_mts: True
2025-11-21 01:09:52,066: is_mts_data: False
2025-11-21 01:09:52,066: verbose: True
2025-11-21 01:09:52,066: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952
2025-11-21 01:09:52,066: run_label: BASELINE
2025-11-21 01:09:52,066: run_stamp: 20251121T090742Z
2025-11-21 01:09:52,067: number_of_basins: 1
2025-11-21 01:09:52,067: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/train_data
2025-11-21 01:09:52,067: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/img_log
2025-11-21 01:09:52,067: seed: 212974
2025-11-21 01:09:52,067: commit_hash: 994040c
2025-11-21 01:09:52,067: package_version: 1.11.0
2025-11-21 01:09:52,069: ### Device cpu will be used for training
2025-11-21 01:09:52,070: Loading basin data into xarray data set.
2025-11-21 01:09:53,338: Calculating target variable stds per basin
2025-11-21 01:09:53,366: Create lookup table and convert to pytorch tensor
2025-11-21 01:09:53,477: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:10:05,719: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:10:17,755: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:10:17,775: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/testing_run_2111_011017/output.log initialized.
2025-11-21 01:10:17,775: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/testing_run_2111_011017
2025-11-21 01:10:17,786: ### Run configurations for testing_run
2025-11-21 01:10:17,795: experiment_name: testing_run
2025-11-21 01:10:17,800: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:10:17,800: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:10:17,801: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:10:17,801: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:10:17,801: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:10:17,801: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:10:17,802: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:10:17,802: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:10:17,802: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:10:17,802: device: cpu
2025-11-21 01:10:17,803: physics_informed: False
2025-11-21 01:10:17,803: physics_data_file: None
2025-11-21 01:10:17,803: validate_every: 5
2025-11-21 01:10:17,803: validate_n_random_basins: 1
2025-11-21 01:10:17,804: save_validation_results: True
2025-11-21 01:10:17,804: metrics: ['NSE', 'MSE']
2025-11-21 01:10:17,804: model: mtslstm
2025-11-21 01:10:17,804: shared_mtslstm: False
2025-11-21 01:10:17,804: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:10:17,804: use_frequencies: ['1H', '1D']
2025-11-21 01:10:17,805: head: regression
2025-11-21 01:10:17,806: output_activation: linear
2025-11-21 01:10:17,807: hidden_size: 256
2025-11-21 01:10:17,807: initial_forget_bias: 3
2025-11-21 01:10:17,808: output_dropout: 0.4
2025-11-21 01:10:17,809: optimizer: Adam
2025-11-21 01:10:17,810: loss: NSE
2025-11-21 01:10:17,812: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:10:17,812: batch_size: 64
2025-11-21 01:10:17,812: epochs: 2
2025-11-21 01:10:17,812: clip_gradient_norm: 1
2025-11-21 01:10:17,813: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:10:17,813: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:10:17,813: log_interval: 16
2025-11-21 01:10:17,813: log_tensorboard: True
2025-11-21 01:10:17,813: log_n_figures: 1
2025-11-21 01:10:17,814: save_weights_every: 2
2025-11-21 01:10:17,814: dataset: russian_river
2025-11-21 01:10:17,814: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:10:17,814: dev_mode: True
2025-11-21 01:10:17,814: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:10:17,814: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:10:17,815: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:10:17,815: num_layers: 1
2025-11-21 01:10:17,815: hourly: True
2025-11-21 01:10:17,815: is_mts: True
2025-11-21 01:10:17,815: is_mts_data: False
2025-11-21 01:10:17,815: verbose: True
2025-11-21 01:10:17,816: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/testing_run_2111_011017
2025-11-21 01:10:17,816: run_label: BASELINE
2025-11-21 01:10:17,816: run_stamp: 20251121T090742Z
2025-11-21 01:10:17,816: number_of_basins: 1
2025-11-21 01:10:17,816: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/testing_run_2111_011017/train_data
2025-11-21 01:10:17,817: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T090742Z/testing_run_2111_010831/testing_run_2111_010859/testing_run_2111_010926/testing_run_2111_010952/testing_run_2111_011017/img_log
2025-11-21 01:10:17,817: seed: 212974
2025-11-21 01:10:17,817: commit_hash: 994040c
2025-11-21 01:10:17,817: package_version: 1.11.0
2025-11-21 01:10:17,818: ### Device cpu will be used for training
2025-11-21 01:10:17,819: Loading basin data into xarray data set.
2025-11-21 01:10:19,067: Calculating target variable stds per basin
2025-11-21 01:10:19,096: Create lookup table and convert to pytorch tensor
2025-11-21 01:10:19,227: No specific hidden size for frequencies are specified. Same hidden size is used for all.
