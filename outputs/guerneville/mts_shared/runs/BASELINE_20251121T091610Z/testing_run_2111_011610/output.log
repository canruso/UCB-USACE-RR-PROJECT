2025-11-21 01:16:10,331: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/output.log initialized.
2025-11-21 01:16:10,332: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610
2025-11-21 01:16:10,332: ### Run configurations for testing_run
2025-11-21 01:16:10,332: experiment_name: testing_run
2025-11-21 01:16:10,332: train_basin_file: guerneville
2025-11-21 01:16:10,333: validation_basin_file: guerneville
2025-11-21 01:16:10,333: test_basin_file: guerneville
2025-11-21 01:16:10,333: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:16:10,333: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:16:10,333: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:16:10,334: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:16:10,334: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:16:10,334: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:16:10,334: device: cpu
2025-11-21 01:16:10,334: physics_informed: False
2025-11-21 01:16:10,335: physics_data_file: None
2025-11-21 01:16:10,335: validate_every: 5
2025-11-21 01:16:10,335: validate_n_random_basins: 1
2025-11-21 01:16:10,335: save_validation_results: True
2025-11-21 01:16:10,335: metrics: ['NSE', 'MSE']
2025-11-21 01:16:10,336: model: mtslstm
2025-11-21 01:16:10,336: shared_mtslstm: False
2025-11-21 01:16:10,336: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:16:10,336: use_frequencies: ['1H', '1D']
2025-11-21 01:16:10,336: head: regression
2025-11-21 01:16:10,336: output_activation: linear
2025-11-21 01:16:10,337: hidden_size: 256
2025-11-21 01:16:10,337: initial_forget_bias: 3
2025-11-21 01:16:10,337: output_dropout: 0.4
2025-11-21 01:16:10,337: optimizer: Adam
2025-11-21 01:16:10,337: loss: NSE
2025-11-21 01:16:10,338: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:16:10,338: batch_size: 64
2025-11-21 01:16:10,338: epochs: 2
2025-11-21 01:16:10,338: clip_gradient_norm: 1
2025-11-21 01:16:10,338: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:16:10,338: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:16:10,339: log_interval: 16
2025-11-21 01:16:10,339: log_tensorboard: True
2025-11-21 01:16:10,339: log_n_figures: 1
2025-11-21 01:16:10,339: save_weights_every: 2
2025-11-21 01:16:10,339: dataset: russian_river
2025-11-21 01:16:10,339: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:16:10,340: dev_mode: True
2025-11-21 01:16:10,340: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:16:10,340: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:16:10,340: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:16:10,340: num_layers: 1
2025-11-21 01:16:10,341: hourly: True
2025-11-21 01:16:10,341: is_mts: True
2025-11-21 01:16:10,341: is_mts_data: False
2025-11-21 01:16:10,341: verbose: True
2025-11-21 01:16:10,341: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610
2025-11-21 01:16:10,341: run_label: BASELINE
2025-11-21 01:16:10,342: run_stamp: 20251121T091610Z
2025-11-21 01:16:10,342: number_of_basins: 1
2025-11-21 01:16:10,342: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/train_data
2025-11-21 01:16:10,342: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/img_log
2025-11-21 01:16:10,346: ### Device cpu will be used for training
2025-11-21 01:16:10,346: Loading basin data into xarray data set.
2025-11-21 01:16:11,605: Calculating target variable stds per basin
2025-11-21 01:16:11,628: Create lookup table and convert to pytorch tensor
2025-11-21 01:16:12,391: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:16:21,228: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:16:29,247: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:16:29,273: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:16:29,281: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/model_epoch002.pt
2025-11-21 01:16:31,857: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:16:31,858: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011610/validation/model_epoch002/validation_results.p
2025-11-21 01:16:32,263: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/output.log initialized.
2025-11-21 01:16:32,263: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632
2025-11-21 01:16:32,263: ### Run configurations for testing_run
2025-11-21 01:16:32,264: experiment_name: testing_run
2025-11-21 01:16:32,264: train_basin_file: guerneville
2025-11-21 01:16:32,264: validation_basin_file: guerneville
2025-11-21 01:16:32,264: test_basin_file: guerneville
2025-11-21 01:16:32,264: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:16:32,265: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:16:32,265: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:16:32,265: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:16:32,265: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:16:32,265: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:16:32,266: device: cpu
2025-11-21 01:16:32,266: physics_informed: True
2025-11-21 01:16:32,266: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:16:32,266: validate_every: 5
2025-11-21 01:16:32,267: validate_n_random_basins: 1
2025-11-21 01:16:32,267: save_validation_results: True
2025-11-21 01:16:32,267: metrics: ['NSE', 'MSE']
2025-11-21 01:16:32,267: model: mtslstm
2025-11-21 01:16:32,267: shared_mtslstm: False
2025-11-21 01:16:32,267: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:16:32,268: use_frequencies: ['1H', '1D']
2025-11-21 01:16:32,268: head: regression
2025-11-21 01:16:32,268: output_activation: linear
2025-11-21 01:16:32,268: hidden_size: 128
2025-11-21 01:16:32,269: initial_forget_bias: 3
2025-11-21 01:16:32,269: output_dropout: 0.4
2025-11-21 01:16:32,269: optimizer: Adam
2025-11-21 01:16:32,269: loss: NSE
2025-11-21 01:16:32,269: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:16:32,270: batch_size: 64
2025-11-21 01:16:32,270: epochs: 2
2025-11-21 01:16:32,270: clip_gradient_norm: 1
2025-11-21 01:16:32,270: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:16:32,270: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:16:32,271: log_interval: 16
2025-11-21 01:16:32,271: log_tensorboard: True
2025-11-21 01:16:32,271: log_n_figures: 1
2025-11-21 01:16:32,271: save_weights_every: 2
2025-11-21 01:16:32,271: dataset: russian_river
2025-11-21 01:16:32,271: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:16:32,271: dev_mode: True
2025-11-21 01:16:32,272: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:16:32,272: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:16:32,272: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:16:32,272: num_layers: 1
2025-11-21 01:16:32,272: hourly: True
2025-11-21 01:16:32,273: is_mts: True
2025-11-21 01:16:32,273: is_mts_data: False
2025-11-21 01:16:32,273: verbose: True
2025-11-21 01:16:32,273: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632
2025-11-21 01:16:32,273: run_label: BASELINE
2025-11-21 01:16:32,274: run_stamp: 20251121T091610Z
2025-11-21 01:16:32,274: number_of_basins: 1
2025-11-21 01:16:32,274: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/train_data
2025-11-21 01:16:32,274: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/img_log
2025-11-21 01:16:32,277: ### Device cpu will be used for training
2025-11-21 01:16:32,278: Loading basin data into xarray data set.
2025-11-21 01:16:36,776: Calculating target variable stds per basin
2025-11-21 01:16:36,831: Create lookup table and convert to pytorch tensor
2025-11-21 01:16:37,042: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:16:41,925: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:16:46,561: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:16:46,572: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:16:46,587: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/model_epoch002.pt
2025-11-21 01:16:52,011: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:16:52,013: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011632/validation/model_epoch002/validation_results.p
2025-11-21 01:16:58,934: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/output.log initialized.
2025-11-21 01:16:58,935: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658
2025-11-21 01:16:58,936: ### Run configurations for testing_run
2025-11-21 01:16:58,936: experiment_name: testing_run
2025-11-21 01:16:58,937: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:16:58,937: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:16:58,937: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:16:58,938: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:16:58,939: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:16:58,939: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:16:58,940: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:16:58,940: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:16:58,941: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:16:58,941: device: cpu
2025-11-21 01:16:58,942: physics_informed: False
2025-11-21 01:16:58,942: physics_data_file: None
2025-11-21 01:16:58,943: validate_every: 5
2025-11-21 01:16:58,943: validate_n_random_basins: 1
2025-11-21 01:16:58,943: save_validation_results: True
2025-11-21 01:16:58,943: metrics: ['NSE', 'MSE']
2025-11-21 01:16:58,943: model: mtslstm
2025-11-21 01:16:58,944: shared_mtslstm: False
2025-11-21 01:16:58,944: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:16:58,944: use_frequencies: ['1H', '1D']
2025-11-21 01:16:58,944: head: regression
2025-11-21 01:16:58,944: output_activation: linear
2025-11-21 01:16:58,945: hidden_size: 256
2025-11-21 01:16:58,945: initial_forget_bias: 3
2025-11-21 01:16:58,945: output_dropout: 0.4
2025-11-21 01:16:58,945: optimizer: Adam
2025-11-21 01:16:58,945: loss: NSE
2025-11-21 01:16:58,946: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:16:58,946: batch_size: 64
2025-11-21 01:16:58,946: epochs: 2
2025-11-21 01:16:58,946: clip_gradient_norm: 1
2025-11-21 01:16:58,946: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:16:58,947: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:16:58,947: log_interval: 16
2025-11-21 01:16:58,947: log_tensorboard: True
2025-11-21 01:16:58,947: log_n_figures: 1
2025-11-21 01:16:58,947: save_weights_every: 2
2025-11-21 01:16:58,947: dataset: russian_river
2025-11-21 01:16:58,948: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:16:58,948: dev_mode: True
2025-11-21 01:16:58,948: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:16:58,948: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:16:58,949: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:16:58,949: num_layers: 1
2025-11-21 01:16:58,950: hourly: True
2025-11-21 01:16:58,950: is_mts: True
2025-11-21 01:16:58,951: is_mts_data: False
2025-11-21 01:16:58,951: verbose: True
2025-11-21 01:16:58,952: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658
2025-11-21 01:16:58,952: run_label: BASELINE
2025-11-21 01:16:58,953: run_stamp: 20251121T091610Z
2025-11-21 01:16:58,953: number_of_basins: 1
2025-11-21 01:16:58,953: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/train_data
2025-11-21 01:16:58,954: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/img_log
2025-11-21 01:16:58,957: ### Device cpu will be used for training
2025-11-21 01:16:58,957: Loading basin data into xarray data set.
2025-11-21 01:17:00,137: Calculating target variable stds per basin
2025-11-21 01:17:00,160: Create lookup table and convert to pytorch tensor
2025-11-21 01:17:00,269: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:17:11,815: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:17:24,086: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:17:24,108: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/output.log initialized.
2025-11-21 01:17:24,109: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724
2025-11-21 01:17:24,109: ### Run configurations for testing_run
2025-11-21 01:17:24,109: experiment_name: testing_run
2025-11-21 01:17:24,109: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:24,110: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:24,110: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:24,110: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:17:24,110: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:17:24,110: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:17:24,111: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:17:24,111: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:17:24,111: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:17:24,111: device: cpu
2025-11-21 01:17:24,112: physics_informed: False
2025-11-21 01:17:24,112: physics_data_file: None
2025-11-21 01:17:24,112: validate_every: 5
2025-11-21 01:17:24,112: validate_n_random_basins: 1
2025-11-21 01:17:24,112: save_validation_results: True
2025-11-21 01:17:24,113: metrics: ['NSE', 'MSE']
2025-11-21 01:17:24,113: model: mtslstm
2025-11-21 01:17:24,113: shared_mtslstm: False
2025-11-21 01:17:24,113: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:17:24,113: use_frequencies: ['1H', '1D']
2025-11-21 01:17:24,113: head: regression
2025-11-21 01:17:24,114: output_activation: linear
2025-11-21 01:17:24,114: hidden_size: 256
2025-11-21 01:17:24,114: initial_forget_bias: 3
2025-11-21 01:17:24,114: output_dropout: 0.4
2025-11-21 01:17:24,114: optimizer: Adam
2025-11-21 01:17:24,115: loss: NSE
2025-11-21 01:17:24,115: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:17:24,115: batch_size: 64
2025-11-21 01:17:24,115: epochs: 2
2025-11-21 01:17:24,115: clip_gradient_norm: 1
2025-11-21 01:17:24,115: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:17:24,116: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:17:24,116: log_interval: 16
2025-11-21 01:17:24,116: log_tensorboard: True
2025-11-21 01:17:24,116: log_n_figures: 1
2025-11-21 01:17:24,116: save_weights_every: 2
2025-11-21 01:17:24,117: dataset: russian_river
2025-11-21 01:17:24,117: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:17:24,117: dev_mode: True
2025-11-21 01:17:24,117: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:17:24,117: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:17:24,118: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:17:24,118: num_layers: 1
2025-11-21 01:17:24,118: hourly: True
2025-11-21 01:17:24,118: is_mts: True
2025-11-21 01:17:24,118: is_mts_data: False
2025-11-21 01:17:24,118: verbose: True
2025-11-21 01:17:24,119: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724
2025-11-21 01:17:24,119: run_label: BASELINE
2025-11-21 01:17:24,119: run_stamp: 20251121T091610Z
2025-11-21 01:17:24,119: number_of_basins: 1
2025-11-21 01:17:24,119: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/train_data
2025-11-21 01:17:24,119: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/img_log
2025-11-21 01:17:24,120: seed: 642033
2025-11-21 01:17:24,120: commit_hash: 994040c
2025-11-21 01:17:24,120: package_version: 1.11.0
2025-11-21 01:17:24,122: ### Device cpu will be used for training
2025-11-21 01:17:24,123: Loading basin data into xarray data set.
2025-11-21 01:17:25,453: Calculating target variable stds per basin
2025-11-21 01:17:25,481: Create lookup table and convert to pytorch tensor
2025-11-21 01:17:25,596: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:17:38,386: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:17:51,171: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:17:51,201: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/output.log initialized.
2025-11-21 01:17:51,201: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751
2025-11-21 01:17:51,201: ### Run configurations for testing_run
2025-11-21 01:17:51,202: experiment_name: testing_run
2025-11-21 01:17:51,202: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:51,202: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:51,202: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:17:51,203: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:17:51,203: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:17:51,203: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:17:51,203: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:17:51,204: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:17:51,204: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:17:51,204: device: cpu
2025-11-21 01:17:51,204: physics_informed: False
2025-11-21 01:17:51,204: physics_data_file: None
2025-11-21 01:17:51,205: validate_every: 5
2025-11-21 01:17:51,205: validate_n_random_basins: 1
2025-11-21 01:17:51,205: save_validation_results: True
2025-11-21 01:17:51,205: metrics: ['NSE', 'MSE']
2025-11-21 01:17:51,205: model: mtslstm
2025-11-21 01:17:51,206: shared_mtslstm: False
2025-11-21 01:17:51,206: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:17:51,206: use_frequencies: ['1H', '1D']
2025-11-21 01:17:51,206: head: regression
2025-11-21 01:17:51,206: output_activation: linear
2025-11-21 01:17:51,207: hidden_size: 256
2025-11-21 01:17:51,207: initial_forget_bias: 3
2025-11-21 01:17:51,207: output_dropout: 0.4
2025-11-21 01:17:51,208: optimizer: Adam
2025-11-21 01:17:51,208: loss: NSE
2025-11-21 01:17:51,208: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:17:51,208: batch_size: 64
2025-11-21 01:17:51,208: epochs: 2
2025-11-21 01:17:51,209: clip_gradient_norm: 1
2025-11-21 01:17:51,209: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:17:51,209: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:17:51,209: log_interval: 16
2025-11-21 01:17:51,209: log_tensorboard: True
2025-11-21 01:17:51,210: log_n_figures: 1
2025-11-21 01:17:51,210: save_weights_every: 2
2025-11-21 01:17:51,210: dataset: russian_river
2025-11-21 01:17:51,210: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:17:51,210: dev_mode: True
2025-11-21 01:17:51,211: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:17:51,211: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:17:51,211: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:17:51,211: num_layers: 1
2025-11-21 01:17:51,211: hourly: True
2025-11-21 01:17:51,211: is_mts: True
2025-11-21 01:17:51,212: is_mts_data: False
2025-11-21 01:17:51,212: verbose: True
2025-11-21 01:17:51,212: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751
2025-11-21 01:17:51,212: run_label: BASELINE
2025-11-21 01:17:51,212: run_stamp: 20251121T091610Z
2025-11-21 01:17:51,213: number_of_basins: 1
2025-11-21 01:17:51,213: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/train_data
2025-11-21 01:17:51,213: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/img_log
2025-11-21 01:17:51,213: seed: 642033
2025-11-21 01:17:51,213: commit_hash: 994040c
2025-11-21 01:17:51,213: package_version: 1.11.0
2025-11-21 01:17:51,216: ### Device cpu will be used for training
2025-11-21 01:17:51,217: Loading basin data into xarray data set.
2025-11-21 01:17:52,655: Calculating target variable stds per basin
2025-11-21 01:17:52,679: Create lookup table and convert to pytorch tensor
2025-11-21 01:17:52,794: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:18:04,947: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:18:17,273: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:18:17,301: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/testing_run_2111_011817/output.log initialized.
2025-11-21 01:18:17,301: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/testing_run_2111_011817
2025-11-21 01:18:17,301: ### Run configurations for testing_run
2025-11-21 01:18:17,302: experiment_name: testing_run
2025-11-21 01:18:17,302: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:18:17,302: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:18:17,302: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:18:17,303: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:18:17,303: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:18:17,303: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:18:17,304: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:18:17,304: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:18:17,304: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:18:17,304: device: cpu
2025-11-21 01:18:17,304: physics_informed: False
2025-11-21 01:18:17,305: physics_data_file: None
2025-11-21 01:18:17,305: validate_every: 5
2025-11-21 01:18:17,305: validate_n_random_basins: 1
2025-11-21 01:18:17,305: save_validation_results: True
2025-11-21 01:18:17,305: metrics: ['NSE', 'MSE']
2025-11-21 01:18:17,306: model: mtslstm
2025-11-21 01:18:17,306: shared_mtslstm: False
2025-11-21 01:18:17,306: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:18:17,306: use_frequencies: ['1H', '1D']
2025-11-21 01:18:17,306: head: regression
2025-11-21 01:18:17,307: output_activation: linear
2025-11-21 01:18:17,307: hidden_size: 256
2025-11-21 01:18:17,307: initial_forget_bias: 3
2025-11-21 01:18:17,307: output_dropout: 0.4
2025-11-21 01:18:17,307: optimizer: Adam
2025-11-21 01:18:17,307: loss: NSE
2025-11-21 01:18:17,308: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:18:17,308: batch_size: 64
2025-11-21 01:18:17,308: epochs: 2
2025-11-21 01:18:17,308: clip_gradient_norm: 1
2025-11-21 01:18:17,308: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:18:17,308: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:18:17,309: log_interval: 16
2025-11-21 01:18:17,309: log_tensorboard: True
2025-11-21 01:18:17,309: log_n_figures: 1
2025-11-21 01:18:17,309: save_weights_every: 2
2025-11-21 01:18:17,309: dataset: russian_river
2025-11-21 01:18:17,309: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:18:17,310: dev_mode: True
2025-11-21 01:18:17,310: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:18:17,310: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:18:17,310: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:18:17,310: num_layers: 1
2025-11-21 01:18:17,311: hourly: True
2025-11-21 01:18:17,311: is_mts: True
2025-11-21 01:18:17,311: is_mts_data: False
2025-11-21 01:18:17,311: verbose: True
2025-11-21 01:18:17,311: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/testing_run_2111_011817
2025-11-21 01:18:17,312: run_label: BASELINE
2025-11-21 01:18:17,312: run_stamp: 20251121T091610Z
2025-11-21 01:18:17,312: number_of_basins: 1
2025-11-21 01:18:17,312: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/testing_run_2111_011817/train_data
2025-11-21 01:18:17,312: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_shared/runs/BASELINE_20251121T091610Z/testing_run_2111_011658/testing_run_2111_011724/testing_run_2111_011751/testing_run_2111_011817/img_log
2025-11-21 01:18:17,312: seed: 642033
2025-11-21 01:18:17,313: commit_hash: 994040c
2025-11-21 01:18:17,313: package_version: 1.11.0
2025-11-21 01:18:17,316: ### Device cpu will be used for training
2025-11-21 01:18:17,316: Loading basin data into xarray data set.
2025-11-21 01:18:18,610: Calculating target variable stds per basin
2025-11-21 01:18:18,651: Create lookup table and convert to pytorch tensor
2025-11-21 01:18:18,777: No specific hidden size for frequencies are specified. Same hidden size is used for all.
