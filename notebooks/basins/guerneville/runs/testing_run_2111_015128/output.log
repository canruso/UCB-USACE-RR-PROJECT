2025-11-21 01:51:28,554: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/output.log initialized.
2025-11-21 01:51:28,555: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128
2025-11-21 01:51:28,556: ### Run configurations for testing_run
2025-11-21 01:51:28,557: experiment_name: testing_run
2025-11-21 01:51:28,558: train_basin_file: guerneville
2025-11-21 01:51:28,558: validation_basin_file: guerneville
2025-11-21 01:51:28,559: test_basin_file: guerneville
2025-11-21 01:51:28,561: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:51:28,561: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:51:28,562: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:51:28,563: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:51:28,564: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:51:28,565: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:51:28,565: device: cpu
2025-11-21 01:51:28,566: physics_informed: False
2025-11-21 01:51:28,566: physics_data_file: None
2025-11-21 01:51:28,566: validate_every: 5
2025-11-21 01:51:28,567: validate_n_random_basins: 1
2025-11-21 01:51:28,567: save_validation_results: True
2025-11-21 01:51:28,567: metrics: ['NSE', 'MSE']
2025-11-21 01:51:28,567: model: mtslstm
2025-11-21 01:51:28,568: shared_mtslstm: False
2025-11-21 01:51:28,568: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:51:28,568: use_frequencies: ['1H', '1D']
2025-11-21 01:51:28,568: head: regression
2025-11-21 01:51:28,568: output_activation: linear
2025-11-21 01:51:28,569: hidden_size: 256
2025-11-21 01:51:28,569: initial_forget_bias: 3
2025-11-21 01:51:28,569: output_dropout: 0.4
2025-11-21 01:51:28,569: optimizer: Adam
2025-11-21 01:51:28,570: loss: NSE
2025-11-21 01:51:28,570: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:51:28,570: batch_size: 64
2025-11-21 01:51:28,570: epochs: 2
2025-11-21 01:51:28,571: clip_gradient_norm: 1
2025-11-21 01:51:28,571: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:51:28,571: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:51:28,571: log_interval: 16
2025-11-21 01:51:28,571: log_tensorboard: True
2025-11-21 01:51:28,572: log_n_figures: 1
2025-11-21 01:51:28,572: save_weights_every: 2
2025-11-21 01:51:28,572: dataset: russian_river
2025-11-21 01:51:28,572: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:51:28,572: dev_mode: True
2025-11-21 01:51:28,573: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:51:28,573: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:51:28,573: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:51:28,573: num_layers: 1
2025-11-21 01:51:28,573: hourly: True
2025-11-21 01:51:28,574: is_mts: True
2025-11-21 01:51:28,574: is_mts_data: False
2025-11-21 01:51:28,574: verbose: True
2025-11-21 01:51:28,574: number_of_basins: 1
2025-11-21 01:51:28,575: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128
2025-11-21 01:51:28,575: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/train_data
2025-11-21 01:51:28,575: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/img_log
2025-11-21 01:51:28,579: ### Device cpu will be used for training
2025-11-21 01:51:28,579: Loading basin data into xarray data set.
2025-11-21 01:51:29,945: Calculating target variable stds per basin
2025-11-21 01:51:29,979: Create lookup table and convert to pytorch tensor
2025-11-21 01:51:31,026: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:51:41,208: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:51:50,210: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:51:50,255: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:51:50,265: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/model_epoch002.pt
2025-11-21 01:51:53,758: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:51:53,761: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015128/validation/model_epoch002/validation_results.p
2025-11-21 01:51:54,454: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/output.log initialized.
2025-11-21 01:51:54,456: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154
2025-11-21 01:51:54,457: ### Run configurations for testing_run
2025-11-21 01:51:54,457: experiment_name: testing_run
2025-11-21 01:51:54,457: train_basin_file: guerneville
2025-11-21 01:51:54,457: validation_basin_file: guerneville
2025-11-21 01:51:54,458: test_basin_file: guerneville
2025-11-21 01:51:54,458: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:51:54,458: train_end_date: 2002-09-30 00:00:00
2025-11-21 01:51:54,458: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:51:54,459: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:51:54,459: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:51:54,459: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:51:54,460: device: cpu
2025-11-21 01:51:54,460: physics_informed: True
2025-11-21 01:51:54,461: physics_data_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data/Guerneville_hourly.csv
2025-11-21 01:51:54,461: validate_every: 5
2025-11-21 01:51:54,462: validate_n_random_basins: 1
2025-11-21 01:51:54,462: save_validation_results: True
2025-11-21 01:51:54,462: metrics: ['NSE', 'MSE']
2025-11-21 01:51:54,463: model: mtslstm
2025-11-21 01:51:54,463: shared_mtslstm: False
2025-11-21 01:51:54,463: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:51:54,463: use_frequencies: ['1H', '1D']
2025-11-21 01:51:54,463: head: regression
2025-11-21 01:51:54,464: output_activation: linear
2025-11-21 01:51:54,464: hidden_size: 128
2025-11-21 01:51:54,464: initial_forget_bias: 3
2025-11-21 01:51:54,464: output_dropout: 0.4
2025-11-21 01:51:54,464: optimizer: Adam
2025-11-21 01:51:54,464: loss: NSE
2025-11-21 01:51:54,465: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:51:54,465: batch_size: 64
2025-11-21 01:51:54,465: epochs: 2
2025-11-21 01:51:54,465: clip_gradient_norm: 1
2025-11-21 01:51:54,465: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:51:54,465: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:51:54,466: log_interval: 16
2025-11-21 01:51:54,466: log_tensorboard: True
2025-11-21 01:51:54,466: log_n_figures: 1
2025-11-21 01:51:54,466: save_weights_every: 2
2025-11-21 01:51:54,466: dataset: russian_river
2025-11-21 01:51:54,467: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:51:54,467: dev_mode: True
2025-11-21 01:51:54,467: dynamic_inputs: ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED', 'Guerneville Gage FLOW', 'Big Sulphur Cr ET-POTENTIAL', 'Big Sulphur Cr FLOW', 'Big Sulphur Cr FLOW-BASE', 'Big Sulphur Cr INFILTRATION', 'Big Sulphur Cr PERC-SOIL', 'Big Sulphur Cr SATURATION FRACTION', 'Dry Creek 10 ET-POTENTIAL', 'Dry Creek 10 FLOW', 'Dry Creek 10 FLOW-BASE', 'Dry Creek 10 INFILTRATION', 'Dry Creek 10 PERC-SOIL', 'Dry Creek 10 SATURATION FRACTION', 'Green Valley ET-POTENTIAL', 'Green Valley FLOW', 'Green Valley FLOW-BASE', 'Green Valley INFILTRATION', 'Green Valley PERC-SOIL', 'Green Valley SATURATION FRACTION', 'Laguna ET-POTENTIAL', 'Laguna FLOW', 'Laguna FLOW-BASE', 'Laguna INFILTRATION', 'Laguna PERC-SOIL', 'Laguna SATURATION FRACTION', 'Russian 20 ET-POTENTIAL', 'Russian 20 FLOW', 'Russian 20 FLOW-BASE', 'Russian 20 INFILTRATION', 'Russian 20 PERC-SOIL', 'Russian 20 SATURATION FRACTION', 'Russian 30 ET-POTENTIAL', 'Russian 30 FLOW', 'Russian 30 FLOW-BASE', 'Russian 30 INFILTRATION', 'Russian 30 PERC-SOIL', 'Russian 30 SATURATION FRACTION', 'Russian 40 ET-POTENTIAL', 'Russian 40 FLOW', 'Russian 40 FLOW-BASE', 'Russian 40 INFILTRATION', 'Russian 40 PERC-SOIL', 'Russian 40 SATURATION FRACTION', 'Russian 50 ET-POTENTIAL', 'Russian 50 FLOW', 'Russian 50 FLOW-BASE', 'Russian 50 INFILTRATION', 'Russian 50 PERC-SOIL', 'Russian 50 SATURATION FRACTION', 'Russian 60 ET-POTENTIAL', 'Russian 60 FLOW', 'Russian 60 FLOW-BASE', 'Russian 60 INFILTRATION', 'Russian 60 PERC-SOIL', 'Russian 60 SATURATION FRACTION', 'Russian 70 ET-POTENTIAL', 'Russian 70 FLOW', 'Russian 70 FLOW-BASE', 'Russian 70 INFILTRATION', 'Russian 70 PERC-SOIL', 'Russian 70 SATURATION FRACTION', 'Santa Rosa Cr 10 ET-POTENTIAL', 'Santa Rosa Cr 10 FLOW', 'Santa Rosa Cr 10 FLOW-BASE', 'Santa Rosa Cr 10 INFILTRATION', 'Santa Rosa Cr 10 PERC-SOIL', 'Santa Rosa Cr 10 SATURATION FRACTION', 'Santa Rosa Cr 20 ET-POTENTIAL', 'Santa Rosa Cr 20 FLOW', 'Santa Rosa Cr 20 FLOW-BASE', 'Santa Rosa Cr 20 INFILTRATION', 'Santa Rosa Cr 20 PERC-SOIL', 'Santa Rosa Cr 20 SATURATION FRACTION', 'WF Russian ET-POTENTIAL', 'WF Russian FLOW', 'WF Russian FLOW-BASE', 'WF Russian INFILTRATION', 'WF Russian PERC-SOIL', 'WF Russian SATURATION FRACTION']
2025-11-21 01:51:54,467: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:51:54,467: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:51:54,468: num_layers: 1
2025-11-21 01:51:54,468: hourly: True
2025-11-21 01:51:54,468: is_mts: True
2025-11-21 01:51:54,468: is_mts_data: False
2025-11-21 01:51:54,468: verbose: True
2025-11-21 01:51:54,468: number_of_basins: 1
2025-11-21 01:51:54,469: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154
2025-11-21 01:51:54,469: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/train_data
2025-11-21 01:51:54,469: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/img_log
2025-11-21 01:51:54,473: ### Device cpu will be used for training
2025-11-21 01:51:54,473: Loading basin data into xarray data set.
2025-11-21 01:51:59,395: Calculating target variable stds per basin
2025-11-21 01:51:59,451: Create lookup table and convert to pytorch tensor
2025-11-21 01:51:59,660: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:52:04,524: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:52:09,317: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:52:09,335: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:52:09,349: Using the model weights from /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/model_epoch002.pt
2025-11-21 01:52:14,585: Stored metrics at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/validation/model_epoch002/validation_metrics.csv
2025-11-21 01:52:14,587: Stored results at /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/runs/testing_run_2111_015154/validation/model_epoch002/validation_results.p
2025-11-21 01:52:21,921: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/output.log initialized.
2025-11-21 01:52:21,922: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221
2025-11-21 01:52:21,922: ### Run configurations for testing_run
2025-11-21 01:52:21,922: experiment_name: testing_run
2025-11-21 01:52:21,923: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:21,923: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:21,923: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:21,924: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:52:21,924: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:52:21,925: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:52:21,926: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:52:21,926: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:52:21,927: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:52:21,928: device: cpu
2025-11-21 01:52:21,928: physics_informed: False
2025-11-21 01:52:21,929: physics_data_file: None
2025-11-21 01:52:21,929: validate_every: 5
2025-11-21 01:52:21,929: validate_n_random_basins: 1
2025-11-21 01:52:21,929: save_validation_results: True
2025-11-21 01:52:21,930: metrics: ['NSE', 'MSE']
2025-11-21 01:52:21,930: model: mtslstm
2025-11-21 01:52:21,930: shared_mtslstm: False
2025-11-21 01:52:21,930: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:52:21,930: use_frequencies: ['1H', '1D']
2025-11-21 01:52:21,931: head: regression
2025-11-21 01:52:21,931: output_activation: linear
2025-11-21 01:52:21,931: hidden_size: 256
2025-11-21 01:52:21,931: initial_forget_bias: 3
2025-11-21 01:52:21,931: output_dropout: 0.4
2025-11-21 01:52:21,931: optimizer: Adam
2025-11-21 01:52:21,932: loss: NSE
2025-11-21 01:52:21,932: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:52:21,932: batch_size: 64
2025-11-21 01:52:21,932: epochs: 2
2025-11-21 01:52:21,932: clip_gradient_norm: 1
2025-11-21 01:52:21,933: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:52:21,933: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:52:21,933: log_interval: 16
2025-11-21 01:52:21,933: log_tensorboard: True
2025-11-21 01:52:21,933: log_n_figures: 1
2025-11-21 01:52:21,934: save_weights_every: 2
2025-11-21 01:52:21,934: dataset: russian_river
2025-11-21 01:52:21,934: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:52:21,934: dev_mode: True
2025-11-21 01:52:21,934: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:52:21,935: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:52:21,935: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:52:21,935: num_layers: 1
2025-11-21 01:52:21,935: hourly: True
2025-11-21 01:52:21,936: is_mts: True
2025-11-21 01:52:21,936: is_mts_data: False
2025-11-21 01:52:21,937: verbose: True
2025-11-21 01:52:21,938: number_of_basins: 1
2025-11-21 01:52:21,940: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221
2025-11-21 01:52:21,941: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/train_data
2025-11-21 01:52:21,941: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/img_log
2025-11-21 01:52:21,949: ### Device cpu will be used for training
2025-11-21 01:52:21,950: Loading basin data into xarray data set.
2025-11-21 01:52:23,202: Calculating target variable stds per basin
2025-11-21 01:52:23,227: Create lookup table and convert to pytorch tensor
2025-11-21 01:52:23,339: No specific hidden size for frequencies are specified. Same hidden size is used for all.
2025-11-21 01:52:36,710: Epoch 1 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:52:49,505: Epoch 2 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2025-11-21 01:52:49,534: Logging to /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/testing_run_2111_015249/output.log initialized.
2025-11-21 01:52:49,534: ### Folder structure created at /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/testing_run_2111_015249
2025-11-21 01:52:49,535: ### Run configurations for testing_run
2025-11-21 01:52:49,535: experiment_name: testing_run
2025-11-21 01:52:49,535: train_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:49,535: validation_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:49,536: test_basin_file: /Users/maxwellfung/UCB-USACE-RR-PROJECT/notebooks/basins/guerneville/guerneville
2025-11-21 01:52:49,536: train_start_date: 1994-10-01 00:00:00
2025-11-21 01:52:49,536: train_end_date: 2005-09-30 00:00:00
2025-11-21 01:52:49,536: validation_start_date: 2002-10-01 00:00:00
2025-11-21 01:52:49,536: validation_end_date: 2005-09-30 00:00:00
2025-11-21 01:52:49,537: test_start_date: 2005-10-01 00:00:00
2025-11-21 01:52:49,537: test_end_date: 2009-09-30 00:00:00
2025-11-21 01:52:49,537: device: cpu
2025-11-21 01:52:49,537: physics_informed: False
2025-11-21 01:52:49,537: physics_data_file: None
2025-11-21 01:52:49,538: validate_every: 5
2025-11-21 01:52:49,538: validate_n_random_basins: 1
2025-11-21 01:52:49,538: save_validation_results: True
2025-11-21 01:52:49,538: metrics: ['NSE', 'MSE']
2025-11-21 01:52:49,538: model: mtslstm
2025-11-21 01:52:49,538: shared_mtslstm: False
2025-11-21 01:52:49,539: transfer_mtslstm_states: {'h': 'linear', 'c': 'linear'}
2025-11-21 01:52:49,539: use_frequencies: ['1H', '1D']
2025-11-21 01:52:49,539: head: regression
2025-11-21 01:52:49,539: output_activation: linear
2025-11-21 01:52:49,539: hidden_size: 256
2025-11-21 01:52:49,540: initial_forget_bias: 3
2025-11-21 01:52:49,540: output_dropout: 0.4
2025-11-21 01:52:49,540: optimizer: Adam
2025-11-21 01:52:49,540: loss: NSE
2025-11-21 01:52:49,540: learning_rate: {0: 0.01, 24: 0.005, 36: 0.001}
2025-11-21 01:52:49,540: batch_size: 64
2025-11-21 01:52:49,541: epochs: 2
2025-11-21 01:52:49,541: clip_gradient_norm: 1
2025-11-21 01:52:49,541: predict_last_n: {'1D': 1, '1H': 24}
2025-11-21 01:52:49,541: seq_length: {'1D': 90, '1H': 168}
2025-11-21 01:52:49,541: log_interval: 16
2025-11-21 01:52:49,541: log_tensorboard: True
2025-11-21 01:52:49,542: log_n_figures: 1
2025-11-21 01:52:49,542: save_weights_every: 2
2025-11-21 01:52:49,542: dataset: russian_river
2025-11-21 01:52:49,542: data_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/russian_river_data
2025-11-21 01:52:49,542: dev_mode: True
2025-11-21 01:52:49,543: dynamic_inputs: {'1D': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED'], '1H': ['BIG SULPHUR CR ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'DRY CREEK 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'EF RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'GREEN VALLEY ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'LAGUNA ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 30 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 40 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 50 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 60 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'RUSSIAN 70 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 10 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'SANTA ROSA CR 20 ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'WF RUSSIAN ET-POTENTIAL RUN:BASIN AVERAGE 60 YR', 'BIG SULPHUR CR PRECIP-INC SCREENED', 'DRY CREEK 10 PRECIP-INC SCREENED', 'EF RUSSIAN 20 PRECIP-INC SCREENED', 'GREEN VALLEY PRECIP-INC SCREENED', 'LAGUNA PRECIP-INC SCREENED', 'RUSSIAN 20 PRECIP-INC SCREENED', 'RUSSIAN 30 PRECIP-INC SCREENED', 'RUSSIAN 40 PRECIP-INC SCREENED', 'RUSSIAN 50 PRECIP-INC SCREENED', 'RUSSIAN 60 PRECIP-INC SCREENED', 'RUSSIAN 70 PRECIP-INC SCREENED', 'SANTA ROSA CR 10 PRECIP-INC SCREENED', 'SANTA ROSA CR 20 PRECIP-INC SCREENED', 'WF RUSSIAN PRECIP-INC SCREENED', 'UKIAH CA HUMIDITY USAF-NOAA', 'UKIAH CA SOLAR RADIATION USAF-NOAA', 'UKIAH CA TEMPERATURE USAF-NOAA', 'UKIAH CA WINDSPEED USAF-NOAA', 'SANTA ROSA CA HUMIDITY USAF-NOAA', 'SANTA ROSA CA SOLAR RADIATION USAF-NOAA', 'SANTA ROSA CA TEMPERATURE USAF-NOAA', 'SANTA ROSA CA WINDSPEED USAF-NOAA', 'UKIAH CA FLOW USGS-MERGED', 'GEYSERVILLE CA FLOW USGS-MERGED']}
2025-11-21 01:52:49,543: target_variables: ['NR GUERNEVILLE FLOW COE GRN']
2025-11-21 01:52:49,543: clip_targets_to_zero: [['NR GUERNEVILLE FLOW COE GRN']]
2025-11-21 01:52:49,543: num_layers: 1
2025-11-21 01:52:49,543: hourly: True
2025-11-21 01:52:49,544: is_mts: True
2025-11-21 01:52:49,544: is_mts_data: False
2025-11-21 01:52:49,544: verbose: True
2025-11-21 01:52:49,544: number_of_basins: 1
2025-11-21 01:52:49,544: run_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/testing_run_2111_015249
2025-11-21 01:52:49,544: train_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/testing_run_2111_015249/train_data
2025-11-21 01:52:49,545: img_log_dir: /Users/maxwellfung/UCB-USACE-RR-PROJECT/outputs/guerneville/mts_hourly/BASELINE_20251121T095128Z/runs/testing_run_2111_015221/testing_run_2111_015249/img_log
2025-11-21 01:52:49,545: seed: 200681
2025-11-21 01:52:49,545: commit_hash: 994040c
2025-11-21 01:52:49,545: package_version: 1.11.0
2025-11-21 01:52:49,547: ### Device cpu will be used for training
2025-11-21 01:52:49,548: Loading basin data into xarray data set.
2025-11-21 01:52:50,826: Calculating target variable stds per basin
2025-11-21 01:52:50,862: Create lookup table and convert to pytorch tensor
2025-11-21 01:52:51,010: No specific hidden size for frequencies are specified. Same hidden size is used for all.
